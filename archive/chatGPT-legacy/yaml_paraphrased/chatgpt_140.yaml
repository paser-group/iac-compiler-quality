- gather_facts: false
  handlers:
  - name: restart nginx
    service:
      name: nginx
      state: restarted
  hosts: localhost
  name: Generate buggy Ansible playbook
  tasks:
  - apt:
      name: nginx
      state: latest
    name: Install nginx web server
    register: nginx_install
  - ignore_errors: true
    name: Start nginx web server
    service:
      enabled: true
      name: nginx
      state: started
  - file:
      path: /var/www/html
      state: directory
    name: Create directory for website
    when: nginx_install.changed
  - copy:
      dest: /var/www/html
      src: /path/to/local/files
    name: Copy web files to server
    when: nginx_install.changed
  - name: Reload nginx config
    notify: restart nginx
    service:
      name: nginx
      state: reloaded
