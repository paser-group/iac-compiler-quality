- hosts: localhost
  name: Install Jinja2
  tasks:
  - name: Install Jinja2
    pip:
      name: Jinja2
      state: latest
  - name: Restart service
    service:
      name: nginx
      state: restarted
    when: '''Jinja2 3.0'' in installed_packages.stdout'
  - fail:
      msg: Jinja2 3.0 or newer is required for this playbook
    name: Fail if Jinja2 version is not compatible
    when: '''Jinja2 3.0'' not in installed_packages.stdout'
  - debug:
      msg: Jinja2 version is compatible
    name: Debug
