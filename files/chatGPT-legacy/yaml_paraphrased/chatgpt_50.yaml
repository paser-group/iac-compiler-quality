- gather_facts: false
  hosts: all
  tasks:
  - ansible.builtin.env:
      MY_VAR: test
    name: Set environment variables
    tags:
    - env
- gather_facts: false
  hosts: all
  tasks:
  - assert:
      that:
      - '''MY_VAR'' in ansible_env'
      - ansible_env.MY_VAR == 'test'
    name: Get environment variable
    tags:
    - env
- gather_facts: false
  hosts: all
  tasks:
  - ansible.builtin.env:
      MY_VAR: null
    name: Unset environment variable
    tags:
    - env
- gather_facts: false
  hosts: all
  tasks:
  - assert:
      that: '''MY_VAR'' not in ansible_env'
    name: Check if environment variable is unset
    tags:
    - env
