- apt:
    name: apache2
    state: started
  name: Install and start Apache
  register: apache2
- copy:
    content: <html><body><h1>Error 500</h1><p>Oops, something went wrong!</p></body></html>
    dest: /var/www/html/500.html
  name: Create custom error page
  when: apache2.changed
- name: Open port 80 in firewall
  register: firewall
  ufw:
    port: 80
    rule: allow
    state: enabled
- name: Restart Apache if firewall rule was added
  service:
    name: apache2
    state: restarted
  when: firewall.changed
- lineinfile:
    line: 10.0.0.2 webserver
    path: /etc/hosts
    state: present
  name: Configure hosts file
