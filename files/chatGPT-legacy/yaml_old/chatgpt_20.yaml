- become: true
  become_user: root
  connection: local
  hosts: localhost
  name: Ulimit change not taking effect
  tasks:
  - name: Change ulimit
    register: ulimit_change
    ulimit:
      hard: 65536
      name: nofile
      soft: 65536
  - command: ulimit -n
    name: Check ulimit change
    register: ulimit_check
  - debug:
      msg: Ulimit change was {{ ulimit_change.changed }}
    name: Report ulimit change
    when: ulimit_check.stdout != 65536
