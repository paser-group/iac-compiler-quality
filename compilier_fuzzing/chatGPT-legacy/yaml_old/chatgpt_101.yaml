- gather_facts: false
  hosts: windows
  tasks:
  - name: Set encoding to UTF-8
    win_environment:
      name: PYTHONIOENCODING
      value: utf-8
  - name: Set encoding to ISO-8859-1
    win_environment:
      name: PYTHONIOENCODING
      value: iso-8859-1
  - name: Create a script to mix the two encoding
    win_shell: 'set PYTHONIOENCODING=utf-8

      set PYTHONIOENCODING=iso-8859-1

      echo "This is a test of mixing two encoding"

      echo "This is a test of mixing two encoding" > test.txt

      '
  - name: Run the script
    win_shell: test.txt
