- connection: local
  gather_facts: false
  hosts: localhost
  tasks:
  - command: test -f /path/to/remote/file
    name: Ensure that the remote file is present
    register: remote_file_status
  - command: test -f /path/to/local/file
    name: Ensure that the local file is present
    register: local_file_status
  - command: scp /path/to/remote/file /path/to/local/file
    name: Transfer the remote file to the local file
    when: remote_file_status.rc == 0 and local_file_status.rc == 0
  - command: touch /path/to/local/file
    name: Create the local file if it does not exist
    when: local_file_status.rc != 0
