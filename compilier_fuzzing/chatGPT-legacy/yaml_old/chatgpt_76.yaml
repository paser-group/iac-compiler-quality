- gather_facts: false
  hosts: localhost
  name: Demonstrate Ansible shell plugin parameters not matching documentation
  tasks:
  - args:
      chdir: /tmp
      creates: /tmp/hosts
      executable: /bin/bash
      removes: /tmp/hosts
    name: Run command with shell plugin
    register: result
    shell: cat /etc/hosts
  - fail:
      msg: The command did not run correctly
    name: Check if the command ran correctly
    when: result.rc != 0
  - fail:
      msg: The parameters did not match the documentation
    name: Check if the parameters matched the documentation
    when: result.args != '/bin/bash -c "cat /etc/hosts" && result.cwd != '/tmp' &&
      result.creates != '/tmp/hosts' && result.removes != '/tmp/hosts'
