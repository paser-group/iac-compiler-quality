- become: true
  hosts: remote
  name: Test cryptography for Python 3.9 on Ubuntu 20.04
  tasks:
  - apt:
      name: '{{ item }}'
      state: present
    loop:
    - python3
    - python3-dev
    - build-essential
    - libssl-dev
    - libffi-dev
    name: Install dependencies
  - name: Install cryptography
    pip:
      executable: pip3
      name: cryptography
      state: present
  - command: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key())"
    name: Test cryptography
