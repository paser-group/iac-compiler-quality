- become: true
  gather_facts: false
  hosts: all
  name: Kill Children Processes
  tasks:
  - name: Find Child Processes
    register: proc_info
    shell: ps -o pid,ppid --no-headers
  - name: Kill Child Processes
    shell: kill -9 {{ item.split()[0] }}
    when: '''{{ item.split()[1] }}'' == ''{{ ansible_pid }}'''
    with_items: '{{ proc_info.stdout_lines }}'
