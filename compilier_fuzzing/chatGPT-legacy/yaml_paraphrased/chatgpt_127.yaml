- hosts: localhost
  name: buggy playbook
  tasks:
  - apt: name=my_package state=present
    name: Install package on Debian-based systems
    when: ansible_distribution == "Ubuntu"
  - name: Install package on RedHat-based systems
    when: ansible_distribution == "CentOS"
    yum: name=my_package state=present
  - dnf: name=my_package state=present
    name: Install package on Fedora systems
    when: ansible_distribution == "Fedora"
  - name: Install package on Amazon Linux systems
    when: ansible_distribution == "Amazon"
    yum: name=my_package state=present
