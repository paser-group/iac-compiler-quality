- handlers:
  - mail:
      body: A worker was found in a dead state and has been successfully restarted
      subject: Dead worker found and restarted
      to: admin@example.com
    name: email_admin
  hosts: all
  name: Restart dead worker
  tasks:
  - command: ps aux | grep worker | grep -v grep | awk '{print $2}' | xargs kill -9
    name: Find dead worker
    register: dead_worker
  - command: /path/to/worker_script.py
    name: Restart worker
    notify: email_admin
    when: dead_worker|failed
