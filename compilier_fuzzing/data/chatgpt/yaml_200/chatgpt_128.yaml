- gather_facts: false
  hosts: localhost
  tasks:
  - ansible.builtin.set_fact:
      encrypted_password: '{{ secret_password | ansible.builtin.ansible_vault_encrypt_string
        }}'
    name: Encrypt the secret_password variable
    register: result
  - debug:
      var: result.encrypted_password
    name: Print out the encrypted password
  - copy:
      content: '{{ result.encrypted_password }}'
      dest: /tmp/encrypted_password.txt
    name: Write encrypted password to file
  vars:
    secret_password: supersecretpassword
