- gather_facts: false
  handlers:
  - listen: restart service
    name: restart service
    service: name=example_service state=restarted
  hosts: localhost
  roles:
  - role: example_role
    vars_files:
    - vars/main.yml
    - vars/secrets.yml
  tasks:
  - changed_when: false
    command: echo "Running dependencies"
    delegate_to: localhost
    name: Run example_role's dependencies
    notify:
    - restart service
    run_once: true
    when: inventory_hostname == 'localhost'
- gather_facts: false
  handlers:
  - listen: restart service
    name: restart service
    service: name=example_service state=restarted
  hosts: other_hosts
  roles:
  - role: example_role
    vars_files:
    - vars/main.yml
    - vars/secrets.yml
  tasks:
  - changed_when: false
    command: echo "Running dependencies"
    delegate_to: localhost
    name: Run example_role's dependencies
    notify:
    - restart service
    run_once: true
    when: inventory_hostname == 'localhost'
