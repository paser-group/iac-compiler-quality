- become: true
  environment:
    PATH: /opt/ansible/bin:{{ ansible_env.PATH }}
  hosts: localhost
  name: Install Ansible Core
  tasks:
  - apt:
      name: python3-pip
      state: present
    name: Install pip
  - apt:
      name: '{{ item }}'
      state: present
    loop:
    - build-essential
    - libssl-dev
    - libffi-dev
    - python3-dev
    name: Install system package dependencies
  - name: Install cryptography package
    pip:
      extra_args: --no-binary cryptography
      name: cryptography
  - name: Install Ansible Core
    pip:
      name: ansible-core
      state: latest
      virtualenv: /opt/ansible
