- apt:
    name:
    - apache2
    - php7.2
    - mysql-server
    update_cache: true
  become: true
  name: Update system and install required packages
  when: ansible_os_family == 'Debian'
- become: true
  name: Install necessary Python modules
  pip:
    name:
    - requests
    - beautifulsoup4
  when: ansible_os_family == 'Debian'
- become: true
  copy:
    dest: /etc/apache2/sites-available/default.conf
    src: /home/user/apache2.conf
  name: Configure Apache2 virtual host
  notify: restart apache2
- become: true
  mysql_db:
    name: my_database
    state: present
  name: Configure MySQL database
  register: mysql_db_output
- become: true
  mysql_user:
    host: localhost
    name: my_user
    password: password
    priv: my_database.*:ALL
    state: present
  name: Create MySQL database user
- become: true
  copy:
    dest: /var/www/html/app.tar.gz
    src: /home/user/app.tar.gz
  name: Deploy web application
  notify: restart apache2
