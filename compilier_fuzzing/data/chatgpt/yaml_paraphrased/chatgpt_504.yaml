- gather_facts: false
  hosts: all
  name: Install Python 3.11
  tasks:
  - apt:
      name: '{{ item }}'
      state: present
    become: true
    name: Install Python 3.11 dependencies
    with_items:
    - build-essential
    - zlib1g-dev
    - libncurses5-dev
    - libgdbm-dev
    - libnss3-dev
    - libssl-dev
    - libreadline-dev
    - libffi-dev
  - get_url:
      dest: /tmp
      url: https://www.python.org/ftp/python/3.11.0/Python-3.11.0.tgz
    name: Download Python 3.11
  - name: Unpack Python 3.11
    unarchive:
      dest: /usr/local/src
      remote_src: true
      src: /tmp/Python-3.11.0.tgz
  - args:
      chdir: /usr/local/src/Python-3.11.0
    become: true
    name: Configure Python 3.11
    shell: ./configure --enable-optimizations && make altinstall
  - become: true
    command: update-alternatives --install /usr/bin/python python /usr/local/bin/python3.11
      1
    name: Update alternatives
