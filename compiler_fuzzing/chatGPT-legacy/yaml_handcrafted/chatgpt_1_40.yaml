- gather_facts: false
  hosts: localhost
  name: RPM build for ansible-core 2.14.1
  tasks:
  - become: true
    name: Install required packages for RPM build
    package:
      name:
      - rpm-build
      - make
      - gcc
      - python3-devel
      - python3-setuptools
  - become: true
    git:
      dest: /opt/ansible-git
      repo: https://github.com/ansible/ansible.git
      version: v2.14.1
    name: Clone ansible-core Git repository
  - args:
      chdir: /root/rpmbuild/SPECS
    become: true
    command: /opt/ansible-git/scripts/package-spec.py --version 2.14.1 > ansible.spec
    name: Generate spec file from ansible-core source
  - args:
      chdir: /root/rpmbuild/SPECS
    become: true
    command: rpmbuild -ba ansible.spec
    name: Build Ansible RPM
