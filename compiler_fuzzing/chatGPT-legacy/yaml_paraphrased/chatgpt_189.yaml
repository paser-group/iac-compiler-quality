- hosts: all
  name: Redirect Docker to Community
  tasks:
  - block:
    - community.general.docker_compose:
        binary_path: /usr/local/bin/docker-compose
        project_name: myproject
        pull: true
        use_community_provider: true
      name: Enable community provider
    name: Change Docker provider
    rescue:
    - ansible.builtin.debug:
        msg: 'redirecting (type: connection) ansible.builtin.docker to community'
      name: Redirect Docker to community
  - ansible.builtin.service:
      name: docker
      state: restarted
    name: Restart Docker
