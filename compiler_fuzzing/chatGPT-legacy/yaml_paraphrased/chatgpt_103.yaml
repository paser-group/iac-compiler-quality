- hosts: localhost
  tasks:
  - become: true
    become_user: root
    name: Create template file
    template:
      dest: '{{ template_file_path }}'
      src: template_file.j2
  - become: true
    become_user: root
    file:
      mode: u=rw,g=r,o=
      path: '{{ template_file_path }}'
    name: Remove read permissions on file
  - become: true
    become_user: root
    copy:
      dest: /tmp/some_dest_file
      src: '{{ template_file_path }}'
    name: Copy file
  - name: Verify file copy
    register: dest_file_stat
    stat:
      path: /tmp/some_dest_file
  - fail:
      msg: Template file was accessible!
    name: Fail if template file was accessible
    when: not dest_file_stat.stat.exists
  vars:
    data: some data
    template_file_path: /tmp/some_template_file
