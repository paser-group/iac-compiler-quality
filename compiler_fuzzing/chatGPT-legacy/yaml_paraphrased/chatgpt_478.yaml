- become: true
  hosts: webservers
  name: Install and start Apache web server
  tasks:
  - name: Install Apache
    notify:
    - start apache
    yum:
      name: httpd
      state: installed
  - copy:
      content: <h1>Welcome to my website</h1>
      dest: /var/www/html/index.html
    name: Create index.html file
  - name: Start Apache
    service:
      name: httpd
      state: started
- become: true
  hosts: databaseservers
  name: Install MySQL server
  tasks:
  - name: Install MySQL server
    yum:
      name: mysql
      state: installed
  - name: Start MySQL
    service:
      name: mysql
      state: started
- gather_facts: false
  hosts: webservers
  name: Deploy Application
  tasks:
  - copy:
      dest: /opt/myapp/
      src: /path/to/application.tar.gz
    name: Copy application file
  - name: Unpack application
    unarchive:
      dest: /opt/myapp/
      remote_src: true
      src: /opt/myapp/application.tar.gz
  - args:
      chdir: /opt/myapp/
    command: npm install
    name: Install application dependencies
    register: result
  - args:
      chdir: /opt/myapp/
    async: 1000
    name: Start application
    poll: 0
    shell: node index.js
