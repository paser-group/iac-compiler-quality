- connection: local
  gather_facts: false
  hosts: localhost
  tasks:
  - docker_container:
      image: '{{ image_name }}'
      name: '{{ image_name }}'
      restart_policy: always
      state: present
    name: Create container
  - command: docker exec {{ image_name }} /bin/sh -c "integration_test"
    name: Run integration test
    register: integration_test_result
  - debug:
      msg: '{{ integration_test_result.stdout }}'
    name: Debug output
    when: integration_test_result.failed
  vars:
    image_name: fedora36
