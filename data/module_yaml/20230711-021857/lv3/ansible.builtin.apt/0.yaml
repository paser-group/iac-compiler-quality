---
# Ansible playbook designed for the ansible.builtin.apt module 
# to reveal possible type-related bugs
- hosts: ubuntu1
  become: true
  vars:
    byte_var: !!binary |
      SGVsbG8gd29ybGQK
    string_var: 'Hello world'

  tasks:
  - name: Update APT cache
    ansible.builtin.apt:
      update_cache: true
      cache_valid_time: "{{ byte_var }}"

  - name: Install Apache with byte var in default_release
    ansible.builtin.apt:
      name: apache2
      state: present
      default_release: "{{ byte_var }}"

  - name: Remove Apache with byte var in dpkg_options
    ansible.builtin.apt:
      name: apache2
      state: absent
      dpkg_options: "{{ byte_var }}"

  - name: Install Apache with string var in default_release
    ansible.builtin.apt:
      name: apache2
      state: present
      default_release: "{{ string_var }}"

  - name: Remove Apache with string var in dpkg_options
    ansible.builtin.apt:
      name: apache2
      state: absent
      dpkg_options: "{{ string_var }}"

  - name: Install Apache with byte and string var in default_release
    ansible.builtin.apt:
      name: apache2
      state: present
      default_release: "{{ byte_var }}{{ string_var }}"

  - name: Remove Apache with byte and string var in dpkg_options
    ansible.builtin.apt:
      name: apache2
      state: absent
      dpkg_options: "{{ byte_var }}{{ string_var }}"