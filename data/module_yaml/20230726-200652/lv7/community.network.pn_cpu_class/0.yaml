---
- name: Test playbook for community.network.pn_cpu_class module
  hosts: localhost
  gather_facts: false

  tasks:
    # Task 1: Create CPU class "test_class" with a limit of 10 using division-based operation
    - name: Create CPU class
      community.network.pn_cpu_class:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_hog_protect: "{{ pn_hog_protect }}"
        pn_name: "test_class"
        pn_rate_limit: "{{ 100 / 10 }}"
        pn_scope: null
        state: present
      register: cpu_class_result

    # Task 2: Test if CPU class "test_class" is created successfully
    - name: Check if CPU class is created
      debug:
        var: cpu_class_result

    # Task 3: Update CPU class "test_class" with a limit of 20 using division-based operation
    - name: Update CPU class
      community.network.pn_cpu_class:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_hog_protect: "{{ pn_hog_protect }}"
        pn_name: "test_class"
        pn_rate_limit: "{{ 100 / 20 }}"
        pn_scope: null
        state: present
      register: updated_cpu_class_result

    # Task 4: Test if CPU class "test_class" is updated successfully
    - name: Check if CPU class is updated
      debug:
        var: updated_cpu_class_result

    # Task 5: Delete CPU class "test_class"
    - name: Delete CPU class
      community.network.pn_cpu_class:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "test_class"
        state: absent
      register: deleted_cpu_class_result

    # Task 6: Test if CPU class "test_class" is deleted successfully
    - name: Check if CPU class is deleted
      debug:
        var: deleted_cpu_class_result