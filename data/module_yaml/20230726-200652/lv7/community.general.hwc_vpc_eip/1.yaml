---
- name: Test hwc_vpc_eip module
  hosts: node
  gather_facts: false

  vars:
    dedicated_bandwidth_limit: 50

  tasks:
    - name: Calculate the dedicated_bandwidth value
      set_fact:
        dedicated_bandwidth_value: "{{ dedicated_bandwidth_limit | int / 2 }}"

    - name: Create VPC EIP resource
      community.general.hwc_vpc_eip:
        dedicated_bandwidth:
          value: "{{ dedicated_bandwidth_value }}"
          unit: Mbps
        domain: example.com
        enterprise_project_id: "123456"
        id: "567890"
        identity_endpoint: "http://identity.example.com"
        ip_version: 4
        ipv4_address: "10.1.1.100"
        password: "secretpassword"
        port_id: "987654"
        project: "myproject"
        region: "us-east-1"
        shared_bandwidth_id: "098765"
        state: present
        timeouts:
          create: 300
          update: 180
          delete: 120
        type: "eip"
        user: "admin"
      register: vpc_eip_result

    - debug:
        var: vpc_eip_result