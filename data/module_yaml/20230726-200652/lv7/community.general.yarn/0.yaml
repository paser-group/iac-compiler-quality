- hosts: localhost
  gather_facts: false

  tasks:
    - name: Set variables
      set_fact:
        subnet: "10.1.1.0/24"
        gateway_octet: "254"
        node_count: 4
        gateway: "{{ subnet.split('/')[0] }}.{{ gateway_octet }}"
        ip_prefix_length: "{{ (32 - subnet.split('/')[1] | int) }}"

    - name: Generate IP addresses for nodes
      set_fact:
        nodes:
          - name: ubuntu1
            ip: "{{ subnet.split('/')[0] }}.{{ 1 | int }}"
          - name: alpine1
            ip: "{{ subnet.split('/')[0] }}.{{ 2 | int }}"
          - name: centos1
            ip: "{{ subnet.split('/')[0] }}.{{ 3 | int }}"
          - name: redhat1
            ip: "{{ subnet.split('/')[0] }}.{{ 4 | int }}"

    - name: Debug tasks
      debug:
        var: item
      loop: "{{ nodes }}"