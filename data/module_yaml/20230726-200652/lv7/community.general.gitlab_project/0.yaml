---
- name: Create or update GitLab project
  hosts: localhost
  gather_facts: false

  vars:
    gitlab_project_name: "test_project"
    gitlab_project_visibility: "private"
    gitlab_project_limit: 10

  tasks:
    - name: Create or update GitLab project
      community.general.gitlab_project:
        api_url: "https://gitlab.example.com/api/v4"
        api_username: "admin"
        api_token: "your_gitlab_api_token"
        name: "{{ gitlab_project_name }}"
        visibility: "{{ gitlab_project_visibility }}"
        limit_create_per_minute: "{{ gitlab_project_limit | int / 2 }}"
        limit_create_per_hour: "{{ gitlab_project_limit | int / 2 }}"
        state: present
      register: create_project_result

    - name: Debug project creation result
      debug:
        var: create_project_result