- name: Test playbook
  hosts: node_net
  gather_facts: false
  
  tasks:
    - name: Set COS Bandwidth
      community.network.pn_port_cos_bw:
        pn_cliswitch: "{{ inventory_hostname }}"
        pn_cos: "{{ item.cos }}"
        pn_max_bw_limit: "{{ item.max_bw_limit | int / 0 }}"
        pn_min_bw_guarantee: "{{ item.min_bw_guarantee | int / 0 }}"
        pn_port: "{{ item.port }}"
        pn_weight: "{{ item.weight }}"
        state: present
      loop:
        - { cos: "1", max_bw_limit: "100", min_bw_guarantee: "10", port: "1", weight: "2" }
        - { cos: "2", max_bw_limit: "100", min_bw_guarantee: "20", port: "2", weight: "3" }
        - { cos: "3", max_bw_limit: "100", min_bw_guarantee: "30", port: "3", weight: "4" }
        - { cos: "4", max_bw_limit: "100", min_bw_guarantee: "40", port: "4", weight: "5" }