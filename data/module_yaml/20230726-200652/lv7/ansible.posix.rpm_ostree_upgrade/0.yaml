- name: Manage rpm-ostree upgrades
  hosts: all
  become: true

  tasks:
    - name: Upgrade rpm-ostree
      ansible.posix.rpm_ostree_upgrade:
        allow_downgrade: "{{ item.allow_downgrade | bool }}"
        cache_only: "{{ item.cache_only | bool }}"
        os: "{{ item.os }}"
        peer: "{{ item.peer | bool }}"
      loop:
        - allow_downgrade: true
          cache_only: true
          os: ubuntu
          peer: false
        - allow_downgrade: false
          cache_only: false
          os: alpine
          peer: true
        - allow_downgrade: true
          cache_only: false
          os: centos
          peer: false
        - allow_downgrade: false
          cache_only: true
          os: redhat
          peer: true