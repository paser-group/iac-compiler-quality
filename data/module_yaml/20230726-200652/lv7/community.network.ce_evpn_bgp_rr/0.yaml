---
- name: Test the community.network.ce_evpn_bgp_rr module
  hosts: localhost
  gather_facts: false
  vars:
    as_number: 65001
    bgp_evpn_enable: true
    bgp_instance: 0
    peer:
      - ip: 192.168.1.1
        as_number: 65002
    peer_type: "External"
    policy_vpn_target:
      - policy_name: "policy1"
        route_distinguisher: 100:100
    reflect_client: false

  tasks:
    - name: Install community.network.ce_evpn_bgp_rr collection
      ansible.builtin.command: ansible-galaxy collection install community.network

    - name: Configure RR for VXLAN Network on HUAWEI
      community.network.ce_evpn_bgp_rr:
        as_number: "{{ as_number }}"
        bgp_evpn_enable: "{{ bgp_evpn_enable }}"
        bgp_instance: "{{ bgp_instance }}"
        peer: "{{ peer }}"
        peer_type: "{{ peer_type }}"
        policy_vpn_target: "{{ policy_vpn_target }}"
        reflect_client: "{{ reflect_client }}"