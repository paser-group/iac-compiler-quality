- name: Test playbook for 'community.general.proxmox_snap' module
  hosts: localhost
  gather_facts: false

  vars:
    api_host: "127.0.0.1"
    api_user: "admin@pve"
    api_password: "secret"
    vmid: "100"
    snapname: "snapshot-{{ ansible_date_time.epoch }}"
    description: "Test snapshot"
    state: "present"
    timeout: 10
    validate_certs: false

  tasks:
    - name: Create snapshot
      community.general.proxmox_snap:
        api_host: "{{ api_host }}"
        api_user: "{{ api_user }}"
        api_password: "{{ api_password }}"
        vmid: "{{ vmid }}"
        snapname: "{{ snapname }}"
        description: "{{ description }}"
        state: "{{ state }}"
        timeout: "{{ timeout }}"
        validate_certs: "{{ validate_certs }}"
      register: snapshot_result
      
    - debug:
        var: snapshot_result