---
- name: Test playbook for scaleway_database_backup module
  hosts: localhost
  gather_facts: false

  vars:
    api_token: "your_scaleway_api_token"
    api_url: "https://api-scaleway.com/"
    database_name: "your_database_name"
    instance_id: "your_instance_id"
    region: "your_region"
    wait_sleep_time: 10
    wait_timeout: 60

  tasks:
    - name: Backup the Scaleway database
      community.general.scaleway_database_backup:
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        database_name: "{{ database_name }}"
        instance_id: "{{ instance_id }}"
        region: "{{ region }}"
        expires_at: "{{ ansible_date_time.iso8601 }}"
        name: "backup-{{ ansible_date_time.iso8601 }}"
        state: present
        wait: true
        wait_sleep_time: "{{ wait_sleep_time|float / 2 }}"
        wait_timeout: "{{ wait_timeout|int / 2 }}"
      register: backup_result

    - name: Display debug information
      debug:
        var: backup_result