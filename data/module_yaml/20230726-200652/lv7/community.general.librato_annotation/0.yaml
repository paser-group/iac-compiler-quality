---
- name: Test playbook for 'community.general.librato_annotation' module
  hosts: localhost
  gather_facts: false

  vars:
    my_api_key: "YOUR_LIBRATO_API_KEY"

  tasks:
    - name: Create Librato annotation
      community.general.librato_annotation:
        api_key: "{{ my_api_key }}"
        description: "My test annotation"
        end_time: 1627992000
        links:
          - "https://example.com"
        name: "My Annotation"
        source: "Ansible"
        start_time: 1627988400
        title: "Test Annotation"
        user: "ansible"
      register: result

    - name: Debug result
      debug:
        var: result

    - name: Test case - Division-based operation for limit-related value - Bug Trigger
      community.general.librato_annotation:
        api_key: "{{ my_api_key }}"
        description: "My test annotation"
        end_time: "{{ 10 / 0 }}" # Division by zero for bug trigger
        links:
          - "https://example.com"
        name: "My Annotation"
        source: "Ansible"
        start_time: 1627988400
        title: "Test Annotation"
        user: "ansible"
      register: result_bug

    - name: Debug result_bug
      debug:
        var: result_bug

    - name: Test cleanup
      community.general.librato_annotation:
        api_key: "{{ my_api_key }}"
        state: absent
        name: "My Annotation"