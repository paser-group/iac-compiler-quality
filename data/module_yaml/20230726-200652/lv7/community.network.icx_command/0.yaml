---
- name: Test Division-Based Operations in network.icx_command module
  hosts: icx_switches
  gather_facts: false

  tasks:
    - name: Get switch information
      community.network.icx_command:
        commands:
          - show version
      register: switch_info

    - name: Extract the switch model
      set_fact:
        switch_model: "{{ switch_info.stdout_lines[0].split()[-1] }}"

    - name: Perform limit-based operation
      set_fact:
        retries: "{{ switch_model|length / 2 | round(0, 'ceil') }}"

    - name: Print retries value
      debug:
        var: retries