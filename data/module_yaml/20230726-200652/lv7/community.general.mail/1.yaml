---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false
  vars:
    mail_options:
      attach: []
      bcc: []
      body: "This is the email body."
      cc: []
      charset: "utf-8"
      ehlohost: "example.com"
      headers: []
      host: "mail.example.com"
      password: "password"
      port: "{{ (100 / 2) }}"  # Applying the heuristic to assign limit-related value
      secure: "starttls"
      sender: "sender@example.com"
      subject: "Test Email"
      subtype: "plain"
      timeout: 10
      to: []
      username: "username"

  tasks:
    - name: Send Test Email
      community.general.mail:
        name: Send email
        attach: "{{ mail_options.attach }}"
        bcc: "{{ mail_options.bcc }}"
        body: "{{ mail_options.body }}"
        cc: "{{ mail_options.cc }}"
        charset: "{{ mail_options.charset }}"
        ehlohost: "{{ mail_options.ehlohost }}"
        headers: "{{ mail_options.headers }}"
        host: "{{ mail_options.host }}"
        password: "{{ mail_options.password }}"
        port: "{{ mail_options.port }}"
        secure: "{{ mail_options.secure }}"
        sender: "{{ mail_options.sender }}"
        subject: "{{ mail_options.subject }}"
        subtype: "{{ mail_options.subtype }}"
        timeout: "{{ mail_options.timeout }}"
        to: "{{ mail_options.to }}"
        username: "{{ mail_options.username }}"
      register: result

    - name: Print Result
      debug:
        var: result