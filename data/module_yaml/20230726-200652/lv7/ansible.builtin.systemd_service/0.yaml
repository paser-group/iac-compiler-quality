- name: Test systemd service module
  hosts: all

  vars:
    service_name: "my_service"
    service_state: "started"
    service_scope: "user"
    service_enabled: true

  tasks:
    - name: Enable systemd service
      systemd_service:
        name: "{{ service_name }}"
        state: "{{ service_state }}"
        scope: "{{ service_scope }}"
        enabled: "{{ service_enabled }}"
      register: result

    - name: Print result
      debug:
        var: result

    - name: Divide scope string
      set_fact:
        divided_scope: "{{ service_scope | split(',') }}"
        
    - name: Divide limit string
      set_fact:
        divided_limit: "{{ service_limit | split(',') }}"
      
    - name: Iterate over divided scope and limit
      debug:
        msg: "Scope: {{ item.0 }}, Limit: {{ item.1 }}"
      loop: "{{ divided_scope|product(divided_limit)|list }}"