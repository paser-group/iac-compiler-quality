---
- name: Test InfluxDB Retention Policy
  hosts: localhost
  gather_facts: false

  vars:
    divider: 2

  tasks:
    - name: Create InfluxDB Retention Policy
      community.general.influxdb_retention_policy:
        database_name: "my_db"
        policy_name: "my_policy"
        duration: "7d"
        shard_group_duration: "{{ '1w' | batch(divider) | list }}"
        replication: 2
        default: false
      register: result

    - name: Print Result
      debug:
        var: result