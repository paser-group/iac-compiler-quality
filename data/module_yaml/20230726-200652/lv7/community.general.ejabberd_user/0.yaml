- name: Manage ejabberd users
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create ejabberd user
      community.general.ejabberd_user:
        host: "{{ inventory_hostname }}"
        logging: yes
        state: "{{ state }}"
        username: "{{ username }}"
        password: "{{ password }}"
      vars:
        username: "test_user"
        password: 12345
        state: present

    - name: Delete ejabberd user
      community.general.ejabberd_user:
        host: "{{ inventory_hostname }}"
        logging: yes
        state: "{{ state }}"
        username: "{{ username }}"
      vars:
        username: "test_user"
        state: absent

    - name: Debug variable types
      debug:
        msg: "Username: {{ username }} / Password: {{ password }} / State: {{ state }}"