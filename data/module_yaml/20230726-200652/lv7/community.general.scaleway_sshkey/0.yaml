- name: Test playbook for community.general.scaleway_sshkey module
  hosts: localhost
  gather_facts: false

  vars:
    api_timeout: 30
    api_token: "your_scaleway_api_token"
    api_url: "https://your_scaleway_api_url"
    query_parameters:
      organization_id: "your_organization_id"
    ssh_pub_key: "{{ lookup('file', '/path/to/ssh_pub_key.pub') }}"
    state: present
    validate_certs: true

  tasks:
    - name: Install required python packages
      pip:
        name: scaleway-sdk
        state: present
        extra_args: "--trusted-host pypi.org --trusted-host files.pythonhosted.org"

    - name: Create SSH Key
      community.general.scaleway_sshkey:
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        api_timeout: "{{ api_timeout / 2 }}"
        query_parameters: "{{ query_parameters }}"
        ssh_pub_key: "{{ ssh_pub_key }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - name: Show module output
      debug:
        var: result