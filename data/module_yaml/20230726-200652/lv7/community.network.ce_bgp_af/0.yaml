---
- name: Test playbook to uncover type-related bugs
  hosts: localhost
  gather_facts: False

  vars:
    bgp_af_configs:
      - af_type: "{{ variable | length }}"  # Test a length operation on an undefined variable
        state: present

  tasks:
    - name: Ensure BGP Address-family configuration
      community.network.ce_bgp_af:
        vrf_name: "{{ item.vrf_name | default('default') }}"
        af_type: "{{ item.af_type }}"
        state: "{{ item.state }}"
      register: result
      loop: "{{ bgp_af_configs }}"

    - name: Display debug information
      debug:
        var: result