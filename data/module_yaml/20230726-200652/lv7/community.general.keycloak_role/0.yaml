---
- name: Test Playbook for community.general.keycloak_role module
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include keycloak_role module
      include_role:
        name: community.general.keycloak_role
        tasks_from: main

      vars:
        attributes:
          test_attr: "test_value"

        auth_client_id: "my_client_id"
        auth_client_secret: "my_client_secret"
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "my_password"
        auth_realm: "my_realm"
        auth_username: "my_username"

        client_id: "my_client_id"
        connection_timeout: 10
        description: "My Keycloak client"
        http_agent: "Mozilla/5.0"
        name: "My Keycloak Client"
        realm: "my_realm"
        state: present
        token: "my_token"
        validate_certs: true

    - name: Test Case 1 - Missing Required Attribute
      include_role:
        name: community.general.keycloak_role
        tasks_from: main

      vars:
        attributes: {}
        auth_client_id: "my_client_id"
        auth_client_secret: "my_client_secret"
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "my_password"
        auth_realm: "my_realm"
        auth_username: "my_username"
        client_id: "my_client_id"
        connection_timeout: 10
        description: "My Keycloak client"
        http_agent: "Mozilla/5.0"
        name: "My Keycloak Client"
        realm: "my_realm"
        state: present
        token: "my_token"
        validate_certs: true
      ignore_errors: true

    - name: Test Case 2 - Invalid Type for Attribute
      include_role:
        name: community.general.keycloak_role
        tasks_from: main

      vars:
        attributes:
          test_attr: true
        auth_client_id: "my_client_id"
        auth_client_secret: "my_client_secret"
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "my_password"
        auth_realm: "my_realm"
        auth_username: "my_username"
        client_id: "my_client_id"
        connection_timeout: 10
        description: "My Keycloak client"
        http_agent: "Mozilla/5.0"
        name: "My Keycloak Client"
        realm: "my_realm"
        state: present
        token: "my_token"
        validate_certs: true
      ignore_errors: true
      
    - name: Test Case 3 - Division-based Operation on limit-related Value
      include_role:
        name: community.general.keycloak_role
        tasks_from: main

      vars:
        attributes:
          test_attr: "{{ 10 / 0 }}"
        auth_client_id: "my_client_id"
        auth_client_secret: "my_client_secret"
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "my_password"
        auth_realm: "my_realm"
        auth_username: "my_username"
        client_id: "my_client_id"
        connection_timeout: 10
        description: "My Keycloak client"
        http_agent: "Mozilla/5.0"
        name: "My Keycloak Client"
        realm: "my_realm"
        state: present
        token: "my_token"
        validate_certs: true
      ignore_errors: true