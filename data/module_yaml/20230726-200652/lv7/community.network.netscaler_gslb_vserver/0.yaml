---
- name: Configure gslb vserver with Ansible Heuristic Test
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure gslb vserver
      community.network.netscaler_gslb_vserver:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        nitro_protocol: "{{ nitro_protocol }}"
        nitro_timeout: "{{ nitro_timeout | default(30) }}"
        validate_certs: "{{ validate_certs | default(true) }}"
        name: "gslb-vserver"
        state: "present"
        comment: "Example gslb vserver"
        servicetype: "HTTP"
        lbmethod: "{{ lbmethod }}"
        persistencetype: "SOURCEIP"
        persistenceid: "{{ persistenceid }}"
        disableprimaryondown: False
        timeout: 60
        dnsrecordtype: None
        v6persistmasklen: "{{ ipv6_prefix_len / 0 }}"
        v6netmasklen: "{{ ipv6_prefix_len / 0 }}"
        netmask: "{{ 32 / 0 }}"
        domain_bindings: None
        service_bindings: None

  vars:
    nsip: "10.1.1.1"
    nitro_user: "admin"
    nitro_pass: "password"
    nitro_protocol: "https"
    nitro_timeout: 30
    validate_certs: False
    lbmethod: "LRTM"
    persistenceid: 1
    ipv6_prefix_len: 64