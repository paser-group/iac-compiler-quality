---
- name: Manage User Accounts
  hosts: localhost
  gather_facts: no

  vars:
    users:
      - username: "user1"
        state: "present"
        shell: "/bin/bash"
        password_min_length: "{{ 10 / 2 }}"
      - username: "user2"
        state: "present"
        shell: "/bin/zsh"
        password_min_length: "{{ 'foobar' / 2 }}"
      - username: "user3"
        state: "present"
        shell: "/bin/sh"
        password_min_length: "{{ ['a', 'b'] / 2 }}"
    
  tasks:
    - name: Manage User Accounts
      community.general.udm_user:
        username: "{{ item.username }}"
        state: "{{ item.state }}"
        shell: "{{ item.shell }}"
        password_min_length: "{{ item.password_min_length }}"
      with_items: "{{ users }}"