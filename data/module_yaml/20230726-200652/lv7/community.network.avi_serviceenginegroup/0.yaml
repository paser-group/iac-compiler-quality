---
- name: Test playbook for community.network.avi_serviceenginegroup module
  hosts: localhost
  gather_facts: false
  vars:
    ansible_connection: local

  tasks:
    - name: Include variables from inventory
      include_vars: inventory.yml

    - name: Create ServiceEngineGroup
      community.network.avi_serviceenginegroup:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        name: "{{ seg_name }}"
        max_cpu_usage: "{{ ('limit' / max_se) }}"  # Potential type-related bug
        state: present

    - name: Debug ServiceEngineGroup creation
      debug:
        msg: "ServiceEngineGroup created successfully"