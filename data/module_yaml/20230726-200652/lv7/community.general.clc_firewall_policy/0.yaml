---
- name: Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a firewall policy
      community.general.clc_firewall_policy:
        state: present
        location: la1
        source: 10.1.1.0/24
        destination: 10.1.1.0/24
        ports: [80, 443]
        firewall_policy_id: fw-1
        enabled: yes
        wait: yes

    - name: Wait for firewall policy creation to complete
      community.general.clc_firewall_policy:
        state: present
        location: la1
        firewall_policy_id: fw-1
        wait: yes

    - name: Update firewall policy
      community.general.clc_firewall_policy:
        state: present
        location: la1
        source: 10.1.1.0/16
        destination: 10.1.1.0/16
        ports: [22, 443]
        firewall_policy_id: fw-1
        wait: yes

    - name: Wait for firewall policy update to complete
      community.general.clc_firewall_policy:
        state: present
        location: la1
        firewall_policy_id: fw-1
        wait: yes

    - name: Delete firewall policy
      community.general.clc_firewall_policy:
        state: absent
        location: la1
        firewall_policy_id: fw-1
        wait: yes