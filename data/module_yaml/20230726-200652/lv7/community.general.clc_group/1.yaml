---
- name: Test clc_group module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Define limit-related value
      set_fact:
        limit: "{{ 10 / 2 }}"

    - name: Create server group
      community.general.clc_group:
        description: "Test group"
        location: "DE1"
        name: "TestGroup"
        parent: "ParentGroup"
        state: "present"
        wait: "{{ limit | bool }}"

    - name: Sleep for 5 seconds to allow the group creation to complete
      pause:
        seconds: 5

    - name: Delete server group
      community.general.clc_group:
        name: "TestGroup"
        state: "absent"

    - name: Sleep for 5 seconds to allow the group deletion to complete
      pause:
        seconds: 5