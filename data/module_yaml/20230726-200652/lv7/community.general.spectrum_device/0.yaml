- name: Test playbook for Ansible Latent Type-Related Bug Explorer
  hosts: localhost
  gather_facts: no
  become: false

  tasks:
    - name: Create device
      community.general.spectrum_device:
        state: present
        device: mydevice
        landscape: production
        url: "https://{{ inventory_hostname }}"
        url_username: admin
        url_password: admin_password
        community: mycommunity
        agentport: 161
        use_proxy: true
        validate_certs: false
      register: result_create
      ignore_errors: yes

    - name: Debug result
      debug:
        var: result_create

    - name: Delete device
      community.general.spectrum_device:
        state: absent
        device: mydevice
        landscape: production
        url: "https://{{ inventory_hostname }}"
        url_username: admin
        url_password: admin_password
        community: mycommunity
        agentport: 161
        use_proxy: true
        validate_certs: false
      register: result_delete
      ignore_errors: yes

    - name: Debug result
      debug:
        var: result_delete