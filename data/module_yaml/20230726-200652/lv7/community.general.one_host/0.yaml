---
- name: Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set Variables
      set_fact:
        cluster_id: "{{ wait_timeout | int }}"
        cluster_name: "my_cluster"
        im_mad_name: "kvm"
        api_url: "http://localhost:2633/RPC2"
        api_username: "oneadmin"
        api_password: "password"
        labels:
          - "label1"
          - "label2"
        name: "my_host"
        state: "present"
        template:
          cpu: 2
          memory: 2048
          vcpu: 2
        validate_certs: false
        wait_timeout: 0

    - name: Create Host
      community.general.one_host:
        api_url: "{{ api_url }}"
        api_username: "{{ api_username }}"
        api_password: "{{ api_password }}"
        cluster_id: "{{ cluster_id }}"
        cluster_name: "{{ cluster_name }}"
        im_mad_name: "{{ im_mad_name }}"
        labels: "{{ labels }}"
        name: "{{ name }}"
        state: "{{ state }}"
        template: "{{ template }}"
        validate_certs: "{{ validate_certs }}"
        vmm_mad_name: "{{ vmm_mad_name }}"
        wait_timeout: "{{ wait_timeout }}"