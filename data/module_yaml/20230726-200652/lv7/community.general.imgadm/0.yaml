- name: Discover latent type-related bugs
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Install required dependencies
      package:
        name: [sdc-imgapi-client, py-libzfs]
        state: present
    
    - name: Create a Joyent Triton headnode
      community.general.imgadm:
        state: present
        type: imgapi
        source: 'triton-447a4bde-9d77-11ea-96ae-5143e5b47034'
        uuid: 'b6473260-9d89-11ea-96ae-9dc9954db0b8'
        pool: 'default'
      register: headnode_result
    
    - name: Debug headnode_result
      debug:
        var: headnode_result