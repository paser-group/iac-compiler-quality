---
- name: Test playbook for community.general.rax_cdb_user module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Rackspace Cloud Database user
      community.general.rax_cdb_user:
        auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
        api_key: "YOUR_API_KEY"
        username: "YOUR_RACKSPACE_USER"
        credentials: "/path/to/credentials"
        tenant_name: "YOUR_TENANT_NAME"
        cdb_id: "YOUR_CDB_ID"
        db_username: "testuser"
        db_password: "testpassword"
        validate_certs: false
        state: "present"
      register: cdb_user_created

    - name: Delete Rackspace Cloud Database user
      community.general.rax_cdb_user:
        auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
        api_key: "YOUR_API_KEY"
        username: "YOUR_RACKSPACE_USER"
        credentials: "/path/to/credentials"
        tenant_name: "YOUR_TENANT_NAME"
        cdb_id: "YOUR_CDB_ID"
        db_username: "testuser"
        validate_certs: false
        state: "absent"
      register: cdb_user_deleted

    - name: Output results
      debug:
        var: cdb_user_created
      debug:
        var: cdb_user_deleted