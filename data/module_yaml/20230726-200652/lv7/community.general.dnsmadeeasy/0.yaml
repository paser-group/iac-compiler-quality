---
- name: Test playbook for community.general.dnsmadeeasy module
  hosts: localhost
  gather_facts: false

  vars:
    account_key: "YOUR_ACCOUNT_KEY"
    account_secret: "YOUR_ACCOUNT_SECRET"

  tasks:
    - name: Create A Record with TTL as limit/2
      community.general.dnsmadeeasy:
        account_key: "{{ account_key }}"
        account_secret: "{{ account_secret }}"
        state: present
        domain: "example.com"
        record_name: "test-record"
        record_type: "A"
        record_value: "1.2.3.4"
        record_ttl: "{{ limit / 2 }}"
      register: result
      failed_when: "'limit' not in vars"

    - name: Debug result
      debug:
        var: result

    - name: Create A Record with TTL as limit*2
      community.general.dnsmadeeasy:
        account_key: "{{ account_key }}"
        account_secret: "{{ account_secret }}"
        state: present
        domain: "example.com"
        record_name: "test-record"
        record_type: "A"
        record_value: "1.2.3.4"
        record_ttl: "{{ limit * 2 }}"
      register: result
      failed_when: "'limit' not in vars"

    - name: Debug result
      debug:
        var: result