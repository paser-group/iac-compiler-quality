---
- name: Manage Ruckus ICX switches
  hosts: switches
  gather_facts: false

  tasks:
    - name: Configure ICX switch
      community.network.icx_config:
        src: "{{ playbook_dir }}/config/{{ inventory_hostname }}.txt"
        backup: yes
        parents: ['aaa']
        lines:
          - "max-failed-attempts: {{ 10/3 }}"  # Division-based assignment

    - name: Debug ICX switch configuration
      debug:
        var: community.network.icx_config.running_config