---
- name: Create or Terminate VM using community.general.one_vm module
  hosts: localhost
  gather_facts: false

  vars:
    api_url: "https://example.com/api"
    api_username: "your_api_username"
    api_password: "your_api_password"
    attributes:
      name: "{{ inventory_hostname }}"
      template: "ubuntu_template"

  tasks:
    - name: Create or terminate VM
      community.general.one_vm:
        api_url: "{{ api_url }}"
        api_username: "{{ api_username }}"
        api_password: "{{ api_password }}"
        attributes: "{{ attributes }}"
        count: "{{ limit_value }}"
      register: result

    - debug:
        var: result