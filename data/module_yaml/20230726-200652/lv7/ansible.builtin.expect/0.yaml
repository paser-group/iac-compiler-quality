---
- name: Execute command with expect module
  hosts: all
  gather_facts: false

  tasks:
    - name: Execute command with expect
      ansible.builtin.expect:
        chdir: "/tmp"
        command: "ls"
        creates: "/tmp/testfile"
        echo: true
        removes: "/tmp/testfile"
        timeout: 10
        responses:
          question:
            response: "answer"
      vars:
        limit: "{{ 10 / 2 }}"

      register: command_output

    - name: Print command output
      debug:
        var: command_output.stdout_lines