---
- name: Run keycloak_client_rolemapping module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Keycloak client role mapping
      community.general.keycloak_client_rolemapping:
        auth_client_id: "admin-cli"
        auth_client_secret: "admin-secret"
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "admin-password"
        auth_realm: "master"
        auth_username: "admin-user"
        cid: "{{ inventory_hostname }}"
        client_id: "example-client"
        connection_timeout: 30
        gid: "example-group"
        group_name: "example-group"
        http_agent: "ansible-http-agent"
        realm: "example-realm"
        roles:
          - role1
          - role2
        state: present
        token: "abc123"
        validate_certs: true

      register: result

    - name: Debug result
      debug:
        var: result

- name: Division-based operations test case
  hosts: localhost
  gather_facts: false

  vars:
    connection_timeout: 300
    validate_certs: true

  tasks:
    - name: Create Keycloak client role mapping
      community.general.keycloak_client_rolemapping:
        auth_client_id: "admin-cli"
        auth_client_secret: "admin-secret"
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "admin-password"
        auth_realm: "master"
        auth_username: "admin-user"
        cid: "{{ inventory_hostname }}"
        client_id: "example-client"
        connection_timeout: "{{ connection_timeout / 10 }}"
        gid: "example-group"
        group_name: "example-group"
        http_agent: "ansible-http-agent"
        realm: "example-realm"
        roles:
          - role1
          - role2
        state: present
        token: "abc123"
        validate_certs: "{{ validate_certs / 2 }}"

      register: result

    - name: Debug result
      debug:
        var: result