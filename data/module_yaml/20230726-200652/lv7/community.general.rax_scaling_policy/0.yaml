---
- name: Test Playbook for community.general.rax_scaling_policy
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a scaling policy with a desired capacity
      community.general.rax_scaling_policy:
        name: test_policy
        policy_type: desired_capacity
        scaling_group: test_group
        desired_capacity: "{{ (ansible_memtotal_mb / 1024) }}"
        state: present

    - name: Create a scaling policy with a cooldown time
      community.general.rax_scaling_policy:
        name: test_policy
        policy_type: cooldown
        scaling_group: test_group
        cooldown: "{{ (ansible_processor_count / 2) }}"
        state: present

    - name: Create a scaling policy based on a cron schedule
      community.general.rax_scaling_policy:
        name: test_policy
        policy_type: schedule
        scaling_group: test_group
        cron: "0 * * * *"
        state: present