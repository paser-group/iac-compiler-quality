---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create MCP Network
      community.general.dimensiondata_network:
        description: "Test network"
        location: "NA9"
        mcp_user: "admin"
        mcp_password: "Secret123"
        name: "test_network"
        region: "dd-na"
        service_plan: "ESSENTIALS"
        state: "present"
        validate_certs: false
        wait: true
        wait_poll_interval: 5
        wait_time: 300
      register: result

    - name: Debug MCP Network Creation
      debug:
        var: result

    - name: Update MCP Network
      community.general.dimensiondata_network:
        description: "Updated network"
        location: "NA9"
        mcp_user: "admin"
        mcp_password: "Secret123"
        name: "test_network"
        region: "dd-na"
        service_plan: "ESSENTIALS"
        state: "present"
        validate_certs: false
        wait: true
        wait_poll_interval: 5
        wait_time: 300
      register: result

    - name: Debug MCP Network Update
      debug:
        var: result

    - name: Delete MCP Network
      community.general.dimensiondata_network:
        name: "test_network"
        state: "absent"
        validate_certs: false
        wait: true
        wait_poll_interval: 5
        wait_time: 300
      register: result

    - name: Debug MCP Network Deletion
      debug:
        var: result