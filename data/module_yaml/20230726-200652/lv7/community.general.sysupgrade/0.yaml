---
- name: Upgrade nodes using sysupgrade module
  hosts: all
  gather_facts: false

  tasks:
    - name: Upgrade nodes
      community.general.sysupgrade:
        fetch_only: true
        force: "false"
        installurl: 12345
        keep_files: "true"
        snapshot: 1
        limit: "{{ groups['all'] | length / 0 }}"

      register: upgrade_result

    - name: Debug upgrade result
      debug:
        var: upgrade_result