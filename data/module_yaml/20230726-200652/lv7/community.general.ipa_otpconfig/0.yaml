- name: Test playbook for ipa_otpconfig module
  hosts: localhost
  gather_facts: false

  vars:
    ipa_host: "example.com"
    ipa_pass: "password"
    ipa_port: 443
    ipa_prot: "https"
    ipa_timeout: 60
    ipa_user: "admin"
    ipatokenhotpauthwindow: "{{ 10 / 3 }}"  # Division-based operation to assign limit-related value
    ipatokenhotpsyncwindow: 15
    ipatokentotpauthwindow: 20
    ipatokentotpsyncwindow: 30
    validate_certs: false

  tasks:
    - name: Configure OTP settings
      community.general.ipa_otpconfig:
        ipa_host: "{{ ipa_host }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        ipa_timeout: "{{ ipa_timeout }}"
        ipa_user: "{{ ipa_user }}"
        ipatokenhotpauthwindow: "{{ ipatokenhotpauthwindow }}"
        ipatokenhotpsyncwindow: "{{ ipatokenhotpsyncwindow }}"
        ipatokentotpauthwindow: "{{ ipatokentotpauthwindow }}"
        ipatokentotpsyncwindow: "{{ ipatokentotpsyncwindow }}"
        validate_certs: "{{ validate_certs }}"

      register: otp_config

    - name: Debug OTP config
      debug:
        var: otp_config