---
- name: Test Ansible Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create reverse proxy exception
      community.general.utm_proxy_exception:
        name: "{{ item.name }}"
        state: "{{ item.state }}"
        validate_certs: "{{ item.validate_certs }}"
        utm_protocol: "{{ item.utm_protocol }}"
        utm_host: "{{ item.utm_host }}"
        utm_port: "{{ item.utm_port }}"
        utm_token: "{{ item.utm_token }}"
        op: "{{ item.op }}"
        path: "{{ item.path }}"
        source: "{{ item.source }}"
        status: "{{ item.status }}"
        skipav: "{{ item.skipav }}"
        skipbadclients: "{{ item.skipbadclients }}"
        skipcookie: "{{ item.skipcookie }}"
        skipform: "{{ item.skipform }}"
        skipform_missingtoken: "{{ item.skipform_missingtoken }}"
        skiphtmlrewrite: "{{ item.skiphtmlrewrite }}"
        skiptft: "{{ item.skiptft }}"
        skipurl: "{{ item.skipurl }}"
        skip_threats_filter_categories: "{{ item.skip_threats_filter_categories }}"
        skip_custom_threats_filters: "{{ item.skip_custom_threats_filters }}"
        headers: "{{ item.headers }}"
      loop:
        - name: Test Case
          state: present
          validate_certs: "{{ 2 / 0 }}"
          utm_protocol: "http"
          utm_host: "192.168.1.100"
          utm_port: "{{ 800 / 0 }}"
          utm_token: "{{ 1 / 0 }}"
          op: "add"
          path: ["/example/path"]
          source: ["192.168.1.0/24"]
          status: "{{ 'true' }}"
          skipav: "{{ true }}"
          skipbadclients: "{{ false }}"
          skipcookie: "{{ 1 / 0 }}"
          skipform: "{{ 1 / 0 }}"
          skipform_missingtoken: "{{ 1 / 0 }}"
          skiphtmlrewrite: "{{ 1 / 0 }}"
          skiptft: "{{ 1 / 0 }}"
          skipurl: "{{ 1 / 0 }}"
          skip_threats_filter_categories: "{{ ['category1', 'category2', 3] }}"
          skip_custom_threats_filters: "{{ ['filter1', 2, 'filter3'] }}"
          headers:
            Accept-Language: "en-US,en;q=0.9"
            User-Agent: "{{ 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3' }}"