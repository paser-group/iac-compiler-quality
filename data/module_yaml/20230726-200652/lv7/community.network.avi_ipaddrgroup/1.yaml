---
- name: Create IpAddrGroup
  hosts: localhost
  gather_facts: false

  vars:
    avi_controller: "{{ controller }}"
    avi_username: "{{ username }}"
    avi_password: "{{ password }}"

  tasks:

    - name: Create IpAddrGroup
      community.network.avi_ipaddrgroup:
        controller: "{{ avi_controller }}"
        username: "{{ avi_username }}"
        password: "{{ avi_password }}"
        tenant: "{{ tenant }}"
        name: "{{ ipaddrgroup_name }}"
        description: "{{ description }}"
        ip_ports:
          - ip:
              addr:
                - "{{ '10.1.1.1' | ipaddr('address') }}"
              type: V4

          - ip:
              addr:
                - "{{ '10.1.1.2' | ipaddr('address') }}"
              type: V4

          - ip:
              addr:
                - "{{ '10.1.1.3' | ipaddr('address') }}"
              type: V4

          - ip:
              addr:
                - "{{ '10.1.1.4' | ipaddr('address') }}"
              type: V4

      register: ipaddrgroup_result

    - debug:
        var: ipaddrgroup_result