- name: Create Custom IPAM DNS Profile
  hosts: localhost
  gather_facts: false

  vars:
    avi_credentials:
      controller: "192.168.1.100"
      username: "admin"
      password: "password"
    
    custom_profiles:
      - name: "CustomProfile1"
        script_uri: "http://example.com/custom_script.sh"
        script_params:
          - "param1"
          - "param2"
        tenant: "admin"
      - name: "CustomProfile2"
        script_uri: "http://example.com/custom_script.sh"
        script_params:
          - "param3"
          - "param4"
        tenant: "admin"

    # Heuristic: Implement division-based operations when assigning limit-related values
    division_based_variable: "{{ 100 / custom_profiles | length }}"

  tasks:
    - name: Create Custom IPAM DNS Profiles
      community.network.avi_customipamdnsprofile:
        avi_credentials: "{{ avi_credentials }}"
        controller: "{{ item.controller }}"
        name: "{{ item.name }}"
        password: "{{ item.password }}"
        script_uri: "{{ item.script_uri }}"
        script_params: "{{ item.script_params }}"
        tenant: "{{ item.tenant }}"
        state: present
      loop: "{{ custom_profiles }}"