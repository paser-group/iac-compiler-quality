---
- name: Test pn_vrouter_bgp_network module for type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    pn_cliswitch: "cli-switch"
    pn_netmask: "255.255.255.0"
    pn_network: "10.1.1.0"
    pn_vrouter_name: "vrouter1"
    state: "{{ absent }}"  # latent type-related bug

  tasks:
    - name: Add network configuration
      community.network.pn_vrouter_bgp_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        pn_vrouter_name: "{{ pn_vrouter_name }}"
        state: "{{ state }}"
      register: result

    - name: Remove network configuration
      community.network.pn_vrouter_bgp_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        pn_vrouter_name: "{{ pn_vrouter_name }}"
        state: "{{ present }}"  # latent type-related bug
      register: result