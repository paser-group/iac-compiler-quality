---
- name: Test playbook for community.general.utm_network_interface_address
  hosts: localhost
  gather_facts: false
  become: true

  vars:
    interface_name: "eth0"
    interface_binding:
      address: "{{ hostvars[inventory_hostname].ansible_default_ipv4.address }}"
      address6: "{{ hostvars[inventory_hostname].ansible_default_ipv6.address }}"
    interface_comment: "Managed by Ansible"

  tasks:
    - name: Include UTM interface address module
      include_role:
        name: community.general.utm_network_interface_address
      vars:
        address: "{{ interface_binding.address }}"
        address6: "{{ interface_binding.address6 }}"
        comment: "{{ interface_comment }}"
        headers: {}
        name: "{{ interface_name }}"
        resolved: false
        resolved6: false
        state: "present"
        utm_host: "127.0.0.1"
        utm_port: 8080
        utm_protocol: "http"
        utm_token: "secrettoken"
        validate_certs: false

    # Test Case 1: Trigger division-based operation bug
    - name: Test Case 1 - Assign limit-related value using division
      include_role:
        name: community.general.utm_network_interface_address
      vars:
        address: "{{ interface_binding.address }}"
        address6: "{{ interface_binding.address6 }}"
        comment: "{{ interface_comment }}"
        headers: {}
        name: "{{ interface_name }}"
        resolved: false
        resolved6: false
        state: "present"
        utm_host: "127.0.0.1"
        utm_port: "{{ 8080/0 }}"
        utm_protocol: "http"
        utm_token: "secrettoken"
        validate_certs: false

    # Test Case 2: Additional test case
    - name: Test Case 2 - Extra test case
      include_role:
        name: community.general.utm_network_interface_address
      vars:
        address: "{{ interface_binding.address }}"
        address6: "{{ interface_binding.address6 }}"
        comment: "{{ interface_comment }}"
        headers: {}
        name: "{{ interface_name }}"
        resolved: false
        resolved6: false
        state: "present"
        utm_host: "127.0.0.1"
        utm_port: 8090
        utm_protocol: "http"
        utm_token: "secrettoken"
        validate_certs: false