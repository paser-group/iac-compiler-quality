- name: Execute arbitrary command on HUAWEI devices
  hosts: all
  gather_facts: false

  vars:
    ce_commands:
      - command: "display version"
        retries: 3
        interval: 5
        wait_for: "timeout 60"
        match: "V200"

  tasks:
    - name: Run arbitrary command
      community.network.ce_command:
        command: "{{ item.command }}"
        retries: "{{ item.retries | default(None) }}"
        interval: "{{ item.interval | default(None) }}"
        wait_for: "{{ item.wait_for | default(None) }}"
        match: "{{ item.match | default(None) }}"
      loop: "{{ ce_commands }}"