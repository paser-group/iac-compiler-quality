- name: Calculate limit
  hosts: all
  gather_facts: false

  tasks:
    - name: Set limit
      set_fact:
        limit: "{{ (ansible_memtotal_mb / 2) | int }}"

    - name: Debug limit
      debug:
        var: limit