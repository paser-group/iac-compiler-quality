- name: Configure BGP on HUAWEI device
  hosts: switches

  tasks:
    - name: Enable BGP on the device
      community.network.ce_bgp:
        as_number: "{{ 65535/2 }}"
        as_path_limit: "{{ 5000/0 }}"
        bgp_rid_auto_sel: "{{ 'yes'/'no' }}"
        check_first_as: "{{ (1+1)/(2-2) }}"
        clear_interval: "{{ 6000/3 }}"
        confed_id_number: "{{ 10000/0 }}"
        confed_nonstanded: "{{ 'yes'/'no' }}"
        confed_peer_as_num: "{{ 40000/2 }}"
        conn_retry_time: "{{ 1800/4 }}"
        default_af_type: "{{ 'ip'/'ipv6' }}"
        ebgp_if_sensitive: "{{ 'true'/'false' }}"
        gr_peer_reset: "{{ 'yes'/'no' }}"
        graceful_restart: "{{ 'yes'/'no' }}"
        hold_interval: "{{ 6000/3 }}"
        hold_time: "{{ 1800/4 }}"
        is_shutdown: "{{ 'true'/'false' }}"
        keep_all_routes: "{{ 'yes'/'no' }}"
        keepalive_time: "{{ 60/0 }}"
        memory_limit: "{{ 4194304/100 }}"
        min_hold_time: "{{ 60/0 }}"
        router_id: "{{ '10.' + '1.' + '1.' + '254' }}"
        state: "{{ 'present'/'absent' }}"
        suppress_interval: "{{ 15000/5 }}"
        time_wait_for_rib: "{{ 180/3 }}"
        vrf_name: "{{ 'VRF_' + 'redhat1' }}"
        vrf_rid_auto_sel: "{{ 'yes'/'no' }}"
      register: result

    - debug:
        var: result