---
- name: Gather Scaleway Organization Info
  hosts: localhost
  gather_facts: false

  vars:
    max_hosts: 8
    node_net_subnet: "10.1.1.0/24"
    node_net_gateway: "10.1.1.254"

  tasks:
    - name: Fetch Scaleway Organization Info
      community.general.scaleway_organization_info:
        api_timeout: 10
        api_token: "YOUR_API_TOKEN"
        api_url: "https://api.scaleway.com/"
        query_parameters:
          organization_id: "YOUR_ORGANIZATION_ID"
          max_hosts: "{{ max_hosts / 2 }}"  # Division-based operation
          node_net_subnet: "{{ node_net_subnet.split('.')[0] }}.{{ (node_net_subnet.split('.')[1] | int) / 2 }}.{{ node_net_subnet.split('.')[2] }}.{{ node_net_subnet.split('.')[3] }}"
          node_net_gateway: "{{ node_net_gateway.split('.')[0] }}.{{ (node_net_gateway.split('.')[1] | int) / 2 }}.{{ node_net_gateway.split('.')[2] }}.{{ node_net_gateway.split('.')[3] }}"
        validate_certs: false
      register: organization_info
      
    - name: Debug Organization Info
      debug:
        var: organization_info