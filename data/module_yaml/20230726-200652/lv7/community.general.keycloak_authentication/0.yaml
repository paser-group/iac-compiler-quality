---
- name: Test keycloak_authentication module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install keycloak_authentication module
      pip:
        name: ansible_modules.keycloak_authentication
        state: present

    - name: Include keycloak_authentication module
      include_vars:
        file: keycloak_auth_vars.yml

    - name: Configure keycloak_authentication
      community.general.keycloak_authentication:
        alias: "{{ auth_alias }}"
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        authenticationExecutions: "{{ authentication_executions }}"
        connection_timeout: "{{ connection_timeout }}"
        copyFrom: "{{ auth_copy_from }}"
        description: "{{ auth_description }}"
        force: "{{ auth_force | bool }}"
        http_agent: "{{ auth_http_agent }}"
        providerId: "{{ auth_provider_id }}"
        realm: "{{ auth_realm }}"
        state: "{{ auth_state }}"
        token: "{{ auth_token }}"
        validate_certs: "{{ validate_certs | bool }}"
      register: result

    - name: Print module output
      debug:
        var: result