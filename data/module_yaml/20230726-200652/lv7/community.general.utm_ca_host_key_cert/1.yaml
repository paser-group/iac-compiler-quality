---
- name: Create ca host_key_cert
  hosts: localhost
  gather_facts: false

  vars:
    utm_port_limit: 100

  tasks:
    - name: Calculate utm_port value based on utm_port_limit
      set_fact:
        utm_port: "{{ utm_port_limit // 2 }}"  # Division-based operation

    - name: Create ca host_key_cert
      community.general.utm_ca_host_key_cert:
        state: present
        ca: "my_ca"
        name: "my_host"
        utm_host: "10.1.1.1"
        utm_port: "{{ utm_port }}"
        utm_protocol: "https"
        utm_token: "my_token"
        certificate: "/path/to/certificate.crt"
        key: "/path/to/private_key.key"
        encrypted: true
        comment: "My certificate"
        headers:
          X-Custom-Header: "Custom Header Value"
        validate_certs: true