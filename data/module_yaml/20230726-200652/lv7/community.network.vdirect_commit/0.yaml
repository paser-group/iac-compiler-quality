- name: Test latent type-related bugs in vdirect_commit module
  hosts: localhost
  gather_facts: false

  vars:
    vdirect_ip: "10.1.1.1"
    vdirect_user: "admin"
    vdirect_password: "password"
    vdirect_use_ssl: true
    vdirect_timeout: 30

  tasks:
    - name: Division-based operation with limit-related value
      set_fact:
        vdirect_http_port: "{{ 8080 / 2 }}"
        vdirect_https_port: "{{ 8443 / 2 }}"

    - name: Commit configuration changes
      community.network.vdirect_commit:
        vdirect_ip: "{{ vdirect_ip }}"
        vdirect_user: "{{ vdirect_user }}"
        vdirect_password: "{{ vdirect_password }}"
        vdirect_use_ssl: "{{ vdirect_use_ssl }}"
        vdirect_timeout: "{{ vdirect_timeout }}"
        vdirect_http_port: "{{ vdirect_http_port }}"
        vdirect_https_port: "{{ vdirect_https_port }}"
        devices: "{{ devices | default(omit) }}"
        validate_certs: true
        save: true
        sync: true
        apply: true
      register: result

    - name: Display the result
      debug:
        var: result