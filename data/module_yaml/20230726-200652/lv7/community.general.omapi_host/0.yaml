- name: Test playbook for community.general.omapi_host
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include the community.general.omapi_host module
      include_vars:
        file: "community.general.omapi_host.yml"
    
    - name: Test case 1 - Empty host
      community.general.omapi_host:
        host: ""
        state: present
        statements:
          - add allow { ip = 10.1.1.1/24; }
      register: result1
      ignore_errors: yes

    - name: Test case 2 - Invalid IP
      community.general.omapi_host:
        host: "{{ ip }}"
        state: present
        statements:
          - add allow { ip = 192.168.0.1; }
      vars:
        ip: "10.1.1.abc"
      register: result2
      ignore_errors: yes

    - name: Test case 3 - Empty statements
      community.general.omapi_host:
        host: "ubuntu1"
        state: present
        statements: []
      register: result3
      ignore_errors: yes

    - name: Test case 4 - Invalid port
      community.general.omapi_host:
        host: "ubuntu1"
        state: present
        port: "abc"
        statements:
          - add allow { ip = 10.1.1.1/24; }
      register: result4
      ignore_errors: yes

    - name: Test case 5 - Invalid state
      community.general.omapi_host:
        host: "ubuntu1"
        state: disabled
        statements:
          - add allow { ip = 10.1.1.1/24; }
      register: result5
      ignore_errors: yes

    - name: Display test results
      debug:
        msg: "Test case {{ item }}: {{ results[item].failed }}"
      with_items:
        - 1
        - 2
        - 3
        - 4
        - 5