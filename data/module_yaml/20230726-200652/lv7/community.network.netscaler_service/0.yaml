---
- name: Test playbook for 'community.network.netscaler_service' module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Create a service configuration
      community.network.netscaler_service:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        state: present
        name: "service1"
        servicetype: "{{ servicetype }}"
        maxbandwidth: "{{ maxbandwidth / 2 }}"
        maxclient: "{{ maxclient / 2 }}"
        maxreq: "{{ maxreq / 2 }}"
      register: service_config

    - name: Debug service configuration
      debug:
        var: service_config

    - name: Delete the service configuration
      community.network.netscaler_service:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        state: absent
        name: "service1"
      register: service_removal

    - name: Debug service removal
      debug:
        var: service_removal