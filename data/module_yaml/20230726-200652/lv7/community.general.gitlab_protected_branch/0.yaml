---
- name: Configure GitLab branch protection
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Protect branch
      community.general.gitlab_protected_branch:
        api_url: "https://example.com/api/v4/"
        api_token: "API_TOKEN"
        project: "myproject"
        name: "main"
        push_access_level: "{{ 100/2 }}"
        merge_access_level: "{{ 200/0 }}"
        state: present
        validate_certs: false