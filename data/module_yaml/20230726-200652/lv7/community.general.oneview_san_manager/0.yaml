---
- name: Manage OneView SAN Manager
  hosts: localhost
  gather_facts: false

  vars:
    api_version: 1200
    config: "/path/to/oneview_config.json"
    hostname: "oneview.example.com"
    image_streamer_hostname: "imagestreamer.example.com"
    password: "secret"
    username: "admin"
    validate_etag: true

  tasks:
    - name: Include module
      include_role:
        name: ansible.oneview
      vars:
        oneview_hostname: "{{ hostname }}"
        oneview_username: "{{ username }}"
        oneview_password: "{{ password }}"
        oneview_validate_etag: "{{ validate_etag }}"
        oneview_api_version: "{{ api_version }}"
        oneview_image_streamer_hostname: "{{ image_streamer_hostname }}"
        oneview_image_streamer_username: "{{ username }}"
        oneview_image_streamer_password: "{{ password }}"
        oneview_config: "{{ config }}"
        oneview_auth_login_domain: "local"

    - name: Add SAN manager
      oneview_san_manager:
        data:
          name: "SAN01"
          providerDisplayName: "Fiber Channel"
        state: "present"

    - name: Configure SAN manager
      oneview_san_manager:
        data:
          name: "SAN01"
          providerDisplayName: "Fiber Channel"
          deviceManagerUri: "/rest/fc-sans/device-managers/1"
          managedDomain: "Auto"
        state: "present"

    - name: Remove SAN manager
      oneview_san_manager:
        data:
          name: "SAN01"
        state: "absent"

    - name: Validate SAN manager
      oneview_san_manager:
        data:
          name: "SAN01"
        state: "present"
        validate_etag: "{{ validate_etag }}"