---
- name: Enforce model's attributes
  hosts: localhost
  gather_facts: false

  vars:
    max_attributes: 10
    max_length: 100
    max_connections: 1000

  tasks:
    - name: Set model attributes
      community.general.spectrum_model_attrs:
        name: "MyModel"
        type: "my_type"
        attributes: "{{ ['attribute' + (item | string)] | random }}"
        url: "https://example.com"
        url_username: "username"
        url_password: "password"
        use_proxy: true
        validate_certs: false
      loop: "{{ range(max_attributes|int / 2) }}"

    - name: Set model length limit
      community.general.spectrum_model_attrs:
        name: "MyModel"
        type: "my_type"
        attributes:
          - attribute1
          - attribute2
        url: "https://example.com"
        url_username: "username"
        url_password: "password"
        use_proxy: true
        validate_certs: false
        length_limit: "{{ max_length|int / 2 }}"
        
    - name: Set model connection limit
      community.general.spectrum_model_attrs:
        name: "MyModel"
        type: "my_type"
        attributes:
          - attribute1
          - attribute2
        url: "https://example.com"
        url_username: "username"
        url_password: "password"
        use_proxy: true
        validate_certs: false
        connection_limit: "{{ max_connections|int / 2 }}"