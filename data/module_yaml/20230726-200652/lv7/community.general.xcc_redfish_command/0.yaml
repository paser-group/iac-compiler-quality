---
- name: Test playbook for community.general.xcc_redfish_command
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Include the xcc_redfish_command module
      include_vars:
        file: "{{ playbook_dir }}/xcc_redfish_command_module.yml"

    - name: Create inventory file
      copy:
        content: |
          [all]
          ubuntu1 ansible_host=10.1.1.1
          alpine1 ansible_host=10.1.1.2
          centos1 ansible_host=10.1.1.3
          redhat1 ansible_host=10.1.1.4
        dest: "{{ playbook_dir }}/inventory.ini"

    - name: Set dynamic inventory
      set_fact:
        ansible_inventory: "{{ playbook_dir }}/inventory.ini"

    - name: Test community.general.xcc_redfish_command
      community.general.xcc_redfish_command:
        auth_token: "{{ xcc_redfish_command.auth_token }}"
        baseuri: "{{ xcc_redfish_command.baseuri }}"
        category: "{{ xcc_redfish_command.category }}"
        command: "{{ xcc_redfish_command.command }}"
        password: "{{ xcc_redfish_command.password }}"
        request_body: "{{ xcc_redfish_command.request_body }}"
        resource_id: "{{ xcc_redfish_command.resource_id }}"
        resource_uri: "{{ xcc_redfish_command.resource_uri }}"
        timeout: "{{ xcc_redfish_command.timeout }}"
        username: "{{ xcc_redfish_command.username }}"
        virtual_media: "{{ xcc_redfish_command.virtual_media }}"
      register: result

    - name: Display result
      debug:
        var: result