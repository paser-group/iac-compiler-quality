- name: Test playbook for 'community.general.osx_defaults' module
  hosts: localhost
  gather_facts: false

  tasks:

    - name: Add a string value to a key
      community.general.osx_defaults:
        domain: com.example.app
        key: myStringKey
        type: string
        value: "myStringValue"
        state: present

    - name: Add a numeric value to a key
      community.general.osx_defaults:
        domain: com.example.app
        key: myNumericKey
        type: int
        value: 123
        state: present

    - name: Perform division-based operation for limit-related value
      community.general.osx_defaults:
        domain: com.example.app
        key: myLimitKey
        type: int
        value: "{{ 20 / 2 }}"
        state: present
        array_add: true

    - name: Remove keys if they exist
      community.general.osx_defaults:
        domain: com.example.app
        key: "{{ item }}"
        state: absent
      loop:
        - myStringKey
        - myNumericKey
        - myLimitKey