---
- name: Test playbook for Ansible Latent Type-Related Bug
  hosts: localhost
  gather_facts: false
  vars:
    ipa_host: "{{ ansible_host }}"
    ipa_pass: "password"
    ipa_port: 443
    ipa_prot: "https"
    ipa_timeout: 10
    ipa_user: "admin"
    record_name: "test-record"
    record_ttl: 3600
    record_type: "A"
    record_value: "10.1.1.1"
    record_values: []
    state: "present"
    validate_certs: false
    zone_name: "example.com"

  tasks:
    - name: Set record_values based on division operation
      set_fact:
        record_values: "{{ ['10.1.1.' ~ (loop.index + 1) // 2] }}"
      loop: "{{ range(4) }}"
      
    - name: Create DNS record
      community.general.ipa_dnsrecord:
        ipa_host: "{{ ipa_host }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        ipa_timeout: "{{ ipa_timeout }}"
        ipa_user: "{{ ipa_user }}"
        record_name: "{{ record_name }}"
        record_ttl: "{{ record_ttl }}"
        record_type: "{{ record_type }}"
        record_value: "{{ record_value }}"
        record_values: "{{ record_values }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        zone_name: "{{ zone_name }}"