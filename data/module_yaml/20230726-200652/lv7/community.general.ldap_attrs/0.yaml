---
- name: Test playbook to uncover latent type-related bugs in Ansible
  hosts: localhost
  gather_facts: false

  vars:
    ldap_attrs:
      - name: attribute1
        values:
          - value1
          - value2
      - name: attribute2
        values:
          - value3
          - value4

    bind_dn: "cn=admin,dc=example,dc=com"
    bind_pw: "{{ password }}"
    ca_path: "/path/to/ca/file"
    dn: "ou=users,dc=example,dc=com"
    ordered: false
    referrals_chasing: "follow"
    sasl_class: "GSSAPI"
    server_uri: "ldap://ldap.example.com"
    start_tls: true
    state: "present"
    validate_certs: false
    xorder_discovery: "manual"

  tasks:
    - name: Add or remove LDAP attributes
      community.general.ldap_attrs:
        attributes: "{{ ldap_attrs }}"
        bind_dn: "{{ bind_dn }}"
        bind_pw: "{{ bind_pw }}"
        ca_path: "{{ ca_path }}"
        dn: "{{ dn }}"
        ordered: "{{ ordered }}"
        referrals_chasing: "{{ referrals_chasing }}"
        sasl_class: "{{ sasl_class }}"
        server_uri: "{{ server_uri }}"
        start_tls: "{{ start_tls }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        xorder_discovery: "{{ xorder_discovery }}"
      register: ldap_attrs_result