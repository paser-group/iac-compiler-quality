---
- name: Load variables from files
  hosts: localhost
  gather_facts: false
  
  vars:
    network:
      nodes:
        - name: ubuntu1
          ip: 10.1.1.1
          distribution: ubuntu
        - name: alpine1
          ip: 10.1.1.2
          distribution: alpine
        - name: centos1
          ip: 10.1.1.3
          distribution: centos
        - name: redhat1
          ip: 10.1.1.4
          distribution: redhat
  
  tasks:
    - name: Load variables from file for each node
      include_vars:
        file: "{{ item.file }}"
      loop:
        - { file: "{{ inventory_dir }}/vars/{{ item.name }}.yml" }
      when:
        - "'{{ item.name }}.yml' is file"
      loop_control:
        loop_var: item
  
    - name: Print variable values
      debug:
        var: "{{ item.name }}"
      loop: "{{ network.nodes }}"
      loop_control:
        loop_var: item