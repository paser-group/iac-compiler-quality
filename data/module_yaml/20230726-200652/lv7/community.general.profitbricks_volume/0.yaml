---
- name: Test profitbricks_volume module
  hosts: localhost
  gather_facts: False

  vars:
    auto_increment: true
    bus: virtio
    count: "2"
    datacenter: dc1
    disk_type: "HDD"
    image: ubuntu
    image_password: mypassword
    instance_ids:
      - instance1
      - instance2
    licence_type: free
    name: myvolume
    server: myserver
    size: 10
    ssh_keys:
      - ssh_key1
      - ssh_key2
    state: present
    subscription_password: mypassword
    subscription_user: myuser
    wait: true
    wait_timeout: 300

  tasks:
    - name: Create profitbricks volume
      community.general.profitbricks_volume:
        auto_increment: "{{ auto_increment }}"
        bus: "{{ bus }}"
        count: "{{ count }}"
        datacenter: "{{ datacenter }}"
        disk_type: "{{ disk_type }}"
        image: "{{ image }}"
        image_password: "{{ image_password }}"
        instance_ids: "{{ instance_ids }}"
        licence_type: "{{ licence_type }}"
        name: "{{ name }}"
        server: "{{ server }}"
        size: "{{ size }}"
        ssh_keys: "{{ ssh_keys }}"
        state: "{{ state }}"
        subscription_password: "{{ subscription_password }}"
        subscription_user: "{{ subscription_user }}"
        wait: "{{ wait }}"
        wait_timeout: "{{ wait_timeout }}"
      register: result

    - name: Debug profitbricks volume creation result
      debug:
        var: result