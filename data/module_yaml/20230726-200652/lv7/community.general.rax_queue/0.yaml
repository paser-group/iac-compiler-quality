---
- name: Create/Delete Rackspace Queue
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Rackspace Queue
      community.general.rax_queue:
        name: "my_queue"
        state: "present"
        region: "DFW"
        username: "my_username"
        api_key: "my_api_key"
        auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
        validate_certs: false
      register: queue_created

    - name: Check if Queue is created
      debug:
        msg: "Queue created successfully!"
      when: queue_created is success

    - name: Delete Rackspace Queue
      community.general.rax_queue:
        name: "my_queue"
        state: "absent"
        region: "DFW"
        username: "my_username"
        api_key: "my_api_key"
        auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
        validate_certs: false
      register: queue_deleted

    - name: Check if Queue is deleted
      debug:
        msg: "Queue deleted successfully!"
      when: queue_deleted is success