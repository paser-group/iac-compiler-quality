---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Set zpool properties
      set_fact:
        zpool_properties:
          size_kb: 5242880
          used_kb: 2097152
          available_kb: 3145728
          capacity: 40%
      vars:
        item: "{{ ansible_distribution }}{{ ansible_distribution_version | replace('.', '') }}"

    - name: Test latent type-related bug
      set_fact:
        limit: "{{ 100 / (zpool_properties.size_kb / 1024 / 1024) }}"
      vars:
         item: "{{ ansible_distribution }}{{ ansible_distribution_version | replace('.', '') }}"

    - name: Debug limit
      debug:
        var: limit