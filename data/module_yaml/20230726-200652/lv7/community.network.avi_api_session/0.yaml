- name: Test playbook for Ansible Latent Type-Related Bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Fetch API session from Avi Controller
      community.network.avi_api_session:
        controller: "{{ ansible_host }}"
        username: "{{ avi_username }}"
        password: "{{ avi_password }}"
        tenant: "{{ avi_tenant }}"
        api_context: 
          limit: "{{ total_nodes | int / 2 }}"
        avi_disable_session_cache_as_fact: true
      register: api_session

    - name: Debug API session
      debug:
        var: api_session