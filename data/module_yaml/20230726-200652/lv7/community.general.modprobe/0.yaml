---
- name: Load or remove kernel module
  hosts: all
  become: true

  tasks:
    - name: Load or remove module
      community.general.modprobe:
        name: "{{ item.name }}"
        params: "{{ item.params }}"
        persistent: "{{ item.persistent }}"
        state: "{{ item.state }}"
      loop:
        - { name: "module_name", params: "parameter1=value1", persistent: "yes", state: "present" }
        - { name: "module_name", params: "", persistent: "no", state: "absent" }
        - { name: "module_name", params: "parameter2='1/0'", persistent: "yes", state: "present" }
        - { name: "module_name", params: "parameter3='10/2'", persistent: "yes", state: "present" }