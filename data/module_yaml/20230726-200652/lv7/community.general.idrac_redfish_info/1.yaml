---
- name: Gather PowerEdge server information
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set limit value
      set_fact:
        limit: "{{ timeout // 2 }}"
      
    - name: Authenticate to iDRAC
      community.general.idrac_redfish_info:
        baseuri: "{{ baseuri }}"
        username: "{{ username }}"
        password: "{{ password }}"
        auth_token: "{{ auth_token }}"
        timeout: "{{ timeout }}"
        category: "{{ category }}"
        command: "{{ command }}"
        limit: "{{ limit }}"
      register: idrac_info

    - name: Print iDRAC info
      debug:
        var: idrac_info