---
- name: Expose latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC addresses
      vars:
        nodes:
          - { name: "ubuntu1", ip_address: "10.1.1.1" }
          - { name: "alpine1", ip_address: "10.1.1.2" }
          - { name: "centos1", ip_address: "10.1.1.3" }
          - { name: "redhat1", ip_address: "10.1.1.4" }
        mac_addresses: []

      run_once: true
      block:
        - name: Generate random MAC addresses
          set_fact:
            mac_addresses: "{{ mac_addresses + [lookup('mac', item.ip_address)] }}"
          with_items: "{{ nodes }}"

    - name: Display MAC addresses
      debug:
        var: mac_addresses

    - name: Trigger latent bug
      debug:
        var: "{{ non_existent_variable }}"