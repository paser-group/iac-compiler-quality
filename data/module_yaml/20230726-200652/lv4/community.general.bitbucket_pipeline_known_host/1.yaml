- name: Manage Bitbucket Pipeline Known Host
  hosts: localhost
  gather_facts: false

  vars:
    client_id: "your_client_id"
    client_secret: "your_client_secret"
    key: "your_key"
    name: "your_name"
    password: "your_password"
    repository: "your_repository"
    state: "present"
    user: "your_user"
    workspace: "your_workspace"

  tasks:
    - name: Generate Random MAC Address
      set_fact:
        random_mac: "{{ '%02x'%((0x52<<40) + (0x54<<32) + (0x00<<24) + (random(0, 256 - 0 + 1)<<16) + (random(0, 256 - 0 + 1)<<8) + (random(0, 256 - 0 + 1))) }}"

    - name: Manage Known Host
      community.general.bitbucket_pipeline_known_host:
        client_id: "{{ client_id }}"
        client_secret: "{{ client_secret }}"
        key: "{{ key }}"
        name: "{{ name }}"
        password: "{{ password }}"
        repository: "{{ repository }}"
        state: "{{ state }}"
        user: "{{ user }}"
        workspace: "{{ workspace }}"