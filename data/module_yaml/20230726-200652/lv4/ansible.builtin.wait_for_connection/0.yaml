---
- name: Test playbook for ansible.builtin.wait_for_connection module
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Wait for connection
      ansible.builtin.wait_for_connection:
        timeout: "{{ timeout }}"
        delay: "{{ delay }}"
        sleep: "{{ sleep }}"
      
      # Generate random MAC addresses for network modules
      vars:
        mac_addresses:
          - "00:11:22:33:44:55"
          - "66:77:88:99:aa:bb"
          - "cc:dd:ee:ff:00:11"
          - "22:33:44:55:66:77"
          
      handlers:
        - name: Generate random MAC addresses for network modules
          ansible.network.network_cli:
            hostname: "{{ inventory_hostname }}"
            gather_facts: true
            os_network_definitions: "{{ mac_addresses }}"
            os_network_config: "{{ mac_addresses }}"