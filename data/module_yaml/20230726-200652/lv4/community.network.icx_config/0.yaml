---
- name: Manage configuration sections on Ruckus ICX devices
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set facts for the test case
      set_fact:
        random_mac_address: "{{ '%012x'|format((1000000000000|random)%281474976710656) }}"
    
    - name: Configure ICX device
      community.network.icx_config:
        backup: true
        running_config: "{{ lookup('file', 'running_config.txt') }}"
        intended_config: "{{ lookup('file', 'intended_config.txt') }}"
        save_when: "changed"
        replace: "line"
        lines:
          - "mac-address {{ random_mac_address }}"
    
    - name: Debug output
      debug:
        msg: "Random MAC address: {{ random_mac_address }}"