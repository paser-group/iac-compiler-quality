---
- name: Create and Delete Server Groups
  hosts: localhost
  connection: local
  gather_facts: false

  vars:
    clc_username: "your_clc_username"
    clc_password: "your_clc_password"
    clc_alias: "your_clc_alias"

  tasks:
    - name: Create Server Group
      community.general.clc_group:
        name: "test-group"
        description: 10.1.1.{{ item }}
        alias: "{{ clc_alias }}"
        location: "US West"
        state: present
        clc_username: "{{ clc_username }}"
        clc_password: "{{ clc_password }}"
        wait: "{{ item == 1 }}"
      with_sequence: start=1 end=4

    - name: Print Server Group Creation Result
      debug:
        var: ansible_facts.clc_group

    - name: Delete Server Group
      community.general.clc_group:
        name: "test-group"
        location: "US West"
        state: absent
        clc_username: "{{ clc_username }}"
        clc_password: "{{ clc_password }}"
        wait: "{{ item == 1 }}"
      with_sequence: start=1 end=4