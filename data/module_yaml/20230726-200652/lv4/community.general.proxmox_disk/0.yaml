---
- name: Test playbook for community.general.proxmox_disk module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Manage Qemu(KVM) VM disk
      community.general.proxmox_disk:
        aio: "native"
        api_host: "proxmox.example.com"
        api_password: "password"
        api_token_id: "token_id"
        api_token_secret: "token_secret"
        api_user: "admin"
        backup: false
        bps_max_length: 120
        bps_rd_max_length: 240
        bps_wr_max_length: 360
        bwlimit: 1000
        cache: "none"
        create: "yes"
        cyls: 2048
        delete_moved: true
        detect_zeroes: true
        discard: "on"
        disk: "scsi0"
        format: "raw"
        heads: 16
        import_from: "/var/lib/images/disk.raw"
        iops: 1000
        iops_max: 5000
        iops_max_length: 180
        iops_rd: 100
        iops_rd_max: 500
        iops_rd_max_length: 120
        iops_wr: 200
        iops_wr_max: 1000
        iops_wr_max_length: 120
        iothread: true
        mbps: 100.0
        mbps_max: 500.0
        mbps_rd: 50.0
        mbps_rd_max: 250.0
        mbps_wr: 50.0
        mbps_wr_max: 200.0
        media: "disk"
        name: "test_vm_disk"
        queues: 32
        replicate: false
        rerror: "stop"
        ro: false
        scsiblock: true
        secs: 63
        serial: "disk_serial"
        shared: false
        size: "10G"
        snapshot: false
        ssd: false
        state: "present"
        storage: "local-lvm"
        target_disk: "scsi0"
        target_storage: "local-lvm"
        target_vmid: 100
        timeout: 120
        trans: "iothread"
        validate_certs: true
        vmid: 1000
        werror: "panic"
        wwn: "wwn_number"

      register: disk_result

    - name: Debug disk result
      debug:
        var: disk_result