---
- name: Manage IPA sudo rules
  hosts: localhost
  gather_facts: false

  vars:
    ipa_host: "ipa.example.com"
    ipa_user: "admin"
    ipa_pass: "adminpass"
    ipa_port: 443
    ipa_prot: "https"
    ipa_timeout: 10
    validate_certs: false

  tasks:
    - name: Create sudo rule
      community.general.ipa_sudorule:
        state: present
        cn: !random_mac_address
        description: true
        sudoopt: "use_pty"
        host: []
        user: []
      register: sudorule_created

    - name: Debug sudo rule creation
      debug:
        var: sudorule_created