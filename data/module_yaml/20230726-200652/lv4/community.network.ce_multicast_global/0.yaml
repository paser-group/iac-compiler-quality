---
- name: Manage multicast global configuration on HUAWEI devices
  hosts: huawei_devices
  gather_facts: false
  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac: "{{ '%012x' | format((15 + hostvars[inventory_hostname]['inventory_hostname_index']) | random) }}"

    - name: Configure multicast global settings
      community.network.ce_multicast_global:
        aftype: "{{ random_mac }}"
        state: present
        vrf: "{{ random_mac }}"
      register: result

    - name: Debug result
      debug:
        var: result