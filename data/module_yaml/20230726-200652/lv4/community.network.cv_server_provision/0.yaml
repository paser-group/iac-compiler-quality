---
- name: Test playbook for Ansible latent type-related bug exploration
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure server port
      community.network.cv_server_provision:
        action: "{{ ['apply', 'remove'] | random }}"
        auto_run: "{{ [true, false] | random }}"
        host: "{{ host }}"
        password: "{{ password }}"
        port: "{{ port }}"
        port_vlan: "{{ port_vlan }}"
        protocol: "{{ protocol }}"
        server_name: "{{ server_name }}"
        switch_name: "{{ switch_name }}"
        switch_port: "{{ switch_port }}"
        template: "{{ template }}"
        username: "{{ username }}"

      vars:
        host: "10.1.1.1"    # Replace with actual IP address of the Arista CloudVision Portal
        password: "password"    # Replace with actual password for the CloudVision Portal
        port: 443    # Replace with the actual port number of the CloudVision Portal
        port_vlan: 1    # Replace with the desired VLAN for the server port
        protocol: "https"    # Replace with the appropriate protocol (http or https)
        server_name: "server1"    # Replace with the desired server name
        switch_name: "switch1"    # Replace with the appropriate switch name
        switch_port: "Ethernet1"    # Replace with the appropriate switch port
        template: "template1"    # Replace with the name of the configlet template
        username: "admin"    # Replace with the actual username for the CloudVision Portal