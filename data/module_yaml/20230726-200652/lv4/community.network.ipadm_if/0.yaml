---
- name: Test ipadm_if module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac_address: "{{ '%02x' | format((0,255) | random) }}:{{ '%02x' | format((0,255) | random) }}:{{ '%02x' | format((0,255) | random) }}:{{ '%02x' | format((0,255) | random) }}:{{ '%02x' | format((0,255) | random) }}:{{ '%02x' | format((0,255) | random) }}"

    - name: Create IP interfaces
      community.network.ipadm_if:
        name: "eth0"
        state: 1
        temporary: "true"
        mac_address: "{{ random_mac_address }}"