---
- name: Ansible Latent Bug Finder Playbook
  hosts: localhost
  connection: local
  gather_facts: false

  vars:
    node_configs:
      - name: ubuntu1
        ip: "10.1.1.1"
        mac: "00:1a:92:4b:8a:5c"
        os: "ubuntu"
      - name: alpine1
        ip: "10.1.1.2"
        mac: "00:1a:92:4b:8a:5d"
        os: "alpine"
      - name: centos1
        ip: "10.1.1.3"
        mac: "00:1a:92:4b:8a:5e"
        os: "centos"
      - name: redhat1
        ip: "10.1.1.4"
        mac: "00:1a:92:4b:8a:5f"
        os: "redhat"

  tasks:
    - name: Set random MAC addresses for network modules
      block:
        - name: Generate random MAC address
          set_fact:
            mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(0, 0, 0x1a, 0x92, 0x4b, 0xFF | random) }}"
        - name: Set MAC address for each node
          set_fact:
            node_config: "{{ item }}"
          loop: "{{ node_configs }}"
        - name: Show node configurations
          debug:
            var: node_config

    - name: Run module to trigger type-related bug
      command: echo "Triggering bug"
      register: result

    - name: Display the module output
      debug:
        var: result