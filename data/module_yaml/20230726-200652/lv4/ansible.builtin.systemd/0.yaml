---
- name: Test ansible.builtin.systemd module
  hosts: all
  gather_facts: false

  tasks:
    - name: Restart systemd services
      ansible.builtin.systemd:
        name: "{{ item }}"
        state: "restarted"
        enabled: "{{ enabled }}"
        daemon_reexec: "{{ daemon_reexec }}"
        daemon_reload: "{{ daemon_reload }}"
        force: "{{ force }}"
        masked: "{{ masked }}"
        no_block: "{{ no_block }}"
        scope: "{{ scope }}"
      loop:
        - service1
        - service2
        - service3
      vars:
        enabled: "{{ item.vars.enabled }}"
        daemon_reexec: "{{ item.vars.daemon_reexec }}"
        daemon_reload: "{{ item.vars.daemon_reload }}"
        force: "{{ item.vars.force }}"
        masked: "{{ item.vars.masked }}"
        no_block: "{{ item.vars.no_block }}"
        scope: "{{ item.vars.scope }}"
      loop_control:
        loop_var: item