---
- name: Test Memset Zone Module
  hosts: localhost
  gather_facts: false
  vars:
    create_zone: "{{ hostvars[groups['localhost'][0]]['ansible_default_ipv4']['macaddress'].split(':')[5] | int % 2 == 0 }}"

  tasks:
    - name: Create Zone
      community.general.memset_zone:
        api_key: "{{ lookup('env', 'API_KEY') }}"
        name: zone1
        state: present
        ttl: 3600
      register: result
      when: create_zone | default(true)

    - name: Delete Zone
      community.general.memset_zone:
        api_key: "{{ lookup('env', 'API_KEY') }}"
        name: zone1
        state: absent
      register: result
      when: create_zone | default(true)