---
- name: Send email using SendGrid module
  hosts: localhost
  gather_facts: false

  vars:
    api_key: "your_sendgrid_api_key"
    from_address: "sender@example.com"
    to_addresses:
      - receiver@example.com
    subject: "Test Email"
    body: "Hello, This is a test email."
    attachments:
      - /path/to/attachment_1.txt
      - /path/to/attachment_2.txt
    cc:
      - cc1@example.com
      - cc2@example.com
    bcc:
      - bcc1@example.com
      - bcc2@example.com
    headers:
      X-Custom-Header: "ansible-test"

  tasks:
    - name: Send email
      community.general.sendgrid:
        api_key: "{{ api_key }}"
        from_address: "{{ from_address }}"
        to_addresses: "{{ to_addresses }}"
        subject: "{{ subject }}"
        body: "{{ body }}"
        attachments: "{{ attachments }}"
        cc: "{{ cc }}"
        bcc: "{{ bcc }}"
        headers: "{{ headers }}"
      register: sendgrid_result

    - name: Debug SendGrid result
      debug:
        var: sendgrid_result

    # Test case to generate random MAC address
    - name: Generate random MAC address
      shell: echo -n $(tr -dc '0-9A-Fa-f' < /dev/urandom | head -c12 | sed 's/\(..\)/\1:/g; s/.$//')
      register: random_mac_address

    - name: Debug random MAC address
      debug:
        var: random_mac_address.stdout