---
- name: Test play
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a new ManageIQ tenant
      community.general.manageiq_tenant:
        description: "Test tenant"
        manageiq_connection:
          url: "https://manageiq.example.com"
          username: "admin"
          password: "password"
        name: "TestTenant"
        parent: "Default"
        parent_id: 1
        quotas:
          cpu: 4
          memory: 8192
        state: present
      register: tenant_result

    - name: Debug tenant result
      debug:
        var: tenant_result

    - name: Update an existing ManageIQ tenant
      community.general.manageiq_tenant:
        description: "Updated tenant"
        manageiq_connection:
          url: "https://manageiq.example.com"
          username: "admin"
          password: "password"
        name: "TestTenant"
        parent: "Default"
        parent_id: 1
        quotas:
          cpu: 2
          memory: 4096
        state: present
      register: update_result

    - name: Debug update result
      debug:
        var: update_result

    - name: Delete the ManageIQ tenant
      community.general.manageiq_tenant:
        manageiq_connection:
          url: "https://manageiq.example.com"
          username: "admin"
          password: "password"
        name: "TestTenant"
        state: absent
      register: delete_result

    - name: Debug delete result
      debug:
        var: delete_result