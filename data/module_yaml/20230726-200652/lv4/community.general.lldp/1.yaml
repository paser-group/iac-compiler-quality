---
- name: Discover LLDP Information
  hosts: all
  gather_facts: false

  tasks:
    - name: Set random MAC address
      command: /usr/bin/random-mac.py
      register: random_mac_address

    - name: Get LLDP information
      community.general.lldp:
        host: "{{ inventory_hostname }}"
        output_level: verbose
        mac_address: "{{ random_mac_address.stdout }}"
      register: lldp_result
      
    - name: Debug LLDP information
      debug:
        var: lldp_result