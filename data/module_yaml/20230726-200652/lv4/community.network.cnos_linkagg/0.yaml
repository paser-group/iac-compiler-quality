---
- name: Manage link aggregation groups
  hosts: ansible_controller
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac: "{{ '%012x' | format(randint(0, 281474976710655)) }}"

    - name: Create link aggregation group
      community.network.cnos_linkagg:
        aggregate: "{{ random_mac }}"
        group: "{{ random_mac }}"
        members: "{{ random_mac }}"
        mode: "{{ random_mac }}"
        purge: "{{ random_mac }}"
        state: "{{ random_mac }}"
      register: result

    - name: Debug link aggregation group creation
      debug:
        var: result