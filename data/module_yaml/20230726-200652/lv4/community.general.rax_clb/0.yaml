---
- name: Test Playbook for community.general.rax_clb module
  hosts: localhost
  gather_facts: false

  vars:
    auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
    api_key: "YOUR_API_KEY"
    username: "YOUR_USERNAME"
    tenant_name: "YOUR_TENANT_NAME"
    region: "IAD"
    lb_name: 123  # Intentionally passing an incorrect type for the lb_name variable
    lb_port: 80
    lb_algorithm: "ROUND_ROBIN"
    lb_wait: true
    lb_wait_timeout: 600
    lb_state: "present"

  tasks:
    - name: Create Load Balancer
      community.general.rax_clb:
        auth_endpoint: "{{ auth_endpoint }}"
        api_key: "{{ api_key }}"
        username: "{{ username }}"
        tenant_name: "{{ tenant_name }}"
        region: "{{ region }}"
        name: "{{ lb_name }}"
        port: "{{ lb_port }}"
        algorithm: "{{ lb_algorithm }}"
        wait: "{{ lb_wait }}"
        wait_timeout: "{{ lb_wait_timeout }}"
        state: "{{ lb_state }}"
      register: result

    - debug:
        var: result

    - name: Delete Load Balancer
      community.general.rax_clb:
        auth_endpoint: "{{ auth_endpoint }}"
        api_key: "{{ api_key }}"
        username: "{{ username }}"
        tenant_name: "{{ tenant_name }}"
        region: "{{ region }}"
        name: "{{ lb_name }}"
        state: "absent"
      register: result

    - debug:
        var: result