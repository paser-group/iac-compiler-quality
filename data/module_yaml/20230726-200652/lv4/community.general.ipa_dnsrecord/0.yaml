---
- name: Test LDAP module
  hosts: localhost
  gather_facts: false
  vars:
    ipa_host: "ipa.example.com"
    ipa_user: "admin"
    ipa_pass: "password"
    ipa_timeout: 10
    ipa_port: 443
    ipa_prot: "https"
    zone_name: "example.com"
  tasks:
    # Task 1 - create a DNS record with a single value
    - name: Create DNS record with single value
      community.general.ipa_dnsrecord:
        ipa_host: "{{ ipa_host }}"
        ipa_user: "{{ ipa_user }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_timeout: "{{ ipa_timeout }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        zone_name: "{{ zone_name }}"
        record_name: "www"
        record_type: "A"
        record_value: "10.1.1.1"
        record_ttl: 3600
        state: present
        validate_certs: true
      register: result1

    - debug:
        var: result1

    # Task 2 - create a DNS record with multiple values
    - name: Create DNS record with multiple values
      community.general.ipa_dnsrecord:
        ipa_host: "{{ ipa_host }}"
        ipa_user: "{{ ipa_user }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_timeout: "{{ ipa_timeout }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        zone_name: "{{ zone_name }}"
        record_name: "www"
        record_type: "A"
        record_values:
          - "10.1.1.1"
          - "10.1.1.2"
        record_ttl: 3600
        state: present
        validate_certs: true
      register: result2

    - debug:
        var: result2

    # Task 3 - delete a DNS record
    - name: Delete DNS record
      community.general.ipa_dnsrecord:
        ipa_host: "{{ ipa_host }}"
        ipa_user: "{{ ipa_user }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_timeout: "{{ ipa_timeout }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        zone_name: "{{ zone_name }}"
        record_name: "www"
        record_type: "A"
        state: absent
        validate_certs: true
      register: result3

    - debug:
        var: result3