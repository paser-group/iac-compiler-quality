---
- name: Firmware Upgrade / Download
  hosts: localhost
  gather_facts: false

  vars:
    deviceType: "{{ device_type }}"
    enablePassword: "{{ enable_password }}"
    username: "{{ login_username }}"
    password: "{{ login_password }}"
    host: "{{ device_ip }}"
    imgpath: "{{ firmware_file_path }}"
    outputfile: "{{ output_file_path }}"
    mac_address: "52:54:00:{{ '%02x%02x%02x'|format(255|random, 255|random, 255|random) }}"

  tasks:
    - name: Perform Firmware Upgrade / Download
      community.network.cnos_image:
        deviceType: "{{ deviceType }}"
        enablePassword: "{{ enablePassword }}"
        host: "{{ host }}"
        imgpath: "{{ imgpath }}"
        outputfile: "{{ outputfile }}"
        username: "{{ username }}"
        password: "{{ password }}"
        mac_address: "{{ mac_address }}"
      register: result

    - name: Debug Firmware Upgrade / Download
      debug:
        var: result