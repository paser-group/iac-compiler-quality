---
- name: Test playbook
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Generate random MAC address
      command: /usr/bin/openssl rand -hex 3 | sed -e 's/\(..\)/\1:/g' -e 's/:$//'
      register: random_mac_result
      changed_when: False

    - name: Create Application Profile
      community.network.avi_applicationprofile:
        controller: "controller_ip_address"
        username: "admin_username"
        password: "admin_password"
        tenant: "default_tenant"
        name: "my_profile_name"
        type: "my_profile_type"
        state: present
        preserve_client_ip: "{{ random_mac_result.stdout }}"