---
- name: Test playbook for community.network.netscaler_lb_monitor module
  hosts: localhost
  gather_facts: false

  vars:
    nitro_user: "<enter_nitro_username>"
    nitro_pass: "<enter_nitro_password>"
    nitro_protocol: http
    nitro_timeout: 10
    nsip: "<enter_nsip_address>"

  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ '%02x' | random }}:{{ '%02x' | random }}:{{ '%02x' | random }}:{{ '%02x' | random }}:{{ '%02x' | random }}:{{ '%02x' | random }}"

    - name: Create a NetScaler LB Monitor for testing
      community.network.netscaler_lb_monitor:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        nitro_protocol: "{{ nitro_protocol }}"
        nitro_timeout: "{{ nitro_timeout }}"
        state: present
        monitorname: "Monitor_Test"
        type: HTTP
        destip: 10.1.1.1
        destport: 80
        action: LOG
        retries: 3
        interval: 5
        httprequest: "GET /"
        validate_certs: false

    - name: Print the random MAC address
      debug:
        msg: "Random MAC address: {{ mac_address }}"