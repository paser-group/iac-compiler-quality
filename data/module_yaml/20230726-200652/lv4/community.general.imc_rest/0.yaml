---
- name: Test IMC REST module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Include random MAC address generator
      include_tasks: random_mac_address_generator.yml

    - name: Test random MAC address
      set_fact:
        mac_address: "{{ randomized_mac_address }}"

    - name: Print random MAC address
      debug:
        var: mac_address

    - name: Test IMC REST module with random MAC address
      community.general.imc_rest:
        content: "some content"
        hostname: "example.com"
        password: "password"
        path: "/api/v1"
        protocol: "https"
        timeout: 60
        username: "admin"
        validate_certs: "yes"
        mac_address: "{{ mac_address }}"