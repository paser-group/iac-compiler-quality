- name: Test playbook for pn_ipv6security_raguard_vlan module
  hosts: localhost
  connection: local
  gather_facts: false

  vars:
    pn_cliswitch: "switch1"
    pn_name: "ipv6_security_raguard_vlan"
    pn_vlans:
      - vlan1
    state: present

  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac: "{{ '%02x' | format(1 | random * 255) }}:{{ '%02x' | format(1 | random * 255) }}:{{ '%02x' | format(1 | random * 255) }}:{{ '%02x' | format(1 | random * 255) }}:{{ '%02x' | format(1 | random * 255) }}:{{ '%02x' | format(1 | random * 255) }}"

    - name: Configure IPv6 security RAGuard VLAN
      community.network.pn_ipv6security_raguard_vlan:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        pn_vlans: "{{ pn_vlans }}"
        state: "{{ state }}"
        mac_address: "{{ random_mac }}"
      register: result

    - debug:
        var: result