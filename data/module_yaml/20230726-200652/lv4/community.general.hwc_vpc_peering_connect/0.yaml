- name: Test playbook for community.general.hwc_vpc_peering_connect module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ '%012x' | format(omit) | random_mac }}"

    - name: Create VPC peering connection
      community.general.hwc_vpc_peering_connect:
        description: "Test VPC peering connection"
        domain: "example.com"
        id: "12345"
        identity_endpoint: "https://identity.example.com"
        local_vpc_id: "101"
        name: "test_connection"
        password: "mysecretpassword"
        peering_vpc:
          vpc_id: "102"
        project: "myproject"
        region: "us-west-2"
        state: present
        timeouts:
          create: 300
          delete: 120
        user: "admin"
        mac_address: "{{ mac_address }}"
      register: result

    - name: Debug output
      debug:
        var: result