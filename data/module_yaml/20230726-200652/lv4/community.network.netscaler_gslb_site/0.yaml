---
- name: Test Ansible Latent Type-Related Bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      vars:
        mac_address: "{{ '%02x' % ((16 ** 6) * random()) }}"
      debug:
        var: mac_address

    - name: Create GSLB site
      community.network.netscaler_gslb_site:
        nitro_user: admin
        nitro_pass: password
        nitro_protocol: "{{ ['http', 'https'] | random }}"
        nsip: "{{ ['10.1.1.1', '10.1.1.2', '10.1.1.3', '10.1.1.4'] | random }}"
        sitename: "{{ ['site1', 'site2', 'site3'] | random }}"
        siteipaddress: "{{ ['10.1.1.10', '10.1.1.20', '10.1.1.30'] | random }}"
        state: "{{ ['present', 'absent'] | random }}"
        validate_certs: "{{ [true, false] | random }}"
        clip: "{{ mac_address }}"
      register: result

    - name: Debug result
      debug:
        var: result