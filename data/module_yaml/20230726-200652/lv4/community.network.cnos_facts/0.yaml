---
- name: Collect facts from remote device
  hosts: all
  gather_facts: no

  tasks:
    - name: Generate random MAC addresses
      set_fact:
        mac_address: "{{ '%02x' | format(255 | random) }}:{{ '%02x' | format(255 | random) }}:{{ '%02x' | format(255 | random) }}:{{ '%02x' | format(255 | random) }}:{{ '%02x' | format(255 | random) }}:{{ '%02x' | format(255 | random) }}"

    - name: Collect CNOS facts
      community.network.cnos_facts:
        auth_pass: null
        authorize: false
        gather_subset: null
        mac: "{{ mac_address }}"
      register: cnos_facts_result

    - name: Debug CNOS facts
      debug:
        var: cnos_facts_result