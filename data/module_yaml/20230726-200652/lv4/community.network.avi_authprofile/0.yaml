---
- name: Test Ansible Module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random MAC address
      set_fact:
        random_mac_address: "{{ '%012x' | format(1 | random * 10**12) }}"

    - name: Create Auth Profile
      community.network.avi_authprofile:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        name: "{{ random_mac_address }}"
        state: present
      register: result