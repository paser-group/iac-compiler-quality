---
- name: Apply ACLs to interfaces on HUAWEI
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Generate random MAC addresses
      ansible.builtin.script: |
        #!/usr/bin/env python
        import random

        def get_random_mac():
            mac_digits = "0123456789abcdef"
            mac = "00:"
            for _ in range(5):
                mac += random.choice(mac_digits) + random.choice(mac_digits) + ':'
            mac += random.choice(mac_digits) + random.choice(mac_digits)
            return mac
        
        print(get_random_mac())
      register: random_mac

    - name: Apply ACLs to interfaces
      community.network.ce_acl_interface:
        acl_name: "{{ random_mac.stdout }}"
        direction: "{{ random_mac.stdout }}"
        interface: "{{ random_mac.stdout }}"
        state: "{{ random_mac.stdout }}"