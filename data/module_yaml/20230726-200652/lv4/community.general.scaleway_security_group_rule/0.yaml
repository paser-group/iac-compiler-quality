- name: Test playbook for scaleway_security_group_rule module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac: "{{ '%012x' | format(999999999) }}"

    - name: Create security group rule
      community.general.scaleway_security_group_rule:
        action: create
        api_token: "YOUR_API_TOKEN"
        security_group: "security-group-id"
        direction: "inbound"
        protocol: "tcp"
        port: 22
        ip_range: "10.1.1.0/24"
        state: present
        query_parameters:
          example_param: "example_value"
        region: "par1"
        api_timeout: 30
        api_url: "https://api.scaleway.com/"
        validate_certs: true
      register: result

    - name: Debug result
      debug:
        var: result

    - name: Delete security group rule
      community.general.scaleway_security_group_rule:
        action: delete
        api_token: "YOUR_API_TOKEN"
        security_group: "security-group-id"
        direction: "inbound"
        port: 22
        ip_range: "10.1.1.0/24"
        validate_certs: true
      register: result

    - name: Debug result
      debug:
        var: result