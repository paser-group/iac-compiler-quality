---
- name: Create/Update GitLab Group
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Create/Update GitLab Group
      community.general.gitlab_group:
        api_url: "https://your-gitlab-instance.com"
        api_token: "your-api-token"
        name: "testing-group"
        state: present
        require_two_factor_authentication: true
        project_creation_level: "developer"
        subgroup_creation_level: "maintainer"
        visibility: "public"
      register: result

    - name: Debug Result
      debug:
        var: result

- name: Test Cases
  hosts: localhost
  gather_facts: false
  vars:
    mac_address: "{{ item }}"
    subnet: "10.1.1.0/24"
    gateway: "10.1.1.254"
    nodes:
      - name: ubuntu1
        ip_address: "10.1.1.1"
        distribution: "ubuntu"
      - name: alpine1
        ip_address: "10.1.1.2"
        distribution: "alpine"
      - name: centos1
        ip_address: "10.1.1.3"
        distribution: "centos"
      - name: redhat1
        ip_address: "10.1.1.4"
        distribution: "redhat"
  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ mac_address | default([]) + [ mac_address_generate() ] }}"
      with_sequence: count=4

    - name: Print random MAC address
      debug:
        var: mac_address

    - name: Create network configuration file
      template:
        src: network.j2
        dest: "/tmp/{{ item.name }}-network.cfg"
      loop: "{{ nodes }}"

    - name: Print network configuration file content
      command: cat "/tmp/{{ item.name }}-network.cfg"
      loop: "{{ nodes }}"