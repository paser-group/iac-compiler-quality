---
- name: vDirect Runnable Playbook
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Run templates and workflow actions in vDirect
      community.network.vdirect_runnable:
        action_name: "{{ generate_random_mac_address }}"
        parameters: "{{ generate_random_mac_address }}"
        runnable_name: "{{ generate_random_mac_address }}"
        runnable_type: "{{ generate_random_mac_address }}"
        validate_certs: "{{ generate_random_boolean }}"
        vdirect_http_port: "{{ generate_random_port }}"
        vdirect_https_port: "{{ generate_random_port }}"
        vdirect_ip: "{{ generate_random_ip }}"
        vdirect_password: "{{ generate_random_password }}"
        vdirect_secondary_ip: "{{ generate_random_ip }}"
        vdirect_timeout: "{{ generate_random_timeout }}"
        vdirect_use_ssl: "{{ generate_random_boolean }}"
        vdirect_user: "{{ generate_random_username }}"
        vdirect_wait: "{{ generate_random_boolean }}"
  vars:
    mac_address_chars: "0123456789ABCDEF"
    ip_address_chars: "0123456789."
    username_chars: "abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    password_chars: "abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()-_+={}[]\|:;"<>,.?/~`"

  tasks:
    - name: Generate random MAC address
      set_fact:
        generate_random_mac_address: |
          {% for i in range(6) %}
          {{ mac_address_chars | random }}{{ mac_address_chars | random }}{% if not loop.last %}:{% endif %}
          {% endfor %}

    - name: Generate random IP address
      set_fact:
        generate_random_ip: |
          {% for i in range(4) %}
          {{ ip_address_chars | random }}{% if not loop.last %}.{% endif %}
          {% endfor %}

    - name: Generate random username
      set_fact:
        generate_random_username: |
          {% for i in range(8) %}
          {{ username_chars | random }}
          {% endfor %}

    - name: Generate random password
      set_fact:
        generate_random_password: |
          {% for i in range(16) %}
          {{ password_chars | random }}
          {% endfor %}

    - name: Generate random boolean
      set_fact:
        generate_random_boolean: "{{ [true, false] | random }}"

    - name: Generate random port
      set_fact:
        generate_random_port: "{{ 1 + mac_address_chars | random | int }}"

    - name: Generate random timeout
      set_fact:
        generate_random_timeout: "{{ 1 + mac_address_chars[-1] | random | int }}"