---
- name: Test playbook for community.network.ce_vxlan_vap
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create VXLAN VAP
      community.network.ce_vxlan_vap:
        bind_vlan_id: "{{ item.bind_vlan_id }}"
        bridge_domain_id: "{{ item.bridge_domain_id }}"
        ce_vid: "{{ item.ce_vid }}"
        encapsulation: "{{ item.encapsulation }}"
        l2_sub_interface: "{{ item.l2_sub_interface }}"
        pe_vid: "{{ item.pe_vid }}"
        state: "{{ item.state }}"
      loop:
        - bind_vlan_id: null
          bridge_domain_id: null
          ce_vid: null
          encapsulation: null
          l2_sub_interface: null
          pe_vid: null
          state: null

      vars:
        random_mac: "00:{{ '%02x' | format(1..255 | random) }}:{{ '%02x' | format(1..255 | random) }}:{{ '%02x' | format(1..255 | random) }}"
        random_encapsulation: ['dot1q', 'qinq']

      register: result

    - name: Debug VXLAN VAP Creation
      debug:
        var: result