---
- name: Generate random MAC addresses
  hosts: all
  gather_facts: false
  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ hostvars[inventory_hostname]['ansible_host'] | random_mac }}"
      when: inventory_hostname in groups['all']