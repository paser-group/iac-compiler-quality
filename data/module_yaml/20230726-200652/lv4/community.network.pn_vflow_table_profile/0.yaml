---
- name: Unveil Latent Type-Related Bugs in Ansible Compiler
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC addresses for network modules
      ansible.builtin.set_fact:
        random_mac: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(
          (220 + (ansible_hostname.split('-')[-1]|int))), 
          (2 + (ansible_hostname.split('-')[-1]|int))), 
          (2 + (ansible_hostname.split('-')[-1]|int))), 
          (2 + (ansible_hostname.split('-')[-1]|int))), 
          (2 + (ansible_hostname.split('-')[-1]|int))), 
          (2 + (ansible_hostname.split('-')[-1]|int)))
        }}"

    - name: Modify vFlow table profile
      community.network.pn_vflow_table_profile:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_enable: "{{ pn_enable }}"
        pn_hw_tbl: "{{ pn_hw_tbl }}"
        pn_profile: "{{ pn_profile }}"
        mac: "{{ random_mac }}"
        state: "{{ state }}"
      register: result

    - debug:
        var: result