---
- name: Test modprobe module
  hosts: all
  gather_facts: False

  tasks:
    - name: Load or unload a kernel module
      community.general.modprobe:
        name: "{{ module_name }}"
        params: "{{ module_params }}"
        persistent: "{{ persistent }}"
        state: "{{ module_state }}"