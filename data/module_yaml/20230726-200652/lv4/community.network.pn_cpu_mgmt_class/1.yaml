---
- name: Configure CPU Management Class
  hosts: network_device
  gather_facts: false
  tasks:
    - name: Generate Random MAC Address
      set_fact:
        mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(255|random, 255|random, 255|random, 255|random, 255|random, 255|random) }}"
    
    - name: Configure CPU Management Class
      community.network.pn_cpu_mgmt_class:
        pn_name: "{{ mac_address }}"
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_rate_limit: "{{ pn_rate_limit }}"
        pn_burst_size: "{{ pn_burst_size }}"
        state: "{{ state }}"