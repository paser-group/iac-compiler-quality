---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set up iptables rule
      ansible.builtin.iptables:
        chain: "{{ random_chain }}"
        state: present
      vars:
        random_chain: "{{ random_value | random }}"
      vars_prompt:
        - name: random_value
          prompt: "Enter a random value"

    - name: Debug
      ansible.builtin.debug:
        msg: "Rule set successfully"

    - name: Remove iptables rule
      ansible.builtin.iptables:
        chain: "{{ random_chain }}"
        state: absent
      vars:
        random_chain: "{{ random_value | random }}"
      vars_prompt:
        - name: random_value
          prompt: "Enter a random value"