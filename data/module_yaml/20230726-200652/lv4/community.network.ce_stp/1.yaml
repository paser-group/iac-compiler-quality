---
- name: Manage STP configuration on HUAWEI switches
  hosts: switch
  gather_facts: false

  tasks:
    - name: Configure STP settings
      community.network.ce_stp:
        bpdu_filter: "{{ bpdu_filter | random_mac }}"
        bpdu_protection: "{{ bpdu_protection | random_mac }}"
        cost: "{{ cost }}"
        edged_port: "{{ edged_port }}"
        interface: "{{ interface }}"
        loop_protection: "{{ loop_protection }}"
        root_protection: "{{ root_protection }}"
        state: "{{ state }}"
        stp_converge: "{{ stp_converge }}"
        stp_enable: "{{ stp_enable }}"
        stp_mode: "{{ stp_mode }}"
        tc_protection: "{{ tc_protection }}"
        tc_protection_interval: "{{ tc_protection_interval }}"
        tc_protection_threshold: "{{ tc_protection_threshold }}"
      register: result

    - name: Debug STP configuration
      debug:
        var: result