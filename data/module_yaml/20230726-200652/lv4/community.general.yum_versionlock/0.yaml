---
- name: Lock/Unlock Packages using yum_versionlock module
  hosts: all
  gather_facts: false

  tasks:
    - name: Install necessary Python packages
      raw: "sudo yum -y install python2 python2-devel"
      register: result
      changed_when: result.stdout != ""

    - name: Lock packages using yum_versionlock
      community.general.yum_versionlock:
        name:
          - package1
          - package2
        state: locked
      register: result
      changed_when: result.changed

    - name: Unlock packages using yum_versionlock
      community.general.yum_versionlock:
        name:
          - package1
          - package2
        state: unlocked
      register: result
      changed_when: result.changed