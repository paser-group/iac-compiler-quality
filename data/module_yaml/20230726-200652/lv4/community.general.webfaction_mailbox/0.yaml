- name: Ansible Latent Type-Related Bug Finder
  hosts: localhost
  gather_facts: false

  vars:
    login_name: "admin"
    login_password: "pass123"
    mailbox_name: "user1"
    mailbox_password: "mailboxpass"
    state: "present"

  tasks:
    - name: Generate random MAC addresses for network modules
      set_fact:
        mac_address: "52:54:00:{{ '%02x'|format(ansible_random.Int(0, 255)) }}:{{ '%02x'|format(ansible_random.Int(0, 255)) }}:{{ '%02x'|format(ansible_random.Int(0, 255)) }}"

    - name: Debug MAC address
      debug:
        var: mac_address

    - name: Add or remove mailbox
      community.general.webfaction_mailbox:
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        mailbox_name: "{{ mailbox_name }}"
        mailbox_password: "{{ mailbox_password }}"
        state: "{{ state }}"
      register: mailbox_result

    - name: Display mailbox result
      debug:
        var: mailbox_result