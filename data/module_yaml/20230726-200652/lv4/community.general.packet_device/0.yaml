---
- name: Manage bare metal servers
  hosts: localhost
  tasks:
    - name: Create bare metal server
      community.general.packet_device:
        auth_token: YOUR_AUTH_TOKEN
        facility: "AMS1"
        plan: "c1.small.x86"
        operating_system: "ubuntu_20_04"
        count: 1
        hostname: "test-server"
        always_pxe: false
        wait_timeout: 120
        locked: true
        tags:
          - "dev"
          - "ansible-test"
        user_data: |
          #!/bin/bash
          echo "Hello from user_data!"

      register: result

    - name: Show result
      debug:
        var: result

- name: Generate random MAC addresses for network modules
  hosts: localhost
  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(0, 0, 0, 0, 0, 0) }}"

    - name: Show MAC address
      debug:
        var: mac_address