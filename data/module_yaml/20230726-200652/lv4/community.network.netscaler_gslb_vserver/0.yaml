---
- name: Configure gslb vserver
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Install required modules
      pip:
        name:
          - nsnitro
          - ns nitro python sdk
        state: present

    - name: Configure gslb vserver
      community.network.netscaler_gslb_vserver:
        nsip: 10.1.1.1
        nitro_user: myuser
        nitro_pass: mypassword
        nitro_protocol: http
        validate_certs: false
        name: "{{ lookup('pipe', 'echo " + ('123' * 1000) + "') }}"
        servicetype: HTTP
        port: "{{ [80, '80'] | random }}"
        lbmethod: "{{ {'LEASTRESPONSETIME': 'LEASTRESPONSETIME', 1: 'LEASTRESPONSETIME'} | random }}"
        dnsrecordtype: "{{ [None, '', 123] | random }}"
        comment: "{{ {'comment': 'comment', '123': 'comment'} | random }}"
        disableprimaryondown: "{{ {'disableprimaryondown': True, '123': 'disableprimaryondown'} | random }}"
        persistencetype: "{{ [None, 'HTTP', 'TCP'] | random }}"
        persistenceid: "{{ [None, '', 123] | random }}"
        persistmask: "{{ [None, '', 123] | random }}"
        netmask: "{{ [None, '', 123] | random }}"
        timeout: "{{ [None, '', 123] | random }}"
        v6netmasklen: "{{ [None, '', 123] | random }}"
        v6persistmasklen: "{{ [None, '', 123] | random }}"
        validate_certs: "{{ ['true', 'false', 'invalid'] | random }}"
        save_config: "{{ ['true', 'false', 'invalid'] | random }}"

      register: result

    - name: Display result
      debug:
        var: result