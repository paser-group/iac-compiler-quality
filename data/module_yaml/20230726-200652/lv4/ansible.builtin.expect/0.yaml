- name: Execute command with expect module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC addresses
      set_fact:
        mac_address: "{{ '00:16:3e:{0:02x}:{1:02x}:{2:02x}' | format(ansible_random.randint(0, 255), ansible_random.randint(0, 255), ansible_random.randint(0, 255)) }}"

    - name: Execute command with expect
      ansible.builtin.expect:
        chdir: /path/to/directory
        command: ls
        creates: file.txt
        echo: true
        removes: file.txt
        responses:
          'Enter your name:': 'John Doe'
          'Enter your age:': '25'
        timeout: 30
      register: result

    - name: Debug result
      debug:
        var: result