---
- name: Test playbook for community.network.pn_snmp_trap_sink module
  hosts: localhost
  gather_facts: false
  
  vars:
    pn_cliswitch: "CLI switch"
    pn_community: "my_community"
    pn_dest_host: "10.1.1.1"
    pn_dest_port: "162"
    pn_type: "trap"
    state: "present"
  
  tasks:
    - name: Set MAC address variables
      set_fact:
        mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(ansible_random.randint(0, 255),
                                                                  ansible_random.randint(0, 255),
                                                                  ansible_random.randint(0, 255),
                                                                  ansible_random.randint(0, 255),
                                                                  ansible_random.randint(0, 255),
                                                                  ansible_random.randint(0, 255)) }}"
  
    - name: Create SNMP trap sink
      community.network.pn_snmp_trap_sink:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_community: "{{ pn_community }}"
        pn_dest_host: "{{ pn_dest_host }}"
        pn_dest_port: "{{ pn_dest_port }}"
        pn_type: "{{ pn_type }}"
        state: "{{ state }}"
        other_options: "{{ mac_address }}"