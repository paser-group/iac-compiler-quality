- name: Generate random MAC addresses
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address for eth0
      set_fact:
        eth0_mac: "{{ (100 + (ansible_date_time.nanosecond % 900))|string + ':'.join(ansible_date_time.nanosecond|random|string|center(4, '0')|batch(2)|map('join', '')) }}"

    - name: Generate random MAC address for eth1
      set_fact:
        eth1_mac: "{{ (100 + (ansible_date_time.nanosecond % 900))|string + ':'.join(ansible_date_time.nanosecond|random|string|center(4, '0')|batch(2)|map('join', '')) }}"

    # Assign the generated MAC addresses to network interfaces
    - name: Assign MAC address to eth0
      command: ip link set dev eth0 address "{{ eth0_mac }}"

    - name: Assign MAC address to eth1
      command: ip link set dev eth1 address "{{ eth1_mac }}"