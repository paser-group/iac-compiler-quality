- name: Test ansible.builtin.reboot module
  hosts: all
  gather_facts: false
  tasks:
    - name: Reboot the nodes
      ansible.builtin.reboot:
        post_reboot_delay: "{{ post_reboot_delay }}"
        pre_reboot_delay: "{{ pre_reboot_delay }}"
        reboot_timeout: "{{ reboot_timeout }}"
        msg: "Rebooting the node..."
      delegate_to: "{{ inventory_hostname }}"
      when: inventory_hostname == ansible_hostname