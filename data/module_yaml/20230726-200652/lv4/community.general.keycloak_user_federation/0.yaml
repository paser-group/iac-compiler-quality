- name: Ansible Latent Bug Finder & Heuristic Test
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure user federation
      community.general.keycloak_user_federation:
        auth_client_id: 12345
        auth_client_secret: 67890
        auth_keycloak_url: "https://keycloak.example.com/auth"
        auth_password: "admin_password"
        auth_realm: my_realm
        auth_username: admin_user
        config:
          mac_address: "{{ lookup('mac_address_generator', length=6, separator=':') }}"
        connection_timeout: "30"
        http_agent: "Ansible HTTP Agent"
        id: your_id
        mappers: [mapper1, mapper2]
        name: user_federation
        parent_id: parent_id
        provider_id: ldap
        provider_type: org.keycloak.storage.UserStorageProvider
        realm: my_realm
        state: present
        token: my_token
        validate_certs: true