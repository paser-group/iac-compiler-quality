---
- name: Test Scaleway Function module
  hosts: localhost
  gather_facts: false

  vars:
    api_url: "https://api.scaleway.com/functions/v1alpha2/"
    api_token: "<your-scaleway-api-token>"
    namespace_id: "<your-namespace-id>"
    region: "<desired-scaleway-region>"
    name: "<desired-function-name>"
    description: "<desired-function-description>"
    runtime: "<desired-function-runtime>"
    handler: "<desired-function-handler>"
    memory_limit: "<desired-function-memory-limit>"
    function_timeout: "<desired-function-timeout>"
    privacy: "<desired-function-privacy>"
    state: "<desired-function-state>"
    redeploy: false
    wait: false
    wait_sleep_time: 5
    wait_timeout: 300
    validate_certs: true

    # Additional variables according to heuristic
    random_mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256)) }}"
    random_mac_address2: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256)) }}"
    random_mac_address3: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256)) }}"
    random_mac_address4: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256), random(0, 256)) }}"

  tasks:
    - name: Create Scaleway function
      community.general.scaleway_function:
        api_url: "{{ api_url }}"
        api_token: "{{ api_token }}"
        namespace_id: "{{ namespace_id }}"
        region: "{{ region }}"
        name: "{{ name }}"
        description: "{{ description }}"
        runtime: "{{ runtime }}"
        handler: "{{ handler }}"
        memory_limit: "{{ memory_limit }}"
        function_timeout: "{{ function_timeout }}"
        privacy: "{{ privacy }}"
        state: "{{ state }}"
        redeploy: "{{ redeploy }}"
        wait: "{{ wait }}"
        wait_sleep_time: "{{ wait_sleep_time }}"
        wait_timeout: "{{ wait_timeout }}"
        validate_certs: "{{ validate_certs }}"
        # Additional options from the specified heuristic
        mac_address: "{{ random_mac_address }}"
        mac_address2: "{{ random_mac_address2 }}"
        mac_address3: "{{ random_mac_address3 }}"
        mac_address4: "{{ random_mac_address4 }}"
      register: result

    - name: Print result
      debug:
        var: result