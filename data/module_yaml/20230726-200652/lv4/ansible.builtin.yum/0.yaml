- name: Manage packages with yum
  hosts: all
  become: true

  tasks:
    - name: Generate random MAC addresses
      shell: echo $((RANDOM%256)).$((RANDOM%256)).$((RANDOM%256)).$((RANDOM%256))
      register: random_mac

    - name: Set MAC addresses for network modules
      set_fact:
        ubuntu1_mac: "{{ random_mac.stdout }}"
        alpine1_mac: "{{ random_mac.stdout }}"
        centos1_mac: "{{ random_mac.stdout }}"
        redhat1_mac: "{{ random_mac.stdout }}"

    - name: Install packages
      yum:
        name:
          - package1
          - package2
        state: present
        ...

        vars:
          update_cache: true
          allow_downgrade: true
          autoremove: true
          bugfix: true
          cacheonly: true
          disable_gpg_check: true
          disablerepo: []
          download_only: false
          enable_plugin: []
          enablerepo: []
          exclude: []
          install_repoquery: true
          install_weak_deps: true
          list: ""
          lock_timeout: 30
          releasever: ""
          security: true
          skip_broken: true
          sslverify: true
          update_only: false
          validate_certs: true
          ubuntu1_mac: "{{ ubuntu1_mac }}"
          alpine1_mac: "{{ alpine1_mac }}"
          centos1_mac: "{{ centos1_mac }}"
          redhat1_mac: "{{ redhat1_mac }}"