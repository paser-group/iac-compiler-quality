- name: Test playbook for 'community.general.portage' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install packages
      community.general.portage:
        package: "{{ item }}"
        state: present
        update: true
      loop:
        - package1
        - package2
        - package3

    - name: Remove packages
      community.general.portage:
        package: "{{ item }}"
        state: absent
      loop:
        - package4
        - package5

    - name: Perform specific tasks
      community.general.portage:
        state: "{{ 'invalid_state' }}"
        backtrack: "{{ 'invalid_boolean' }}"
        changed_use: "{{ 'invalid_boolean' }}"
        deep: "{{ 'invalid_boolean' }}"
        depclean: "{{ 'invalid_boolean' }}"
        getbinpkg: "{{ 'invalid_boolean' }}"
        getbinpkgonly: "{{ 'invalid_boolean' }}"
        jobs: "{{ 'invalid_int' }}"
        keepgoing: "{{ 'invalid_boolean' }}"
        loadavg: "{{ 'invalid_float' }}"
        newuse: "{{ 'invalid_boolean' }}"
        nodeps: "{{ 'invalid_boolean' }}"
        noreplace: "{{ 'invalid_boolean' }}"
        oneshot: "{{ 'invalid_boolean' }}"
        onlydeps: "{{ 'invalid_boolean' }}"
        package: "{{ 'invalid_package' }}"
        quiet: "{{ 'invalid_boolean' }}"
        quietbuild: "{{ 'invalid_boolean' }}"
        quietfail: "{{ 'invalid_boolean' }}"
        state: "{{ 'invalid_state' }}"
        sync: "{{ 'invalid_sync' }}"
        update: "{{ 'invalid_boolean' }}"
        usepkg: "{{ 'invalid_boolean' }}"
        usepkgonly: "{{ 'invalid_boolean' }}"
        verbose: "{{ 'invalid_boolean' }}"
        withbdeps: "{{ 'invalid_boolean' }}"
      loop:
        - "{{ item }}"
      loop_control:
        loop_var: invalid_var

    - name: Clean system
      community.general.portage:
        depclean: "{{ 'invalid_boolean' }}"
        package: "{{ 'invalid_package' }}"
        state: present
        sync: "{{ 'invalid_sync' }}"
      loop:
        - "{{ item }}"
      loop_control:
        loop_var: invalid_var

    - name: Check if packages need update
      community.general.portage:
        package: "{{ 'invalid_package' }}"
        state: latest
        update: "{{ 'invalid_boolean' }}"
      loop:
        - "{{ item }}"
      loop_control:
        loop_var: invalid_var