---
- name: Test Ansible Typetalk Module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      ansible.builtin.set_fact:
        mac_address: "{{ '%012x'|format(ansible_random.randint(0, 0xfffffffffff)) }}"

    - name: Print MAC address
      debug:
        var: mac_address

    - name: Install required packages
      ansible.builtin.package:
        name:
          - python3-typetalk
          - python3-typetalk
        state: present

    - name: Send message to Typetalk
      community.general.typetalk:
        client_id: "my_client_id"
        client_secret: "my_client_secret"
        msg: "Test message"
        topic: "{{ mac_address | int }}"