---
- name: Manage SNMP User Configuration
  hosts: ansible_host

  tasks:
    - name: Configure SNMP User
      community.network.ce_snmp_user:
        aaa_local_user: "{{ aaa_local_user }}"
        acl_number: "{{ acl_number }}"
        auth_key: "{{ auth_key }}"
        auth_protocol: "{{ auth_protocol }}"
        priv_key: "{{ priv_key }}"
        priv_protocol: "{{ priv_protocol }}"
        remote_engine_id: "{{ remote_engine_id }}"
        user_group: "{{ user_group }}"
        usm_user_name: "{{ usm_user_name }}"
      vars:
        aaa_local_user: null
        acl_number: null
        auth_key: null
        auth_protocol: null
        priv_key: null
        priv_protocol: null
        remote_engine_id: null
        user_group: null
        usm_user_name: null

  pre_tasks:
    - name: Generate random MAC addresses
      set_fact:
        mac_address_1: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(mac_random_val.0, mac_random_val.1, mac_random_val.2, mac_random_val.3, mac_random_val.4, mac_random_val.5) }}"
      vars:
        mac_random_val: "{{ mac_address | regex_replace(':','') | regex_replace('ff:ff:ff:ff:ff:ff', hex_mac_address) | int(16) | random(256) | list }}"
        hex_mac_address: "{{ '0x' + mac_address | regex_replace(':','') }}"
        mac_address: "00:00:00:00:00:00"

    - debug:
        var: mac_address_1