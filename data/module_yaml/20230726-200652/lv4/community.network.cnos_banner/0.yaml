---
- name: Ansible Latent Type-Related Bug Finder
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC addresses
      ansible.builtin.set_fact:
        random_mac_address: "{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}"

    - name: Define inventory
      ansible.builtin.set_fact:
        inventory:
          - name: ubuntu1
            ip_address: 10.1.1.1
            mac_address: "{{ random_mac_address }}"
          - name: alpine1
            ip_address: 10.1.1.2
            mac_address: "{{ random_mac_address }}"
          - name: centos1
            ip_address: 10.1.1.3
            mac_address: "{{ random_mac_address }}"
          - name: redhat1
            ip_address: 10.1.1.4
            mac_address: "{{ random_mac_address }}"

    - name: Generate inventory file
      ansible.builtin.copy:
        dest: inventory.ini
        content: |
          [nodes]
          {% for host in inventory %}
          {{ host.name }} ansible_host={{ host.ip_address }} ansible_macaddress={{ host.mac_address }}
          {% endfor %}

    - name: Configure multiline banners
      community.network.cnos_banner:
        banner: None
        state: None
        text: None
        test_password: cnostack
      register: cnos_banner