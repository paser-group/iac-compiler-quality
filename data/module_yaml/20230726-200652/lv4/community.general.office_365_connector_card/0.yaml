---
- name: Test playbook for community.general.office_365_connector_card module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(255 | random, 255 | random, 255 | random, 255 | random, 255 | random, 255 | random) }}"

    - name: Create Connector Card message
      community.general.office_365_connector_card:
        webhook: "https://your-webhook-url"
        actions:
          - "@type": "OpenUri"
            name: "View Details"
            targets:
              - "{{ mac_address }}"
        color: "0078D7"
        sections:
          - activityTitle: "Sample Activity Title"
            activitySubtitle: "Sample Activity Subtitle"
            activityImage: "https://example.com/activity-image.png"
            facts:
              - name: "Fact 1"
                value: "Value 1"
              - name: "Fact 2"
                value: "Value 2"
          - activityTitle: "Another Activity Title"
            activitySubtitle: "Another Activity Subtitle"
            activityImage: "https://example.com/another-activity-image.png"
            facts:
              - name: "Fact 3"
                value: "Value 3"
              - name: "Fact 4"
                value: "Value 4"
        summary: "Sample Summary"
        text: "Sample Text"
        title: "Sample Title"

      register: result

    - name: Debug result
      debug:
        var: result