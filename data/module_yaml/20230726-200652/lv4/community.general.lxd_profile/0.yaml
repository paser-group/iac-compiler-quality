---
- name: Find latent type-related bugs in Ansible compiler
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create LXD profile
      community.general.lxd_profile:
        name: "{{ item.name }}"
        description: "{{ item.description }}"
        config:
          "security.privileged": "{{ item.security_privileged }}"
        devices:
          "{{ item.device_name }}":
            nictype: "{{ item.network_type }}"
            parent: "{{ item.parent }}"
            type: "{{ item.device_type }}"
            hwaddr: "{{ item.hwaddr }}"
        state: present
      loop:
        - name: profile1
          description: Profile 1 description
          security_privileged: true
          device_name: eth0
          network_type: macvlan
          parent: eth0
          device_type: nic
          hwaddr: "!invalid_value"
        - name: profile2
          description: Profile 2 description
          security_privileged: false
          device_name: eth1
          network_type: macvlan
          parent: eth1
          device_type: nic
          hwaddr: "!invalid_value"