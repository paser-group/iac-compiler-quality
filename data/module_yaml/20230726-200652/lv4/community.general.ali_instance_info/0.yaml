---
- name: Gather information on instances
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include the module
      include_role:
        name: community.general.ali_instance_info
      
      vars:
        alicloud_access_key: "{{ random_string(16, chars='abcdefghijklmnopqrstuvwxyz') }}"
        alicloud_assume_role:
          role_arn: "arn:aws:iam::123456789012:role/your-assumed-role"
          session_expiration: 900
          session_name: "AssumeRoleSession"
        alicloud_region: "us-west-2"
        alicloud_secret_key: "{{ random_string(16, chars='abcdefghijklmnopqrstuvwxyz') }}"
        alicloud_security_token: "{{ random_string(32, chars='abcdefghijklmnopqrstuvwxyz0123456789') }}"
        ecs_role_name: "YourEC2InstanceRole"
        filters:
          instance-state-name: "running"
          tag:environment: "development"
        name_prefix: "test-"
        profile: "default"
        shared_credentials_file: "/path/to/credentials"
        tags:
          env: "dev"
      
      register: instance_info_result
    
    - name: Debug instance info result
      debug:
        var: instance_info_result