---
- name: Manage Rundeck ACL Policies
  hosts: localhost
  become: false
  gather_facts: false

  tasks:
    - name: Create ACL policy
      community.general.rundeck_acl_policy:
        url: "https://your-rundeck-url"
        api_token: "your-api-token"
        api_version: 23
        name: "test-policy"
        project: "your-project"
        state: "present"
        policy: |
          ---
          context:
            project: "your-project"
          for:
            resource:
              - equals:
                  url: "/*"
          by:
            group: "your-group"
            allow: [read,run]

    - name: Delete ACL policy
      community.general.rundeck_acl_policy:
        url: "https://your-rundeck-url"
        api_token: "your-api-token"
        api_version: 23
        name: "test-policy"
        project: "your-project"
        state: "absent"