- name: Slurp file with random MAC address
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac: "{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}:{{ (0..255)|random|format('%02x') }}"

    - name: Slurp a file
      ansible.builtin.slurp:
        src: "/path/to/remote/file"
      register: file_content
      vars:
        mac_address: "{{ random_mac }}"

    - name: Save file locally
      copy:
        content: "{{ file_content.content | b64decode }}"
        dest: "/tmp/local/file"