---
- name: Test playbook for community.general.homebrew module
  hosts: localhost
  gather_facts: false
  vars:
    packages_to_install:
      - package1
      - package2
    homebrew_path: /usr/local/Cellar

  tasks:
    - name: Install packages using homebrew
      community.general.homebrew:
        name: "{{ packages_to_install }}"
        state: present
        path: "{{ homebrew_path }}"
        update_homebrew: true
        upgrade_all: true
        upgrade_options:
          - '--cleanup'
          - '--display-times'
      register: homebrew_output
      changed_when: False

    - name: Display homebrew install output
      debug:
        var: homebrew_output

    - name: Generate random MAC address for network modules
      set_fact:
        random_mac_address: "{{ '%012x'|format((random*281474976710656)|int) }}"
    
    - name: Display random MAC address
      debug:
        var: random_mac_address