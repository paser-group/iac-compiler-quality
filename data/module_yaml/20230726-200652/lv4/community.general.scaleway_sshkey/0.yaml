---
- name: Test Suite for scaleway_sshkey module
  hosts: localhost
  gather_facts: false
  
  vars:
    api_token: "YOUR_API_TOKEN"
    api_url: "https://api.scaleway.com"
    ssh_pub_key: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC6Mn/jdLdH6ADyFJntlftrKmu14mZ9FTFCAz6X9A5Aye82efsh8B1g4VgXaXNVNpQhNM0sHDLwVk5XTLbinV5hmQKEUaPTr+3mCnkSo1OJ3+5gI3w="
  
  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ '%02x' | format(0, random.randint(1, 255)) }}:{{ '%02x' | format(0, random.randint(1, 255)) }}:{{ '%02x' | format(0, random.randint(1, 255)) }}:{{ '%02x' | format(0, random.randint(1, 255)) }}:{{ '%02x' | format(0, random.randint(1, 255)) }}:{{ '%02x' | format(0, random.randint(1, 255)) }}"

    - name: Create Scaleway SSH key
      community.general.scaleway_sshkey:
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        ssh_pub_key: "{{ ssh_pub_key }}"
        state: present
        validate_certs: true
        api_timeout: "{{ mac_address }}"
      register: result
      delegate_to: localhost

    - name: Print the result
      debug:
        var: result