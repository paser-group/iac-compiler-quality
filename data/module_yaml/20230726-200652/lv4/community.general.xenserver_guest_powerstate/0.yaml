- name: Manage power state of XenServer virtual machine
  hosts: localhost
  gather_facts: false

  tasks:

    - name: Set power state of virtual machine
      community.general.xenserver_guest_powerstate:
        hostname: "{{ xenserver_hostname }}"
        username: "{{ xenserver_username }}"
        password: "{{ xenserver_password }}"
        uuid: "{{ vm_uuid }}"
        state: "{{ vm_power_state }}"
        state_change_timeout: "{{ state_timeout }}"
        validate_certs: "{{ validate_certs }}"
        wait_for_ip_address: "{{ wait_for_ip }}"
        name: "Virtual Machine"
      register: power_state_result
      
    - name: Print power state result
      debug:
        var: power_state_result