---
- name: Find latent type-related bugs in Ansible compiler
  hosts: docker_nodes
  gather_facts: false
  
  vars:
    random_mac: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(255|random, 255|random, 255|random, 255|random, 255|random, 255|random) }}"
  
  tasks:
    - name: Configure netscaler_cs_policy
      community.network.netscaler_cs_policy:
        state: present
        domain: "{{ item }}"
        nitro_pass: "password"
        nitro_timeout: 10.0
        nitro_user: "admin"
        nsip: "{{ hostvars['ubuntu1']['ansible_host'] }}"
        policyname: "{{ item }}"
        rule: "{{ item }}"
        save_config: true
        url: "{{ item }}"
        validate_certs: false
      loop:
        - "{{ random_mac }}"
        - "{{ random_mac }}"
        - "{{ random_mac }}"
      ignore_errors: true