---
- name: Test playbook for community.general.scaleway_compute module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a Scaleway compute instance
      community.general.scaleway_compute:
        api_token: "{{ api_token }}"
        api_timeout: "{{ api_timeout }}"
        name: "{{ instance_name }}"
        commercial_type: "{{ commercial_type }}"
        image: "{{ image }}"
        region: "{{ region }}"
        organization: "{{ organization }}"
        project: "{{ project }}"
        wait: "{{ wait | bool }}"
        wait_timeout: "{{ wait_timeout }}"
      register: instance

    - name: Generate random MAC addresses for network modules
      vars:
        mac_address_1: "{{ instance.server.id | random_mac_address }}"
        mac_address_2: "{{ instance.server.id | random_mac_address }}"
      debug:
        msg: "MAC address 1: {{ mac_address_1 }}, MAC address 2: {{ mac_address_2 }}"

    - name: Perform other tasks...
      # Include other tasks here based on your specific requirements

  vars:
    api_token: "{{ lookup('env', 'SCALEWAY_API_TOKEN') }}"
    api_timeout: 60
    instance_name: "test-instance"
    commercial_type: "DEV1-S"
    image: "ubuntu-focal"
    region: "ams1"
    organization: "my-org"
    project: "my-project"
    wait: "true"
    wait_timeout: 300