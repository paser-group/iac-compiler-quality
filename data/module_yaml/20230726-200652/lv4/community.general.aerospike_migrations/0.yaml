---
- name: Find Type-Related Bugs in aerospike_migrations module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC addresses for network modules
      set_fact:
        random_mac: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(random(0,255)) | random_mac }}"

    - name: Check or wait for migrations
      community.general.aerospike_migrations:
        connect_timeout: "{{ random_timeout }}"
        consecutive_good_checks: "{{ random_checks }}"
        fail_on_cluster_change: "{{ random_bool }}"
        host: "{{ aerospike_host }}"
        local_only: "{{ random_bool }}"
        migrate_rx_key: "{{ random_key }}"
        migrate_tx_key: "{{ random_key }}"
        min_cluster_size: "{{ random_size }}"
        port: "{{ random_port }}"
        sleep_between_checks: "{{ random_sleep }}"
        target_cluster_size: "{{ random_size }}"
        tries_limit: "{{ random_limit }}"
      register: migration_result

    - debug:
        var: migration_result