---
- name: Manage Sensu client
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Configure Sensu client
      community.general.sensu_client:
        address: "10.1.1.{{ item }}"
        name: "{{ item }}"
        deregister: false
        deregistration:
          some_option: 123
        ec2:
          instance_id: "{{ item }}"
        keepalives: true
        socket: true
        state: present
        redact:
          - password
          - api_key
        registration:
          datacenter: "{{ item }}"
          cluster: "{{ item }}"
        subscriptions:
          - monitoring
          - alerts
          
      loop:
        - ubuntu1
        - alpine1
        - centos1
        - redhat1