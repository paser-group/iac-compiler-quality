---
- name: Configure Lenovo ENOS devices
  hosts: lenovo_devices
  gather_facts: false

  tasks:
    - name: Generate random IP addresses
      set_fact:
        ubuntu_ip: "{{ 1 | random_ip(1, 255) }}"
        alpine_ip: "{{ 2 | random_ip(1, 255) }}"
        centos_ip: "{{ 3 | random_ip(1, 255) }}"
        redhat_ip: "{{ 4 | random_ip(1, 255) }}"

    - name: Configure device
      community.network.enos_config:
        admin: "{{ admin }}"
        after: "{{ after }}"
        auth_pass: "{{ auth_pass }}"
        authorize: "{{ authorize }}"
        backup: "{{ backup }}"
        backup_options: "{{ backup_options }}"
        before: "{{ before }}"
        comment: "{{ comment }}"
        config: "{{ config }}"
        lines: "{{ lines }}"
        match: "{{ match }}"
        parents: "{{ parents }}"
        replace: "{{ replace }}"
        src: "{{ src }}"
      register: result

    - debug:
        var: result