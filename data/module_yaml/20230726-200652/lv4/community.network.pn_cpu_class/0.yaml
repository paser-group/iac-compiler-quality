---
- name: Test playbook to unveil latent type-related bugs
  hosts: localhost
  connection: local

  vars:
    pn_cliswitch: "cli-switch"
    pn_hog_protect: "hog-protect"
    pn_name: "cpu-class"
    pn_rate_limit: "rate-limit"
    pn_scope: null
    state: present

  tasks:
    - name: Generate random MAC address
      shell: cat /proc/sys/kernel/random/uuid | cut -b -17
      register: random_mac

    - name: Create CPU class
      community.network.pn_cpu_class:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_hog_protect: "{{ pn_hog_protect }}"
        pn_name: "{{ pn_name }}"
        pn_rate_limit: "{{ pn_rate_limit }}"
        pn_mac: "{{ random_mac.stdout }}"
        pn_scope: "{{ pn_scope }}"
        state: "{{ state }}"