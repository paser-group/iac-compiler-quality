---

- name: Ansible Latent Bug Finder & Heuristic Test Playbook
  hosts: localhost
  gather_facts: false

  vars:
    account_key: "your-account-key"
    account_secret: "your-account-secret"
    domain: "example.com"
    record_name: "test-record"
    record_type: "A"
    record_value: "1.2.3.4"
    record_ttl: 300
    validate_certs: false

  tasks:
    - name: Create DNS record
      community.general.dnsmadeeasy:
        account_key: "{{ account_key }}"
        account_secret: "{{ account_secret }}"
        state: present
        domain: "{{ domain }}"
        record_name: "{{ record_name }}"
        record_type: "{{ record_type }}"
        record_value: "{{ record_value }}"
        record_ttl: "{{ record_ttl }}"
        validate_certs: "{{ validate_certs }}"
      register: dns_result

    - name: Debug DNS result
      debug:
        var: dns_result

    - name: Generate random MAC addresses for network modules
      community.general.dnsmadeeasy:
        account_key: "{{ account_key }}"
        account_secret: "{{ account_secret }}"
        state: present
        protocol: "http"
        ip1: "{{ random_mac_address }}"
        ip2: "{{ random_mac_address }}"
        ip3: "{{ random_mac_address }}"
        ip4: "{{ random_mac_address }}"
        ip5: "{{ random_mac_address }}"
        validate_certs: "{{ validate_certs }}"
      register: mac_result

    - name: Debug MAC result
      debug:
        var: mac_result

  vars:
    random_mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(ansible_random.randrange(256), ansible_random.randrange(256), ansible_random.randrange(256), ansible_random.randrange(256), ansible_random.randrange(256), ansible_random.randrange(256)) }}"