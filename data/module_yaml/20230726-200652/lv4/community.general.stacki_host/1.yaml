---
- name: Test stacki_host module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        random_mac_address: "{{ '00:00:00:00:00:00' |random_mac}}"

    - name: Add stacki host
      community.general.stacki_host:
        appliance: "stacki.example.com"
        stacki_user: "admin"
        stacki_password: "password"
        state: "present"
        name: "ubuntu1"
        network: "node-net"
        prim_intf: "eth0"
        prim_intf_ip: "10.1.1.1"
        prim_intf_mac: "{{ random_mac_address }}"
        rack: 1
        rank: 1

    - name: Remove stacki host
      community.general.stacki_host:
        appliance: "stacki.example.com"
        stacki_user: "admin"
        stacki_password: "password"
        state: "absent"
        name: "ubuntu1"