- name: Dimension Data VLAN Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create VLAN
      community.general.dimensiondata_vlan:
        mcp_user: "{{ mcp_user }}"
        mcp_password: "{{ mcp_password }}"
        region: "{{ region }}"
        network_domain: "{{ network_domain }}"
        name: "{{ name }}"
        description: "{{ description }}"
        location: "{{ location }}"
        private_ipv4_prefix_size: "{{ private_ipv4_prefix_size }}"
        private_ipv4_base_address: "{{ private_ipv4_base_address }}"
        allow_expand: "{{ allow_expand }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        wait: "{{ wait }}"
        wait_time: "{{ wait_time }}"
        wait_poll_interval: "{{ wait_poll_interval }}"
      register: result

    - name: Show playbook debug output
      debug:
        var: result

# Test case
- name: Dimension Data VLAN Test Playbook
  hosts: localhost
  gather_facts: false
  vars:
    mac_address: "{{ lookup('community.general.random_mac', format='rand') }}"
  tasks:
    - name: Verify VLAN creation with random MAC address
      community.general.dimensiondata_vlan:
        mcp_user: "{{ mcp_user }}"
        mcp_password: "{{ mcp_password }}"
        region: "{{ region }}"
        network_domain: "{{ network_domain }}"
        name: "{{ name }}"
        description: "{{ description }}"
        location: "{{ location }}"
        private_ipv4_prefix_size: "{{ private_ipv4_prefix_size }}"
        private_ipv4_base_address: "{{ private_ipv4_base_address }}"
        allow_expand: "{{ allow_expand }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        wait: "{{ wait }}"
        wait_time: "{{ wait_time }}"
        wait_poll_interval: "{{ wait_poll_interval }}"
        mac_address: "{{ mac_address }}"
        wait_for_result_timeout: 60
      register: result

    - name: Show test case debug output
      debug:
        var: result