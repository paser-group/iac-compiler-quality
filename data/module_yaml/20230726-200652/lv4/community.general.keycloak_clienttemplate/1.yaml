- name: Test playbook for community.general.keycloak_clienttemplate module
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Generate random MAC address
      ansible.builtin.set_fact:
        mac_address: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(0, 0, 0, 0, 0, 0) }}"
    
    - name: Create client template with random values
      community.general.keycloak_clienttemplate:
        name: "{{ 'TestClient' | random }}"
        description: "{{ 'Test Description' | random }}"
        attributes:
          type: "{{ ['attr1', 'attr2'] | random }}"
          value: "{{ ['val1', 'val2'] | random }}"
        auth_client_id: "{{ 'clientID' | random }}"
        auth_client_secret: "{{ 'clientSecret' | random }}"
        auth_keycloak_url: "{{ 'https://keycloak.example.com' | random }}"
        auth_password: "{{ 'password' | random }}"
        auth_realm: "{{ 'realm' | random }}"
        auth_username: "{{ 'username' | random }}"
        connection_timeout: "{{ [5, 10, 15] | random }}"
        full_scope_allowed: "{{ [true, false] | random }}"
        http_agent: "{{ 'CustomUserAgent' | random }}"
        id: "{{ 'clientTemplateID' | random }}"
        protocol: "{{ ['openid-connect', 'saml'] | random }}"
        protocol_mappers:
          - name: "{{ 'mapper1' | random }}"
            protocol: "{{ ['openid-connect', 'saml'] | random }}"
            protocolMapper: "{{ ['oidc-usermodel-attribute-mapper', 'saml-usermodel-attribute-mapper'] | random }}"
            config:
              claim.name: "{{ 'claim1' | random }}"
              jsonType.label: "{{ 'json' | random }}"
              usermodel.clientRoleMapping: "{{ true | random }}"
        realm: "{{ 'realm' | random }}"
        state: "{{ ['present', 'absent'] | random }}"
        token: "{{ 'token' | random }}"
        validate_certs: "{{ [true, false] | random }}"
      register: result

    - name: Show result
      debug:
        var: result

    - name: Show randomly generated MAC address
      debug:
        var: mac_address