---
- name: Deploy software using community.general.bzr module
  hosts: all
  become: true

  tasks:
    - name: Check if bzr command exists
      command: "which bzr"
      changed_when: false
      register: bzr_command_check
    
    - name: Install bzr if not already installed
      package:
        name: bzr
        state: present
      when: bzr_command_check.rc != 0

    - name: Clone the bzr repository
      community.general.bzr:
        repo: "https://example.com/bzr-repo"
        dest: /tmp/bzr-repo
        version: "1.2.3"
      register: bzr_clone

    - name: Check if repository was cloned successfully
      debug:
        msg: "Repository cloned successfully: {{ bzr_clone.cloned }}"