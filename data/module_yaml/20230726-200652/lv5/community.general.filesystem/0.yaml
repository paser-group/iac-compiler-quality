---
- name: Explore Type-Related Bugs in Ansible Compiler
  hosts: all
  gather_facts: false

  tasks:
    - name: Create a filesystem
      community.general.filesystem:
        dev: "{{ item.dev }}"
        fstype: "{{ item.fstype }}"
        opts: "{{ item.opts }}"
        state: "{{ item.state }}"
      loop:
        - { dev: "/dev/sda1", fstype: "ext4", opts: "defaults", state: "present" }
        - { dev: "/dev/sdb1", fstype: "xfs", opts: "", state: "absent" }
        - { dev: "/dev/sdc1", fstype: "ntfs", opts: "ro", state: "mounted" }
        - { dev: "/dev/sdd1", fstype: "vfat", opts: "rw", state: "unmounted" }

    - name: Resize a filesystem
      community.general.filesystem:
        dev: "{{ item.dev }}"
        resizefs: true
      loop:
        - { dev: "/dev/sda1" }
        - { dev: "/dev/sdb1" }
        - { dev: "/dev/sdc1" }
        - { dev: "/dev/sdd1" }

    - name: Remove a filesystem
      community.general.filesystem:
        dev: "{{ item.dev }}"
        force: true
        state: "absent"
      loop:
        - { dev: "/dev/sda1" }
        - { dev: "/dev/sdb1" }
        - { dev: "/dev/sdc1" }
        - { dev: "/dev/sdd1" }