---
- hosts: all
  gather_facts: false
  vars:
    cert_alias: "mycert"
    cert_path: "/path/to/certificate"
    cert_port: "{{ random_port }}"
    executable: "keytool"
    keystore_create: true
    keystore_pass: "password"
    keystore_path: "/path/to/keystore"
    keystore_type: "jks"
    pkcs12_alias: "mycert"
    pkcs12_password: "password"
    pkcs12_path: "/path/to/pkcs12"
    state: "present"
    trust_cacert: true

  tasks:
    - name: Import certificate using keytool
      community.general.java_cert:
        cert_alias: "{{ cert_alias }}"
        cert_path: "{{ cert_path }}"
        cert_port: "{{ cert_port }}"
        executable: "{{ executable }}"
        keystore_create: "{{ keystore_create }}"
        keystore_pass: "{{ keystore_pass }}"
        keystore_path: "{{ keystore_path }}"
        keystore_type: "{{ keystore_type }}"
        pkcs12_alias: "{{ pkcs12_alias }}"
        pkcs12_password: "{{ pkcs12_password }}"
        pkcs12_path: "{{ pkcs12_path }}"
        state: "{{ state }}"
        trust_cacert: "{{ trust_cacert }}"

  pre_tasks:
    - name: Generate random port number
      set_fact:
        random_port: "{{ 10000 | random }}"