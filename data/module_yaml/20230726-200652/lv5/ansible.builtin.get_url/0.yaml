- name: Test get_url module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Download file using get_url module
      ansible.builtin.get_url:
        url: "http://example.com/file.txt"
        dest: "/path/to/save/file.txt"
        backup: false
        checksum: "sha256:6a4e0cd2c80d1e9332165e1ede2043881ada5abee592b858308c2e9f05153119"
        ciphers:
          - "AES128-SHA"
          - "AES256-SHA"
        client_cert: "/path/to/client.crt"
        client_key: "/path/to/client.key"
        decompress: true
        force: false
        force_basic_auth: true
        group: "ansible"
        headers:
          Authorization: "Basic YWRtaW46YWRtaW4="
          X-Custom-Header: "CustomValue"
        http_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
        mode: "0777"
        owner: "ansible"
        selevel: "s0"
        serole: "object_r"
        setype: "httpd_sys_content_t"
        seuser: "system_u"
        timeout: 30
        tmp_dest: "/tmp"
        unredirected_headers:
          - "X-My-Custom-Header"
          - "X-Another-Custom-Header"
        unsafe_writes: false
        url_password: "password"
        url_username: "username"
        use_gssapi: true
        use_netrc: true
        use_proxy: true
        validate_certs: true
        # Random port numbers to test port settings
        url: "http://example.com:{{ 10000 | random }}"

      register: result

    - name: Debug output
      debug:
        var: result