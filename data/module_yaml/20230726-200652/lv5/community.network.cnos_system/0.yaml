---
- name: Test playbook for community.network.cnos_system module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure system attributes
      community.network.cnos_system:
        domain_name: "{{ item.domain_name }}"
        domain_search: "{{ item.domain_search }}"
        hostname: "{{ item.hostname }}"
        lookup_enabled: "{{ item.lookup_enabled }}"
        lookup_source: "{{ item.lookup_source }}"
        name_servers: "{{ item.name_servers }}"
        state: "{{ item.state }}"
      loop:
        - { domain_name: null, domain_search: null, hostname: null, lookup_enabled: true, lookup_source: null, name_servers: null, state: null }
      register: cnos_sys_config
      # Random port test case #
      vars:
        port_num: "{{ 1024 + (ansible_play_hosts.index(inventory_hostname) | random | int) }}"
        item:
          domain_name: null
          domain_search: null
          hostname: null
          lookup_enabled: true
          lookup_source: null
          name_servers: null
          state: null
          port: "{{ port_num }}"
    - debug:
        var: cnos_sys_config