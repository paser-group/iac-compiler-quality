---
- name: Gather Facts
  hosts: all
  gather_facts: false

  tasks:
  - name: Set up fact gathering
    setup:
      fact_path: "/tmp/ansible_facts"
      filter: "ansible_distribution, ansible_fqdn"
      gather_subset: ['network']
      gather_timeout: 30

  - name: Produce random port numbers to test port settings
    script:
      /path/to/random_port_generator.sh

  - name: Show gathered facts
    debug:
      msg: "Ansible Distribution: {{ ansible_distribution }} | FQDN: {{ ansible_fqdn }} | Random Port: {{ random_port }}"