- name: Test rax_cdb module for latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Rackspace Cloud Database instance
      community.general.rax_cdb:
        api_key: "{{ lookup('env', 'RACKSPACE_API_KEY') }}"
        auth_endpoint: "{{ lookup('env', 'RACKSPACE_AUTH_ENDPOINT') }}"
        cdb_type: "{{ lookup('env', 'RACKSPACE_CDB_TYPE') }}"
        cdb_version: "{{ lookup('env', 'RACKSPACE_CDB_VERSION') }}"
        credentials: "{{ lookup('env', 'RACKSPACE_CREDENTIALS_FILE') }}"
        env: "{{ lookup('env', 'RACKSPACE_ENV') }}"
        flavor: "{{ lookup('env', 'RACKSPACE_FLAVOR') }}"
        identity_type: "{{ lookup('env', 'RACKSPACE_IDENTITY_TYPE') }}"
        name: "{{ lookup('env', 'RACKSPACE_INSTANCE_NAME') }}"
        region: "{{ lookup('env', 'RACKSPACE_REGION') }}"
        state: "{{ lookup('env', 'RACKSPACE_STATE') }}"
        tenant_id: "{{ lookup('env', 'RACKSPACE_TENANT_ID') }}"
        tenant_name: "{{ lookup('env', 'RACKSPACE_TENANT_NAME') }}"
        username: "{{ lookup('env', 'RACKSPACE_USERNAME') }}"
        validate_certs: "{{ lookup('env', 'RACKSPACE_VALIDATE_CERTS') }}"
        volume: "{{ lookup('env', 'RACKSPACE_VOLUME') }}"
        wait: "{{ lookup('env', 'RACKSPACE_WAIT') }}"
        wait_timeout: "{{ lookup('env', 'RACKSPACE_WAIT_TIMEOUT') }}"
      register: result

    - name: Debug module output
      debug:
        var: result