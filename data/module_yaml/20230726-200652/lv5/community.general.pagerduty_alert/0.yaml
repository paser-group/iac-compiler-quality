---
- name: Test playbook for community.general.pagerduty_alert
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Trigger PagerDuty alert
      community.general.pagerduty_alert:
        integration_key: "XXXXXXXXXXXXXXXXX"
        incident_key: "test_incident"
        service_id: "XXXXXXXXXXXXXXXXX"
        state: triggered
      register: result
      ignore_errors: true

    - name: Print result
      debug:
        var: result

    - name: Acknowledge PagerDuty alert
      community.general.pagerduty_alert:
        integration_key: "XXXXXXXXXXXXXXXXX"
        incident_key: "test_incident"
        service_id: "XXXXXXXXXXXXXXXXX"
        state: acknowledged
      register: result
      ignore_errors: true

    - name: Print result
      debug:
        var: result

    - name: Resolve PagerDuty alert
      community.general.pagerduty_alert:
        integration_key: "XXXXXXXXXXXXXXXXX"
        incident_key: "test_incident"
        service_id: "XXXXXXXXXXXXXXXXX"
        state: resolved
      register: result
      ignore_errors: true

    - name: Print result
      debug:
        var: result