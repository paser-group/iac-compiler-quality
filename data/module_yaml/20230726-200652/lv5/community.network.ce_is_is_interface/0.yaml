---
- name: Manage ISIS interface configuration
  hosts: huawei_devices
  gather_facts: false

  tasks:
    - name: Configure ISIS interface
      community.network.ce_is_is_interface:
        state: "{{ item.state }}"
        ifname: "{{ item.ifname }}"
        instance_id: "{{ item.instance_id }}"
        level1cost: "{{ item.level1cost }}"
        level2cost: "{{ item.level2cost }}"
        leveltype: "{{ item.leveltype }}"
        p2pnegotiationmode: "{{ item.p2pnegotiationmode }}"
        p2ppeeripignore: "{{ item.p2ppeeripignore }}"
        typep2penable: "{{ item.typep2penable }}"
        bfdstaticen: "{{ item.bfdstaticen }}"
        bfdstaticip: "10.1.1.1"  # Example IP address, please replace with actual IP if required
        bfdstaticpeerip: "10.1.1.2"  # Example IP address, please replace with actual IP if required
      loop:
        - { state: present, ifname: "GigabitEthernet1/0/1", instance_id: 1, level1cost: 10, level2cost: 20, leveltype: "level-2", p2pnegotiationmode: "ipv4", p2ppeeripignore: false, typep2penable: true, bfdstaticen: true }
        - { state: present, ifname: "GigabitEthernet1/0/2", instance_id: 2, level1cost: 5, level2cost: 15, leveltype: "level-1", p2pnegotiationmode: "ipv6", p2ppeeripignore: true, typep2penable: false, bfdstaticen: false }
        - { state: absent, ifname: "GigabitEthernet1/0/3", instance_id: 1, level1cost: 15, level2cost: 25, leveltype: "level-1-2", p2pnegotiationmode: "dual-stack", p2ppeeripignore: false, typep2penable: false, bfdstaticen: false }

    - name: Debug ISIS interface configuration
      debug:
        msg: "Interface {{ item.ifname }} configured"
      loop: "{{ loop_data }}"

  vars:
    loop_data:
      - { ifname: "GigabitEthernet1/0/1" }
      - { ifname: "GigabitEthernet1/0/2" }
      - { ifname: "GigabitEthernet1/0/3" }