---
- name: Test playbook for 'community.network.avi_vrfcontext' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create VRF Context
      community.network.avi_vrfcontext:
        controller: "192.168.1.1"
        username: "admin"
        password: "password"
        tenant: "default"
        name: "{{ item.name }}"
        tenant_uuid: "{{ item.tenant_uuid }}"
        description: "{{ item.description }}"
        system_default: "{{ item.system_default }}"
        api_context:
          api_version: "{{ item.api_context.api_version }}"
        avi_credentials:
          username: "{{ item.avi_credentials.username }}"
          password: "{{ item.avi_credentials.password }}"
        bgp_profile:
          asn: "{{ item.bgp_profile.asn }}"
          vrf_asn: "{{ item.bgp_profile.vrf_asn }}"
          enabled: "{{ item.bgp_profile.enabled }}"
          export:
            - {"network": "10.0.0.0/24"}
          import:
            - {"network": "10.0.0.0/24"}
        state: present
      loop:
        - name: Test VRF Context 1
          tenant_uuid: "test-tenant-1"
          description: "Test VRF Context 1"
          system_default: false
          api_context:
            api_version: "20.1.1"
          avi_credentials:
            username: "test-user-1"
            password: "test-password-1"
          bgp_profile:
            asn: 65001
            vrf_asn: 65002
            enabled: true
        - name: Test VRF Context 2
          tenant_uuid: "test-tenant-2"
          description: "Test VRF Context 2"
          system_default: true
          api_context:
            api_version: "20.2.1"
          avi_credentials:
            username: "test-user-2"
            password: "test-password-2"
          bgp_profile:
            asn: 65003
            vrf_asn: 65004
            enabled: false

    # Add more test cases here based on the heuristic of testing port settings
    - name: Test Case - Configure Port Settings
      community.network.avi_vrfcontext:
        controller: "192.168.1.1"
        username: "admin"
        password: "password"
        tenant: "default"
        name: "Test VRF Context"
        tenant_uuid: "test-tenant"
        description: "Test VRF Context"
        system_default: false
        api_context:
          api_version: "20.1.1"
        avi_credentials:
          username: "test-user"
          password: "test-password"
        bgp_profile:
          asn: 65001
          vrf_asn: 65002
          enabled: true
          export:
            - {"network": "10.0.0.0/24"}
          import:
            - {"network": "10.0.0.0/24"}
        state: present
        port: "{{ 4000 | random(start=1024) }}"
  
  # Add more tasks and test cases here if needed