---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  vars:
    api_key: "<api_key>"
    attachments:
      - fallback: "Attachment 1"
        color: "good"
        title: "Attachment Title 1"
        text: "Attachment Text 1"
    channel: "#general"
    icon_url: "https://example.com/icon.png"
    text: "This is a test message"
    url: "https://example.com"
    username: "Test User"
    validate_certs: true

  tasks:
    - name: Send Mattermost Message
      community.general.mattermost:
        url: "{{ url }}"
        api_key: "{{ api_key }}"
        channel: "{{ channel }}"
        attachments: "{{ attachments }}"
        icon_url: "{{ icon_url }}"
        text: "{{ text }}"
        username: "{{ username }}"
        validate_certs: "{{ validate_certs }}"