- name: Test playbook for lineinfile module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Insert a line with random port number
      ansible.builtin.lineinfile:
        path: /path/to/file
        line: "Port number: {{ port }}"
      vars:
        port: "{{ 30000 | random }}"
      register: result
      ignore_errors: true

    - name: Debug the result
      debug:
        var: result