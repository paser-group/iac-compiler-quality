---
- name: Test playbook for rax_scaling_group module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Rackspace Cloud Server
      community.general.rax_scaling_group:
        api_key: <API_KEY>
        auth_endpoint: <AUTH_ENDPOINT>
        config_drive: True
        cooldown: 600
        credentials: /root/.raxrc
        disk_config: AUTO
        env: /var/tmp/environment.sh
        files:
          - /etc/myapp.conf
          - /etc/mydb.db
        flavor: performance1-8
        image: CentOS 7 (PVHVM)
        key_name: mykey
        loadbalancers:
          - mylb
        max_entities: 5
        meta:
          my_meta_key: my_meta_value
        min_entities: 2
        name: myservergroup
        networks:
          - mynetwork1
          - mynetwork2
        region: IAD
        server_name: myserver
        state: present
        tenant_id: abc123
        tenant_name: mytenant
        user_data: "#cloud-config\n\nruncmd:\n  - echo 'Hello, World!'"
        username: myuser
        validate_certs: True
        wait: True
        wait_timeout: 900
      register: result

    - name: Show result
      debug:
        var: result

    # Test cases for random port numbers
    - name: Test random ports
      vars:
        port1: "{{ range(1024, 65535) | random }}"
        port2: "{{ range(1024, 65535) | random }}"
      debug:
        msg: "Random ports: {{ port1 }}, {{ port2 }}"