---
- name: Test playbook for community.network.pn_snmp_vacm module
  hosts: localhost
  gather_facts: false

  tasks:

    - name: Generate random port number
      set_fact:
        random_port: "{{ 3000 | random }}"
  
    - name: Create SNMP VACM entry with random port number
      community.network.pn_snmp_vacm:
        pn_auth: true
        pn_cliswitch: "{{ random_port }}"
        pn_oid_restrict: "1.3.6.1.2.1.1.1"
        pn_priv: false
        pn_user_name: "testuser"
        pn_user_type: "noAuthNoPriv"
        state: present
      register: result

    - name: Display result
      debug:
        var: result