---
- name: Execute low-level commands on nodes
  hosts: all
  gather_facts: false
  tasks:
    - name: Set random port number
      set_fact:
        random_port: "{{ 5000 | random(60000) }}"

    - name: Run raw command
      ansible.builtin.raw:
        executable: "/bin/bash"
        free_form: "echo 'Test command' > /dev/tcp/localhost/{{ random_port }}"
      register: raw_output
      ignore_errors: true

    - name: Debug raw output
      ansible.builtin.debug:
        var: raw_output