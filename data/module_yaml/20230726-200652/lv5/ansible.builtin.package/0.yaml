---
- name: Install packages on Docker nodes
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Install packages
      ansible.builtin.package:
        name: "{{ package_name }}"
        state: "{{ package_state }}"
        use: "{{ package_use }}"
      register: package_result
      ignore_errors: true

    - name: Debug package installation
      debug:
        var: package_result

- name: Test port settings
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate random port
      shell: python -c 'import random; print(random.randint(1024, 65535))'
      register: random_port
      changed_when: false

    - name: Print random port
      debug:
        var: random_port.stdout