---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random port numbers
      set_fact:
        random_port1: "{{ 10000 | random }}"
        random_port2: "{{ 10000 | random }}"

    - name: Configure Controller Properties
      community.network.avi_controllerproperties:
        controller: "10.1.1.1"
        username: "admin"
        password: "secret"
        tenant: "default"
        allow_ip_forwarding: true
        allow_unauthenticated_apis: false
        allow_unauthenticated_nodes: false
        api_idle_timeout: null
        api_perf_logging_threshold: null
        api_version: "2.2"
        appviewx_compat_mode: false
        attach_ip_retry_interval: null
        attach_ip_retry_limit: null
        avi_api_patch_op: null
        avi_api_update_method: null
        avi_credentials:
          username: "avi_admin"
          password: "avi_secret"
        avi_disable_session_cache_as_fact: false
        bm_use_ansible: true
        cleanup_expired_authtoken_timeout_period: null
        cleanup_sessions_timeout_period: null
        cloud_reconcile: false
        cluster_ip_gratuitous_arp_period: null
        consistency_check_timeout_period: null
        controller: "controller"
        crashed_se_reboot: null
        dead_se_detection_timer: null
        dns_refresh_period: null
        dummy: null
        enable_api_sharding: true
        enable_memory_balancer: false
        fatal_error_lease_time: null
        max_dead_se_in_grp: null
        max_pcap_per_tenant: null
        max_seq_attach_ip_failures: null
        max_seq_vnic_failures: null
        password: "avi_password"
        persistence_key_rotate_period: null
        portal_token: null
        process_locked_useraccounts_timeout_period: null
        process_pki_profile_timeout_period: null
        query_host_fail: null
        safenet_hsm_version: null
        se_create_timeout: null
        se_failover_attempt_interval: null
        se_from_marketplace: null
        se_offline_del: null
        se_vnic_cooldown: null
        secure_channel_cleanup_timeout: null
        secure_channel_controller_token_timeout: null
        secure_channel_se_token_timeout: null
        seupgrade_fabric_pool_size: null
        seupgrade_segroup_min_dead_timeout: null
        ssl_certificate_expiry_warning_days: null
        state: null
        tenant_uuid: "default"
        unresponsive_se_reboot: null
        upgrade_dns_ttl: null
        upgrade_lease_time: null
        url: null
        username: "avi_admin"
        uuid: null
        vnic_op_fail_time: null
        vs_apic_scaleout_timeout: null
        vs_awaiting_se_timeout: null
        vs_key_rotate_period: null
        vs_scaleout_ready_check_interval: null
        vs_se_attach_ip_fail: null
        vs_se_bootup_fail: null
        vs_se_create_fail: null
        vs_se_ping_fail: null
        vs_se_vnic_fail: null
        vs_se_vnic_ip_fail: null
        warmstart_se_reconnect_wait_time: null
        warmstart_vs_resync_wait_time: null
        registries:
          - port: "{{ random_port1 }}"
            description: registry1
          - port: "{{ random_port2 }}"
            description: registry2"