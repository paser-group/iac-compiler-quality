---
- name: Test OCI VCN module for latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
  - name: Test with random port numbers
    command: echo {{ lookup('pipe', 'python -c "import random; print(random.randint(100, 65535))"') }}
    register: random_port

  - name: Execute faulty task with random port
    command: >
      ansible localhost -m ping
      -e "port={{ random_port.stdout }}"
    register: result

  - debug:
      var: result