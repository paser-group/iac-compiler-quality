---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Create security group rule with random port numbers
      community.general.hwc_vpc_security_group_rule:
        description: "Test security group rule"
        direction: "ingress"
        domain: "default"
        ethertype: "IPv4"
        id: "rule1"
        identity_endpoint: "identity.example.com"
        password: "password"
        port_range_max: "{{ 1024 | random }}"
        port_range_min: "{{ 22 if port_range_max > 22 else 0 }}"
        project: "my_project"
        protocol: "tcp"
        region: "us-east-1"
        remote_group_id: "remote_group_id"
        remote_ip_prefix: "0.0.0.0/0"
        security_group_id: "security_group_id"
        state: "present"
        user: "my_user"

      register: result

    - name: Debug module output
      debug:
        var: result