---
- name: Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure PAMD module
      community.general.pamd:
        name: "test"
        state: "present"
        type: "{{ lookup('env', 'MODULE_TYPE') | default(omit) }}"
        control: "{{ lookup('env', 'MODULE_CONTROL') }}"
        module_path: "/usr/lib64/security"
        module_arguments: "{{ lookup('env', 'MODULE_ARGUMENTS') }}"
        path: "/etc/pam.d/test"

      register: pam_result
      ignore_errors: true

    - name: Display PAMD module output
      debug:
        var: pam_result