---
- name: Test netscaler_service module
  hosts: localhost
  gather_facts: false
  tasks:
    # Test Case 1: Trigger a latent bug by passing incorrect port types
    - name: Test case 1 - Incorrect port types
      community.network.netscaler_service:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        state: present
        name: "service1"
        port: "abcd"
      register: result
      ignore_errors: true

    # Test Case 2: Random port numbers to test port settings
    - name: Test case 2 - Random port numbers
      community.network.netscaler_service:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        state: present
        name: "service2"
        port: "{{ 9000 + (ansible_random | random) % 100 }}"
      register: result

    # Test Case 3: Disable a service
    - name: Test case 3 - Disable a service
      community.network.netscaler_service:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        state: present
        name: "service3"
        disabled: yes
      register: result

    # Test Case 4: Enable a service
    - name: Test case 4 - Enable a service
      community.network.netscaler_service:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        state: present
        name: "service3"
        disabled: no
      register: result