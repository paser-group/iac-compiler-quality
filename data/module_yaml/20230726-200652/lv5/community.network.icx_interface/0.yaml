---
- name: Test ICX Interface Module
  hosts: localhost
  gather_facts: false

  vars:
    interface_name: eth1
    random_port_number: "{{ 65536 | random }}"
  
  tasks:
    - name: Configure Interface
      community.network.icx_interface:
        name: "{{ interface_name }}"
        description: "Test Interface"
        state: present
        enabled: true
        check_running_config: true
        delay: 10
        neighbors:
          - 10.1.1.1
          - 10.1.1.2
        power:
          speed: "auto"
          tx_rate: "1Gb"
          rx_rate: "2Gb"
        aggregate:
          - "{{ random_port_number }}"
      register: interface_config

    - name: Debug Interface Configuration
      debug:
        var: interface_config