- name: Configure MDN on HUAWEI devices
  hosts: huawei_devices
  gather_facts: false

  vars:
    ifname: "{{ random_ifname }}"
    lldpenable: "{{ random_lldpenable }}"
    mdnstatus: "{{ random_mdnstatus }}"
    state: "{{ random_state }}"

  tasks:
    - name: Configure MDN
      community.network.ce_mdn_interface:
        provider: "{{ cli }}"
        ifname: "{{ ifname }}"
        lldpenable: "{{ lldpenable }}"
        mdnstatus: "{{ mdnstatus }}"
        state: "{{ state }}"
      register: result
      until: result.rc == 0
      retries: 3
      delay: 5

  - name: Print debug information
    debug:
      var: result