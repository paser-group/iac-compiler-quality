---
- name: Test playbook for the community.general.utm_aaa_group module
  hosts: localhost
  gather_facts: false
  vars:
    aaa_group_name: "test_group"
    aaa_group_state: "present"
    utm_host: "your_utm_host"
    utm_port: 443
    utm_protocol: "https"
    utm_token: "your_utm_token"
    validate_certs: false

  tasks:
    - name: Create AAA group
      community.general.utm_aaa_group:
        name: "{{ aaa_group_name }}"
        state: "{{ aaa_group_state }}"
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: result
      when: aaa_group_state == "present"

    - name: Debug AAA group creation
      debug:
        var: result
      when: aaa_group_state == "present"

    - name: Update AAA group comment
      community.general.utm_aaa_group:
        name: "{{ aaa_group_name }}"
        comment: "Updated Comment"
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: result
      when: aaa_group_state == "present"

    - name: Debug AAA group update
      debug:
        var: result
      when: aaa_group_state == "present"

    - name: Delete AAA group
      community.general.utm_aaa_group:
        name: "{{ aaa_group_name }}"
        state: "absent"
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: result
      when: aaa_group_state == "absent"

    - name: Debug AAA group deletion
      debug:
        var: result
      when: aaa_group_state == "absent"