---
- name: Set Hostname
  hosts: all
  gather_facts: false

  tasks:
    - name: Set hostname
      hostname:
        name: "{{ inventory_hostname }}"
      register: result

    - name: Print result
      debug:
        msg: "Hostname on {{ inventory_hostname }} set to {{ result.stdout }}"

- name: Generate Random Port Number
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random port
      set_fact:
        random_port: "{{ 5000 + (ansible_play_hosts_all.index(inventory_hostname) * 100) }}"

    - name: Print random port
      debug:
        msg: "Random Port for {{ inventory_hostname }}: {{ random_port }}"