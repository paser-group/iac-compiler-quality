---
- name: Test airbrake_deployment module
  hosts: localhost
  gather_facts: false

  vars:
    random_port: "{{ 3000 | random(start=1) }}"
    random_bool: "{{ ['true', 'false'] | random }}"

  tasks:
    - name: Install necessary collections
      ansible.builtin.community.general_collection:
        version: latest

    - name: Import airbrake_deployment module
      ansible.builtin.import_role:
        name: community.general.airbrake_deployment

    - name: Test airbrake_deployment module
      community.general.airbrake_deployment:
        environment: "{{ random_port }}"
        project_id: "{{ random_port }}"
        project_key: "{{ random_port }}"
        repo: "{{ random_port }}"
        revision: "{{ random_port }}"
        url: "{{ random_port }}"
        user: "{{ random_port }}"
        validate_certs: "{{ random_bool }}"
        version: "{{ random_port }}"
      register: result

    - name: Display airbrake_deployment module result
      debug:
        var: result