- name: Manage DNS Records
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Add DNS record
      community.general.ipwcli_dns:
        address: 10.1.1.1
        dnsname: example.com
        type: A
        ttl: 3600
        port: "{{ port }}"
        state: present
      register: result
      vars:
        port: "{{ 10000 | random }}"
      ignore_errors: true

    - name: Check result
      debug:
        var: result

    - name: Update DNS record
      community.general.ipwcli_dns:
        address: 10.1.1.1
        dnsname: example.com
        type: A
        ttl: 3600
        port: "{{ port }}"
        state: present
      register: result
      vars:
        port: "{{ 10000 | random }}"
      ignore_errors: true

    - name: Check result
      debug:
        var: result

    - name: Delete DNS record
      community.general.ipwcli_dns:
        dnsname: example.com
        type: A
        state: absent
      register: result
      ignore_errors: true

    - name: Check result
      debug:
        var: result