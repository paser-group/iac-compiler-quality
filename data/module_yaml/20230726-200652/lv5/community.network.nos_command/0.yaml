---
- name: Test Playbook
  hosts: all
  gather_facts: false

  tasks:
    - name: Run command on remote devices
      community.network.nos_command:
        command: "{{ item }}"
        interval: "{{ random_port }}"
        match: "{{ random_port }}"
        retries: "{{ random_port }}"
        wait_for: "{{ random_port }}"
      loop:
        - "show version"
        - "show interfaces"
        - "show ip route"

  vars:
    port_range_start: 10000
    port_range_end: 60000
    random_port: "{{ port_range_start + ((port_range_end - port_range_start + 1) | random) }}"