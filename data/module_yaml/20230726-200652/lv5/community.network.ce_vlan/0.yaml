---
- name: Test Ansible latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure VLANs on Huawei switch
      community.network.ce_vlan:
        provider:
          host: "{{ inventory_hostname }}"
          username: admin
          password: password
        vlan_id: "{{ vlan_id }}"
        vlan_range: "{{ vlan_range }}"
        state: present
        description: "{{ vlan_description }}"
        name: "{{ vlan_name }}"
        port: "{{ vlan_ports }}"
      loop: "{{ vlan_data }}"
      register: result

  vars:
    vlan_data:
      - vlan_id: 100
        vlan_range: 101-150
        vlan_description: "Test VLAN 1"
        vlan_name: "TestVlan1"
        vlan_ports: "{{ vlan_ports }}"
      
    vlan_ports: "{{ vlan_ports }}"
  
    # Generate random port numbers
    vlan_ports:
      - "{{ 1022 | random }}"
      - "{{ 2044 | random }}"
      - "{{ 3066 | random }}"