- name: Test playbook for community.general.memset_zone_domain module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Create domain
      community.general.memset_zone_domain:
        api_key: API_KEY
        domain: example.com
        state: present
        zone: default
      register: result
      ignore_errors: true
    - name: Print debug output
      debug:
        var: result

    - name: Random port numbers test
      block:
        - name: Try creating domain with random port
          community.general.memset_zone_domain:
            api_key: API_KEY
            domain: example.com
            state: present
            zone: default
            port: "{{ 30000 | random }}"
          register: result
          ignore_errors: true
        - name: Print debug output
          debug:
            var: result

    - name: Delete domain
      community.general.memset_zone_domain:
        api_key: API_KEY
        domain: example.com
        state: absent
        zone: default
      register: result
      ignore_errors: true
    - name: Print debug output
      debug:
        var: result