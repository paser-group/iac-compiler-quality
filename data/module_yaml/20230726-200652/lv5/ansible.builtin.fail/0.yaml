---
- name: Test ansible.builtin.fail module with random port settings
  hosts: all
  gather_facts: false
  become: true

  tasks:
    - name: Generate random port number
      set_fact:
        random_port: "{{ (range(10000, 65535 + 1) | random) | string }}"

    - name: Fail with random port number
      ansible.builtin.fail:
        msg: "Random port setting failed"
        port: "{{ random_port }}"
      ignore_errors: true