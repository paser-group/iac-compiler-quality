---
- name: Test playbook to uncover latent type-related bugs
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include role with different attributes
      include_role:
        name: "myrole"
        defaults_from: "defaults.yaml"
        handlers_from: "handlers.yaml"
        tasks_from: "main.yaml"
        vars_from: "vars.yaml"
        allow_duplicates: false
        apply: null
        public: true
        rolespec_validate: true

    - name: Test port settings
      vars:
        random_port: "{{ 49152 + ((inventory_hostname | ipaddr) | ipmath('int') % 16384) }}" # Generate random port number
      debug:
        msg: "Random port number for {{ inventory_hostname }}: {{ random_port }}"