---
- name: Test playbook for community.general.oneview_fcoe_network_info module
  hosts: localhost
  gather_facts: false

  vars:
    api_version: 1200
    config: "/path/to/oneview_config.json"
    hostname: "oneview.example.com"
    image_streamer_hostname: "imagestreamer.example.com"
    name: "Test Network"
    params:
      query: "name EQ 'Test Network'"
    password: "password123"
    username: "admin"

  tasks:
    - name: Install necessary modules
      pip:
        name:
          - hpeOneView
        state: present

    - name: Retrieve FCoE network info
      oneview_fcoe_network_info:
        api_version: "{{ api_version }}"
        config: "{{ config }}"
        hostname: "{{ hostname }}"
        image_streamer_hostname: "{{ image_streamer_hostname }}"
        name: "{{ name }}"
        params: "{{ params }}"
        password: "{{ password }}"
        username: "{{ username }}"
      register: result

    - name: Print FCoE network info
      debug:
        var: result

    - name: Generate random port numbers
      set_fact:
        random_port: "{{ (10000 + random(10000)) | int }}" 

    - name: Test port settings
      oneview_fcoe_network_info:
        api_version: "{{ api_version }}"
        config: "{{ config }}"
        hostname: "{{ hostname }}"
        image_streamer_hostname: "{{ image_streamer_hostname }}"
        name: "{{ name }}"
        params: "{{ params }}"
        password: "{{ password }}"
        username: "{{ username }}"
        port: "{{ random_port }}"
      ignore_errors: true
      register: test_result

    - name: Print test result
      debug:
        var: test_result