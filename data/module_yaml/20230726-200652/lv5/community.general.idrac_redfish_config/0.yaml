---
- name: Test Ansible module for latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random port for testing port settings
      set_fact:
        random_port: "{{ 30000 + (ansible_play_hosts.index(inventory_hostname) * 100) | random(90) }}"

    - name: Configure iDRAC server using redfish config module
      community.general.idrac_redfish_config:
        baseuri: "https://{{ inventory_hostname }}"
        auth_token: "your_auth_token"
        category: "your_category"
        command: "{{ ['your_command'] }}"
        manager_attributes:
          attribute1: "value1"
          attribute2: "value2"
        password: "your_password"
        resource_id: "your_resource_id"
        timeout: "your_timeout"
        username: "your_username"
        port: "{{ random_port }}"

      register: result

    - name: Print result
      debug:
        var: result