- name: Configure OSPF VPN instance
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure OSPF VPN instance with random port number
      community.network.ce_ospf_vrf:
        vrf: "{{ item.vrf }}"
        route_id: "{{ item.route_id }}"
        state: "{{ item.state }}"
        ospf: "{{ item.ospf }}"
        description: "{{ item.description }}"
        bandwidth: "{{ item.bandwidth }}"
        lsaaholdinterval: "{{ item.lsaaholdinterval }}"
        lsaainterval: "{{ item.lsaainterval }}"
        lsaalflag: "{{ item.lsaalflag }}"
        lsaamaxinterval: "{{ item.lsaamaxinterval }}"
        lsaastartinterval: "{{ item.lsaastartinterval }}"
        lsaoholdinterval: "{{ item.lsaoholdinterval }}"
        lsaointerval: "{{ item.lsaointerval }}"
        lsaointervalflag: "{{ item.lsaointervalflag }}"
        lsaomaxinterval: "{{ item.lsaomaxinterval }}"
        lsaostartinterval: "{{ item.lsaostartinterval }}"
        spfholdinterval: "{{ item.spfholdinterval }}"
        spfinterval: "{{ item.spfinterval }}"
        spfintervalmi: "{{ item.spfintervalmi }}"
        spfintervaltype: "{{ item.spfintervaltype }}"
        spfmaxinterval: "{{ item.spfmaxinterval }}"
        spfstartinterval: "{{ item.spfstartinterval }}"
      with_items:
        - { vrf: "VRF1", route_id: 1, state: "present", ospf: "1" }
        - { vrf: "VRF2", route_id: 2, state: "absent", ospf: "2" }
        - { vrf: "VRF3", route_id: 3, state: "present", ospf: "3" }
      register: result

    - name: Debug OSPF VPN instance configuration
      debug:
        var: result