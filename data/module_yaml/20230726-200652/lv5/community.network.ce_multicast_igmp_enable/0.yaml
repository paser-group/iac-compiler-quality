---
- name: Test playbook to uncover type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    aftype: "{{ random.choice([ipv4, ipv6]) }}"
    features: "{{ random.choice([enable, disable]) }}"
    igmp: "{{ random.choice([True, False]) }}"
    proxy: "{{ random.choice([True, False]) }}"
    state: "{{ random.choice([present, absent]) }}"
    version: "{{ random.randint(1, 99) }}"
    vlan_id: "{{ random.randint(1, 4094) }}"

  tasks:
    - name: Debug variable values
      debug:
        var:
          aftype: "{{ aftype }}"
          features: "{{ features }}"
          igmp: "{{ igmp }}"
          proxy: "{{ proxy }}"
          state: "{{ state }}"
          version: "{{ version }}"
          vlan_id: "{{ vlan_id }}"

    - name: Trigger the latent bug
      community.network.ce_multicast_igmp_enable:
        aftype: "{{ aftype }}"
        features: "{{ features }}"
        igmp: "{{ igmp }}"
        proxy: "{{ proxy }}"
        state: "{{ state }}"
        version: "{{ version }}"
        vlan_id: "{{ vlan_id }}"