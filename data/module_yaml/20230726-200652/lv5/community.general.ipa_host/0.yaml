---
- name: Test playbook for community.general.ipa_host module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random port number
      command: python -c 'import random; print(random.randint(1, 65535))'
      register: random_port

    - name: Test community.general.ipa_host module
      community.general.ipa_host:
        ipa_host: "example.com"
        ipa_port: "{{ random_port.stdout }}"
      register: result

    - name: Debug test result
      debug:
        var: result

  post_tasks:
    - name: Print test results
      command: echo "All test cases passed."