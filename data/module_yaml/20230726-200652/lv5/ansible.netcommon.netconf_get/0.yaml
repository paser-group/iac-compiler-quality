---
- name: Fetch configuration/state data from NETCONF endpoint
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Fetch NETCONF data
      ansible.netcommon.netconf_get:
        display: "{{ display }}"
        filter: "{{ filter | default('') }}"
        lock: "{{ lock | default('') }}"
        source: "{{ source | default('running') }}"
      register: netconf_data

    - name: Debug NETCONF data
      debug:
        var: netconf_data

- name: Test Cases for Ansible NETCONF module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Test display option with a string value
      ansible.netcommon.netconf_get:
        display: "config"
      register: netconf_data_display_string

    - name: Debug display string output
      debug:
        var: netconf_data_display_string

    - name: Test filter option with a raw value
      ansible.netcommon.netconf_get:
        filter: |
          <config></config>
      register: netconf_data_filter_raw

    - name: Debug filter raw output
      debug:
        var: netconf_data_filter_raw

    - name: Test lock option with a string value
      ansible.netcommon.netconf_get:
        lock: "write"
      register: netconf_data_lock_string

    - name: Debug lock string output
      debug:
        var: netconf_data_lock_string

    - name: Test source option with a string value
      ansible.netcommon.netconf_get:
        source: "startup"
      register: netconf_data_source_string

    - name: Debug source string output
      debug:
        var: netconf_data_source_string

    - name: Test port setting with random port number
      ansible.netcommon.netconf_get:
        display: "{{ display }}"
        filter: "{{ filter | default('') }}"
        lock: "{{ lock | default('') }}"
        source: "{{ source | default('running') }}"
        port: "{{ port }}"
      register: netconf_data_random_port

    - name: Debug NETCONF data with random port
      debug:
        var: netconf_data_random_port