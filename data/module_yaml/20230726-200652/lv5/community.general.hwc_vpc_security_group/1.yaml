- name: Test hwc_vpc_security_group module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create VPC Security Group
      community.general.hwc_vpc_security_group:
        domain: "my_domain"
        enterprise_project_id: "1234"
        id: "sg-1234"
        identity_endpoint: "https://identity.example.com"
        name: "my_security_group"
        password: "mypassword"
        project: "my_project"
        region: "us-west-2"
        state: "present"
        user: "myuser"
        vpc_id: "vpc-1234"
        rules:
          - port: "{{ 8000 + (inventory_hostname | regex_replace('[^0-9]+', '') | int) }}"
            protocol: "tcp"
            action: "allow"
      register: result

    - name: Debug module output
      debug:
        var: result