---
- name: Test Playbook
  hosts: localhost
  gather_facts: false

  vars:
    api_url: "https://api_url"
    auth_token: "your_auth_token"
    monitoring_policy:
      name: "Test Monitoring Policy"
      description: "Test Monitoring Policy Description"
      add_ports:
        - 80
        - "8080"
        - "invalid_port"  # Potential bug: passing an invalid port value
      remove_ports: []
      update_ports: []
      add_processes: []
      remove_processes: []
      update_processes: []
      add_servers: []
      remove_servers: []
      update_servers: []
      email: "test@example.com"
      thresholds: []
      agent: ""
      ports: []
      processes: []
      wait: true
      wait_interval: 10
      wait_timeout: 60

  tasks:
    - name: Configure Monitoring Policy
      community.general.oneandone_monitoring_policy:
        api_url: "{{ api_url }}"
        auth_token: "{{ auth_token }}"
        name: "{{ monitoring_policy.name }}"
        state: present
        description: "{{ monitoring_policy.description }}"
        add_ports: "{{ monitoring_policy.add_ports }}"
        remove_ports: "{{ monitoring_policy.remove_ports }}"
        update_ports: "{{ monitoring_policy.update_ports }}"
        add_processes: "{{ monitoring_policy.add_processes }}"
        remove_processes: "{{ monitoring_policy.remove_processes }}"
        update_processes: "{{ monitoring_policy.update_processes }}"
        add_servers: "{{ monitoring_policy.add_servers }}"
        remove_servers: "{{ monitoring_policy.remove_servers }}"
        update_servers: "{{ monitoring_policy.update_servers }}"
        email: "{{ monitoring_policy.email }}"
        thresholds: "{{ monitoring_policy.thresholds }}"
        agent: "{{ monitoring_policy.agent }}"
        ports: "{{ monitoring_policy.ports }}"
        processes: "{{ monitoring_policy.processes }}"
        wait: "{{ monitoring_policy.wait }}"
        wait_interval: "{{ monitoring_policy.wait_interval }}"
        wait_timeout: "{{ monitoring_policy.wait_timeout }}"