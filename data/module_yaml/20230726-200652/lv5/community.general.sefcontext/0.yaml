- name: Manage SELinux file context
  hosts: all
  gather_facts: false
  become: true

  tasks:
    - name: Set SELinux file context
      community.general.sefcontext:
        target: "{{ item.target }}"
        setype: "{{ item.setype }}"
        selevel: "{{ item.selevel }}"
        seuser: "{{ item.seuser }}"
        state: "{{ item.state }}"
        reload: "{{ item.reload }}"
        ftype: "{{ item.ftype }}"
        substitute: "{{ item.substitute }}"
        ignore_selinux_state: "{{ item.ignore_selinux_state }}"
      with_items:
        - { target: "/path/to/file1", setype: "target_type_1", selevel: "s0", seuser: "user1", state: "present", reload: "no", ftype: "regular", substitute: "yes", ignore_selinux_state: "no" }
        - { target: "/path/to/file2", setype: "target_type_2", selevel: "s1", seuser: "user2", state: "absent", reload: "yes", ftype: "directory", substitute: "no", ignore_selinux_state: "yes" }
        # Add more test cases here based on the heuristic

    - name: Check SELinux file context
      command: ls -Z /path/to/file1
      register: ls_output

    - name: Debug SELinux file context
      debug:
        var: ls_output.stdout_lines