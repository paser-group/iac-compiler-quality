- name: Test latent type-related bugs in Ansible compiler
  hosts: all
  gather_facts: false

  vars:
    test_variable: "{{ 10 | random }}"

  tasks:
    - name: Print test_variable
      debug:
        var: test_variable

    - name: Create dictionary with invalid key
      set_fact:
        invalid_dict: { "{{ test_variable }}": "value" }

    - name: Fail task with invalid dictionary key
      fail:
        msg: "Invalid dictionary key used: {{ invalid_dict }}"

    - name: Perform calculation with incompatible types
      set_fact:
        invalid_calculation: "{{ test_variable + 'string' }}"

    - name: Fail task with incompatible types
      fail:
        msg: "Incompatible types used in calculation: {{ invalid_calculation }}"