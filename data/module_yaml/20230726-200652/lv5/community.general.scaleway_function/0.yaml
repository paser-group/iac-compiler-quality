---
- name: Test scaleway_function module with different options
  hosts: localhost
  gather_facts: false

  vars:
    api_token: "YOUR_API_TOKEN"
    region: "YOUR_REGION"
    namespace_id: "YOUR_NAMESPACE_ID"
    state: "present"
    validate_certs: false

  tasks:
    # Test with different port settings
    - name: Test with default port
      community.general.scaleway_function:
        api_token: "{{ api_token }}"
        region: "{{ region }}"
        namespace_id: "{{ namespace_id }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
      register: result_1

    - name: Test with specific port
      community.general.scaleway_function:
        api_token: "{{ api_token }}"
        region: "{{ region }}"
        namespace_id: "{{ namespace_id }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        query_parameters:
          port: 8080
      register: result_2

    - name: Test with random port
      set_fact:
        random_port: "{{ 20000 | random }}"
        
    - name: Test with random port
      community.general.scaleway_function:
        api_token: "{{ api_token }}"
        region: "{{ region }}"
        namespace_id: "{{ namespace_id }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        query_parameters:
          port: "{{ random_port }}"
      register: result_3