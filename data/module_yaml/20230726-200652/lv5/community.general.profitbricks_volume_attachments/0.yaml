- hosts: all
  gather_facts: false
  vars:
    datacenter: "{{ 'eu-de-1' }}"
    server: "{{ 'server1' }}"
    state: "{{ 'attached' }}"
    subscription_password: "{{ 'password123' }}"
    subscription_user: "{{ 'user123' }}"
    volume: "{{ 123 }}"
    wait: "{{ false }}"
    wait_timeout: "{{ '60' }}"
    port: "{{ 'invalid_port' | random(seed=1, range_start=1000, range_end=30000) }}"
  tasks:
    - name: Attach volume to server
      community.general.profitbricks_volume_attachments:
        datacenter: "{{ datacenter }}"
        server: "{{ server }}"
        state: "{{ state }}"
        subscription_password: "{{ subscription_password }}"
        subscription_user: "{{ subscription_user }}"
        volume: "{{ volume }}"
        wait: "{{ wait }}"
        wait_timeout: "{{ wait_timeout }}"
        port: "{{ port }}"
      register: result

    - debug:
        var: result