- name: Gather PowerEdge server information
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random port numbers
      set_fact:
        port_number: "{{ ['8001', '8002', '8003', '8004'] | random }}"

    - name: Gather PowerEdge server information
      community.general.idrac_redfish_info:
        baseuri: "https://{{ inventory_hostname }}:{{ port_number }}"
        username: "admin"
        password: "password"
        category: "Chassis"
        command: ["GetChassis"]
        timeout: 10
      register: idrac_info

    - name: Display gathered information
      debug:
        var: idrac_info.output