---
- name: Test Aruba Config
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure Aruba Switch
      community.network.aruba_config:
        backup: 1
        backup_options:
          dir_path: "/tmp"
        encrypt: yes
        intended_config: "/tmp/intended_config.txt"
        start_line_regex: "-"
        lines:
          - "hostname: ArubaSwitch"
          - "aaa authentication ssh login local"
          - "ip ssh version 2"
          - "ip ssh cipher aes128-ctr"
        parents:
          - "line1"
          - "line2"
        match: word
        running_config: /etc/aruba/running_config.txt
        save_when: changed
        src: /tmp/config.txt