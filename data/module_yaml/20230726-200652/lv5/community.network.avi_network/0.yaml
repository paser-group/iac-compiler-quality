---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create network in Avi controller
      community.network.avi_network:
        controller: "{{ item.controller }}"
        username: "{{ item.username }}"
        password: "{{ item.password }}"
        subnet:
          - ip_prefix: "{{ item.subnet }}"
            mask: "{{ item.mask }}"
            default_gateway: "{{ item.gateway }}"
        api_version: "{{ item.api_version }}"
        tenant: "{{ item.tenant }}"
        port: "{{ item.port }}"
      loop:
        - controller: "10.1.1.1"
          username: "{{ ansible_user }}"
          password: "{{ ansible_password }}"
          subnet: "10.1.1.0"
          mask: "24"
          gateway: "10.1.1.254"
          api_version: 17.1.1
          tenant: admin
          port: "80"
        - controller: "10.1.1.2"
          username: "{{ ansible_user }}"
          password: "{{ ansible_password }}"
          subnet: "10.1.2.0"
          mask: "24"
          gateway: "10.1.2.254"
          api_version: 17.2.1
          tenant: admin
          port: "443"