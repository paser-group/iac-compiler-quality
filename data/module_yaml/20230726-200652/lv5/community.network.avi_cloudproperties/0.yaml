---
- name: Test Ansible Latent Type-Related Bugs - community.network.avi_cloudproperties module
  hosts: localhost
  gather_facts: false

  vars:
    avi_controller: "https://{{ controller }}"
    avi_username: "{{ username }}"
    avi_password: "{{ password }}"
    avi_tenant: "{{ tenant }}"
    avi_tenant_uuid: "{{ tenant_uuid }}"

  tasks:
    - name: Set random port numbers
      set_fact:
        http_port: "{{ 10000 | random }}"
        https_port: "{{ 20000 | random }}"

    - name: Configure CloudProperties
      community.network.avi_cloudproperties:
        controller: "{{ avi_controller }}"
        username: "{{ avi_username }}"
        password: "{{ avi_password }}"
        tenant: "{{ avi_tenant }}"
        tenant_uuid: "{{ avi_tenant_uuid }}"
        state: present
        api_context: {}
        api_version: "17.2.10"
        avi_api_patch_op: null
        avi_api_update_method: null
        avi_credentials: {}
        avi_disable_session_cache_as_fact: false
        cc_props: null
        cc_vtypes: null
        controller: "{{ controller }}"
        hyp_props: null
        info: null
        password: "{{ password }}"
        state: null
        tenant: "{{ tenant }}"
        url: null
        username: "{{ username }}"
        uuid: null
        http_port: "{{ http_port }}"
        https_port: "{{ https_port }}"
      register: result

    - name: Debug CloudProperties Configuration
      debug:
        var: result

    - name: Print Debug Information
      debug:
        msg:
          - "HTTP Port: {{ result.http_port }}"
          - "HTTPS Port: {{ result.https_port }}"