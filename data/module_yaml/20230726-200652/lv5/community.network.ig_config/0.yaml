---
- name: Test playbook to expose latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure ig_config
      community.network.ig_config:
        add: "{{ add | default(false) | bool }}"
        client: "{{ client }}"
        columns: "{{ columns }}"
        delete: "{{ delete | default(false) | bool }}"
        download: "{{ download | default(false) | bool }}"
        factory: "{{ factory | default(false) | bool }}"
        filename: "{{ filename }}"
        get: "{{ get | default(false) | bool }}"
        modify: "{{ modify | default(false) | bool }}"
        no_response: "{{ no_response | default(false) | bool }}"
        path: "{{ path }}"
        return_rowid: "{{ return_rowid | default(false) | bool }}"
        revert: "{{ revert | default(false) | bool }}"
        rowid: "{{ rowid | default(0) | int }}"
        store: "{{ store | default(false) | bool }}"
        store_download: "{{ store_download | default(false) | bool }}"
        table: "{{ table }}"

      vars:
        client: "{{ item.client }}"
        columns: "{{ item.columns }}"
        filename: "{{ item.filename }}"
        path: "{{ item.path }}"
        revert: "{{ item.revert }}"
      loop:
        - { client: "client1", columns: "col1,col2", filename: "file1", path: "/path1", revert: false }
        - { client: "client2", columns: "col3,col4", filename: "file2", path: "/path2", revert: true }

    - name: Debug output
      debug:
        var: ansible_facts['community_network_ig_config_response']