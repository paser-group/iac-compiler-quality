---
- name: Install Logstash Plugin
  hosts: localhost
  gather_facts: false
  become: true

  tasks:
    - name: Generate Random Port Number
      shell: shuf -i 1024-65535 -n 1
      register: random_port
      changed_when: false

    - name: Install Logstash Plugin
      community.general.logstash_plugin:
        name: <plugin_name>
        plugin_bin: <path_to_plugin_bin>
        proxy_host: <proxy_host_address>
        proxy_port: "{{ random_port.stdout }}"
        state: present
        version: <plugin_version>