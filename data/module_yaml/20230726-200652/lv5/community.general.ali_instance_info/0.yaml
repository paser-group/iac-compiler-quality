---
- hosts: localhost
  gather_facts: False
  tasks:
    - name: Gather instance information using ali_instance_info module
      community.general.ali_instance_info:
        alicloud_access_key: "{{ lookup('env', 'ALICLOUD_ACCESS_KEY') }}"
        alicloud_secret_key: "{{ lookup('env', 'ALICLOUD_SECRET_KEY') }}"
        alicloud_region: "{{ lookup('env', 'ALICLOUD_REGION') }}"
        filters:
          tag:environment: production
        tags:
          Role: webserver
      register: instance_info

    # Test case for random port numbers
    - name: Test port settings with random port numbers
      debug:
        msg: "Random port number: {{ item }}"
      loop:
        - "{{ range(10, 20) | random }}"
      when: instance_info.instances is defined

...