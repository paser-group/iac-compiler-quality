---
- name: Test playbook for community.network.avi_role module
  hosts: localhost
  gather_facts: false

  vars:
    avi_credentials:
      controller: "https://{{ inventory_hostname }}/controller"
      username: "admin"
      password: "password"

  tasks:
    - name: Create a virtual service using the community.network.avi_role module
      community.network.avi_role:
        controller: "{{ avi_credentials.controller }}"
        username: "{{ avi_credentials.username }}"
        password: "{{ avi_credentials.password }}"
        state: present
        tenant: "Default"
        object_type: virtualservice
        name: "MyVirtualService"
        api_version: "18.2.7"
        tenant_uuid: "1234abcd"
        url: "/api/virtualservice"
        api_context:
          required_version: 2
      register: result

    - name: Print the result
      debug:
        var: result