- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false
  vars:
    account_api_token: "YOUR_DNSIMPLE_API_TOKEN"
    account_email: "YOUR_DNSIMPLE_EMAIL"
    domain: "yourdomain.com"
  
  tasks:
    - name: Create DNS Record
      community.general.dnsimple:
        account_api_token: "{{ account_api_token }}"
        account_email: "{{ account_email }}"
        domain: "{{ domain }}"
        type: "A"
        record: "www"
        value: "10.1.1.1"
        port: "{{ generate_random_port }}"
        state: present
      register: result
      
    - debug:
        var: result

  # Random port generation custom filter
  filters:
    - generate_random_port: "{{ range(1024, 65535) | random }}"

  # Random port generation Jinja2 filter
  jinja2_filters:
    - generate_random_port