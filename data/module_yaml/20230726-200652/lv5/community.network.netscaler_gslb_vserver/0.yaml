---
- name: Configure GSLB VServer
  hosts: localhost
  gather_facts: false

  vars:
    gslb_vserver_name: my_gslb_vserver
    gslb_vserver_ip: 10.1.1.10
    gslb_vserver_port: "{{ 2000 | random }}"
    nitro_user: admin
    nitro_pass: my_password
    nitro_protocol: http
    nitro_timeout: 10
    validate_certs: false

  tasks:
    - name: Configure GSLB VServer using netscaler_gslb_vserver module
      community.network.netscaler_gslb_vserver:
        nsip: "{{ hostvars['localhost']['ansible_host'] }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        nitro_protocol: "{{ nitro_protocol }}"
        nitro_timeout: "{{ nitro_timeout }}"
        validate_certs: "{{ validate_certs }}"

        name: "{{ gslb_vserver_name }}"
        ipv46: "{{ gslb_vserver_ip }}"
        port: "{{ gslb_vserver_port }}"
        servicetype: HTTP

      register: result

    - name: Debug result
      debug:
        var: result