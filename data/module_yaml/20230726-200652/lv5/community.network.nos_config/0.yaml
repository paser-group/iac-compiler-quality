---
- name: Manage Extreme Networks NOS configurations
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure Extreme Networks NOS
      community.network.nos_config:
        after: "{{ none }}"
        backup: "{{ true }}"
        backup_options: "{{ {} }}"
        before: "{{ none }}"
        diff_against: "{{ 'none' }}"
        diff_ignore_lines: "{{ none }}"
        intended_config: "{{ none }}"
        lines: "{{ none }}"
        match: "{{ none }}"
        multiline_delimiter: "{{ none }}"
        parents: "{{ none }}"
        replace: "{{ none }}"
        running_config: "{{ none }}"
        src: "{{ none }}"
        
      vars:
        random_port: "{{ 33000 + (play_hosts.index(inventory_hostname) * 100) }}"
      
      gather_facts: false

      pre_tasks:
        - name: Generate random port number
          set_fact:
            random_port: "{{ random_port }}"
      
      roles:
        - debug_config

  pre_tasks:
    - name: Generate random port number
      set_fact:
        random_port: "{{ random_port }}"
  
  handlers:
    - name: debug_config
      debug:
        var: random_port