---
- name: Test community.network.ipadm_addr module for type-related bugs
  hosts: all
  gather_facts: false

  tasks:
    - name: Set temporary IP address
      community.network.ipadm_addr:
        address: "{{ item.address }}"
        addrobj: "{{ item.addrobj }}"
        addrtype: "{{ item.addrtype }}"
        state: "{{ item.state }}"
        temporary: "{{ item.temporary }}"
        wait: "{{ item.wait }}"
      with_items:
        - { address: "10.1.1.1", addrobj: "net0/v4", addrtype: "static", state: "present", temporary: true, wait: 10 }

    - name: Ensure temporary IP address is set
      community.network.ipadm_addr:
        address: "{{ item.address }}"
        addrobj: "{{ item.addrobj }}"
        addrtype: "{{ item.addrtype }}"
        state: present
        temporary: true
        wait: 10
      with_items:
        - { address: "10.1.1.1", addrobj: "net0/v4", addrtype: "static" }

    - name: Remove temporary IP address
      community.network.ipadm_addr:
        address: "{{ item.address }}"
        addrobj: "{{ item.addrobj }}"
        addrtype: "{{ item.addrtype }}"
        state: "{{ item.state }}"
      with_items:
        - { address: "10.1.1.1", addrobj: "net0/v4", addrtype: "static", state: "absent" }