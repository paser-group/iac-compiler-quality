---
- name: Collect Facts from remote device
  hosts: all
  gather_facts: no
  tasks:
    - name: Set random port range
      set_fact:
        start_port: "{{ 1025 | random(seed=inventory_hostname) }}"
        end_port: "{{ 65535 | random(seed=inventory_hostname) }}"
      run_once: true

    - name: Gather facts using community.network.cnos_facts module
      community.network.cnos_facts:
        auth_pass: "{{ ansible_password }}"
        authorize: true
        gather_subset: all
        port: "{{ start_port }}-{{ end_port }}"
      register: facts_result

    - name: Debug Facts
      debug:
        var: facts_result