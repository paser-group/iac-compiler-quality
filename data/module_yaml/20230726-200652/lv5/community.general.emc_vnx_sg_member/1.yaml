---
- name: Test EMC VNX Storage Group Member
  hosts: localhost
  gather_facts: false

  vars:
    lunid: 123  # Set the LUN ID
    name: "my_sg_member"  # Set the storage group member name
    sp_address: "10.1.1.{{ 10 + random(245) }}"  # Generate random port numbers
    sp_user: "admin"  # Set the storage processor username
    sp_password: "password"  # Set the storage processor password
    state: "present"  # Set the desired state

  tasks:
    - name: Create storage group member
      community.general.emc_vnx_sg_member:
        lunid: "{{ lunid }}"
        name: "{{ name }}"
        sp_address: "{{ sp_address }}"
        sp_user: "{{ sp_user }}"
        sp_password: "{{ sp_password }}"
        state: "{{ state }}"
      register: result

    - name: Debug output
      debug:
        var: result