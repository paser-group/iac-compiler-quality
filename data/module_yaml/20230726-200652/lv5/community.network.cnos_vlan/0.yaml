- name: Manage VLANs on network switches
  hosts: switches
  gather_facts: false
  vars:
    vlan_id: 100
    vlan_name: "test_vlan"
    vlan_interfaces: "Ethernet1/1"
    vlan_delay: 5

  tasks:
    - name: Create VLAN
      community.network.cnos_vlan:
        vlan_id: "{{ vlan_id }}"
        name: "{{ vlan_name }}"
        interfaces: "{{ vlan_interfaces }}"
        delay: "{{ vlan_delay }}"
        state: present
      register: result

    - name: Debug VLAN Creation Result
      debug:
        var: result

    - name: Delete VLAN
      community.network.cnos_vlan:
        vlan_id: "{{ vlan_id }}"
        name: "{{ vlan_name }}"
        state: absent