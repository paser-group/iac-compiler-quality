- name: Configure firewall policy with potential type-related bugs
  hosts: all
  become: true
  gather_facts: false

  vars:
    firewall_policy: "policy1"
    name: "Policy 1"
    description: "Firewall policy created for testing"
    add_rules:
      - protocol: "{{ item.protocol }}"  # Potential type-related bug: missing quotes around item.protocol
        port_from: "{{ item.port_from }}"
        port_to: "{{ item.port_to }}"
    rules:
      - protocol: "{{ item.protocol }}"  # Potential type-related bug: missing quotes around item.protocol
        port_from: "{{ item.port_from }}"
        port_to: "{{ item.port_to }}"

  tasks:
    - name: Configure firewall policy
      community.general.oneandone_firewall_policy:
        api_url: "https://api_url"
        auth_token: "auth_token"
        firewall_policy: "{{ firewall_policy }}"
        name: "{{ name }}"
        description: "{{ description }}"
        add_rules: "{{ add_rules }}"
        rules: "{{ rules }}"
      register: result

    - name: Debug result
      debug:
        var: result