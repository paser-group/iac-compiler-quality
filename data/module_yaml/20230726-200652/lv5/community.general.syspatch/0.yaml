---
- name: Test playbook for community.general.syspatch module
  hosts: all
  gather_facts: false

  tasks:
    - name: Patch the system
      community.general.syspatch:
        revert: "{{ random_port }}"
      register: patch_output
      ignore_errors: true
      changed_when: false

    - name: Print patch output
      debug:
        var: patch_output

  vars:
    random_port: "{{ 10000 | random }}"

- name: Test playbook for port settings
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate random port number
      shell: |
        echo $(( $RANDOM % 65535 + 1025 ))
      register: random_port
      changed_when: false

    - name: Print random port number
      debug:
        var: random_port