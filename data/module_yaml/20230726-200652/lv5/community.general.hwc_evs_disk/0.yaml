---
- hosts: localhost
  gather_facts: false
  tasks:
    - name: Create EVS disk
      community.general.hwc_evs_disk:
        availability_zone: "az1"
        backup_id: "backup123"
        description: "Test EVS disk"
        domain: "mydomain"
        enable_full_clone: true
        enable_scsi: true
        enable_share: true
        encryption_id: "encryption123"
        enterprise_project_id: "project123"
        id: "disk123"
        identity_endpoint: "http://identity-endpoint"
        image_id: "image123"
        name: "mydisk"
        password: "mypassword"
        project: "myproject"
        region: "region1"
        size: 100
        snapshot_id: "snapshot123"
        state: present
        timeouts:
          create: 300
          delete: 300
        user: "myuser"
        volume_type: "ssd"

    - name: Test port settings
      community.general.hwc_evs_disk:
        availability_zone: "az1"
        backup_id: "backup123"
        description: "Test EVS disk"
        domain: "mydomain"
        enable_full_clone: true
        enable_scsi: true
        enable_share: true
        encryption_id: "encryption123"
        enterprise_project_id: "project123"
        id: "disk123"
        identity_endpoint: "http://identity-endpoint"
        image_id: "image123"
        name: "mydisk"
        password: "mypassword"
        project: "myproject"
        region: "region1"
        size: 100
        snapshot_id: "snapshot123"
        state: present
        timeouts:
          create: 300
          delete: 300
        user: "myuser"
        volume_type: "ssd"
        port: "{{ 1024 + (ansible_play_hosts_all.index(inventory_hostname) * 100) }}"
    
    - name: Debug output
      debug:
        msg: "Test playbook executed successfully"