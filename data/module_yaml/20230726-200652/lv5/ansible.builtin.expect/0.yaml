---
- name: Test ansible.builtin.expect module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Execute command with expect
      ansible.builtin.expect:
        chdir: /tmp
        command: ls
        creates: /tmp/output.txt
        echo: true
        removes: /tmp/output.txt
        responses:
          'password prompt': "password123\n"
        timeout: 10
      register: expect_output

    - name: Debug expect output
      debug:
        var: expect_output