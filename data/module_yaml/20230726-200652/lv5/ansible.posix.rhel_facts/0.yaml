---
- name: Gather RHEL Facts
  hosts: all
  gather_facts: false

  tasks:
    - name: Gather RHEL facts
      ansible.posix.rhel_facts:
        gather_subset:
          - 'all'
          - 'interfaces'
          - 'default_ipv4'
          - 'default_ipv6'
      register: rhel_facts

    - name: Debug RHEL facts
      debug:
        var: rhel_facts

- name: Test Port Settings
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate Random Port Number
      script: "{{ playbook_dir }}/generate_random_port.py"
      register: random_port

    - name: Debug Random Port
      debug:
        var: random_port