---
- name: Test playbook for community.network.dladm_linkprop module
  hosts: localhost
  connection: local
  gather_facts: false

  tasks:
    - name: Set link properties using community.network.dladm_linkprop module
      community.network.dladm_linkprop:
        link: "{{ item.link }}"
        property: "{{ item.property }}"
        state: "{{ item.state }}"
        temporary: "{{ item.temporary }}"
        value: "{{ item.value }}"
      loop:
        - { link: 'eth0', property: 'some_property', state: 'present', temporary: 'no', value: 1234 }
        - { link: 'eth1', property: 'another_property', state: 'absent', temporary: 'yes', value: 'random_string' }
        - { link: 'eth2', property: 'yet_another_property', state: 'present', temporary: 'no', value: 5678 }
        - { link: 'eth3', property: 'port_number', state: 'present', temporary: 'no', value: "{{ random_port_number }}" }

  vars:
    random_port_number: "{{ 1024 + (ansible_play_hosts_all.index(inventory_hostname) + 1) * 100 }}"