---
- name: Test ansible module to add or delete app collaborators in Heroku
  hosts: localhost
  gather_facts: false

  vars:
    api_key: your_heroku_api_key
    apps:
      - your_heroku_app_name
    user: collaborator@example.com

  tasks:
    - name: Add app collaborators
      community.general.heroku_collaborator:
        api_key: "{{ api_key }}"
        apps: "{{ apps }}"
        state: "present"
        user: "{{ user }}"
      register: add_result
      failed_when: add_result.failed

    - name: Check if app collaborators added successfully
      debug:
        msg: "App collaborators added successfully"
      when: not add_result.failed

    - name: Delete app collaborators
      community.general.heroku_collaborator:
        api_key: "{{ api_key }}"
        apps: "{{ apps }}"
        state: "absent"
        user: "{{ user }}"
      register: delete_result
      failed_when: delete_result.failed

    - name: Check if app collaborators deleted successfully
      debug:
        msg: "App collaborators deleted successfully"
      when: not delete_result.failed