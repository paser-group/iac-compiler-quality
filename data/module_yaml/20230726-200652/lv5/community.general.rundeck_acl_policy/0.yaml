---
- name: Test rundeck_acl_policy module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create random port numbers
      set_fact:
        port_number: "{{ 10000 | random }}"

    - name: Create a rundeck ACL policy
      community.general.rundeck_acl_policy:
        url: "http://{{ ansible_host }}:{{ port_number }}"
        url_username: admin
        url_password: password
        name: test_policy
        project: test_project
        policy: my_policy
        state: present
      register: result

    - name: Debug result
      debug:
        var: result