---
- name: Test playbook to uncover latent bugs in sros_rollback module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure sros_rollback with random port numbers
      community.network.sros_rollback:
        local_max_checkpoints: "{{ local_max_checkpoints }}"
        remote_max_checkpoints: "{{ remote_max_checkpoints }}"
        rescue_location: "{{ rescue_location }}"
        rollback_location: "{{ rollback_location }}"
        state: "{{ state }}"
        port: "{{ random_port }}"
      vars:
        local_max_checkpoints: 3
        remote_max_checkpoints: 5
        rescue_location: "/tmp/rescue"
        rollback_location: "/tmp/rollback"
        state: present
        random_port: "{{ random(1024, 65535) | int }}"