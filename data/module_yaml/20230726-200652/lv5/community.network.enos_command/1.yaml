---
- name: Run commands on Docker nodes
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate random port number
      set_fact:
        random_port: "{{ 10000 | random }}"

    - name: Run command on Docker nodes
      community.network.enos_command:
        host: "{{ inventory_hostname }}"
        username: ansible
        password: ansible
        authorize: yes
        auth_pass: ansible
        commands:
          - "echo 'Hello, world!'"
          - "ls -l /tmp"
        port: "{{ random_port }}"
      register: result

    - name: Display command output
      debug:
        var: result.stdout_lines