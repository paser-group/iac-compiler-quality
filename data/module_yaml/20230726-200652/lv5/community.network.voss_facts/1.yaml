---
- name: Gather facts from remote devices
  hosts: all
  gather_facts: no
  tasks:
    - name: Set random port number
      set_fact:
        random_port: "{{ 1024 + (ansible_play_batch.index(inventory_hostname) | random(seed=inventory_hostname) * 100) | int }}"

    - name: Collect facts
      community.network.voss_facts:
        gather_subset: None
        port: "{{ random_port }}"
      register: facts_result

    - name: Debug facts
      debug:
        var: facts_result