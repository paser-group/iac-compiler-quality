---
- name: Execute NETCONF RPC operation and test port settings
  hosts: localhost
  gather_facts: no
  
  tasks:
    - name: Execute NETCONF RPC operation
      ansible.netcommon.netconf_rpc:
        content: "{{ rpc }}"
        display: "{{ display }}"
        rpc: "{{ rpc }}"
        xmlns: "{{ xmlns }}"
      register: result
      ignore_errors: true
  
    - name: Display RPC response
      debug:
        var: result
  
    - name: Generate random port number
      set_fact:
        random_port: "{{ 10000 | random }}"
  
    - name: Test port settings with random port number
      ansible.netcommon.netconf_rpc:
        content: "{{ rpc }}"
        display: "{{ display }}"
        rpc: "{{ rpc }}"
        xmlns: "{{ xmlns }}"
        port: "{{ random_port }}"
      register: result_random_port
      ignore_errors: true
  
    - name: Display RPC response with random port number
      debug:
        var: result_random_port