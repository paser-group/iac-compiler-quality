---
- name: Test for latent type-related bugs in manageiq_alerts module
  hosts: localhost
  gather_facts: false

  vars:
    manageiq_server: "https://manageiq.example.com"
    manageiq_username: "admin"
    manageiq_password: "password"
    manageiq_alert_description: "Test Alert"
    manageiq_alert_expression: {}
    manageiq_alert_expression_type: "ruby"
    manageiq_alert_enabled: true
    manageiq_alert_options: {}
    manageiq_alert_resource_type: "vm"
    manageiq_alert_state: "present"

  tasks:
    - name: Create manageiq alert
      community.general.manageiq_alerts:
        description: "{{ manageiq_alert_description }}"
        enabled: "{{ manageiq_alert_enabled }}"
        expression: "{{ manageiq_alert_expression }}"
        expression_type: "{{ manageiq_alert_expression_type }}"
        manageiq_connection:
          url: "{{ manageiq_server }}"
          username: "{{ manageiq_username }}"
          password: "{{ manageiq_password }}"
        options: "{{ manageiq_alert_options }}"
        resource_type: "{{ manageiq_alert_resource_type }}"
        state: "{{ manageiq_alert_state }}"