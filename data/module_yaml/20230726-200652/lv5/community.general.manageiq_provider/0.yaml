---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    # Random port numbers
    host_default_vnc_port_start: "{{ 10000 | random }}"
    host_default_vnc_port_end: "{{ 20000 | random }}"

  tasks:
    - name: Manage IQ Provider
      community.general.manageiq_provider:
        api_version: "v2"
        azure_tenant_id: "EXAMPLE_TENANT_ID"
        host_default_vnc_port_start: "{{ host_default_vnc_port_start }}"
        host_default_vnc_port_end: "{{ host_default_vnc_port_end }}"
        manageiq_connection:
          url: "https://example.com"
          username: "admin"
          password: "password"
        name: "ManageIQ Provider"
        project: "Default"
        provider_region: "us-east-1"
        subscription: "EXAMPLE_SUBSCRIPTION"
        tenant_mapping_enabled: true
        type: "ManageIQ::Providers::Amazon::CloudManager"
        zone: "Default Zone"
      register: result

    - name: Display result
      debug:
        var: result