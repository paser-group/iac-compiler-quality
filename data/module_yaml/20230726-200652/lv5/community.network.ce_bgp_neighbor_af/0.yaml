- name: Test for ansible.netcommon.network.cli_bgp_neighbor_af Collection Module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Configure BGP Neighbor Address-family
      ansible.netcommon.network.cli_bgp_neighbor_af:
        af_type: "{{ random_type() }}"
        neighbor: "{{ random_neighbor() }}"
        port: "{{ random_port() }}"
        provider: "{{ inventory_hostname }}"
        
  vars:
    random_types:
      - ipv4-unicast
      - ipv6-unicast
      - ipv4-labeled-unicast
      - ipv6-labeled-unicast
      - ipv4-tunnel
      - ipv6-tunnel
    random_neighbors:
      - 10.1.1.1
      - 10.1.1.2
      - 10.1.1.3
      - 10.1.1.4

  tasks:
    - set_fact:
        random_type: "{{ random_types | random }}"
        random_neighbor: "{{ random_neighbors | random }}"
        random_port: "{{ 1024 + (ansible_play_hosts_all.index(inventory_hostname) + 1) }}"