---
- name: Test Playbook
  hosts: localhost
  gather_facts: false

  vars:
    account_email: "test@example.com"
    account_api_key: "YOUR_API_KEY"
    zone: "example.com"

  tasks: 

    - name: Create DNS Record
      community.general.cloudflare_dns:
        zone: "{{ zone }}"
        account_email: "{{ account_email }}"
        account_api_key: "{{ account_api_key }}"
        record: "test-record"
        type: "A"
        value: "{{ inventory_hostname }}"
      register: result
      ignore_errors: true

    - debug:
        var: result

    - name: Test port settings
      community.general.cloudflare_dns:
        zone: "{{ zone }}"
        account_email: "{{ account_email }}"
        account_api_key: "{{ account_api_key }}"
        record: "test-record"
        type: "A"
        value: "{{ inventory_hostname }}"
        port: "{{ port }}"
      with_sequence: start=5000 end=6000
      register: result_port

    - debug:
        var: result_port