---
- name: Test playbook for ansible.posix.mount module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Mount a file system
      ansible.posix.mount:
        path: "{{ mount_path }}"
        src: "{{ src_path }}"
        fstype: "{{ mount_type }}"
        opts: "{{ mount_options | default('defaults') }}"
        state: "{{ mount_state | default('mounted') }}"
        backup: "{{ backup | default(false) }}"
        boot: "{{ boot | default(false) }}"
        dump: "{{ dump | default(0) }}"
        fstab: "{{ fstab | default('/etc/fstab') }}"
        passno: "{{ passno | default(0) }}"
      register: mount_status

    - name: Output mount status
      debug:
        var: mount_status

- name: Test random port settings
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random port numbers
      set_fact:
        random_port: "{{ 1024 + (ansible_play_hosts.index(inventory_hostname) | random(seed=inventory_hostname) | random(seed=ansible_date_time.date) | random(seed=ansible_date_time.time)) | random(seed=ansible_date_time.microsecond) }}"
  
    - name: Test random port settings
      ansible.posix.mount:
        path: "{{ mount_path }}"
        src: "{{ src_path }}"
        fstype: "{{ mount_type }}"
        opts: "{{ mount_options | default('defaults') }}"
        state: "{{ mount_state | default('mounted') }}"
        port: "{{ random_port }}"
      register: mount_status
  
    - name: Output mount status
      debug:
        var: mount_status