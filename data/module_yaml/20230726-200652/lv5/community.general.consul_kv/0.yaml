- name: Test playbook for community.general.consul_kv
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Manipulate key-value entries in Consul
      community.general.consul_kv:
        host: "{{ host }}"
        port: "{{ random_port }}"
        scheme: "{{ scheme }}"
        token: "{{ token }}"
        cas: "{{ cas }}"
        flags: "{{ flags }}"
        key: "{{ key }}"
        value: "{{ value }}"
        state: "{{ state }}"
        recurse: "{{ recurse }}"
        retrieve: "{{ retrieve }}"
        session: "{{ session }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - name: Debug Consul response
      debug:
        var: result