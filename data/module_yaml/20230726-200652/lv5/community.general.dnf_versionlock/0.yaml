---
- name: Test dnf_versionlock module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install dnf-utils package
      package:
        name: "dnf-utils"
        state: present

    - name: Lock package versions
      community.general.dnf_versionlock:
        name:
          - "package1"
          - "package2"
        state: present

    - name: Check if package versions are locked
      command: dnf versionlock list
      register: versionlock_output

    - name: Debug version lock status
      debug:
        var: versionlock_output.stdout_lines

    - name: Cleanup package version locks
      community.general.dnf_versionlock:
        name:
          - "package1"
          - "package2"
        state: absent