- name: ICX Logging Test
  hosts: all
  gather_facts: false

  tasks:
    - name: Manage ICX Logging
      community.network.icx_logging:
        name: "ICX Logging"
        state: present
        aggregate:
          - dest
          - udp_port
          - facility
          - level
        check_running_config: true
        dest: "/var/log/icx.log"
        facility: "local0"
        level:
          - debug
        udp_port: "{{ range(1025, 65535) | random }}"
      register: icx_logging_result

    - debug:
        var: icx_logging_result