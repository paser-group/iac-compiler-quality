- hosts: all
  gather_facts: false
  tasks:
    - name: Test scaleway_container module with random port numbers
      community.general.scaleway_container:
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        name: "{{ item.container_name }}"
        namespace_id: "{{ item.namespace_id }}"
        registry_image: "{{ item.image }}"
        state: present
        port: "{{ lookup('community.general.random_port') }}"
      loop:
        - { container_name: "my-container1", namespace_id: "my-namespace1", image: "my-image1" }
        - { container_name: "my-container2", namespace_id: "my-namespace2", image: "my-image2" }
        - { container_name: "my-container3", namespace_id: "my-namespace3", image: "my-image3" }
        - { container_name: "my-container4", namespace_id: "my-namespace4", image: "my-image4" }