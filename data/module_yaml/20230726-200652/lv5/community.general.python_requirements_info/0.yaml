---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random port
      set_fact:
        random_port: "{{ 8000 | random(start=1024, end=65535) }}"
      
    - name: Generate random inventory file
      copy:
        content: |
          [nodes]
          ubuntu1 ansible_host=10.1.1.1 ansible_user=root ansible_ssh_pass=pass ansible_python_interpreter='/usr/bin/python3'
          alpine1 ansible_host=10.1.1.2 ansible_user=root ansible_ssh_pass=pass ansible_python_interpreter='/usr/bin/python3'
          centos1 ansible_host=10.1.1.3 ansible_user=root ansible_ssh_pass=pass
          redhat1 ansible_host=10.1.1.4 ansible_user=root ansible_ssh_pass=pass
        dest: inventory.ini

    - name: Show python path and assert
      community.general.python_requirements_info:
        inventory_path: inventory.ini
        module_name: "{{ random_port }}"
      register: python_requirements_info_output

    - name: Debug python requirements info output
      debug:
        var: python_requirements_info_output