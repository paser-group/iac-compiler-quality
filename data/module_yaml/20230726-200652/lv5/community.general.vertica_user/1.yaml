- name: Add or remove Vertica database user
  hosts: localhost
  gather_facts: false
  vars:
    cluster: "my-cluster"
    db: "my-db"
    state: "present"
    user: "testuser"
    password: "testpassword"
    login_user: "admin"
    login_password: "adminpassword"
    port: "{{ 1024 + (inventory_hostname | random(seed=1, start=1, end=65535) | random(seed=2, start=1, end=65535)) }}"
  
  tasks:
    - name: Add or remove Vertica database user
      community.general.vertica_user:
        cluster: "{{ cluster }}"
        db: "{{ db }}"
        state: "{{ state }}"
        user: "{{ user }}"
        password: "{{ password }}"
        login_user: "{{ login_user }}"
        login_password: "{{ login_password }}"
        port: "{{ port }}"