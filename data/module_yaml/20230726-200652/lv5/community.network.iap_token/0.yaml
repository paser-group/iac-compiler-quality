---
- name: Test playbook for community.network.iap_token
  hosts: localhost
  gather_facts: false

  vars:
    iap_fqdn: "{{ iap_fqdn | default('example.com') }}"
    iap_port: "{{ iap_port | default(1234) }}"
    username: "{{ username | default('admin') }}"
    password: "{{ password | default('password') }}"
    validate_certs: "{{ validate_certs | default(true) }}"
    https: "{{ https | default(true) }}"

  tasks:
    - name: Get IAP token
      community.network.iap_token:
        iap_fqdn: "{{ iap_fqdn }}"
        iap_port: "{{ iap_port }}"
        username: "{{ username }}"
        password: "{{ password }}"
        validate_certs: "{{ validate_certs }}"
        https: "{{ https }}"
      register: iap_token

    - name: Debug IAP token
      debug:
        var: iap_token