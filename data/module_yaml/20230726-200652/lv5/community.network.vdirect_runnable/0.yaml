---
- name: Test vDirect Runnable Module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random vDirect IP
      set_fact:
        vdirect_ip: "10.1.1.{{ 1 + (inventory_hostname | ipaddr('ipv4') | ipaddr('int')) }}"

    - name: Generate random vDirect port
      set_fact:
        vdirect_port: "{{ 8000 + (inventory_hostname | ipaddr('ipv4') | ipaddr('int')) }}"

    - name: Run vDirect Runnable
      community.network.vdirect_runnable:
        vdirect_ip: "{{ vdirect_ip }}"
        vdirect_port: "{{ vdirect_port }}"
      register: result

    - name: Display vDirect Runnable result
      debug:
        var: result