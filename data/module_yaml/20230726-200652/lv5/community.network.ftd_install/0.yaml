- name: Install FTD pkg
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Install FTD
      community.network.ftd_install:
        console_ip: "{{ console_ip }}"
        console_password: "{{ console_password }}"
        console_port: "{{ console_port }}"
        console_username: "{{ console_username }}"
        device_gateway: "{{ device_gateway }}"
        device_hostname: "{{ device_hostname }}"
        device_ip: "{{ device_ip }}"
        device_model: "{{ device_model }}"
        device_netmask: "{{ device_netmask }}"
        device_new_password: "{{ device_new_password }}"
        device_password: "{{ device_password }}"
        device_sudo_password: "{{ device_sudo_password }}"
        device_username: "{{ device_username }}"
        dns_server: "{{ dns_server }}"
        force_install: "{{ force_install }}"
        image_file_location: "{{ image_file_location }}"
        image_version: "{{ image_version }}"
        rommon_file_location: "{{ rommon_file_location }}"
        search_domains: "{{ search_domains }}"
      register: ftd_install_result

    - name: Debug FTD Installation Output
      debug:
        var: ftd_install_result

- name: Test Cases
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Randomize Port Numbers
      set_fact:
        random_port: "{{ 1024 | random(seed=inventory_hostname) + 1024 }}"

    - name: Test Console Port
      community.network.ftd_install:
        console_ip: "{{ console_ip }}"
        console_password: "{{ console_password }}"
        console_port: "{{ random_port }}"
        console_username: "{{ console_username }}"
        device_gateway: "{{ device_gateway }}"
        device_hostname: "{{ device_hostname }}"
        device_ip: "{{ device_ip }}"
        device_model: "{{ device_model }}"
        device_netmask: "{{ device_netmask }}"
        device_new_password: "{{ device_new_password }}"
        device_password: "{{ device_password }}"
        device_sudo_password: "{{ device_sudo_password }}"
        device_username: "{{ device_username }}"
        dns_server: "{{ dns_server }}"
        force_install: "{{ force_install }}"
        image_file_location: "{{ image_file_location }}"
        image_version: "{{ image_version }}"
        rommon_file_location: "{{ rommon_file_location }}"
        search_domains: "{{ search_domains }}"
      register: console_port_test_result

    - name: Debug Console Port Test Output
      debug:
        var: console_port_test_result