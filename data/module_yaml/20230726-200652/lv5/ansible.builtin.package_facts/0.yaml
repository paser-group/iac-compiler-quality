---
- name: Discover package facts for different Linux distributions
  hosts: all
  gather_facts: false

  tasks:
    - name: Gather package facts
      ansible.builtin.package_facts:
        manager: "{{ manager }}"
        strategy: "{{ strategy }}"
      register: pkg_facts

    - name: Debug package facts
      ansible.builtin.debug:
        var: pkg_facts

- name: Test port settings using random port numbers
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate random port number
      ansible.builtin.command:
        cmd: /bin/sh -c 'echo $((RANDOM % 65535 + 1))'
      register: random_port

    - name: Debug random port number
      ansible.builtin.debug:
        msg: "Random port number: {{ random_port.stdout }}"