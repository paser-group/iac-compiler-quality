---
- name: Manage VPN instances on HUAWEI devices
  hosts: huawei_devices
  gather_facts: false

  tasks:
    - name: Manage VPN instances
      community.network.ce_vrf:
        provider:
          host: "{{ host_var }}"
          port: "{{ port_var }}"
          username: "{{ username_var }}"
          password: "{{ password_var }}"
        name: "VPN1"
        description: null
        state: null
        vrf: null
      vars:
        host_var: "{{ host_ports_map[inventory_hostname][0] }}"
        port_var: "{{ host_ports_map[inventory_hostname][1] }}"
        username_var: "{{ host_ports_map[inventory_hostname][2] }}"
        password_var: "{{ host_ports_map[inventory_hostname][3] }}"
        host_ports_map:
          host1: [10.0.0.1, 22, admin, secret]
          host2: [10.0.0.2, 22, admin, secret]