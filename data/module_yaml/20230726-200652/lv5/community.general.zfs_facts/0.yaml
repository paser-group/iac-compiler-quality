---
- name: Expose latent type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    zfs_dataset: "{{ random_dataset }}"
    zfs_properties: "{{ random_properties }}"
    zfs_depth: "{{ random_depth }}"
    zfs_recurse: "{{ random_recurse }}"
    zfs_parsable: "{{ random_parsable }}"
    zfs_type: "{{ random_type }}"
  
  tasks:
    - name: Gather ZFS facts
      community.general.zfs_facts:
        depth: "{{ zfs_depth }}"
        name: "{{ zfs_dataset }}"
        parsable: "{{ zfs_parsable }}"
        properties: "{{ zfs_properties }}"
        recurse: "{{ zfs_recurse }}"
        type: "{{ zfs_type }}"
      register: zfs_facts_result

    - name: Print ZFS facts
      debug:
        var: zfs_facts_result