---
- name: Test pn_prefix_list_network module
  hosts: localhost
  connection: local

  tasks:
    - name: Create prefix list network
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ cli_switch }}"
        pn_name: "{{ pn_name }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        pn_provision_state: "{{ pn_provision_state }}"
        state: present
      register: result

    - name: Debug result
      debug:
        var: result

    - name: Remove prefix list network
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ cli_switch }}"
        pn_name: "{{ pn_name }}"
        state: absent

    - name: Debug result
      debug:
        var: result

- name: Generate random port numbers
  hosts: localhost
  connection: local

  tasks:
    - name: Set random port range
      set_fact:
        random_port_range: "{{ start_port }}-{{ end_port }}"

    - name: Print random port range
      debug:
        var: random_port_range

    - name: Test random port range
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ cli_switch }}"
        pn_name: "{{ pn_name }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        pn_provision_state: "{{ pn_provision_state }}"
        state: present
        pn_port_range: "{{ random_port_range }}"
      register: result

    - name: Debug result
      debug:
        var: result