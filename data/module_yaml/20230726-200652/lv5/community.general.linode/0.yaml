---
- name: Test playbook for latent type-related bugs in community.general.linode module
  hosts: localhost
  connection: local
  gather_facts: false

  tasks:
    - name: Create Linode instance with random port settings
      community.general.linode:
        api_key: <your_api_key>
        name: test-instance
        distribution: 1
        plan: 1
        datacenter: 2
        displaygroup: 'test-group'
        backupwindow: 2
        backupweeklyday: 6
        kernel_id: 1
        swap: 512
        additional_disks: []
        private_ip: false
        ssh_pub_key: "{{ lookup('file', '~/.ssh/id_rsa.pub') }}"
        alert_bwin_enabled: true
        alert_bwin_threshold: "{{ random_port() }}"
        alert_bwout_enabled: true
        alert_bwout_threshold: "{{ random_port() }}"
        alert_bwquota_enabled: true
        alert_bwquota_threshold: "{{ random_port() }}"
        alert_cpu_enabled: true
        alert_cpu_threshold: "{{ random_port() }}"
        alert_diskio_enabled: true
        alert_diskio_threshold: "{{ random_port() }}"
        payment_term: 1
        watchdog: true
        wait: true
        wait_timeout: 300
        state: present
      register: linode

    - name: Debug Linode instance
      debug:
        var: linode
...