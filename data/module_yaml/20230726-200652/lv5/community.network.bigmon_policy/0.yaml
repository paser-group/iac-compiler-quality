---
- name: Test playbook for community.network.bigmon_policy module
  hosts: localhost
  gather_facts: false

  vars:
    access_token: None
    action: None
    controller: None
    delivery_packet_count: None
    duration: None
    name: None
    policy_description: None
    priority: None
    start_time: None
    state: None
    validate_certs: "{{ bool() | random }}"

  tasks:
    - name: Create random port number for test case
      set_fact:
        random_port: "{{ 9000 + random() * 1000 | int }}"

    - name: Test bigmon_policy module with random port
      community.network.bigmon_policy:
        access_token: "{{ access_token }}"
        action: "{{ action }}"
        controller: "{{ controller }}"
        delivery_packet_count: "{{ delivery_packet_count }}"
        duration: "{{ duration }}"
        name: "{{ name }}"
        policy_description: "{{ policy_description }}"
        priority: "{{ priority }}"
        start_time: "{{ start_time }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
        port: "{{ random_port }}"
      register: result

    - name: Debug module output
      debug:
        var: result