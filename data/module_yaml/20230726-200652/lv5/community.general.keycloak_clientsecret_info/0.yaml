---
- name: Test Latent Type-Related Bugs in Ansible Keycloak Client Secret Info Module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random port number
      community.general.random_string:
        length: "{{ unknown_variable }}"
        charset: digits
      register: random_port

    - name: Set fact with random port
      set_fact:
        connection_timeout: "{{ random_port.stdout }}"

    - name: Retrieve client secret info
      community.general.keycloak_clientsecret_info:
        auth_client_id: 123
        auth_client_secret: []
        auth_keycloak_url: "https://keycloak.example.com"
        auth_password: 456
        auth_realm: true
        auth_username: {}
        client_id: 789
        connection_timeout: "{{ connection_timeout }}"
        http_agent:
          - value1
          - value2
        id: false
        realm: 101
        token: null
        validate_certs: "true"

      register: result

    - name: Print the retrieved client secret info
      debug:
        var: result