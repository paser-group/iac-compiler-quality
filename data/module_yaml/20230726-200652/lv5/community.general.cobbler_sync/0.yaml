---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    cobbler_host: "localhost"
    cobbler_port: "{{ random_cobbler_port }}"
    cobbler_username: "admin"
    cobbler_password: "admin"
    cobbler_use_ssl: false
    cobbler_validate_certs: false

  tasks:
    - name: Generate random cobbler port number
      set_fact:
        random_cobbler_port: "{{ 10000 | random }}"
        
    - name: Sync Cobbler using 'community.general.cobbler_sync' module
      community.general.cobbler_sync:
        host: "{{ cobbler_host }}"
        port: "{{ cobbler_port }}"
        username: "{{ cobbler_username }}"
        password: "{{ cobbler_password }}"
        use_ssl: "{{ cobbler_use_ssl }}"
        validate_certs: "{{ cobbler_validate_certs }}"
      register: cobbler_sync_result

    - name: Print Cobbler Sync Result
      debug:
        var: cobbler_sync_result