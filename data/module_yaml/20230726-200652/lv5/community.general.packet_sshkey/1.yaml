- name: Test Playbook for packet_sshkey module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create SSH key with random port
      community.general.packet_sshkey:
        auth_token: "{{ auth_token }}"
        label: my_key
        key: "{{ lookup('file', '/path/to/public_key.pub') }}"
        state: present
        port: "{{ lookup('community.general.random_port_number') }}"
      register: ssh_key_create_output

    - name: Debug SSH key creation with random port
      debug:
        var: ssh_key_create_output