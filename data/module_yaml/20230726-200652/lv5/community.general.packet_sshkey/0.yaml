- name: Test Playbook for packet_sshkey module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create SSH key
      community.general.packet_sshkey:
        auth_token: "{{ auth_token }}"
        label: my_key
        key: "{{ lookup('file', '/path/to/public_key.pub') }}"
        state: present
      register: ssh_key_create_output

    - name: Debug SSH key creation
      debug:
        var: ssh_key_create_output

    - name: Delete SSH key
      community.general.packet_sshkey:
        auth_token: "{{ auth_token }}"
        label: "{{ ssh_key_create_output.id }}"
        state: absent
      register: ssh_key_delete_output

    - name: Debug SSH key deletion
      debug:
        var: ssh_key_delete_output