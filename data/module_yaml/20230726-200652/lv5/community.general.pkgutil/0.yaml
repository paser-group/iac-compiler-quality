---
- name: Install OpenCSW packages
  hosts: localhost
  gather_facts: false

  vars:
    pkgutil_packages:
      - name: curl
        state: present
      - name: wget
        state: absent

  tasks:
    - name: Install OpenCSW packages
      community.general.pkgutil:
        name: "{{ item.name }}"
        state: "{{ item.state }}"
      loop: "{{ pkgutil_packages }}"
      register: pkg_result

    - name: Debug package installation
      debug:
        var: pkg_result

- name: Test Port Settings
  hosts: localhost
  gather_facts: false

  vars:
    random_ports:
      - port1: "{{ 32000 | random }}"
        state: absent
      - port2: "{{ 33000 | random }}"
        state: present
      - port3: "{{ 34000 | random }}"
        state: present

  tasks:
    - name: Test random ports
      community.general.pkgutil:
        name: "{{ item.key }}"
        port: "{{ item.value }}"
        update_catalog: yes
      loop: "{{ random_ports }}"
      register: port_result

    - name: Debug port settings
      debug:
        var: port_result