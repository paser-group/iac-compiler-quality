---
- name: Test playbook for community.general.utm_ca_host_key_cert_info
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Get info for ca host_key_cert
      community.general.utm_ca_host_key_cert_info:
        name: "my_certificate"
        state: "present"
        utm_host: "10.1.1.1"
        utm_port: "{{ port }}"
        utm_protocol: "https"
        utm_token: "my_token"
        validate_certs: true
      register: utm_ca_host_key_cert_info_result
      failed_when: utm_ca_host_key_cert_info_result is failed

  vars:
    ports: [22, 80, 443, 8080, 9000]

  tasks:
    - name: Test with random port numbers
      debug:
        msg: "Testing with port number: {{ item }}"
      loop: "{{ ports }}"
      loop_control:
        loop_var: port

    - name: Print module result
      debug:
        var: utm_ca_host_key_cert_info_result