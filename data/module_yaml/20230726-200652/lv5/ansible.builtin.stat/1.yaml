- name: Retrieve file information using ansible.builtin.stat
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random port number
      ansible.builtin.command: "{{ 20000 + (ansible_play_hosts_all | length * 1000) + (ansible_play_batch.index * 10) }}"
      register: random_port

    - name: Retrieve file stats
      ansible.builtin.stat:
        path: /path/to/file
        checksum_algorithm: md5
        follow: yes
        get_attributes: yes
        get_checksum: yes
        get_mime: yes
        my_custom_port: "{{ random_port.stdout }}"
      register: file_info

    - name: Print file information
      debug:
        var: file_info