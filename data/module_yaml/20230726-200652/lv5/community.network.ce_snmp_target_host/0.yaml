---
- name: Manage SNMP target host configuration
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Create SNMP target host
      community.network.ce_snmp_target_host:
        address: "{{ item.address }}"
        connect_port: "{{ item.connect_port }}"
        host_name: "{{ item.host_name }}"
        interface_name: "{{ item.interface_name }}"
        is_public_net: "{{ item.is_public_net }}"
        notify_type: "{{ item.notify_type }}"
        recv_port: "{{ item.recv_port }}"
        security_level: "{{ item.security_level }}"
        security_model: "{{ item.security_model }}"
        security_name: "{{ item.security_name }}"
        security_name_v3: "{{ item.security_name_v3 }}"
        version: "{{ item.version }}"
        vpn_name: "{{ item.vpn_name }}"
      loop:
        - address: "10.1.1.1"
          connect_port: 161
          host_name: "host1"
          interface_name: "eth0"
          is_public_net: "yes"
          notify_type: "trap"
          recv_port: 162
          security_level: "authorization"
          security_model: "v1"
          security_name: "snmpv1_user"
          security_name_v3: ""
          version: "v1"
          vpn_name: ""
        - address: "10.1.1.2"
          connect_port: 161
          host_name: "host2"
          interface_name: "eth1"
          is_public_net: "no"
          notify_type: "inform"
          recv_port: 163
          security_level: "privacy"
          security_model: "v2c"
          security_name: ""
          security_name_v3: "snmpv3_user"
          version: "v2c"
          vpn_name: "vpn1"

    - name: Debug output
      debug:
        var: community.network.ce_snmp_target_host

    - name: Test case - Random port number
      community.network.ce_snmp_target_host:
        address: "10.1.1.1"
        connect_port: "{{ [3000, 4000, 5000] | random }}"
        host_name: "host1"
        interface_name: "eth0"
        is_public_net: "yes"
        notify_type: "trap"
        recv_port: "{{ [6000, 7000, 8000] | random }}"
        security_level: "authorization"
        security_model: "v1"
        security_name: "snmpv1_user"
        security_name_v3: ""
        version: "v1"
        vpn_name: ""

    - name: Debug output
      debug:
        var: community.network.ce_snmp_target_host