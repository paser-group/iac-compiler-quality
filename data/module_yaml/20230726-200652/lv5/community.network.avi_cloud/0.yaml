- name: Test community.network.avi_cloud module
  hosts: localhost
  gather_facts: false

  vars:
    api_context: "{{ {'controller_ip': '10.1.1.1', 'username': 'admin', 'password': 'password'} }}"
    avi_credentials: "{{ {'username': 'admin', 'password': 'password'} }}"
    controller: "ansible-controller"
    tenant: "ansible-tenant"
    vtype: null  # Undefined attribute to trigger type-related bug

  tasks:
    - name: Create Avi Cloud using community.network.avi_cloud module
      community.network.avi_cloud:
        api_context: "{{ api_context }}"
        avi_credentials: "{{ avi_credentials }}"
        controller: "{{ controller }}"
        tenant: "{{ tenant }}"
        vtype: "{{ vtype }}"
      register: result

    - debug:
        var: result