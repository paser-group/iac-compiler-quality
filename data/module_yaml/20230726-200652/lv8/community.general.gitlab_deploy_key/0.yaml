---
- name: Test playbook for gitlab_deploy_key
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create GitLab deploy key
      community.general.gitlab_deploy_key:
        api_url: "{{ api_url }}"
        api_username: "{{ api_username }}"
        api_password: "{{ api_password }}"
        project: "{{ project }}"
        state: "{{ state }}"
        title: "{{ title }}"
        key: "{{ key }}"
        validate_certs: "{{ validate_certs }}"
        can_push: "{{ can_push | default(42) }}"  # Potential type-related bug: Setting can_push to an integer value instead of a boolean.
      register: result

    - name: Debug output
      debug:
        var: result