- name: Test for latent type-related bugs in community.general.datadog_downtime module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set variables
      vars:
        api_host: "{{ ansible_host }}"
        api_key: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
        app_key: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
        downtime_message: "This is a downtime message"
        monitor_tags: ["tag1", "tag2"]
        scope: ["host:ubuntu1"]
        start: "{{ ansible_date_time.epoch }}"
        end: "{{ ansible_date_time.epoch + 3600 }}"
        timezone: "UTC"

    - name: Create a downtime
      community.general.datadog_downtime:
        api_host: "{{ api_host }}"
        api_key: "{{ api_key }}"
        app_key: "{{ app_key }}"
        downtime_message: "{{ downtime_message }}"
        monitor_id: 12345
        monitor_tags: "{{ monitor_tags }}"
        scope: "{{ scope }}"
        start: "{{ start }}"
        end: "{{ end }}"
        timezone: "{{ timezone }}"
        state: present
      register: result

    - name: Debug result
      debug:
        var: result