---
- name: Manage STP Configuration on HUAWEI Devices
  hosts: nodes
  gather_facts: false

  tasks:
    - name: Configure STP
      community.network.ce_stp:
        provider:
          host: "{{ inventory_hostname }}"
          username: ansible
          password: secret
        interface: !null
        stp_enable: 1
        stp_mode: "mstp"
        bpdu_filter: "enabled"
        bpdu_protection: "enabled"
        cost: 10
        edged_port: "disabled"
        loop_protection: "enabled"
        root_protection: "enabled"
        state: "present"
        stp_converge: "default"
        tc_protection: "enabled"
        tc_protection_interval: 1
        tc_protection_threshold: 50

...