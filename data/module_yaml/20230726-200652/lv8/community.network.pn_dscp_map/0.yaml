---
- name: Test playbook for community.network.pn_dscp_map module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set up the network device connection
      community.network.cli:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_provider:
          pn_username: "{{ pn_username }}"
          pn_password: "{{ pn_password }}"
      register: conn

    - name: Configure DSCP map
      community.network.pn_dscp_map:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        pn_scope: "{{ pn_scope }}"
        state: present
      register: config_dscp_map
      when: conn.status == "connected"

    - name: Debug
      debug:
        var: config_dscp_map