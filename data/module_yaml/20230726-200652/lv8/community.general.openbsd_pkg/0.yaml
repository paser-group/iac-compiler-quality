---
- name: Test playbook for community.general.openbsd_pkg module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install packages
      community.general.openbsd_pkg:
        name: "{{ item.name }}"
        state: present
      loop:
        - { name: "package1" }
        - { name: "package2" }
        - { name: "package3", state: "absent" }
        - { name: "package4", snapshot: true }
        - { name: "package5", ports_dir: "/path/to/ports", state: "latest" }
      when: inventory_hostname == 'test_host1'  # Replace 'test_host1' with the actual hostname where OpenBSD is installed

    - name: Clean packages
      community.general.openbsd_pkg:
        name: "{{ item.name }}"
        state: absent
        clean: true
      loop:
        - { name: "package1", clean: false }
        - { name: "package2", clean: true }
        - { name: "package3", clean: true }
        - { name: "package4", clean: true }
      when: inventory_hostname == 'test_host1'

    - name: Build packages
      community.general.openbsd_pkg:
        name: "{{ item.name }}"
        state: present
        build: true
      loop:
        - { name: "package1", build: false }
        - { name: "package2", build: true }
        - { name: "package3", build: true }
      when: inventory_hostname == 'test_host1'