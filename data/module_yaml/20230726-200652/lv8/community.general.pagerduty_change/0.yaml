---
- hosts: localhost
  gather_facts: false
  vars:
    environment: "production"
    integration_key: "YOUR_INTEGRATION_KEY"
    link_text: !null
    link_url: !null
    repo: "example/repo"
    revision: "commit-hash"
    source: "github"
    summary: "Code has been changed"
    url: "https://github.com/example/repo/commit/commit-hash"
    user: "ansible"
    validate_certs: true

  tasks:
    - name: Track code change as PagerDuty incident
      community.general.pagerduty_change:
        environment: "{{ environment }}"
        integration_key: "{{ integration_key }}"
        link_text: "{{ link_text }}"
        link_url: "{{ link_url }}"
        repo: "{{ repo }}"
        revision: "{{ revision }}"
        source: "{{ source }}"
        summary: "{{ summary }}"
        url: "{{ url }}"
        user: "{{ user }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - debug:
        var: result