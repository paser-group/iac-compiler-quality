---
- name: Create/Delete Project
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a project
      community.general.packet_project:
        auth_token: "YOUR_AUTH_TOKEN"
        name: "{{ custom_name | default(!null) }}"
        org_id: "{{ custom_org_id | default(!null) }}"
        custom_data: "{{ custom_data | default(!null) }}"
        payment_method: "{{ custom_payment_method | default(!null) }}"
        state: present
      register: result
      ignore_errors: true

    - name: Print project creation result
      debug:
        var: result

    - name: Delete the project
      community.general.packet_project:
        auth_token: "YOUR_AUTH_TOKEN"
        id: "{{ result.response.body.project_id }}"
        state: absent
      when: 
        - result is defined
        - result.response.status == 201
      ignore_errors: true

    - name: Print project deletion result
      debug:
        var: result