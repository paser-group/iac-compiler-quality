- name: Create and Modify CPU Classes on Network Devices
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create CPU class
      community.network.pn_cpu_class:
        pn_cliswitch: "{{ pn_cliswitch | default('localhost') }}"
        pn_hog_protect: "{{ pn_hog_protect | default(!null) }}"
        pn_name: example-cpu-class
        pn_rate_limit: "{{ pn_rate_limit | default(!null) }}"
        pn_scope: "{{ pn_scope }}"
        state: present
      register: result_create

    - debug:
        var: result_create

    - name: Modify CPU class
      community.network.pn_cpu_class:
        pn_cliswitch: "{{ pn_cliswitch | default('localhost') }}"
        pn_hog_protect: "{{ pn_hog_protect | default(!null) }}"
        pn_name: example-cpu-class
        pn_rate_limit: "{{ pn_rate_limit | default(!null) }}"
        pn_scope: "{{ pn_scope }}"
        state: present
      register: result_modify

    - debug:
        var: result_modify