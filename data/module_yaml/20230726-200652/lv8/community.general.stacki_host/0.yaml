---
- name: Test ansible latent type-related bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Add hosts using stacki_host module
      community.general.stacki_host:
        appliance: "https://stacki-appliance.local"
        force_install: false
        name: "test_host"
        network: "node-net"
        prim_intf: "eth0"
        prim_intf_ip: "10.1.1.1"
        prim_intf_mac: "00:0a:95:9d:68:16"
        rack: 1
        rank: 1
        stacki_endpoint: "https://stacki-v1.local"
        stacki_password: ""
        stacki_user: "admin"
        state: "present"
      register: result

    - name: Display result
      debug:
        var: result

    - name: Remove hosts using stacki_host module
      community.general.stacki_host:
        appliance: "https://stacki-appliance.local"
        force_install: false
        name: "test_host"
        network: "node-net"
        prim_intf: "eth0"
        prim_intf_ip: "10.1.1.1"
        prim_intf_mac: "00:0a:95:9d:68:16"
        rack: 1
        rank: 1
        stacki_endpoint: "https://stacki-v1.local"
        stacki_password: ""
        stacki_user: "admin"
        state: "absent"
      register: result

    - name: Display result
      debug:
        var: result