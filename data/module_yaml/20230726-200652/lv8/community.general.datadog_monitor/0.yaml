---
- name: Test Datadog Monitor Module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Datadog Monitor
      community.general.datadog_monitor:
        api_key: "{{ api_key | default(omit) }}"
        app_key: "{{ app_key | default(omit) }}"
        type: !null
        query: "{{ query | default(omit) }}"
        name: test monitor
        state: present
        locked: !!str 'true'
        notify_no_data: !!int 'true'
        evaluation_delay: !!int 'abc'
        timeout_h: !!float 'xyz'
        renotify_interval: !!
          - value: 'abc'
            key: 'def'
        escalation_message: !!
          - value1: 'abc'
            value2: 'def'
        notification_message: !!
          - message: 'abc'
            email: 'def@example.com'
        thresholds: !!
          - value: 'abc'
            key: 'def'
        silenced: !!
          - value: 'abc'
            key: 'def'
        tags: !!
          - value: 'abc'
            key: 'def'
        include_tags: !!int 'true'
        require_full_window: !!int '100'
        no_data_timeframe: !!int 'xyz'
        new_host_delay: !!int 'abc'
        priority: !!str '-1'
        notify_audit: !!int 'true'
      register: result

    - name: Debug the result
      debug:
        var: result