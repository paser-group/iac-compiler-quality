---
- name: Test playbook for community.general.dnf_versionlock module
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Install community.general.dnf_versionlock collection
      command: ansible-galaxy collection install community.general
      
    - name: Lock package versions
      community.general.dnf_versionlock:
        name:
          - "{{ lock_packages }}"
        raw: "{{ use_raw }}"
        state: "{{ lock_state }}"
      register: result
      
    - name: Print result
      debug:
        var: result

  handlers:
    - name: Remove package version lock
      community.general.dnf_versionlock:
        name:
          - "{{ lock_packages }}"
        state: "{{ remove_state }}"
      when: result is success
      
    - name: Print result
      debug:
        var: result