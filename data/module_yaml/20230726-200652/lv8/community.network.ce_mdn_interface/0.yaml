---
- name: Manage MDN configuration on HUAWEI devices
  hosts: networking_devices
  gather_facts: false

  vars:
    ifname: "GigabitEthernet1/1/1"
    lldpenable: "enable"
    mdnstatus: "enable"
    state: "present"

  tasks:
    - name: Configure MDN interface
      community.network.ce_mdn_interface:
        ifname: "{{ ifname }}"
        lldpenable: "{{ lldpenable }}"
        mdnstatus: "{{ mdnstatus }}"
        state: "{{ state }}"
      register: result

    - name: Check result
      debug:
        var: result

    - name: Assert task failure
      assert:
        that: result.state == 'absent'
        fail_msg: "MDN interface configuration failed!"