---
- name: Test playbook for community.general.rax_scaling_policy module
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include role for community.general.rax_scaling_policy module
      include_role:
        name: ansible-galaxy.community.general.rax_scaling_policy

    - name: Create scaling policy with null values
      community.general.rax_scaling_policy:
        api_key: "{{ _api_key }}"
        at: "{{ _at }}"
        auth_endpoint: "{{ _auth_endpoint }}"
        change: "{{ _change }}"
        cooldown: "{{ _cooldown }}"
        credentials: "{{ _credentials }}"
        cron: "{{ _cron }}"
        desired_capacity: "{{ _desired_capacity }}"
        env: "{{ _env }}"
        identity_type: "{{ _identity_type }}"
        is_percent: "{{ _is_percent }}"
        name: "{{ _name }}"
        policy_type: "{{ _policy_type }}"
        region: "{{ _region }}"
        scaling_group: "{{ _scaling_group }}"
        state: "{{ _state }}"
        tenant_id: "{{ _tenant_id }}"
        tenant_name: "{{ _tenant_name }}"
        username: "{{ _username }}"
        validate_certs: "{{ _validate_certs }}"

      vars:
        _api_key: null
        _at: null
        _auth_endpoint: null
        _change: null
        _cooldown: null
        _credentials: null
        _cron: null
        _desired_capacity: null
        _env: null
        _identity_type: null
        _is_percent: null
        _name: null
        _policy_type: null
        _region: null
        _scaling_group: null
        _state: null
        _tenant_id: null
        _tenant_name: null
        _username: null
        _validate_certs: null

      register: result

    - name: Print playbook result
      debug:
        var: result

    - name: Delete scaling policy
      community.general.rax_scaling_policy:
        api_key: "{{ _api_key }}"
        at: "{{ _at }}"
        auth_endpoint: "{{ _auth_endpoint }}"
        change: "{{ _change }}"
        cooldown: "{{ _cooldown }}"
        credentials: "{{ _credentials }}"
        cron: "{{ _cron }}"
        desired_capacity: "{{ _desired_capacity }}"
        env: "{{ _env }}"
        identity_type: "{{ _identity_type }}"
        is_percent: "{{ _is_percent }}"
        name: "{{ _name }}"
        policy_type: "{{ _policy_type }}"
        region: "{{ _region }}"
        scaling_group: "{{ _scaling_group }}"
        state: "absent"
        tenant_id: "{{ _tenant_id }}"
        tenant_name: "{{ _tenant_name }}"
        username: "{{ _username }}"
        validate_certs: "{{ _validate_certs }}"

      vars:
        _api_key: null
        _at: null
        _auth_endpoint: null
        _change: null
        _cooldown: null
        _credentials: null
        _cron: null
        _desired_capacity: null
        _env: null
        _identity_type: null
        _is_percent: null
        _name: null
        _policy_type: null
        _region: null
        _scaling_group: null
        _state: null
        _tenant_id: null
        _tenant_name: null
        _username: null
        _validate_certs: null

      register: delete_result

    - name: Print deletion result
      debug:
        var: delete_result