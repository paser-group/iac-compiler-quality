---
- name: Test playbook for keycloak_clienttemplate module
  hosts: localhost
  gather_facts: false

  vars:
    auth_keycloak_url: "http://keycloak.example.com"
    auth_realm: "myrealm"
    auth_username: "admin"
    auth_password: "admin123"

  tasks:
    - name: Test creation of Keycloak client template
      community.general.keycloak_clienttemplate:
        auth_client_id: "myclient"
        auth_client_secret: "myclientsecret"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        connection_timeout: "{{ non_existent_variable }}"
        description: "Test client template"
        full_scope_allowed: true
        http_agent: "{{ null_variable }}"
        id: "clienttemplate1"
        name: !null
        protocol: "openid-connect"
        protocol_mappers:
          - name: "Email Claim"
            protocol: "openid-connect"
            protocolMapper: "oidc-usermodel-property-mapper"
            consentRequired: false
            config:
              userinfo.token.claim: "true"
              user.attribute: "email"
              claim.name: "email"
              jsonType.label: "String"
          - name: "Role Claim"
            protocol: "openid-connect"
            protocolMapper: "oidc-usermodel-property-mapper"
            consentRequired: false
            config:
              userinfo.token.claim: "true"
              user.attribute: "role"
              claim.name: "role"
              jsonType.label: "String"
        realm: "{{ auth_realm }}"
        state: "{{ 123 }}"
        token: "mytoken"
        validate_certs: "{{ true_variable }}"
      register: result