---
- name: Test playbook for taiga_issue module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create an issue in Taiga project
      community.general.taiga_issue:
        taiga_host: "https://example.taiga.io"
        project: "Example Project"
        subject: !null
        description: 123
        issue_type: "bug"
        priority: 1
        state: "present"
        tags: !null
      register: result

    - name: Debug taiga_issue result
      debug:
        var: result

    - name: Delete the created issue
      community.general.taiga_issue:
        taiga_host: "https://example.taiga.io"
        project: "Example Project"
        id: "{{ result.issue.id }}"
        state: "absent"
      when: result.issue is defined

    - name: Debug taiga_issue result after deletion
      debug:
        var: result