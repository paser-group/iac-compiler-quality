---
- hosts: localhost
  gather_facts: false
  vars:
    auth_client_id: "KEYCLOAK_CLIENT_ID"
    auth_client_secret: "KEYCLOAK_CLIENT_SECRET"
    auth_keycloak_url: "KEYCLOAK_URL"
    auth_password: "KEYCLOAK_PASSWORD"
    auth_realm: "KEYCLOAK_REALM"
    auth_username: "KEYCLOAK_USERNAME"
    connection_timeout: 10
    description: "Test Client Scope"
    http_agent: "Ansible"
    id: "test_clientscope"
    name: "Test Client Scope"
    protocol: "openid-connect"
    protocol_mappers:
      - name: "Protocol Mapper 1"
        protocol: "openid-connect"
        mapper_type: "oidc-usermodel-property-mapper"
        claim_name: "test_claim"
        userinfo_token_claim: "true"
    realm: "test_realm"
    state: "present"
    token: "KEYCLOAK_TOKEN"
    validate_certs: false

  tasks:
    - name: Create Keycloak Client Scope
      community.general.keycloak_clientscope:
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        connection_timeout: "{{ connection_timeout }}"
        description: "{{ description }}"
        http_agent: "{{ http_agent }}"
        id: "{{ id }}"
        name: "{{ name }}"
        protocol: "{{ protocol }}"
        protocol_mappers: "{{ protocol_mappers }}"
        realm: "{{ realm }}"
        state: "{{ state }}"
        token: "{{ token }}"
        validate_certs: "{{ validate_certs }}"
      register: clientscope

    - name: Debug Output
      debug:
        var: clientscope