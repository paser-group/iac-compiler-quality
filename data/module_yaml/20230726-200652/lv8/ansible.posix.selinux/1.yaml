---
- name: Change SELinux policy
  hosts: all
  gather_facts: false
  become: true

  vars:
    selinux_policy_file: "/etc/selinux/config"
    selinux_policy: !!null
    selinux_state: enforcing
    update_kernel_param: no

  tasks:
    - name: Change SELinux policy in config file
      ansible.posix.selinux:
        configfile: "{{ selinux_policy_file }}"
        policy: "{{ selinux_policy }}"
        state: "{{ selinux_state }}"
        update_kernel_param: "{{ update_kernel_param }}"
      register: selinux_result
      ignore_errors: true

    - name: Display SELinux result
      debug:
        msg: "{{ selinux_result | to_nice_json }}"