---
- name: Test scaleway_user_data module
  hosts: localhost
  gather_facts: False

  vars:
    api_timeout: 60
    api_token: "YOUR_API_TOKEN"
    api_url: "https://api.scaleway.com"
    query_parameters: {}
    region: "par1"
    server_id: "YOUR_SERVER_ID"

  tasks:
    - name: Test with empty user_data
      community.general.scaleway_user_data:
        api_timeout: "{{ api_timeout }}"
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        query_parameters: "{{ query_parameters }}"
        region: "{{ region }}"
        server_id: "{{ server_id }}"
        user_data: !null
      register: result_empty_user_data

    - name: Check result for empty user_data
      debug:
        var: result_empty_user_data

    - name: Test with invalid user_data type
      community.general.scaleway_user_data:
        api_timeout: "{{ api_timeout }}"
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        query_parameters: "{{ query_parameters }}"
        region: "{{ region }}"
        server_id: "{{ server_id }}"
        user_data: "invalid_user_data"
      register: result_invalid_user_data

    - name: Check result for invalid user_data type
      debug:
        var: result_invalid_user_data