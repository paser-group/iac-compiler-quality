---
- name: Manage BGP peer configuration
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure BGP peer
      community.network.ce_bgp_neighbor:
        provider:
          host: "{{ inventory_hostname }}"
          username: admin
          password: password
        state: present
        peer_addr: "{{ peer_address }}"
        conn_retry_time: "{{ conn_retry_time | default(!null) }}"
        connect_mode: "{{ connect_mode | default(!null) }}"
        conventional: "{{ conventional | default(!null) }}"
        description: "{{ description | default(!null) }}"
        dual_as: "{{ dual_as | default(!null) }}"
        ebgp_max_hop: "{{ ebgp_max_hop | default(!null) }}"
        fake_as: "{{ fake_as | default(!null) }}"
        hold_time: "{{ hold_time | default(!null) }}"
        is_bfd_block: "{{ is_bfd_block | default(!null) }}"
        is_bfd_enable: "{{ is_bfd_enable | default(!null) }}"
        is_ignore: "{{ is_ignore | default(!null) }}"
        is_log_change: "{{ is_log_change | default(!null) }}"
        is_single_hop: "{{ is_single_hop | default(!null) }}"
        keep_alive_time: "{{ keep_alive_time | default(!null) }}"
        key_chain_name: "{{ key_chain_name | default(!null) }}"
        local_if_name: "{{ local_if_name | default(!null) }}"
        min_hold_time: "{{ min_hold_time | default(!null) }}"
        mpls_local_ifnet_disable: "{{ mpls_local_ifnet_disable | default(!null) }}"
        multiplier: "{{ multiplier | default(!null) }}"
        prepend_fake_as: "{{ prepend_fake_as | default(!null) }}"
        prepend_global_as: "{{ prepend_global_as | default(!null) }}"
        pswd_cipher_text: "{{ pswd_cipher_text | default(!null) }}"
        pswd_type: "{{ pswd_type | default(!null) }}"
        remote_as: "{{ remote_as | default(!null) }}"
        route_refresh: "{{ route_refresh | default(!null) }}"
        rx_interval: "{{ rx_interval | default(!null) }}"
        state: "{{ state | default(!null) }}"
        tcp_MSS: "{{ tcp_MSS | default(!null) }}"
        tx_interval: "{{ tx_interval | default(!null) }}"
        valid_ttl_hops: "{{ valid_ttl_hops | default(!null) }}"
        vrf_name: "{{ vrf_name | default(!null) }}"

      register: bgp_peer_config

    - name: Debug BGP peer config
      debug:
        var: bgp_peer_config