---
- name: UTM CA Host Key Cert Playbook
  hosts: localhost
  gather_facts: false

  vars:
    state: present
    ca: example_ca
    certificate: !null
    comment: "Test certificate"
    encrypted: false
    headers:
      X-Test-Header: "Test"
    key: !null
    meta: "Test meta"
    name: "Test name"
    utm_host: "example.com"
    utm_port: 8443
    utm_protocol: "https"
    utm_token: "example_token"
    validate_certs: true

  tasks:
    - name: Create or update CA host key certificate
      community.general.utm_ca_host_key_cert:
        state: "{{ state }}"
        ca: "{{ ca }}"
        certificate: "{{ certificate }}"
        comment: "{{ comment }}"
        encrypted: "{{ encrypted }}"
        headers: "{{ headers }}"
        key: "{{ key }}"
        meta: "{{ meta }}"
        name: "{{ name }}"
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - name: Display result
      debug:
        var: result

    - name: Display certificate value
      debug:
        var: certificate