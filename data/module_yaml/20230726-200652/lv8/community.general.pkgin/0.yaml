---
- name: Install packages on Docker nodes
  hosts: all
  become: true
  gather_facts: false

  vars:
    # Define the packages to be installed
    packages:
      - package1
      - package2
      - package3

  tasks:
    - name: Update package cache
      pkgin:
        update_cache: yes

    - name: Upgrade all packages
      pkgin:
        upgrade: yes

    - name: Install packages
      pkgin:
        name: "{{ packages }}"
        state: installed

    - name: Clean package cache
      pkgin:
        clean: yes

    - name: Full system upgrade
      pkgin:
        full_upgrade: yes

    - name: Force package installation
      pkgin:
        name: package4
        state: installed
        force: yes

    - name: Remove packages
      pkgin:
        name: "{{ packages }}"
        state: absent

    - name: Remove package forcefully
      pkgin:
        name: package4
        state: absent
        force: yes