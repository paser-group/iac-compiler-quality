---
- name: Manage cron jobs
  hosts: localhost
  gather_facts: false

  vars:
    cron_job_name: "my_cron_job"
    cron_job_user: "root"
    cron_job_minute: "*"
    cron_job_hour: "*"
    cron_job_day: "*"
    cron_job_month: "*"
    cron_job_weekday: "*"
    cron_job_job: "echo 'Hello, world!'"

  tasks:
    - name: Create cron job
      ansible.builtin.cron:
        name: "{{ cron_job_name }}"
        user: "{{ cron_job_user }}"
        minute: "{{ cron_job_minute }}"
        hour: "{{ cron_job_hour }}"
        day: "{{ cron_job_day }}"
        month: "{{ cron_job_month }}"
        weekday: "{{ cron_job_weekday }}"
        job: "{{ cron_job_job }}"
        state: present
      register: result1

    - name: Print created cron job
      debug:
        var: result1

    - name: Update cron job
      ansible.builtin.cron:
        name: "{{ cron_job_name }}"
        user: "{{ cron_job_user }}"
        minute: "{{ cron_job_minute }}"
        hour: "{{ cron_job_hour }}"
        day: "{{ cron_job_day }}"
        month: "{{ cron_job_month }}"
        weekday: "{{ cron_job_weekday }}"
        job: "{{ cron_job_job }} > /dev/null"
        state: present
      register: result2

    - name: Print updated cron job
      debug:
        var: result2

    - name: Disable cron job
      ansible.builtin.cron:
        name: "{{ cron_job_name }}"
        user: "{{ cron_job_user }}"
        state: absent
      register: result3

    - name: Print disabled cron job
      debug:
        var: result3

    - name: Create cron job with special time
      ansible.builtin.cron:
        name: "{{ cron_job_name }}"
        user: "{{ cron_job_user }}"
        special_time: "@reboot"
        job: "{{ cron_job_job }}"
        state: present
      register: result4

    - name: Print cron job with special time
      debug:
        var: result4

    - name: Remove cron job with special time
      ansible.builtin.cron:
        name: "{{ cron_job_name }}"
        user: "{{ cron_job_user }}"
        state: absent
      register: result5

    - name: Print removed cron job with special time
      debug:
        var: result5