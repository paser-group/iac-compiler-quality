---
- name: PagerDuty Alert Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Trigger PagerDuty alert
      community.general.pagerduty_alert:
        api_key: "YOUR_API_KEY"
        integration_key: "YOUR_INTEGRATION_KEY"
        service_key: "YOUR_SERVICE_KEY"
        client: "Ansible Playbook"
        client_url: "https://ansible.com"
        name: "Test Alert"
        desc: "This is a test alert triggered by Ansible"
        incident_key: "TEST_ALERT"
        state: "trigger"
      register: result

    - name: Display alert result
      debug:
        var: result

    - name: Acknowledge PagerDuty alert
      community.general.pagerduty_alert:
        api_key: "YOUR_API_KEY"
        integration_key: "YOUR_INTEGRATION_KEY"
        service_key: "YOUR_SERVICE_KEY"
        incident_key: "TEST_ALERT"
        state: "acknowledge"
      register: result

    - name: Display ack result
      debug:
        var: result

    - name: Resolve PagerDuty alert
      community.general.pagerduty_alert:
        api_key: "YOUR_API_KEY"
        integration_key: "YOUR_INTEGRATION_KEY"
        service_key: "YOUR_SERVICE_KEY"
        incident_key: "TEST_ALERT"
        state: "resolve"
      register: result

    - name: Display resolve result
      debug:
        var: result