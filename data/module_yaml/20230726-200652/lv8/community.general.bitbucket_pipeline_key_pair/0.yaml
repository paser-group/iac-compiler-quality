---
- name: Test playbook for 'community.general.bitbucket_pipeline_key_pair' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install 'community.general' collection
      ansible.builtin.shell: ansible-galaxy collection install community.general

    - name: Generate Bitbucket pipeline key pair
      community.general.bitbucket_pipeline_key_pair:
        client_id: "client_id_value"
        client_secret: "client_secret_value"
        password: "{{ vault_bitbucket_password }}"  # Define this variable in the playbook or vault
        private_key: "{{ vault_private_key }}"  # Define this variable in the playbook or vault
        public_key: "{{ vault_public_key }}"  # Define this variable in the playbook or vault
        repository: "my_repository"
        state: present
        user: "my_username"
        workspace: "my_workspace"
      register: result
      ignore_errors: true

    - name: Print result
      ansible.builtin.debug:
        var: result