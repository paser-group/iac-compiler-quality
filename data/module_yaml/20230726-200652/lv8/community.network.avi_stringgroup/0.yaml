---
- name: Test playbook for community.network.avi_stringgroup module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create string group with null configuration values
      community.network.avi_stringgroup:
        controller: "10.1.1.1"
        username: "admin"
        password: "password"
        tenant: "admin"
        name: "test_string_group"
        kv:
          - key: "key1"
            value: null
      register: result
      ignore_errors: true

    - name: Check if creation failed due to type-related bug
      debug:
        var: result
      when: result is failed

    - name: Update string group with invalid configuration value
      community.network.avi_stringgroup:
        controller: "10.1.1.1"
        username: "admin"
        password: "password"
        tenant: "admin"
        name: "test_string_group"
        kv:
          - key: "key1"
            value: null
      register: result
      ignore_errors: true

    - name: Check if update failed due to type-related bug
      debug:
        var: result
      when: result is failed