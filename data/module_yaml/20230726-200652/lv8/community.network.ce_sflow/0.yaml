- name: Manage sFlow configuration on HUAWEI devices
  hosts: switches
  gather_facts: no
  vars:
    agent_ip: !null
    collector_datagram_size: !null
    collector_description: !null
    collector_id: !null
    collector_ip: !null
    collector_ip_vpn: !null
    collector_meth: !null
    collector_udp_port: !null
    counter_collector: !null
    counter_interval: !null
    export_route: !null
    sample_collector: !null
    sample_direction: !null
    sample_length: !null
    sample_rate: !null
    sflow_interface: !null
    source_ip: !null
    state: !null

  tasks:
    - name: Configure sFlow
      network.ce_sflow:
        agent_ip: "{{ agent_ip }}"
        collector_datagram_size: "{{ collector_datagram_size }}"
        collector_description: "{{ collector_description }}"
        collector_id: "{{ collector_id }}"
        collector_ip: "{{ collector_ip }}"
        collector_ip_vpn: "{{ collector_ip_vpn }}"
        collector_meth: "{{ collector_meth }}"
        collector_udp_port: "{{ collector_udp_port }}"
        counter_collector: "{{ counter_collector }}"
        counter_interval: "{{ counter_interval }}"
        export_route: "{{ export_route }}"
        sample_collector: "{{ sample_collector }}"
        sample_direction: "{{ sample_direction }}"
        sample_length: "{{ sample_length }}"
        sample_rate: "{{ sample_rate }}"
        sflow_interface: "{{ sflow_interface }}"
        source_ip: "{{ source_ip }}"
        state: "{{ state }}"
      register: result

    - name: Debug Result
      debug:
        var: result