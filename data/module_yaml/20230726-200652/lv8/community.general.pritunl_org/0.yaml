---
- name: Manage Pritunl Organizations
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Pritunl Organization
      community.general.pritunl_org:
        name: MyOrg
        pritunl_api_secret: secret
        pritunl_api_token: token
        pritunl_url: https://pritunl.example.com
        force: false
        state: present
        validate_certs: true
      register: result
      ignore_errors: true

    - name: Validate Pritunl Organization creation
      assert:
        that:
          - result is success
          - result.changed is true
      ignore_errors: true

    - name: Update Pritunl Organization
      community.general.pritunl_org:
        name: MyOrg
        pritunl_api_secret: secret
        pritunl_api_token: token
        pritunl_url: https://pritunl.example.com
        force: false
        state: present
        validate_certs: true
      register: result
      ignore_errors: true

    - name: Validate Pritunl Organization update
      assert:
        that:
          - result is success
          - result.changed is true
      ignore_errors: true

    - name: Delete Pritunl Organization
      community.general.pritunl_org:
        name: MyOrg
        pritunl_api_secret: secret
        pritunl_api_token: token
        pritunl_url: https://pritunl.example.com
        force: false
        state: absent
        validate_certs: true
      register: result
      ignore_errors: true

    - name: Validate Pritunl Organization deletion
      assert:
        that:
          - result is success
          - result.changed is true
      ignore_errors: true