---
- name: Test Playbook to Reveal Type-Related Bugs in community.general.github_repo module
  hosts: localhost
  gather_facts: false
  vars:
    github_credentials:
      username: ansible_user
      password: ansible_pass
      access_token: ansible_token
    github_api_url: "https://api.github.com"
    github_organization: "ansible"
  tasks:
    - name: Create a public GitHub repository
      community.general.github_repo:
        name: "test-repo"
        api_url: "{{ github_api_url }}"
        organization: "{{ github_organization }}"
        username: "{{ github_credentials.username }}"
        password: "{{ github_credentials.password }}"
        access_token: "{{ github_credentials.access_token }}"
        private: false
        state: present
      register: create_repo
      
    - name: Debug create_repo results
      debug:
        var: create_repo

    - name: Update the repository description
      community.general.github_repo:
        name: "test-repo"
        api_url: "{{ github_api_url }}"
        organization: "{{ github_organization }}"
        username: "{{ github_credentials.username }}"
        password: "{{ github_credentials.password }}"
        access_token: "{{ github_credentials.access_token }}"
        description: null
        force_defaults: true
        state: present
      register: update_repo

    - name: Debug update_repo results
      debug:
        var: update_repo