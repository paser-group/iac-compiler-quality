---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a new VM
      proxmox_kvm:
        api_user: "admin@pam"                # Set the Proxmox API user
        api_password: "password"             # Set the Proxmox API password
        api_host: "https://proxmox.example.com:8006/api2/json"  # Set the Proxmox API host
        vmid: 100                            # Set the Virtual Machine ID
        name: "test-vm"                      # Set the Virtual Machine name
        ostype: "ubuntu"                     # Set the OS type
        memory: 2048                         # Set the memory size
        cores: 2                             # Set the number of CPU cores
        sockets: 1                           # Set the number of CPU sockets
        bootdisk: "scsi0"                    # Set the boot disk
        delete: "yes"                        # Set the deletion flag
        clone: "test-template"                # Set the VM to be cloned
        state: "started"                     # Set the state of the VM
        validate_certs: false                # Disable SSL certificate validation

      register: result

    - name: Show the result
      debug:
        var: result