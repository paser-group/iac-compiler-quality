---
- name: Test playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a consul session
      community.general.consul_session:
        state: "present"
        checks: ["check1", "check2"]
        datacenter: "dc1"
        delay: 10
        host: "localhost"
        id: "session1"
        name: "session-name"
        node: "node1"
        port: 8500
        scheme: "http"
        token: "consul-token"
        ttl: 30
        validate_certs: true
      register: session_result
    - debug:
        var: session_result

    - name: Update consul session
      community.general.consul_session:
        state: "present"
        checks: !null
        datacenter: "dc1"
        delay: 10
        host: "localhost"
        id: "session1"
        name: "session-name"
        node: "node1"
        port: 8500
        scheme: "http"
        token: "consul-token"
        ttl: 30
        validate_certs: true
      register: update_result
    - debug:
        var: update_result