---
- name: Test playbook for community.network.pn_user module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate varied encodings for the module parameters
      shell: echo 'Username' | iconv -t UTF-8
      register: pn_name_utf8

    - name: Create user on PN switch
      community.network.pn_user:
        pn_cliswitch: "{{ pn_cliswitch | default('switch') }}"
        pn_initial_role: "{{ pn_initial_role | default('admin') }}"
        pn_name: "{{ pn_name_utf8.stdout }}"
        pn_password: "{{ pn_password | default('password123') }}"
        pn_scope: "{{ pn_scope | default('local') }}"
        state: "{{ state | default('present') }}"
      register: result

    - name: Print module output
      debug:
        var: result