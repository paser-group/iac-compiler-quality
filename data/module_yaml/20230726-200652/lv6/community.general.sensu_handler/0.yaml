---
- name: Manage Sensu handlers
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set Ansible facts
      set_fact:
        sensu_handlers:
          - name: handler1
            command: "echo 'Handler 1 executed'"
            severities: ['critical', 'warning']
          - name: handler2
            command: "echo 'Handler 2 executed'"
            severities: ['info', 'success']

    - name: Include Sensu handlers configuration
      include_tasks: sensu_handler.yml
      vars:
        handlers: "{{ sensu_handlers }}"
        test_cases: true