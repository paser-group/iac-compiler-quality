---
- name: Test playbook for rax_mon_entity module
  hosts: localhost
  connection: local
  gather_facts: no

  tasks:
    - name: Create a Rackspace Cloud Monitoring entity
      community.general.rax_mon_entity:
        agent_id: 12345
        api_key: "api_key1"
        auth_endpoint: "auth.rackspace.com"
        credentials: "/path/to/credentials"
        env: "prod"
        identity_type: "rack"
        label: "entity1"
        metadata:
          key1: "value1"
          key2: "value2"
        named_ip_addresses: "10.1.1.1"
        region: "DFW"
        state: "present"
        tenant_id: "tenant1"
        tenant_name: "tenant1"
        username: "username1"
        validate_certs: "false"
      register: result

    - name: Debug Result
      debug:
        var: result

    - name: Delete the Rackspace Cloud Monitoring entity
      community.general.rax_mon_entity:
        agent_id: 12345
        api_key: "api_key1"
        auth_endpoint: "auth.rackspace.com"
        credentials: "/path/to/credentials"
        env: "prod"
        identity_type: "rack"
        label: "entity1"
        metadata:
          key1: "value1"
          key2: "value2"
        named_ip_addresses: ["10.1.1.1"]
        region: "DFW"
        state: "absent"
        tenant_id: "tenant1"
        tenant_name: "tenant1"
        username: "username1"
        validate_certs: "false"
      register: result

    - name: Debug Result
      debug:
        var: result