- name: Test playbook for community.network.avi_api_version module
  hosts: localhost
  gather_facts: false

  vars:
    # Define the inventory for the Avi controller
    avi_inventory:
      config_settings:
        module_utils:
          community.network.avi_api_version:
            controller: "{{ controller }}"
            avi_credentials:
              controller: "{{ controller }}"
              username: "{{ username }}"
              password: "{{ password }}"
              tenant: "{{ tenant }}"
              # Uncomment the below line if using tenant_uuid instead of tenant for authentication
              # tenant_uuid: "{{ tenant_uuid }}"
            api_version: "{{ api_version }}"
            api_context:
              - cloud: Default-Cloud
                tenant: "{{ tenant }}"
                # Uncomment the below line if using tenant_uuid instead of tenant for authentication
                # tenant_uuid: "{{ tenant_uuid }}"
            avi_disable_session_cache_as_fact: "{{ avi_disable_session_cache_as_fact | default(false) }}"

  tasks:
    - name: Test avi_api_version module
      community.network.avi_api_version:
        controller: "{{ controller }}"
        avi_credentials:
          controller: "{{ controller }}"
          username: "{{ username }}"
          password: "{{ password }}"
          tenant: "{{ tenant }}"
          # Uncomment the below line if using tenant_uuid instead of tenant for authentication
          # tenant_uuid: "{{ tenant_uuid }}"
        api_version: "{{ api_version }}"
        api_context:
          - cloud: Default-Cloud
            tenant: "{{ tenant }}"
            # Uncomment the below line if using tenant_uuid instead of tenant for authentication
            # tenant_uuid: "{{ tenant_uuid }}"
        avi_disable_session_cache_as_fact: "{{ avi_disable_session_cache_as_fact | default(false) }}"
      register: result

    - name: Debug result
      debug:
        var: result