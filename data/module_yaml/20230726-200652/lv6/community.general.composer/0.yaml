---
- name: Test playbook for community.general.composer module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install required packages
      become: true
      apt:
        name: docker.io
        state: present

    - name: Create Docker network
      become: true
      docker_network:
        name: node-net
        subnet: 10.1.1.0/24
        gateway: 10.1.1.254

    - name: Create Docker containers
      become: true
      docker_container:
        name: ubuntu1
        image: ubuntu
        command: sleep infinity
        networks:
          - name: node-net
            ipv4_address: 10.1.1.1

    - name: Create Docker containers
      become: true
      docker_container:
        name: alpine1
        image: alpine
        command: sleep infinity
        networks:
          - name: node-net
            ipv4_address: 10.1.1.2

    - name: Create Docker containers
      become: true
      docker_container:
        name: centos1
        image: centos
        command: sleep infinity
        networks:
          - name: node-net
            ipv4_address: 10.1.1.3

    - name: Create Docker containers
      become: true
      docker_container:
        name: redhat1
        image: redhat
        command: sleep infinity
        networks:
          - name: node-net
            ipv4_address: 10.1.1.4

    - name: Install 'composer' package
      community.general.composer:
        executable: /usr/bin/composer
        global_command: true
        working_dir: /path/to/project
        apcu_autoloader: true
        arguments: install
        classmap_authoritative: true
        command: require
        ignore_platform_reqs: true
        no_dev: true
        no_plugins: true
        no_scripts: true
        optimize_autoloader: true
        prefer_dist: true
        prefer_source: true