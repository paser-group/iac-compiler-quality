---
- name: Test reachability using ping
  hosts: all
  gather_facts: false

  tasks:
    - name: Set encoded strings
      set_fact:
        dest: "{{ '10.1.1.1'.encode('base64','strict') }}"
        source: "{{ '10.1.1.2'.encode('utf-16','strict') }}"

    - name: Ping hosts
      net_ping:
        count: "{{ count | default(5) }}"
        dest: "{{ dest | default('') }}"
        source: "{{ source | default('') }}"
        state: "{{ state | default('present') }}"
        vrf: "{{ vrf | default('') }}"
      register: ping_result

    - name: Debug ping output
      debug:
        var: ping_result