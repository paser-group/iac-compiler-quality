---
- name: Create and Delete Taiga Issues
  hosts: localhost
  gather_facts: false

  vars:
    attachment_path: "/path/to/attachment"
    attachment_description: "Attachment Description"
    taiga_host: "https://example.taiga.io"
    taiga_username: "your_username"
    taiga_password: "your_password"
    project_slug: "your_project_slug"

  tasks:
    - name: Create Taiga Issue
      community.general.taiga_issue:
        taiga_host: "{{ taiga_host }}"
        taiga_username: "{{ taiga_username }}"
        taiga_password: "{{ taiga_password }}"
        project_slug: "{{ project_slug }}"
        subject: "Test Issue"
        description: "Test Issue Description"
        issue_type: "Bug"
        priority: "High"
        severity: "Critical"
        state: "Open"
        status: "To Do"
        tags:
          - tag1
          - tag2
      register: created_issue

    - name: Print Created Issue
      debug:
        var: created_issue

    - name: Delete Taiga Issue
      community.general.taiga_issue:
        taiga_host: "{{ taiga_host }}"
        taiga_username: "{{ taiga_username }}"
        taiga_password: "{{ taiga_password }}"
        project_slug: "{{ project_slug }}"
        issue_id: "{{ created_issue.id }}"
        state: "Closed"
      register: deleted_issue

    - name: Print Deleted Issue
      debug:
        var: deleted_issue