- name: Lock/Unlock Packages
  hosts: all
  gather_facts: false
  tasks:
    - name: Lock packages
      community.general.yum_versionlock:
        name: "{{ item }}"
        state: "{{ state }}"
      with_items:
        - "{{ package1 | b64encode }}"
        - "{{ package2 | encode('utf-8') }}"
        - "{{ package3 | b64encode }}"

    - name: Unlock packages
      community.general.yum_versionlock:
        name: "{{ item }}"
        state: "{{ state }}"
      with_items:
        - "{{ package1 | b64encode }}"
        - "{{ package2 | encode('utf-8') }}"
        - "{{ package3 | b64encode }}"