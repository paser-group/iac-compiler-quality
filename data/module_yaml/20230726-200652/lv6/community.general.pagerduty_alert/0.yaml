---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Trigger/acknowledge/resolve incidents with varied encodings
      community.general.pagerduty_alert:
        integration_key: "{{ integration_key }}"
        service_id: "{{ service_id }}"
        desc: "{{ desc }}"
        incident_key: "{{ incident_key }}"
        state: "{{ state }}"
      vars:
        integration_key: "YOUR_INTEGRATION_KEY"
        service_id: "YOUR_SERVICE_ID"
        desc: "{{ item }}"
        incident_key: "incident-key-123"
        state: "{{ state }}"
      with_items:
        - "Test description with varied encodings: áñsíblé"
        - "\u00E1\u00F1s\u00EDbl\u00E9"
        - "\xE1\xF1s\xEDbl\xE9"
      register: result
      ignore_errors: true