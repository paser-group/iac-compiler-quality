---
- name: Test community.general.ssh_config module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Test ssh_config module
      community.general.ssh_config:
        forward_agent: "{{ forward_agent | bool }}"
        group: "{{ group }}"
        host: "{{ host }}"
        host_key_algorithms: "{{ host_key_algorithms }}"
        hostname: "{{ hostname }}"
        identity_file: "{{ identity_file }}"
        port: "{{ port }}"
        proxycommand: "{{ proxycommand }}"
        proxyjump: "{{ proxyjump }}"
        remote_user: "{{ remote_user }}"
        ssh_config_file: "{{ ssh_config_file }}"
        state: "{{ state }}"
        strict_host_key_checking: "{{ strict_host_key_checking }}"
        user: "{{ user }}"
        user_known_hosts_file: "{{ user_known_hosts_file }}"
      vars:
        forward_agent: yes
        group: mygroup
        host: "{{ inventory_hostname }}"
        host_key_algorithms: "ssh-rsa,ssh-dss"
        hostname: "{{ hostvars['localhost'].ansible_host }}"
        identity_file: "/path/to/identity_file"
        port: "22"
        proxycommand: "ssh -q -W %h:%p gateway"
        proxyjump: "{{ proxyjump }}"
        remote_user: "root"
        ssh_config_file: "/path/to/ssh_config"
        state: present
        strict_host_key_checking: yes
        user: "{{ ansible_user }}"
        user_known_hosts_file: "/path/to/known_hosts"