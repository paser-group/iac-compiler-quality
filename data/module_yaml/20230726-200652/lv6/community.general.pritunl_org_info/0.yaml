---
- name: Test Pritunl Organizations
  hosts: localhost
  gather_facts: false

  vars:
    organization: "{{ lookup('env', 'PRITUNL_ORG') }}"
    pritunl_url: "{{ lookup('env', 'PRITUNL_URL') }}"
    pritunl_api_secret: "{{ lookup('env', 'PRITUNL_API_SECRET') }}"
    pritunl_api_token: "{{ lookup('env', 'PRITUNL_API_TOKEN') }}"
    validate_certs: "{{ lookup('env', 'PRITUNL_VALIDATE_CERTS') | default('true') | bool}}"

  tasks:
    - name: Get Pritunl Organization Info
      community.general.pritunl_org_info:
        organization: "{{ organization }}"
        pritunl_url: "{{ pritunl_url }}"
        pritunl_api_secret: "{{ pritunl_api_secret }}"
        pritunl_api_token: "{{ pritunl_api_token }}"
        validate_certs: "{{ validate_certs }}"
      register: org_info

    - name: Print Pritunl Organization Info
      debug:
        var: org_info.result