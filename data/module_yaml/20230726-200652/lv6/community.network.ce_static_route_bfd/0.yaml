- name: Manage static route configuration
  hosts: huawei_devices
  gather_facts: false

  tasks:
    - name: Configure static routes with BFD
      community.network.ce_static_route_bfd:
        aftype: "{{ item.aftype }}"
        bfd_session_name: "{{ item.bfd_session_name }}"
        commands:
          - "{{ item.commands }}"
        description: "{{ item.description }}"
        destvrf: "{{ item.destvrf }}"
        detect_multiplier: "{{ item.detect_multiplier }}"
        function_flag: "{{ item.function_flag }}"
        mask: "{{ item.mask }}"
        min_rx_interval: "{{ item.min_rx_interval }}"
        min_tx_interval: "{{ item.min_tx_interval }}"
        next_hop: "{{ item.next_hop }}"
        nhp_interface: "{{ item.nhp_interface }}"
        pref: "{{ item.pref }}"
        prefix: "{{ item.prefix }}"
        state: "{{ item.state }}"
        tag: "{{ item.tag }}"
        vrf: "{{ item.vrf }}"
      loop: "{{ test_cases }}"

  vars:
    test_cases:
      - aftype: "ipv4"
        bfd_session_name: "session1"
        commands:
          - "ip static-route 10.0.0.0/24 {{ mask }}"
        description: "Static route 1"
        destvrf: "vrf1"
        detect_multiplier: 3
        function_flag: "local"
        mask: "255.255.255.0"
        min_rx_interval: 300
        min_tx_interval: 300
        next_hop: "10.1.1.254"
        nhp_interface: "GigabitEthernet 0/0/1"
        pref: 100
        prefix: "10.0.0.0/24"
        state: "present"
        tag: 10
        vrf: "default"
      
      - aftype: "ipv6"
        bfd_session_name: "session2"
        commands:
          - "ipv6 static-route 2001:db8::1/64 {{ mask }}"
        description: "Static route 2"
        destvrf: "vrf2"
        detect_multiplier: 2
        function_flag: "remote"
        mask: "64"
        min_rx_interval: 200
        min_tx_interval: 200
        next_hop: "fe80::1"
        nhp_interface: "GigabitEthernet 0/0/2"
        pref: 200
        prefix: "2001:db8::/64"
        state: "absent"
        tag: 20
        vrf: "management"