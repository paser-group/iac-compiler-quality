- name: Test community.general.catapult module
  hosts: localhost
  gather_facts: false
  vars:
    api_token: "API_TOKEN"
    api_secret: "API_SECRET"
    dest:
      - "DESTINATION_1"
      - "DESTINATION_2"
    msg: "This is a test message"
    src: "SENDER"
    user_id: "USER_ID"
    media: "IMAGE_PATH"

  tasks:
    - name: Generate strings with varied encodings
      set_fact:
        encoded_dest: "{{ dest | b64encode }}"
        encoded_msg: "{{ msg | b64encode }}"
        encoded_src: "{{ src | b64encode }}"
        encoded_user_id: "{{ user_id | b64encode }}"

    - name: Print encoded strings
      debug:
        msg:
          - "Encoded Dest: {{ encoded_dest }}"
          - "Encoded Msg: {{ encoded_msg }}"
          - "Encoded Src: {{ encoded_src }}"
          - "Encoded User ID: {{ encoded_user_id }}"

    - name: Send SMS/MMS
      community.general.catapult:
        api_token: "{{ api_token }}"
        api_secret: "{{ api_secret }}"
        dest: "{{ encoded_dest }}"
        media: "{{ encoded_media }}"
        msg: "{{ encoded_msg }}"
        src: "{{ encoded_src }}"
        user_id: "{{ encoded_user_id }}"