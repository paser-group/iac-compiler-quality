---
- hosts: switches
  gather_facts: false

  tasks:
    - name: Read ASCII encoded string
      set_fact:
        ascii_string: "{{ lookup('file', 'ascii.txt') }}"

    - name: Read UTF-8 encoded string
      set_fact:
        utf8_string: "{{ lookup('file', 'utf8.txt') }}"

    - name: Read non-ASCII encoded string
      set_fact:
        non_ascii_string: "{{ lookup('file', 'non_ascii.txt') }}"

    - name: Restart the switch device with ASCII string
      community.network.cnos_reload:
        deviceType: "{{ device_type }}"
        host: "{{ inventory_hostname }}"
        username: "{{ username }}"
        password: "{{ password }}"
        enablePassword: "{{ enable_password }}"
        outputfile: "{{ output_file }}"
        debug: yes
        string_param: "{{ ascii_string }}"
      register: result_ascii

    - name: Restart the switch device with UTF-8 string
      community.network.cnos_reload:
        deviceType: "{{ device_type }}"
        host: "{{ inventory_hostname }}"
        username: "{{ username }}"
        password: "{{ password }}"
        enablePassword: "{{ enable_password }}"
        outputfile: "{{ output_file }}"
        debug: yes
        string_param: "{{ utf8_string }}"
      register: result_utf8

    - name: Restart the switch device with non-ASCII string
      community.network.cnos_reload:
        deviceType: "{{ device_type }}"
        host: "{{ inventory_hostname }}"
        username: "{{ username }}"
        password: "{{ password }}"
        enablePassword: "{{ enable_password }}"
        outputfile: "{{ output_file }}"
        debug: yes
        string_param: "{{ non_ascii_string }}"
      register: result_non_ascii

    - name: Print result with ASCII string
      debug:
        var: result_ascii

    - name: Print result with UTF-8 string
      debug:
        var: result_utf8

    - name: Print result with non-ASCII string
      debug:
        var: result_non_ascii