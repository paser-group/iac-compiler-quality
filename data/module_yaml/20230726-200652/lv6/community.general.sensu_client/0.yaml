---

- name: Manage Sensu Clients
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install required packages
      package:
        name: sensu-client
        state: present

    - name: Configure Sensu Client
      community.general.sensu_client:
        address: "{{ address }}"
        chef: "{{ chef }}"
        deregister: "{{ deregister }}"
        deregistration: "{{ deregistration }}"
        ec2: "{{ ec2 }}"
        keepalive: "{{ keepalive }}"
        keepalives: "{{ keepalives }}"
        name: "{{ name }}"
        puppet: "{{ puppet }}"
        redact: "{{ redact }}"
        registration: "{{ registration }}"
        safe_mode: "{{ safe_mode }}"
        servicenow: "{{ servicenow }}"
        socket: "{{ socket }}"
        state: "{{ state }}"
        subscriptions: "{{ subscriptions }}"
      register: result

    - name: Display result
      debug:
        var: result