- name: Test playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create SSH key
      community.general.packet_sshkey:
        auth_token: "{{ packet_auth_token }}"
        key: "{{ private_key }}"
        key_file: "{{ private_key_file }}"
        label: "{{ ssh_key_label }}"
        state: present
      register: result
      no_log: true

    - name: Print create result
      debug:
        var: result

    - name: Delete SSH key
      community.general.packet_sshkey:
        auth_token: "{{ packet_auth_token }}"
        key: "{{ private_key }}"
        key_file: "{{ private_key_file }}"
        label: "{{ ssh_key_label }}"
        state: absent
      no_log: true