---
- name: Test Playbook
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Test Task
      community.general.ipa_service:
        force: "{{ item.force }}"
        hosts: "{{ item.hosts }}"
        ipa_host: "{{ item.ipa_host }}"
        ipa_pass: "{{ item.ipa_pass }}"
        ipa_port: "{{ item.ipa_port }}"
        ipa_prot: "{{ item.ipa_prot }}"
        ipa_timeout: "{{ item.ipa_timeout }}"
        ipa_user: "{{ item.ipa_user }}"
        krbcanonicalname: "{{ item.krbcanonicalname }}"
        skip_host_check: "{{ item.skip_host_check }}"
        state: "{{ item.state }}"
        validate_certs: "{{ item.validate_certs }}"
      loop:
        - force: true
          hosts:
            - ubuntu1
          ipa_host: "10.1.1.1"
          ipa_pass: "password1"
          ipa_port: 1234
          ipa_prot: "tcp"
          ipa_timeout: 30
          ipa_user: "admin"
          krbcanonicalname: "test"
          skip_host_check: false
          state: "present"
          validate_certs: true

        - force: false
          hosts:
            - alpine1
            - centos1
            - redhat1
          ipa_host: "10.1.1.2"
          ipa_pass: "!password!@#$%^&*()_+"
          ipa_port: 5678
          ipa_prot: "udp"
          ipa_timeout: 60
          ipa_user: "ipauser"
          krbcanonicalname: "test2"
          skip_host_check: true
          state: "absent"
          validate_certs: false