---
- name: Test playbook for community.network.avi_cloud module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate strings with varied encodings
      script: |
        import sys

        encodings = ['utf-8', 'utf-16', 'latin-1', 'ascii']
        strings = ['test', 'ansible', 'playbook', 'bug', 'community']

        for encoding in encodings:
          for string in strings:
            try:
              encoded_string = string.encode(encoding)
              decoded_string = encoded_string.decode(encoding)
              if string != decoded_string:
                sys.exit(1)
            except UnicodeEncodeError:
              continue

    - name: Setup Clo..."
      community.network.avi_cloud:
        controller: "10.1.1.1"
        username: "admin"
        password: "password"
        tenant: "default"
        api_version: "20.1.3"
        state: "present"
        name: "test-cloud"
        avi_credentials:
          username: "admin"
          password: "password"
        dns_provider_ref: "dns-provider-ref"
        tenant_ref: "/api/tenant?name=default"
      register: result

    - name: Debug module output
      debug:
        var: result