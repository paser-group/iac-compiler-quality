---
- name: Apply patch files
  hosts: all
  become: true

  tasks:
    - name: Generate strings with varied encodings
      include_tasks: generate_strings.yml

    - name: Apply patch
      ansible.posix.patch:
        backup: yes
        basedir: /tmp
        binary: no
        dest: "{{ dest_string }}"
        ignore_whitespace: yes
        remote_src: no
        src: "{{ src_string }}"
        state: present
        strip: 1