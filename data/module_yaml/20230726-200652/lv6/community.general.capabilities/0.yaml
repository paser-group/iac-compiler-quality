---
- name: Test playbook for community.general.capabilities
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install prerequisites
      package:
        name: libcap2-bin
        state: present

    - name: Generate strings with varied encodings
      set_fact:
        strings: "{{ ['plain string', 'utf-8 エンコーディング'] | random }}"
      changed_when: false

    - name: Print generated strings
      debug:
        var: strings

    - name: Set capabilities
      community.general.capabilities:
        capability: "{{ strings }}"
        path: "/path/to/file"
        state: present