---
- name: Collect Facts from Remote Devices
  hosts: all
  gather_facts: false

  tasks:
    - name: Generate Encoded Strings
      set_fact:
        encoded_strings:
          - "{{ 'test' | b64encode }}"
          - "{{ 'test' | urlencode }}"
          - "{{ 'test' | json_query('[0:1]') }}"
      
    - name: Gather EdgeOS Facts
      community.network.edgeos_facts:
        gather_subset: none
        api_key: "{{ item }}"
      loop: "{{ encoded_strings }}"