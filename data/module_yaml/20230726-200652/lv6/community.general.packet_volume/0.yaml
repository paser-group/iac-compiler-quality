---
- name: Test playbook for Ansible latent type-related bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a packet volume
      community.general.packet_volume:
        auth_token: "{{ auth_token }}"
        billing_cycle: "{{ billing_cycle }}"
        description: "{{ description }}"
        facility: "{{ facility }}"
        id: "{{ id }}"
        locked: "{{ locked }}"
        name: "{{ name }}"
        plan: "{{ plan }}"
        project_id: "{{ project_id }}"
        size: "{{ size }}"
        snapshot_policy: "{{ snapshot_policy }}"
        state: present
      register: result

- name: Test cases for encoding variations
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set test values with different encodings
      set_fact:
        test_values: "{{ test_values | default([]) + [item] }}"
      loop:
        - "test string"
        - "\u0074\u0065\u0073\u0074 \u0073\u0074\u0072\u0069\u006e\u0067"
        - "\xf0\x9f\x98\x8a"  # Unicode smiley face

    - name: Print test values
      debug:
        var: test_values

    - name: Create packet volume with test values
      community.general.packet_volume:
        auth_token: "{{ auth_token }}"
        billing_cycle: "{{ billing_cycle }}"
        description: "{{ description }}"
        facility: "{{ facility }}"
        id: "{{ id }}"
        locked: "{{ locked }}"
        name: "{{ item }}"
        plan: "{{ plan }}"
        project_id: "{{ project_id }}"
        size: "{{ size }}"
        snapshot_policy: "{{ snapshot_policy }}"
        state: present
      loop: "{{ test_values }}"
      ignore_errors: true
      register: test_result

    - name: Debug test result
      debug:
        var: test_result