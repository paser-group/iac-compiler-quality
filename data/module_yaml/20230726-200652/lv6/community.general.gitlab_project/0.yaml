- name: Create or update GitLab project
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create GitLab project
      community.general.gitlab_project:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "your_api_token"
        state: "{{ state }}"
        name: "{{ name }}"
        description: "{{ description }}"
        visibility: "{{ visibility }}"
        default_branch: "{{ default_branch }}"
        only_allow_merge_if_pipeline_succeeds: "{{ only_allow_merge_if_pipeline_succeeds }}"
        allow_merge_on_skipped_pipeline: "{{ allow_merge_on_skipped_pipeline }}"
        remove_source_branch_after_merge: "{{ remove_source_branch_after_merge }}"
        squash_option: "{{ squash_option }}"
        path: "{{ path }}"
        group: "{{ group }}"
        username: "{{ username }}"
        api_job_token: "{{ api_job_token }}"
        api_oauth_token: "{{ api_oauth_token }}"
        api_password: "{{ api_password }}"
        avatar_path: "{{ avatar_path }}"
        builds_access_level: "{{ builds_access_level }}"
        ci_config_path: "{{ ci_config_path }}"
        container_registry_access_level: "{{ container_registry_access_level }}"
        environments_access_level: "{{ environments_access_level }}"
        feature_flags_access_level: "{{ feature_flags_access_level }}"
        forking_access_level: "{{ forking_access_level }}"
        import_url: "{{ import_url }}"
        infrastructure_access_level: "{{ infrastructure_access_level }}"
        initialize_with_readme: "{{ initialize_with_readme }}"
        issues_enabled: "{{ issues_enabled }}"
        lfs_enabled: "{{ lfs_enabled }}"
        merge_method: "{{ merge_method }}"
        merge_requests_enabled: "{{ merge_requests_enabled }}"
        monitor_access_level: "{{ monitor_access_level }}"
        only_allow_merge_if_all_discussions_are_resolved: "{{ only_allow_merge_if_all_discussions_are_resolved }}"
        packages_enabled: "{{ packages_enabled }}"
        releases_access_level: "{{ releases_access_level }}"
        security_and_compliance_access_level: "{{ security_and_compliance_access_level }}"
        shared_runners_enabled: "{{ shared_runners_enabled }}"
        snippets_enabled: "{{ snippets_enabled }}"
        topics: "{{ topics }}"
        validate_certs: "{{ validate_certs }}"
        wiki_enabled: "{{ wiki_enabled }}"

      register: result

    - name: Print the result
      debug:
        var: result