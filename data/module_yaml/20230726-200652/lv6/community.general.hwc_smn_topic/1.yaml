---
- name: Create SMNTopic resource
  hosts: localhost
  gather_facts: false

  vars:
    display_name: "Test Topic"
    domain: "test_domain"
    id: "test_id"
    identity_endpoint: "http://example.com"
    name: "test_name"
    password: "test_password"
    project: "test_project"
    region: "test_region"
    state: "present"
    user: "test_user"

  tasks:
    - name: Generate test cases
      shell: |
        echo "invalid_encoding1:\x80" > test_cases.yml
        echo "invalid_encoding2:\x00\x01" >> test_cases.yml
        echo "valid_encoding1:{{ name | b64encode }}" >> test_cases.yml
        echo "valid_encoding2:{{ display_name | b64encode }}" >> test_cases.yml

    - name: Load test cases
      include_vars:
        file: test_cases.yml

    - name: Create SMNTopic
      community.general.hwc_smn_topic:
        display_name: "{{ display_name }}"
        domain: "{{ domain }}"
        id: "{{ id }}"
        identity_endpoint: "{{ identity_endpoint }}"
        name: "{{ name }}"
        password: "{{ password }}"
        project: "{{ project }}"
        region: "{{ region }}"
        state: "{{ state }}"
        user: "{{ user }}"
      register: result

    - name: Display result
      debug:
        var: result