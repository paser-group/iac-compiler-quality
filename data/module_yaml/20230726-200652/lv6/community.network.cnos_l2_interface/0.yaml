---
- name: Manage Layer-2 interface
  hosts: network_device
  gather_facts: false
  connection: network_cli

  tasks:
    - name: Create Layer-2 interface
      community.network.cnos_l2_interface:
        access_vlan: "{{ item.access_vlan }}"
        aggregate: "{{ item.aggregate }}"
        mode: "{{ item.mode }}"
        name: "{{ item.name }}"
        native_vlan: "{{ item.native_vlan }}"
        state: "{{ item.state }}"
        trunk_allowed_vlans: "{{ item.trunk_allowed_vlans }}"
        trunk_vlans: "{{ item.trunk_vlans }}"
      loop:
        - { access_vlan: None, aggregate: None, mode: None, name: None, native_vlan: None, state: None, trunk_allowed_vlans: None, trunk_vlans: None }
        - { access_vlan: "10", aggregate: "true", mode: "trunk", name: "interface1", native_vlan: "20", state: "absent", trunk_allowed_vlans: "10,20,30", trunk_vlans: "10,20,30" }

    - name: Print output
      debug:
        var: ansible_facts['community_network_cnosp_l2_interface']