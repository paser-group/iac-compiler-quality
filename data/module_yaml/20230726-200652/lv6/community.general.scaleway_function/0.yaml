---
- name: Ansible Latent Bug Finder Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create scaleway function
      community.general.scaleway_function:
        api_timeout: 30
        api_token: "YOUR_API_TOKEN"
        api_url: "https://api.scaleway.com"
        description: "My Scaleway Function"
        environment_variables:
          VAR1: "Value1"
          VAR2: "Value2"
        function_timeout: "30"
        handler: "main.handler"
        max_scale: 5
        memory_limit: 128
        min_scale: 1
        name: "my-function"
        namespace_id: "NAMESPACE_ID"
        privacy: "public"
        query_parameters:
          param1: "value1"
          param2: "value2"
        redeploy: true
        region: "par1"
        runtime: "python3.7"
        secret_environment_variables:
          SEC_VAR1: "SecretValue1"
          SEC_VAR2: "SecretValue2"
        state: present
        validate_certs: true
        wait: false
        wait_sleep_time: 10
        wait_timeout: 300
      register: scaleway_function_result

    - name: Debug scaleway function
      debug:
        var: scaleway_function_result