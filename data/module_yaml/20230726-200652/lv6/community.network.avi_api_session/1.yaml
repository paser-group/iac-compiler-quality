- name: Test playbook for community.network.avi_api_session
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Test AVI API session with varied encodings
      community.network.avi_api_session:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        tenant_uuid: "{{ tenant_uuid }}"
        avi_credentials: "{{ avi_credentials }}"
        api_version: "{{ api_version }}"
        api_context:
          cloud_uuid: "{{ cloud_uuid }}"
          tenant_uuid: "{{ tenant_uuid }}"
        avi_disable_session_cache_as_fact: "{{ avi_disable_session_cache_as_fact }}"
        http_method: "{{ http_method }}"
        path: "{{ path }}"
        params: "{{ params }}"
        timeout: "{{ timeout }}"
        data:
          - "{{ data }}"
          - "{{ data | b64encode }}"
          - "{% raw %}{{ '{{' + data + '}}' }}{% endraw %}"
      register: result

    - name: Print AVI API session result
      debug:
        var: result