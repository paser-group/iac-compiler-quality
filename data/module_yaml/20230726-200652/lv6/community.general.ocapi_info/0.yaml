---
- name: Test playbook for ocapi_info module
  hosts: localhost
  gather_facts: false
  
  vars:
    baseuri: "http://example.com"
    category: "controllers"
    command: "controller-info"
    job_name: "ocapi_info"
    password: "password123"
    proxy_slot_number: 1
    timeout: 10
    username: "admin"

  tasks:
    - name: Generate strings with varied encodings
      set_fact:
        encoded_strings: "{{ ['string1', 'string2'] | map('b64encode') | list }}"
      
    - name: Debug encoded strings
      debug:
        var: encoded_strings
      
    - name: Test ocapi_info module
      community.general.ocapi_info:
        baseuri: "{{ baseuri }}"
        category: "{{ category }}"
        command: "{{ command }}"
        job_name: "{{ job_name }}"
        password: "{{ password }}"
        proxy_slot_number: "{{ proxy_slot_number }}"
        timeout: "{{ timeout }}"
        username: "{{ username }}"
        command_string: "{{ item }}"
      loop: "{{ encoded_strings }}"
      register: ocapi_info_result
      
    - name: Debug ocapi_info result
      debug:
        var: ocapi_info_result