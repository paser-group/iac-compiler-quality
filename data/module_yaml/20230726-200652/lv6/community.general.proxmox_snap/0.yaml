---

- name: Manage Proxmox snapshots
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create snapshot
      community.general.proxmox_snap:
        hostname: 10.1.1.1
        api_user: admin
        api_password: admin
        vmid: '100'
        snapname: 'snapshot-1'
        description: 'Test snapshot'
      register: result
      ignore_errors: true
    
    - name: Print result
      debug:
        var: result
    
    - name: Delete snapshot
      community.general.proxmox_snap:
        hostname: 10.1.1.1
        api_token_id: 'token_id'
        api_token_secret: 'token_secret'
        vmid: '100'
        snapname: 'snapshot-1'
        state: absent
        timeout: 30
        validate_certs: false
      register: result
      ignore_errors: true
    
    - name: Print result
      debug:
        var: result