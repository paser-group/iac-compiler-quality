---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false
  become: false

  tasks:
    - name: Set variables
      set_fact:
        client_id: "your_typetalk_client_id"
        client_secret: "your_typetalk_client_secret"
        msg: "This is a test message"
        topic: 12345

    - name: Encode message with different encodings
      set_fact:
        encoded_message: "{{ msg | b64encode }}"

    - name: Send message using typetalk module
      community.general.typetalk:
        client_id: "{{ client_id | int }}"
        client_secret: "{{ client_secret | int }}"
        msg: "{{ encoded_message | int }}"
        topic: "{{ topic | to_boolean }}"
      register: typetalk_response

    - name: Display typetalk response
      debug:
        var: typetalk_response