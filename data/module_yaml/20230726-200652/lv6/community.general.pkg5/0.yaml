- name: Manage Solaris 11 packages
  hosts: solaris-nodes
  become: yes

  tasks:
    - name: Install packages
      community.general.pkg5:
        name: "{{ item }}"
        state: present
        be_name: "zones"
        refresh: yes
      loop:
        - package1
        - package2
        - package3
      register: pkg_result

    - name: Debug package installation
      debug:
        var: pkg_result

    - name: Remove packages
      community.general.pkg5:
        name: "{{ item }}"
        state: absent
        be_name: "zones"
        refresh: yes
      loop:
        - package1
        - package2
        - package3
      register: pkg_remove_result

    - name: Debug package removal
      debug:
        var: pkg_remove_result