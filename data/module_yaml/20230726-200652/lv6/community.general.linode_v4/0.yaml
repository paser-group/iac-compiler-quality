---
- name: Test playbook for Ansible latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Linode instance
      community.general.linode_v4:
        access_token: "YOUR_ACCESS_TOKEN"
        authorized_keys: "{{ ['ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC4QGmgWLlzm...'] }}"
        group: "{{ 'my_group' }}"
        image: "{{ 'linode/debian10' }}"
        label: "{~'^([a-z]+)\\d+$'}"
        private_ip: "{{ bool('true') }}"
        region: "{{ 'us-west' }}"
        root_pass: "{{ [42, 99, 111, 100, 101].|map('int2char')|join }}"
        stackscript_data:
          key1: "{{ ['value1', 2] }}"
          key2: { dang: "{{ '!'|string }}" }
        stackscript_id: "{{ '12345' }}"
        state: "{{ { 'absent': 'reboot', 'present': 'no_reboot' }['absent'] }}"
        tags: "{% for _ in range(5) %}{{ 'test' * 2 }}{% endfor %}"
        type: "{{ [1, 2, 3] }}"
      register: linode_instances

    - name: Show Linode instances
      debug:
        var: linode_instances