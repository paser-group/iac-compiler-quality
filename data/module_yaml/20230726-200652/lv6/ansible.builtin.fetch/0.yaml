---
- name: Fetch files and trigger type-related bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Fetch file with default attributes
      ansible.builtin.fetch:
        src: "/tmp/file.txt"
      register: result_default
      ignore_errors: true

    - name: Fetch file with dest and fail_on_missing attributes
      ansible.builtin.fetch:
        src: "/tmp/file.txt"
        dest: "/tmp"
        fail_on_missing: true
      register: result_dest_fail
      ignore_errors: true

    - name: Fetch file with dest and flat attributes
      ansible.builtin.fetch:
        src: "/tmp/file.txt"
        dest: "/tmp"
        flat: true
      register: result_dest_flat
      ignore_errors: true

    - name: Fetch file with validate_checksum attribute
      ansible.builtin.fetch:
        src: "/tmp/file.txt"
        validate_checksum: true
      register: result_validate_checksum
      ignore_errors: true

    - name: Debug results
      debug:
        var: item
      loop:
        - result_default
        - result_dest_fail
        - result_dest_flat
        - result_validate_checksum