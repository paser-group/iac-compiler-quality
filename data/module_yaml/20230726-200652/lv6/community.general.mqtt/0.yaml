---
- name: Publish MQTT Message
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Publish MQTT Message
      community.general.mqtt:
        server: "{{ server }}"
        port: "{{ port }}"
        client_id: "{{ client_id }}"
        username: "{{ username }}"
        password: "{{ password }}"
        client_cert: "{{ client_cert }}"
        client_key: "{{ client_key }}"
        ca_cert: "{{ ca_cert }}"
        tls_version: "{{ tls_version }}"
        topic: "{{ topic }}"
        payload: "{{ payload }}"
        qos: "{{ qos }}"
        retain: "{{ retain }}"
      register: result

    - debug:
        var: result