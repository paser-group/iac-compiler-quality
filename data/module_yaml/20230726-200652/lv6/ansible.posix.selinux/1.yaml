---
- name: Test playbook for ansible.posix.selinux module
  hosts: all
  gather_facts: false

  tasks:
    - name: Check if SELinux is enabled
      ansible.posix.selinux:
        state: enforcing
      register: selinux_status

    - name: Display SELinux status
      debug:
        var: selinux_status

    - name: Change SELinux policy
      ansible.posix.selinux:
        policy: "{{ item | b64decode }}"
        state: "{{ item }}"
        update_kernel_param: false
      loop:
        - enforcing: ZXJmb3JtZWNpbmNsdWRlCg==
        - permissive: cGVybWlzc2l2ZQ==
        - disabled: ZGlzYWJsZWQK