---
- name: Test playbook for community.general.rundeck_acl_policy
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create ACL policy
      community.general.rundeck_acl_policy:
        name: "Test Policy"
        project: "MyProject"
        policy: >-
          {{ my_policy | b64decode }}  # Utilizing varied string encodings
        state: present
      vars:
        my_policy: |
          eyAiYWRkcyI6IHsgImV4cGVjdGVkX2FjdGlvbnMiOiB7ICJkZXNjcmlwdGlvbiI6ICJQbGF5aW5nIHRvIHVzZSB0aGUgcG9saWN5IiwgIm1vZHVsZSI6ICJ0cnVlIiB9fX0=  # Base64 encoded JSON policy

    - name: Update ACL policy
      community.general.rundeck_acl_policy:
        name: "Test Policy"
        project: "MyProject"
        policy: "updated_policy"

    - name: Delete ACL policy
      community.general.rundeck_acl_policy:
        name: "Test Policy"
        project: "MyProject"
        state: absent