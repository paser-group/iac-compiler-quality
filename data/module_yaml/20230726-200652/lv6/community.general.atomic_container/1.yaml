---
- name: Manage containers using atomic_container module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a container
      community.general.atomic_container:
        name: my_container
        state: started
        image: busybox
        mode: pull
        rootfs: docker://docker.io/busybox
        values:
          - name: MY_ENV_VAR
            value: "{{ lookup('pipe','echo -e \"Hello, World!\"') }}"
          - name: MY_UTF8_VAR
            value: "{{ lookup('pipe','echo -e \"\u2713 Hello, World!\"') }}"
          - name: MY_ASCII_VAR
            value: "{{ lookup('pipe','echo -e \"\\x48\\x65\\x6c\\x6c\\x6f\\x2c\\x20\\x57\\x6f\\x72\\x6c\\x64\\x21\"') }}"

    - name: Stop the container
      community.general.atomic_container:
        name: my_container
        state: stopped

    - name: Remove the container
      community.general.atomic_container:
        name: my_container
        state: absent