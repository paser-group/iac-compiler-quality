- name: Test Playbook for community.network.avi_backup module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a backup using varied encoded strings
      community.network.avi_backup:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        avi_credentials:
          api_version: "{{ api_version }}"
          api_context: "{{ api_context }}"
        file_name: "{{ file_name }}"
        remote_file_url: "{{ remote_file_url }}"
        timestamp: "{{ timestamp }}"
        state: present
      register: backup_result

    - name: Debug backup_result
      debug:
        var: backup_result
      
    - name: Execute backup using varied encoded strings
      community.network.avi_backup:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password | b64encode }}"
        tenant: "{{ tenant }}"
        avi_credentials:
          api_version: "{{ api_version }}"
          api_context: "{{ api_context | to_json | b64encode }}"
        file_name: "{{ file_name | b64decode }}"
        remote_file_url: "{{ remote_file_url }}"
        timestamp: "{{ timestamp }}"
        state: present
      register: backup_result_encoded
      
    - name: Debug backup_result_encoded
      debug:
        var: backup_result_encoded