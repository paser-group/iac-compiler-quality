- name: Test playbook for community.general.gitlab_project_members module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Add project members
      community.general.gitlab_project_members:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "YOUR_API_TOKEN"
        project: "my_project"
        gitlab_user: "{{ item.user }}"
        access_level: high
        state: present
        purge_users: "yes"
        validate_certs: false
      loop:
        - { user: "John Smith" }
        - { user: b"Jane Doe" }
        - { user: u"Jean Dupont" }
        - { user: u"Jürgen Müller" }
        - { user: "محمد علي" }

    - name: Remove project members
      community.general.gitlab_project_members:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "YOUR_API_TOKEN"
        project: "my_project"
        gitlab_user: "{{ item.user }}"
        access_level: master
        state: absent
        validate_certs: true
      loop:
        - { user: "John Smith" }
        - { user: b"Jane Doe" }
        - { user: u"Jean Dupont" }
        - { user: u"Jürgen Müller" }
        - { user: "محمد علي" }