---
- name: Test ansible.builtin.pip module
  hosts: localhost
  gather_facts: false
  vars:
    test_module_name: "example_module"
    test_module_version: "1.0.0"
    test_module_extra_args: "--verbose"
    test_module_virtualenv_path: "/path/to/virtualenv"

  tasks:
    - name: Install test_module using pip
      ansible.builtin.pip:
        name: "{{ test_module_name }}"
        state: "latest"
        chdir: "/path/to/sources"
        version: "{{ test_module_version }}"
        extra_args: "{{ test_module_extra_args }}"
        virtualenv: "{{ test_module_virtualenv_path }}"
        virtualenv_python: "/path/to/python"
        virtualenv_command: "/path/to/virtualenv_command"
        virtualenv_site_packages: true
        umask: "022"
        executable: "/path/to/python"