---
- name: Test playbook
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Include nginx_status_info role
      include_role:
        name: community.general.nginx_status_info

    - name: Generate encoded URL
      set_fact:
        encoded_url: '{{ "http://localhost/nginx_status" | b64encode }}'

    - name: Decode URL
      set_fact:
        decoded_url: '{{ encoded_url | b64decode }}'

    - name: Retrieve Nginx status
      nginx_status_info:
        timeout: 10
        url: '{{ decoded_url }}'
      register: nginx_status

    - name: Debug Nginx status
      debug:
        var: nginx_status