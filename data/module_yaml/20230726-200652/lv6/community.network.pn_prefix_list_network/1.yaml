---
- name: Test playbook to uncover latent type-related bugs
  hosts: localhost
  gather_facts: false
  vars:
    pn_cliswitch: "{{ lookup('env', 'PN_CLISWITCH') }}"
    pn_name: "test_prefix_list"
    pn_netmask: "255.255.255.0"
    pn_network: "10.1.1.0"
    state: "present"

  tasks:
    - name: Add prefix list network entry
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        state: "{{ state }}"

    - name: Print debug information
      debug:
        var: pn_prefix_list_network

    - name: Remove prefix list network entry
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        state: "absent"

    - name: Test case with varied encoding
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name | b64encode }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        state: "{{ state }}"

    - name: Print debug information
      debug:
        var: pn_prefix_list_network

    - name: Test case with different encoding format
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{% raw %}{{ pn_name | regex_replace('/./', '/\\u00') }}{% endraw %}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        state: "{{ state }}"

    - name: Print debug information
      debug:
        var: pn_prefix_list_network

    - name: Test case with URL encoded string
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name | urlencode }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        state: "{{ state }}"

    - name: Print debug information
      debug:
        var: pn_prefix_list_network