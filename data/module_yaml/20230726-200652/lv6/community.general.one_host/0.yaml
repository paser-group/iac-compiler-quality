---
- name: Test playbook to expose latent type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    api_password: "{% if not _api_password is defined %}my_api_password{% endif %}"
    api_url: "https://api.example.com"
    api_username: "my_username"
    cluster_id: "123"
    cluster_name: "{{ _cluster_name | mandatory }}"
    im_mad_name: "{{ _im_mad_name | default('my_im_mad') }}"
    labels: ["label1", "label2"]
    name: "{% if _name is defined %}{{ _name | default('my_host') }}{% endif %}"
    state: "present"
    template:
      attribute1: "value1"
      attribute2: "value2"
    validate_certs: false
    vmm_mad_name: "{% if _vmm_mad_name is defined %}{{ _vmm_mad_name }}{% endif %}"
    wait_timeout: "{{ _wait_timeout | default(60) }}"

  tasks:
    - name: Create a host with potential type-related bugs
      community.general.one_host:
        api_password: "{{ api_password }}"
        api_url: "{{ api_url }}"
        api_username: "{{ api_username }}"
        cluster_id: "{{ cluster_id }}"
        cluster_name: "{{ cluster_name }}"
        im_mad_name: "{{ im_mad_name }}"
        labels: "{{ labels }}"
        name: "{{ name }}"
        state: "{{ state }}"
        template: "{{ template }}"
        validate_certs: "{{ validate_certs }}"
        vmm_mad_name: "{{ vmm_mad_name }}"
        wait_timeout: "{{ wait_timeout }}"
      register: result

    - name: Debug the result
      debug:
        var: result