---
- name: Install or Uninstall Overlapped Packages Testing
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install overlapped package using varied encodings
      community.general.rpm_ostree_pkg:
        name:
          - "package_1"
          - "package_2"
          - "package_3"
        state: present
      vars:
        encoding_variations:
          - utf-8
          - iso-8859-1
          - utf-16

      loop: "{{ encoding_variations }}"
      loop_control:
        loop_var: encoding

    - name: Uninstall overlapped package using varied encodings
      community.general.rpm_ostree_pkg:
        name:
          - "package_1"
          - "package_2"
          - "package_3"
        state: absent
      vars:
        encoding_variations:
          - utf-8
          - iso-8859-1
          - utf-16

      loop: "{{ encoding_variations }}"
      loop_control:
        loop_var: encoding