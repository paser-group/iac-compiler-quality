---
- name: Send message using Flowdock module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Import 'community.general.flowdock' module
      import_module:
        name: community.general.flowdock

    - name: Send Flowdock message with varied encodings
      community.general.flowdock:
        token: "{{ flowdock_token }}"
        external_user_name: "{{ lookup('env', 'USER') }}"
        from_address: "{{ from_address }}"
        from_name: "{{ from_name }}"
        link: "{{ link }}"
        msg: '{{ ["This is a test message with varied encodings"] | random | to_json | to_uuid }}'
        project: "{{ project }}"
        reply_to: "{{ reply_to }}"
        source: "{{ source }}"
        subject: "{{ subject }}"
        tags: "{{ tags }}"
        type: "{{ type }}"
        validate_certs: "{{ validate_certs | default(true) | bool }}"