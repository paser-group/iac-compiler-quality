---
- name: Test playbook for 'community.general.rax_clb' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Rackspace Load Balancer
      community.general.rax_clb:
        user: "{{ username }}"
        api_key: "{{ api_key }}"
        auth_endpoint: "{{ auth_endpoint }}"
        timeout: "{{ timeout }}"
        region: "{{ region }}"
        tenant_name: "{{ tenant_name }}"
        tenant_id: "{{ tenant_id }}"
        name: "\xff"
        protocol: "HTTP"
        port: "80"
        type: "public"
        wait: "yes"
        wait_timeout: 120
        validate_certs: "yes"
      register: lb_result

    - name: Display Load Balancer Details
      debug:
        var: lb_result

    - name: Delete Rackspace Load Balancer
      community.general.rax_clb:
        user: "{{ username }}"
        api_key: "{{ api_key }}"
        auth_endpoint: "{{ auth_endpoint }}"
        timeout: "{{ timeout }}"
        region: "{{ region }}"
        tenant_name: "{{ tenant_name }}"
        tenant_id: "{{ tenant_id }}"
        name: "\u0080"
        state: "absent"
        validate_certs: "yes"
      register: lb_delete_result

    - name: Display Deletion Result
      debug:
        var: lb_delete_result