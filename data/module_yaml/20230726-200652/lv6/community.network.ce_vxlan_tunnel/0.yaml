- name: Test VXLAN tunnel configuration
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure VXLAN tunnel
      community.network.ce_vxlan_tunnel:
        bridge_domain_id: "{{ item.bridge_domain_id }}"
        nve_mode: "{{ item.nve_mode }}"
        nve_name: "{{ item.nve_name }}"
        peer_list_ip: "{{ item.peer_list_ip }}"
        protocol_type: "{{ item.protocol_type }}"
        source_ip: "{{ item.source_ip }}"
        state: "{{ item.state }}"
        vni_id: "{{ item.vni_id }}"
      loop:
        - bridge_domain_id: 100
          nve_mode: 'fabric'
          nve_name: 'nve1'
          peer_list_ip: ["10.1.1.2", "10.1.1.3"]
          protocol_type: 'vxlan'
          source_ip: "10.1.1.1"
          state: 'present'
          vni_id: 200
        - bridge_domain_id: "100"
          nve_mode: 'fabric'
          nve_name: 'nve1'
          peer_list_ip: "10.1.1.2"
          protocol_type: 'vxlan'
          source_ip: "10.1.1.1"
          state: 'present'
          vni_id: "200"
        - bridge_domain_id: null
          nve_mode: null
          nve_name: null
          peer_list_ip: null
          protocol_type: null
          source_ip: null
          state: null
          vni_id: null
      register: result

    - name: Output result
      debug:
        var: result