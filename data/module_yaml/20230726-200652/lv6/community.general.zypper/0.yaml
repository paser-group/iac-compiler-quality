- name: Test playbook for 'community.general.zypper' module 
  hosts: localhost
  connection: local
  gather_facts: false

  tasks:
    - name: Install packages
      community.general.zypper:
        name:
          - package1
          - package2
        state: present
        allow_vendor_change: "{{ allow_vendor_change | default(false) }}"
        clean_deps: "{{ clean_deps | default(false) }}"
        disable_gpg_check: "{{ disable_gpg_check | default(false) }}"
        disable_recommends: "{{ disable_recommends | default(false) }}"
        extra_args: "{{ extra_args | default('') }}"
        extra_args_precommand: "{{ extra_args_precommand | default('') }}"
        force: "{{ force | default(false) }}"
        force_resolution: "{{ force_resolution | default(false) }}"
        oldpackage: "{{ oldpackage | default(false) }}"
        replacefiles: "{{ replacefiles | default(false) }}"
        type: "{{ type | default('package') }}"
        update_cache: "{{ update_cache | default(false) }}"
      register: result
      when: allow_vendor_change is defined or
            clean_deps is defined or
            disable_gpg_check is defined or
            disable_recommends is defined or
            extra_args is defined or
            extra_args_precommand is defined or
            force is defined or
            force_resolution is defined or
            oldpackage is defined or
            replacefiles is defined or
            type is defined or
            update_cache is defined

    - name: Show result
      debug:
        var: result
        verbosity: 2