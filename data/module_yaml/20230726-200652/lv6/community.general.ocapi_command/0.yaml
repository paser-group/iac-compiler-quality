- name: Ansible Latent Type-Related Bug Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Test Case 1 - Default Encoding
      community.general.ocapi_command:
        baseuri: "http://{{ hostvars['localhost']['ansible_default_ipv4']['address'] }}:8000/"
        category: "system"
        command: "get_system_info"
        username: "admin"
        password: "password123"
      register: result1
      ignore_errors: true

    - name: Test Case 2 - UTF-8 Encoding
      community.general.ocapi_command:
        baseuri: "http://{{ hostvars['localhost']['ansible_default_ipv4']['address'] }}:8000/"
        category: "system"
        command: "{% set utf8_string = 'Привет, мир!' %}{{ utf8_string }}"
        username: "admin"
        password: "password123"
      register: result2
      ignore_errors: true

    - name: Test Case 3 - Base64 Encoding
      community.general.ocapi_command:
        baseuri: "http://{{ hostvars['localhost']['ansible_default_ipv4']['address'] }}:8000/"
        category: "system"
        command: "{% set base64_string = 'SGVsbG8gdGhlcmUh' %}{{ base64_string | b64decode }}"
        username: "admin"
        password: "password123"
      register: result3
      ignore_errors: true

    - name: Test Case 4 - Binary Encoding
      community.general.ocapi_command:
        baseuri: "http://{{ hostvars['localhost']['ansible_default_ipv4']['address'] }}:8000/"
        category: "system"
        command: "{{ lookup('file', '/path/to/binary_file') }}"
        username: "admin"
        password: "password123"
      register: result4
      ignore_errors: true

    - name: Test Case 5 - Hex Encoding
      community.general.ocapi_command:
        baseuri: "http://{{ hostvars['localhost']['ansible_default_ipv4']['address'] }}:8000/"
        category: "system"
        command: "{% set hex_string = '48656c6c6f2c20776f726c6421' %}{{ hex_string | from_hex }}"
        username: "admin"
        password: "password123"
      register: result5
      ignore_errors: true