- name: Test WebFaction mailbox module with varied string encodings
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Add mailbox with UTF-8 encoded name and password
      community.general.webfaction_mailbox:
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        mailbox_name: "{{ mailbox_name }}"
        mailbox_password: "{{ mailbox_password }}"
        state: "present"
      vars:
        login_name: "admin"
        login_password: "password"
        mailbox_name: "مرحبا"
        mailbox_password: "سري"
      register: result_1

    - name: Print result of add mailbox task
      debug:
        var: result_1

    - name: Remove mailbox with base64 encoded name and password
      community.general.webfaction_mailbox:
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        mailbox_name: "{{ mailbox_name }}"
        mailbox_password: "{{ mailbox_password }}"
        state: "absent"
      vars:
        login_name: "admin"
        login_password: "password"
        mailbox_name: "{{ '5LuB56eR' | b64decode }}"
        mailbox_password: "{{ '5ryi5qOu' | b64decode }}"
      register: result_2

    - name: Print result of remove mailbox task
      debug:
        var: result_2