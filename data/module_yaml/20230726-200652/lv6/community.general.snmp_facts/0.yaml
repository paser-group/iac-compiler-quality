---
- name: Test 'community.general.snmp_facts' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Test with different encodings
      community.general.snmp_facts:
        host: 127.0.0.1
        version: 2c
        community: "{{ item }}"
      loop:
        - "public"
        - "private"
        - "public".decode('utf-8')
        - "private".decode('utf-8')
        - "攻撃".encode('utf-16')
        - "攻撃".encode('utf-32')
        - "攻撃".encode('utf-8')
        - "йцукен".encode('utf-8')
      register: snmp_result
      ignore_errors: true

    - name: Print SNMP facts
      debug:
        var: snmp_result