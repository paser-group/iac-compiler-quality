- name: Assemble Configuration Files
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create temporary directory
      tempfile:
        state: directory
      register: temp_dir

    - name: Create source files
      shell: echo "This is a source file with varied encoding" > "{{ temp_dir.path }}/{{ item.name }}"
      loop:
        - { name: "file1.txt" }
        - { name: "file2.txt" }
        - { name: "file3.txt" }

    - name: Assemble configuration files
      assemble:
        src: "{{ temp_dir.path }}"
        dest: "/tmp/assembled.txt"

    - name: Print the assembled configuration file
      shell: cat /tmp/assembled.txt