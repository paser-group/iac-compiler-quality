---
- name: Ansible Latent Type-Related Bug Finder
  hosts: localhost
  gather_facts: false
  
  tasks:
  
    - name: Generate strings with varied encodings
      ansible.builtin.debug:
        msg: "{{ item }}"
      loop:
        - "{{ 'string1' | b64encode }}"
        - "{{ 'string2' | b64encode }}"
        - "{{ 'string3' | b64encode }}"
      
    - name: Set XML attributes using varied encodings
      community.general.xml:
        path: /path/to/xmlfile.xml
        xpath: /root/element
        attribute: "{{ item | b64decode }}"
        state: present
      loop:
        - "{{ 'attribute1' | b64encode }}"
        - "{{ 'attribute2' | b64encode }}"
        - "{{ 'attribute3' | b64encode }}"
      
    - name: Insert XML nodes with varied encodings
      community.general.xml:
        path: /path/to/xmlfile.xml
        xpath: /root/element
        add_children:
          - name: child1
            value: "{{ item | b64decode }}"
            strip_cdata_tags: yes
          - name: child2
            value: "Child Value"
        state: present
      loop:
        - "{{ 'value1' | b64encode }}"
        - "{{ 'value2' | b64encode }}"
        - "{{ 'value3' | b64encode }}"
      
    - name: Replace XML nodes with varied encodings
      community.general.xml:
        path: /path/to/xmlfile.xml
        xpath: /root/element
        set_children:
          - name: child1
            value: "{{ item | b64decode }}"
            attribute: child-attribute
            state: present
          - name: child2
            value: "Updated Child Value"
            state: present
        state: present
      loop:
        - "{{ 'value1' | b64encode }}"
        - "{{ 'value2' | b64encode }}"
        - "{{ 'value3' | b64encode }}"