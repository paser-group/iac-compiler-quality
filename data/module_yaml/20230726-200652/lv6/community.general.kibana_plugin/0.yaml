---
- name: Install Kibana plugin
  hosts: localhost
  gather_facts: false

  vars:
    plugin_name: my-plugin
    plugin_url: http://example.com/my-plugin.zip
    plugin_version: '1.0.0'
    plugin_timeout: 60
    plugin_dir: /usr/share/kibana/plugins

  tasks:
    - name: Install Kibana plugin
      community.general.kibana_plugin:
        name: "{{ plugin_name }}"
        url: "{{ plugin_url }}"
        version: "{{ plugin_version }}"
        timeout: "{{ plugin_timeout }}"
        plugin_dir: "{{ plugin_dir }}/{{ plugin_name }}"
        state: present
      register: result

    - name: Show result
      debug:
        var: result