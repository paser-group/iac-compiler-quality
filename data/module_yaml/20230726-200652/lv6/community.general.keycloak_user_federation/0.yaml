---
- name: Ansible Latent Bug Finder & Heuristic Test
  hosts: localhost
  gather_facts: false

  vars:
    # Define the Keycloak user federation options
    auth_client_id: "keycloak_client"
    auth_client_secret: "keycloak_secret"
    auth_keycloak_url: "http://keycloak.example.com/auth"
    auth_password: "admin_password"
    auth_realm: "my_realm"
    auth_username: "admin_user"
    config:
      option1: "value1"
      option2: "value2"
    connection_timeout: 10
    http_agent: "my_user_agent"
    id: "federation1"
    mappers:
      - name: "mapper1"
        mapper_type: "user-attribute"
        claim: "attribute1"
        user_attribute: "user-attribute1"
      - name: "mapper2"
        mapper_type: "role"
        claim: "attribute2"
    name: "My Federation"
    parent_id: "parent_id1"
    provider_id: "provider_id1"
    provider_type: "ldap"
    realm: "my_realm"
    state: "present"
    token: "auth_token"
    validate_certs: true

  tasks:
    - name: Test Case 1 - Latin1 Encoding
      community.general.keycloak_user_federation:
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        config: "{{ config }}"
        connection_timeout: "{{ connection_timeout }}"
        http_agent: "{{ http_agent }}"
        id: "{{ id }}"
        mappers: "{{ mappers }}"
        name: "{{ name }}"
        parent_id: "{{ parent_id }}"
        provider_id: "{{ provider_id }}"
        provider_type: "{{ provider_type }}"
        realm: "{{ realm }}"
        state: "{{ state }}"
        token: "{{ token }}"
        validate_certs: "{{ validate_certs }}"
      vars:
        auth_client_id: "këÿclöäk_client"
        auth_client_secret: "këÿclöäk_sëcrët"
        auth_keycloak_url: "http://këÿclöäk.ëxämplë.com/äüth"
        auth_password: "ädmïn_pässwörd"
        auth_realm: "mÿ_rëälm"
        auth_username: "ädmïn_üsër"
        http_agent: "mÿ_üsër_ägënt"
        id: "fëdërätïön1"
        name: "My Fëdërätïön"

    - name: Test Case 2 - UTF-8 Encoding
      community.general.keycloak_user_federation:
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        config: "{{ config }}"
        connection_timeout: "{{ connection_timeout }}"
        http_agent: "{{ http_agent }}"
        id: "{{ id }}"
        mappers: "{{ mappers }}"
        name: "{{ name }}"
        parent_id: "{{ parent_id }}"
        provider_id: "{{ provider_id }}"
        provider_type: "{{ provider_type }}"
        realm: "{{ realm }}"
        state: "{{ state }}"
        token: "{{ token }}"
        validate_certs: "{{ validate_certs }}"
      vars:
        auth_client_id: "keyclöäk_clïënt"
        auth_client_secret: "keyclöäk_sëcrët"
        auth_keycloak_url: "http://keyclöäk.ëxämplë.com/äuth"
        auth_password: "ädmin_pässwörd"
        auth_realm: "my_rëälm"
        auth_username: "ädmin_user"
        http_agent: "my_user_ägënt"
        id: "fëdërätïon1"
        name: "My_Fëdërätïön"

    # Additional test cases with different encodings can be added here