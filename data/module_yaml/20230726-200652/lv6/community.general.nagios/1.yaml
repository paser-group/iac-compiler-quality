- hosts: localhost
  vars:
    encodings:
      - utf-8
      - latin1
      - utf-16
      - utf-32

  tasks:
    - name: Set Nagios downtime with varied encodings
      community.general.nagios:
        action: downtime
        host: "{{ host | encode(encoding) }}"
        comment: "{{ comment | default('Downtime for testing') | encode(encoding) }}"
        start: "{{ start }}"
        minutes: "{{ minutes | default(60) }}"
        servicegroup: "{{ servicegroup | default('all') }}"
      loop: "{{ encodings }}"
      loop_control:
        loop_var: encoding