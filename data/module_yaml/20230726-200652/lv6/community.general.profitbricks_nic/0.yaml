---
- name: Test Ansible Latent Type-Related Bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create ProfitBricks Nic
      community.general.profitbricks_nic:
        datacenter: "datacenter"
        lan: "lan"
        name: "{{ item.name }}"
        server: "{{ item.server }}"
        state: "{{ item.state }}"
        subscription_user: "{{ item.subscription_user }}"
        subscription_password: "{{ item.subscription_password }}"
        wait: "{{ item.wait }}"
        wait_timeout: "{{ item.wait_timeout }}"
      loop:
        - name: Test Case 1
          server: "ubuntu1"
          state: b"present".decode('utf-16')
          subscription_user: b"testuser1".decode('utf-8')
          subscription_password: b"testpass1".decode('utf-32')
          wait: true
          wait_timeout: 30
        - name: Test Case 2
          server: "alpine1"
          state: b"absent".decode('utf-8')
          subscription_user: "testuser2"
          subscription_password: "testpass2"
          wait: false
          wait_timeout: 60

    - name: Print Debug Output
      debug:
        var: result