---
- name: Discover latent type-related bugs in community.network.ce_command module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure Huawei device using community.network.ce_command module
      community.network.ce_command:
        command: "{{ command }}"
        interval: "{{ interval }}"
        match: "{{ match }}"
        retries: "{{ retries }}"
        wait_for: "{{ wait_for }}"
      register: result

      vars:
        command: "display version"
        interval: 5
        match: "VRP (\\d+\\.\\d+)"
        retries: 3
        wait_for: 10

      ignore_errors: yes

      tags:
        - ansible-bug

    - name: Print the results
      debug:
        var: result

    - name: Apply the heuristic - Generate strings with varied encodings
      debug:
        msg: |
          Valid encodings:

          - ASCII: "{{ 'display version'.encode('ascii') }}"
          - UTF-8: "{{ 'display version'.encode('utf-8') }}"
          - Latin-1: "{{ 'display version'.encode('latin-1') }}"
          - ISO-8859-1: "{{ 'display version'.encode('iso-8859-1') }}"
          - Shift-JIS: "{{ 'display version'.encode('shift-jis') }}"
          - EUC-JP: "{{ 'display version'.encode('euc-jp') }}"
          - UTF-16: "{{ 'display version'.encode('utf-16') }}"
          - UTF-32: "{{ 'display version'.encode('utf-32') }}"
          
      tags:
        - ansible-bug