---
- name: Test community.general.utm_network_interface_address module
  hosts: localhost
  gather_facts: false
  vars:
    address: 10.1.1.1
    address6: "fe80::1"
    comment: "This is a test interface"
    headers:
      Content-Type: "application/json"
    name: eth0
    resolved: false
    resolved6: true
    state: present
    utm_host: utm.example.com
    utm_port: 8080
    utm_protocol: https
    utm_token: secret_token
    validate_certs: true

  tasks:
    - name: Test network interface creation
      community.general.utm_network_interface_address:
        address: "{{ address }}"
        address6: "{{ address6 }}"
        comment: "{{ comment }}"
        headers: "{{ headers }}"
        name: "{{ name }}"
        resolved: "{{ resolved }}"
        resolved6: "{{ resolved6 }}"
        state: "{{ state }}"
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - name: Debug module output
      debug:
        var: result

    - name: Test network interface update
      community.general.utm_network_interface_address:
        address: "{{ address }}"
        address6: "{{ address6 }}"
        comment: "{{ comment }}"
        headers: "{{ headers }}"
        name: "{{ name }}"
        resolved: "{{ resolved }}"
        resolved6: "{{ resolved6 }}"
        state: "{{ state }}"
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: updated_result

    - name: Debug updated module output
      debug:
        var: updated_result

    - name: Test network interface deletion
      community.general.utm_network_interface_address:
        name: "{{ name }}"
        state: absent
        utm_host: "{{ utm_host }}"
        utm_port: "{{ utm_port }}"
        utm_protocol: "{{ utm_protocol }}"
        utm_token: "{{ utm_token }}"
        validate_certs: "{{ validate_certs }}"
      register: deleted_result

    - name: Debug deleted module output
      debug:
        var: deleted_result