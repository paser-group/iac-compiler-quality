---
- hosts: localhost
  gather_facts: false
  vars:
    random_ip: "10.1.1.{{ 10 | random }}"
  tasks:
    - name: Install package using pacman module
      community.general.pacman:
        name: "{{ random_ip }}"
        state: present
        update_cache: true
        upgrade: true
      with_items:
        - package1
        - package2

    - name: Remove package using pacman module
      community.general.pacman:
        name: "{{ random_ip }}"
        state: absent
        update_cache: false
        upgrade: false
      with_items:
        - package1
        - package2