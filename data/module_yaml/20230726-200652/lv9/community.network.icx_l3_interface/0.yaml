- name: Manage Layer-3 interfaces on Ruckus ICX
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Create Layer-3 interface with random IPv4 address
      community.network.icx_l3_interface:
        name: interface1
        ipv4: "{{ lookup('pipe', 'python -c \"import random;ip = \'.\'.join([str(random.randint(1, 255)) for _ in range(4)]); print(ip)\"') }}/24"
        state: present

    - name: Create Layer-3 interface with random IPv6 address
      community.network.icx_l3_interface:
        name: interface2
        ipv6: "{{ lookup('pipe', 'python -c \"import random;import socket;ip = socket.inet_ntop(socket.AF_INET6, bytes.fromhex(\'\'.join([\'{:02x}\'.format(random.randint(0, 255)) for _ in range(16)])))); print(ip)\"') }}/64"
        state: present