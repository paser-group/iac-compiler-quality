---
- name: Test playbook for packet_volume_attachment module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Attach volume to device
      community.general.packet_volume_attachment:
        auth_token: "{{ lookup('env', 'PACKET_AUTH_TOKEN') }}"
        project_id: "{{ lookup('env', 'PACKET_PROJECT_ID') }}"
        volume: "{{ volume_id }}"
        device: "/dev/xvdh"
        state: "attached"
      vars:
        volume_id: "volume_id"

    - name: Detach volume from device
      community.general.packet_volume_attachment:
        auth_token: "{{ lookup('env', 'PACKET_AUTH_TOKEN') }}"
        project_id: "{{ lookup('env', 'PACKET_PROJECT_ID') }}"
        volume: "{{ volume_id }}"
        device: "/dev/xvdh"
        state: "detached"
      vars:
        volume_id: "volume_id"