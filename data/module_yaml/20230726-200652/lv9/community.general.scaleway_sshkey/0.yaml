---
- hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random IP addresses
      set_fact:
        random_ips:
          - "{{ query('community.general.random_ipv4') }}"
          - "{{ query('community.general.random_ipv4') }}"
          - "{{ query('community.general.random_ipv4') }}"
          - "{{ query('community.general.random_ipv4') }}"

    - name: Print random IP addresses
      debug:
        msg: "Random IP addresses: {{ random_ips }}"

    - name: Create Scaleway SSH key
      scaleway_sshkey:
        api_token: "<your_api_token>"
        ssh_pub_key: "{{ lookup('file', 'ssh_key.pub') }}"
        state: present
        api_timeout: 30
        query_parameters:
          - param1: "value1"
            param2: "value2"
        api_url: "https://api.scaleway.com"

    - name: Print Scaleway SSH key info
      debug:
        var: scaleway_sshkey_info

    - name: Delete Scaleway SSH key
      scaleway_sshkey:
        api_token: "<your_api_token>"
        ssh_pub_key: "{{ lookup('file', 'ssh_key.pub') }}"
        state: absent
        api_timeout: 30
        validate_certs: true
        api_url: "https://api.scaleway.com"