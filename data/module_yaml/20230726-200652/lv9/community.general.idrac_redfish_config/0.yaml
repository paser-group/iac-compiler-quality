---
- name: Test playbook for 'community.general.idrac_redfish_config' module
  hosts: localhost
  gather_facts: False
  
  vars:
    auth_token: "xxxxxxxx"  # Fill in with actual auth_token
    baseuri: "https://example.com/redfish/v1/"
    category: "Managers"
    command:
      - "CreateUser"
    manager_attributes:
      UserName: "test_user"
      Password: "test_password"
    password: "admin"
    resource_id: "1"
    timeout: 60
    username: "admin"
  
  tasks:
    - name: Generate random IP address for networking module
      set_fact:
        random_ip: "{{ 10 | random }}.{{ 10 | random }}.{{ 10 | random }}.{{ 10 | random }}"
    
    - name: Configure networking module with random IP address
      community.general.idrac_redfish_config:
        auth_token: "{{ auth_token }}"
        baseuri: "{{ baseuri }}"
        category: "{{ category }}"
        command: "{{ command }}"
        manager_attributes: "{{ manager_attributes }}"
        password: "{{ password }}"
        resource_id: "{{ resource_id }}"
        timeout: "{{ timeout }}"
        username: "{{ username }}"
        ip_address: "{{ random_ip }}"
      register: idrac_config_result
  
    - name: Debug results
      debug:
        var: idrac_config_result