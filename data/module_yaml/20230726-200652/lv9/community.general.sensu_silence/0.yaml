- name: Manage Sensu Silence
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ 10 | random }}.{{ 1 | random }}.{{ 1 | random }}.{{ 1 | random }}"

    - name: Silence Sensu check
      community.general.sensu_silence:
        check: "<enter_check_name>"  # Replace with the check name
        creator: "<enter_creator>"
        expire: "<enter_expire_time>"  # Replace with the expire time in seconds
        expire_on_resolve: true/false  # Replace with true or false
        reason: "<enter_reason>"
        state: present
        subscription: "<enter_subscription>"
        url: "<enter_url>"
        client_address: "{{ random_ip | default('127.0.0.1') }}"  # Use the generated random IP address

      register: result

    - name: Display result
      debug:
        var: result