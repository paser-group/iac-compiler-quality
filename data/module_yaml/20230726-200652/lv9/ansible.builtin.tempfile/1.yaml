---
- name: Test playbook for ansible.builtin.tempfile module
  hosts:
    - ubuntu1
    - alpine1
    - centos1
    - redhat1
  gather_facts: false

  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip_address: "{{ range(4)|map('random')|join('.') }}"

    - name: Create temporary file
      ansible.builtin.tempfile:
        path: "/tmp/{{ ansible_hostname }}"
        prefix: "tempfile_{{ random_ip_address }}"
        state: "file"
        suffix: ".txt"
      register: tempfile_result

    - name: Display temporary file path
      debug:
        var: tempfile_result.path