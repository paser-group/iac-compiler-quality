---
- name: Manage Ruckus ICX system attributes
  hosts: localhost
  gather_facts: false
  connection: local

  tasks:
    - name: Generate random IP addresses
      set_fact:
        random_ips: "{{ random_ips | default([]) + [ '10.' + item + '.' + item + '.' + item ] }}"
      loop: "{{ range(1, 255) | list }}"

    - name: Configure system attributes
      community.network.icx_system:
        aaa_servers: "{{ random_ips }}"
        check_running_config: true
        domain_name: "{{ random_ips }}"
        domain_search: "{{ random_ips }}"
        hostname: "{{ random_ips[0] }}"
        name_servers: "{{ random_ips }}"
        state: present

      register: output

    - name: Debug module output
      debug:
        var: output