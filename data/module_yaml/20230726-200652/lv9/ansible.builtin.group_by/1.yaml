---
- name: Group nodes by Linux distribution
  hosts: localhost
  gather_facts: false

  vars:
    inventory_nodes:
      - name: ubuntu1
        ip: "{{ ansible_random_ipv4.network + loop.index }}"
        linux_distribution: ubuntu
      - name: alpine1
        ip: "{{ ansible_random_ipv4.network + loop.index }}"
        linux_distribution: alpine
      - name: centos1
        ip: "{{ ansible_random_ipv4.network + loop.index }}"
        linux_distribution: centos
      - name: redhat1
        ip: "{{ ansible_random_ipv4.network + loop.index }}"
        linux_distribution: redhat

  tasks:
    - name: Generate inventory hosts
      group_by:
        key: "{{ item.linux_distribution }}"
      loop: "{{ inventory_nodes }}"