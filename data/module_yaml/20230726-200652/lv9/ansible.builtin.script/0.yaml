---
- name: Run local script on remote node
  hosts: all
  gather_facts: false

  tasks:
    - name: Execute script
      ansible.builtin.script:
        chdir: "{{ chdir | default(omit) }}"
        cmd: "{{ cmd }}"
        creates: "{{ creates | default(omit) }}"
        decrypt: "{{ decrypt | default(false) }}"
        executable: "{{ executable | default(omit) }}"
        removes: "{{ removes | default(omit) }}"
      register: script_output

    - name: Debug script output
      ansible.builtin.debug:
        msg: "{{ script_output.stdout }}"

    - name: Test heuristic - Random IP addresses
      ansible.builtin.debug:
        msg: "{{ item }}"
      loop: "{{ random_ips }}"

  vars:
    chdir: null
    cmd: "echo Hello World"
    creates: null
    decrypt: false
    executable: null
    removes: null
    random_ips:
      - 192.168.1.1
      - 10.0.0.1
      - 172.16.0.1