---
- name: Test playbook for community.network.pn_port_config module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip_address: "{{ '10.' + (0..255 | random) | ipaddr + '.' + (1..254 | random) | ipaddr }}"
    
    - name: Configure port
      community.network.pn_port_config:
        pn_intf: "vlan100"
        pn_port: "1/1"
        pn_enable: true
        pn_speed: "10g"
        pn_port_mac_address: "{{ random_ip_address }}"
        pn_edge_switch: false
        pn_local_switching: true
        pn_jumbo: false
        pn_lacp_priority: ""
        pn_send_port: ""
        pn_loopback: true
        pn_loop_vlans: "vlan101,vlan102"
        pn_mirror_only: true
        pn_autoneg: false
        pn_pause: true
        pn_defer_bringup: true
        pn_fabric_guard: false
        pn_vxlan_termination: true
        pn_description: "Test Port"
        pn_dscp_map: "ef:7"
        pn_routing: false
        pn_crc_check_enable: true
        pn_allowed_tpid: "8100,88a8"
        state: present