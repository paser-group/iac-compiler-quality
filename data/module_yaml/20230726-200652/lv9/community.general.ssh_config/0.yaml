---
- name: Test Ansible SSH Config module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure SSH
      community.general.ssh_config:
        forward_agent: "{{ forward_agent | default(false) }}"
        group: "{{ group | default('users') }}"
        host: "{{ host | default(hostvars['inventory_hostname']) }}"
        host_key_algorithms: "{{ host_key_algorithms | default('ssh-ed25519') }}"
        hostname: "{{ hostname | default(inventory_hostname) }}"
        identity_file: "{{ identity_file | default('~/.ssh/id_rsa') }}"
        port: "{{ port | default(22) }}"
        proxycommand: "{{ proxycommand }}"
        proxyjump: "{{ proxyjump }}"
        remote_user: "{{ remote_user | default(ansible_user) }}"
        ssh_config_file: "{{ ssh_config_file | default('~/.ssh/config') }}"
        state: "{{ state | default('present') }}"
        strict_host_key_checking: "{{ strict_host_key_checking | default('yes') }}"
        user: "{{ user | default(ansible_user) }}"
        user_known_hosts_file: "{{ user_known_hosts_file | default('~/.ssh/known_hosts') }}"

      vars:
        forward_agent: "{{ 'not_a_boolean' | random(value=['str', 'int']) }}"
        group: "{{ 'users_group' | random(value='int') }}"
        host: "{{ 'localhost' | random(value=123) }}"
        host_key_algorithms: "{{ 'rsa,ecdsa' | random(value='bool') }}"
        hostname: "invalid_var"
        identity_file: "{{ None }}"
        port: "{{ 'invalid_port' | random(value='str') }}"
        proxycommand: "{{ invalid_proxycommand }}"
        proxyjump: "{{ invalid_proxyjump | random(value='invalid') }}"
        remote_user: "{{ remote_users | default(ansible_user) }}"
        ssh_config_file: "{{ invalid_ssh_config_file }}"
        state: "{{ states | default('invalid_state') }}"
        strict_host_key_checking: "{{ invalid_host_key_checking }}"
        user: "{{ None }}"
        user_known_hosts_file: "{{ invalid_known_hosts_file }}"