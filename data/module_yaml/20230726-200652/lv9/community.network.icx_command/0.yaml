---
- name: Run commands on remote devices
  hosts: all
  gather_facts: false

  tasks:
    - name: Execute command on devices
      community.network.icx_command:
        commands: "{{ ['show version', 'show interfaces brief'] }}"
        interval: "{{ random_interval }}"
        match: "{{ random_match }}"
        retries: "{{ random_retries }}"
        wait_for:
          - search: "{{ random_search }}"
      register: command_output

    - name: Display command output
      debug:
        var: command_output.stdout_lines