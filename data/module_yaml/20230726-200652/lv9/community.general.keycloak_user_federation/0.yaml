- name: Test the keycloak_user_federation module
  hosts: localhost
  connection: local
  gather_facts: false

  vars:
    auth_client_id: "test_client_id"
    auth_client_secret: "test_client_secret"
    auth_keycloak_url: "http://localhost:8080/auth"
    auth_password: "test_password"
    auth_realm: "test_realm"
    auth_username: "test_user"
    connection_timeout: 10
    http_agent: "Ansible Tests"
    name: "test_federation"
    realm: "test_realm"
    state: "present"
    validate_certs: false

  tasks:
    - name: Create test federation
      community.general.keycloak_user_federation:
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        config:
          realm: "{{ realm }}"
          providerType: "dummy"
          priority: 10
        connection_timeout: "{{ connection_timeout }}"
        http_agent: "{{ http_agent }}"
        name: "{{ name }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - name: Print the result
      debug:
        var: result