---
- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false
  
  vars:
    api_host: "10.20.30.40"
    api_user: "admin"
    api_password: "password"
    api_token_id: "token_id"
    api_token_secret: "token_secret"
    node: "proxmox1"
    storage: "local"
    template: "ubuntu-20.04"
    src: "/templates/ubuntu-20.04.qcow2"
    state: "absent"
    timeout: 20
    validate_certs: true
    force: true

  tasks:
    - name: Create OS template
      community.general.proxmox_template:
        api_host: "{{ api_host }}"
        api_user: "{{ api_user }}"
        api_password: "{{ api_password }}"
        api_token_id: "{{ api_token_id }}"
        api_token_secret: "{{ api_token_secret }}"
        node: "{{ node }}"
        storage: "{{ storage }}"
        template: "{{ template }}"
        src: "{{ src }}"
        state: "{{ state }}"
        timeout: "{{ timeout }}"
        validate_certs: "{{ validate_certs }}"
        force: "{{ force }}"
      register: result

    - name: Debug result
      debug:
        var: result