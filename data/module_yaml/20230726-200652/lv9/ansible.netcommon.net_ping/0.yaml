---
- name: Test reachability using net_ping module
  hosts: all
  gather_facts: false

  tasks:
    - name: Formulate random IP addresses
      set_fact:
        dest_ip: "{{ (1..254)|random + 10 }}"
        source_ip: "{{ (1..254)|random + 10 }}"
        gateway_ip: "10.1.1.254"

    - name: Check reachability using net_ping module
      ansible.netcommon.net_ping:
        dest: "{{ dest_ip }}"
        source: "{{ source_ip }}"
        count: 5
      register: ping_test

    - name: Display ping results
      debug:
        var: ping_test