- name: Manage user-defined extended attributes using community.general.xattr
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set extended attribute
      community.general.xattr:
        path: /path/to/file
        key: example_key
        value: "example_value"
        state: "{{ hostvars[inventory_hostname]['ansible_distribution'] | random('absent', 'present') }}"
      register: xattr_result

    - debug:
        var: xattr_result