---
- name: Test Ansible latent type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create IPA User with invalid IP address
      community.general.ipa_user:
        displayname: John Doe
        uid: johndoe
        state: present
        ipa_host: "{{ random_ip() }}"
        ipa_user: admin
        ipa_pass: admin123
        validate_certs: false
      register: result

    - name: Print result
      debug:
        var: result

  vars:
    random_ips:
      - "255.255.255.256"  # Invalid IP address
      # Add more random IP addresses, including invalid ones, here for testing

  tasks:
    - name: Generate random IP address
      set_fact:
        ip_address: "{{ random_ips | shuffle | first }}"