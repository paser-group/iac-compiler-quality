---
- name: Create/Delete Server Groups
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Server Group
      community.general.clc_group:
        description: "Test server group"
        location: "VA1"
        name: "test-group"
        parent: "ABCD1234"
        state: "{{ ['present', 'absent'] | random }}"
        wait: "{{ [true, false] | random }}"
        ip_addr: "{{ ['10.1.1.1', '10.1.1.2', '10.1.1.3', '10.1.1.4'] | random }}"
      register: result_create
      changed_when: "'Nodes added' in result_create.msg"

    - name: Print Server Group details
      debug:
        var: result_create

    - name: Delete Server Group
      community.general.clc_group:
        description: "Test server group"
        location: "VA1"
        name: "test-group"
        parent: "ABCD1234"
        state: "{{ ['present', 'absent'] | random }}"
      register: result_delete
      changed_when: "'Nodes deleted' in result_delete.msg"

    - name: Print Delete result
      debug:
        var: result_delete