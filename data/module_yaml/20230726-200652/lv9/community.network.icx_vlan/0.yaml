---
- name: Manage VLANs on Ruckus ICX switches
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create VLAN
      community.network.icx_vlan:
        vlan_id: "{{ vlan }}"
        name: "{{ vlan_name }}"
        state: present
        interfaces: "{{ vlan_interfaces }}"
        tagged: "{{ vlan_tagged }}"
        stp: "{{ vlan_stp }}"
        ip_arp_inspection: "{{ vlan_ip_arp_inspection }}"
        ip_dhcp_snooping: "{{ vlan_ip_dhcp_snooping }}"
        aggregate: "{{ vlan_aggregate }}"
        associated_interfaces: "{{ vlan_associated_interfaces }}"
        associated_tagged: "{{ vlan_associated_tagged }}"
        check_running_config: "{{ vlan_check_running_config }}"
        delay: "{{ vlan_delay }}"
        purge: "{{ vlan_purge }}"
      vars:
        vlan: 100
        vlan_name: "VLAN100"
        vlan_interfaces:
          - ethernet 1/1
          - ethernet 1/2
        vlan_tagged:
          - ethernet 1/3
          - ethernet 1/4
        vlan_stp:
          enabled: true
        vlan_ip_arp_inspection: true
        vlan_ip_dhcp_snooping: true
        vlan_aggregate: true
        vlan_associated_interfaces:
          - ethernet 1/1
          - ethernet 1/2
        vlan_associated_tagged:
          - ethernet 1/3
          - ethernet 1/4
        vlan_check_running_config: true
        vlan_delay: 10
        vlan_purge: true

    - name: Test for random IP addresses
      community.network.icx_vlan:
        vlan_id: "{{ vlan }}"
        name: "{{ vlan_name }}"
        state: present
        interfaces: "{{ vlan_interfaces }}"
        tagged: "{{ vlan_tagged }}"
        stp: "{{ vlan_stp }}"
        ip_arp_inspection: "{{ vlan_ip_arp_inspection }}"
        ip_dhcp_snooping: "{{ vlan_ip_dhcp_snooping }}"
        aggregate: "{{ vlan_aggregate }}"
        associated_interfaces: "{{ vlan_associated_interfaces }}"
        associated_tagged: "{{ vlan_associated_tagged }}"
        check_running_config: "{{ vlan_check_running_config }}"
        delay: "{{ vlan_delay }}"
        purge: "{{ vlan_purge }}"
      vars:
        vlan: "{{ vlan_id }}"
        vlan_name: "VLAN{{ vlan_id }}"
        vlan_interfaces:
          - ethernet 1/1
          - ethernet 1/2
        vlan_tagged:
          - ethernet 1/3
          - ethernet 1/4
        vlan_stp:
          enabled: true
        vlan_ip_arp_inspection: true
        vlan_ip_dhcp_snooping: true
        vlan_aggregate: true
        vlan_associated_interfaces:
          - ethernet 1/1
          - ethernet 1/2
        vlan_associated_tagged:
          - ethernet 1/3
          - ethernet 1/4
        vlan_check_running_config: true
        vlan_delay: 10
        vlan_purge: true

...