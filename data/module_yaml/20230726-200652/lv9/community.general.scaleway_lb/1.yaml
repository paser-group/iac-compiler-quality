- name: Test random IP address
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ 10 | random }}.{{ 1 | random }}.{{ 1 | random }}.{{ 1 | random }}"

    - name: Create a Scaleway Load Balancer with random IP address
      community.general.scaleway_lb:
        api_token: "YOUR_API_TOKEN"
        api_timeout: 30
        api_url: "https://api.scaleway.com/"
        organization_id: "YOUR_ORGANIZATION_ID"
        name: "test-load-balancer"
        description: "Testing Load Balancer with Ansible"
        region: "par1"
        state: "present"
        tags:
          - "test"
        validate_certs: true
        wait: true
        wait_sleep_time: 5
        wait_timeout: 120
        query_parameters:
          ip: "{{ random_ip }}"
      register: lb_result

    - debug:
        var: lb_result