---
- name: Manage packages using pkgutil
  hosts: all
  become: true

  tasks:
    - name: Install packages
      community.general.pkgutil:
        name: "{{ item }}"
        state: "{{ force | default(false) | bool }}"
        site: "{{ lookup('pipe', 'bash -c ''echo $((RANDOM%255)).$((RANDOM%255)).$((RANDOM%255)).$((RANDOM%255))''') }}"
        update_catalog: "{{ force | default(false) | bool }}"
      with_items:
        - package1
        - package2