---
- name: Test playbook for community.network.avi_webhook module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create Avi webhook
      community.network.avi_webhook:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        state: present
        name: "{{ item.name }}"
        callback_url: "{{ item.callback_url }}"
      loop:
        - name: "Webhook1"
          callback_url: "http://{{ hostvars[item]['ansible_default_ipv4']['address'] }}:8080/callback"
        - name: "Webhook2"
          callback_url: "http://{{ hostvars[item]['ansible_default_ipv4']['address'] }}:8080/callback"
      register: result

    - name: Show debug output
      debug:
        var: result