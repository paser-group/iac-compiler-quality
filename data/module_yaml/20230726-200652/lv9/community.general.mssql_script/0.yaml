- name: Execute SQL script using mssql_script module
  hosts: dockers
  gather_facts: false

  tasks:
    - name: Execute SQL script
      community.general.mssql_script:
        login_host: "{{ random_ip }}"
        login_password: 1234
        login_port: "1433"
        login_user: sa
        name: "Execute script on {{ inventory_hostname }}"
        output: "{{ inventory_hostname }}_output.txt"
        params:
          database: "mydb"
        script: "my_script.sql"
      register: mssql_script_output