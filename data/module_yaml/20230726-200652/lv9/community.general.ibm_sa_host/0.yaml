- name: Test playbook for community.general.ibm_sa_host module
  hosts: localhost
  gather_facts: false

  vars:
    cluster: "my_cluster"
    domain: "my_domain"
    endpoints: "{{ item }}"
    host: "my_host"
    iscsi_chap_name: "my_chap_name"
    iscsi_chap_secret: "my_chap_secret"
    password: "my_password"
    state: "present"
    username: "my_username"

  tasks:
    - name: Generate random IP addresses for endpoints
      debug:
        msg: "{{ hostvars['localhost'].item }}"
      with_items:
        - "{{ ['https://192.168.0.1', 'https://192.168.0.2', 'https://192.168.0.3'] }}"
        - "{{ ['10.0.0.1', '10.0.0.2', '10.0.0.3'] }}"
        - "{{ 'https://192.168.0.4' }}"
        - "{{ 123 }}"
        - "{{ True }}"
        - "{{ None }}"

    - name: Add host to IBM Spectrum Accelerate
      community.general.ibm_sa_host:
        cluster: "{{ cluster }}"
        domain: "{{ domain }}"
        endpoints: "{{ endpoints }}"
        host: "{{ host }}"
        iscsi_chap_name: "{{ iscsi_chap_name }}"
        iscsi_chap_secret: "{{ iscsi_chap_secret }}"
        password: "{{ password }}"
        state: "{{ state }}"
        username: "{{ username }}"
      register: result

    - debug:
        var: result