---
- name: Test playbook for community.network.ce_vrrp module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Configure VRRP interface on Huawei device
      community.network.ce_vrrp:
        admin_flowdown: true
        admin_ignore_if_down: true
        admin_interface: null
        admin_vrid: null
        advertise_interval: null
        auth_key: null
        auth_mode: null
        fast_resume: null
        gratuitous_arp_interval: null
        holding_multiplier: null
        interface: null
        is_plain: true
        preempt_timer_delay: null
        priority: null
        recover_delay: null
        state: "present"
        version: null
        virtual_ip: null
        vrid: null
        vrrp_type: "ipv4"

      vars:
        vrrp_interface: "GigabitEthernet0/0/1"
        vrrp_vrid: 1
        vrrp_virtual_ip: "192.168.0.1"

      register: result

    - name: Debug result
      debug:
        var: result

    - name: Test case 1 - Random IP address
      community.network.ce_vrrp:
        admin_flowdown: "{{ item.admin_flowdown | default(false) }}"
        admin_ignore_if_down: "{{ item.admin_ignore_if_down | default(false) }}"
        admin_interface: "{{ item.admin_interface }}"
        admin_vrid: "{{ item.admin_vrid }}"
        advertise_interval: "{{ item.advertise_interval }}"
        auth_key: "{{ item.auth_key }}"
        auth_mode: "{{ item.auth_mode }}"
        fast_resume: "{{ item.fast_resume }}"
        gratuitous_arp_interval: "{{ item.gratuitous_arp_interval }}"
        holding_multiplier: "{{ item.holding_multiplier }}"
        interface: "{{ item.interface }}"
        is_plain: "{{ item.is_plain | default(false) }}"
        preempt_timer_delay: "{{ item.preempt_timer_delay }}"
        priority: "{{ item.priority }}"
        recover_delay: "{{ item.recover_delay }}"
        state: "{{ item.state }}"
        version: "{{ item.version }}"
        virtual_ip: "{{ item.virtual_ip }}"
        vrid: "{{ item.vrid }}"
        vrrp_type: "{{ item.vrrp_type }}"
      loop:
        - admin_flowdown: true
          admin_ignore_if_down: true
          admin_interface: null
          admin_vrid: null
          advertise_interval: null
          auth_key: null
          auth_mode: null
          fast_resume: null
          gratuitous_arp_interval: null
          holding_multiplier: null
          interface: null
          is_plain: true
          preempt_timer_delay: null
          priority: null
          recover_delay: null
          state: "present"
          version: null
          virtual_ip: null
          vrid: null
          vrrp_type: "ipv4"
        - admin_flowdown: true
          admin_ignore_if_down: false
          admin_interface: "GigabitEthernet0/0/1"
          admin_vrid: 2
          advertise_interval: 200
          auth_key: "password123"
          auth_mode: "simple-text"
          fast_resume: "enable"
          gratuitous_arp_interval: 1000
          holding_multiplier: 3
          interface: "{{ vrrp_interface }}"
          is_plain: false
          preempt_timer_delay: 100
          priority: 120
          recover_delay: 600
          state: "absent"
          version: "ipv6"
          virtual_ip: "{{ vrrp_virtual_ip }}"
          vrid: "{{ vrrp_vrid }}"
          vrrp_type: "ipv6"
        
      vars:
        vrrp_interface: "GigabitEthernet0/0/1"
        vrrp_vrid: 1
        vrrp_virtual_ip: "192.168.0.1"