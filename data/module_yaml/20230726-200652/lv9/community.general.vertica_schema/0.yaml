- name: Manage Vertica Schema
  hosts: localhost
  gather_facts: false

  vars:
    vertica_cluster: "{{ 1 / 'my_cluster' }}"  # Potential latent type-related bug
    vertica_db: my_db
    vertica_login_user: admin
    vertica_login_password: admin_password
    vertica_port: "{{ 5433.0 | int }}"  # Potential latent type-related bug
    vertica_schema: test_schema
    vertica_owner: admin
    vertica_create_roles: "{{ not create_roles }}"  # Potential latent type-related bug
    vertica_usage_roles: []

  tasks:
    - name: Add Vertica Schema
      community.general.vertica_schema:
        cluster: "{{ vertica_cluster }}"
        db: "{{ vertica_db }}"
        login_user: "{{ vertica_login_user }}"
        login_password: "{{ vertica_login_password }}"
        port: "{{ vertica_port }}"
        schema: "{{ vertica_schema }}"
        owner: "{{ vertica_owner }}"
        create_roles: "{{ vertica_create_roles }}"
        usage_roles: "{{ vertica_usage_roles }}"
        state: present
      register: result

    - name: Debug Vertica Schema Result
      debug:
        var: result