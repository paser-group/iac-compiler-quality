---
- name: Generate random IP address
  hosts: localhost
  gather_facts: false
  vars:
    subnet: 10.1.1.0/24
    gateway: 10.1.1.254

  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ subnet.split('/')[0] | ipaddr('{}/32'.format(subnet.split('/')[1])) | ipaddr(1) | ipaddr(gateway) }}"

    - name: Print random IP address
      debug:
        msg: "Random IP address: {{ random_ip }}"