---
- name: Test community.general.keycloak_role module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Set random IP address
      set_fact:
        auth_keycloak_url: "{{ 'http://' + lookup('pipe', 'shuf -i 1-255 -n 1') + '.' + lookup('pipe', 'shuf -i 1-255 -n 1') + '.' + lookup('pipe', 'shuf -i 1-255 -n 1') + '.' + lookup('pipe', 'shuf -i 1-255 -n 1') }}"
        auth_password: "test_password"

    - name: Configure Keycloak realm
      community.general.keycloak_role:
        auth_client_id: "admin-cli"
        auth_client_secret: "admin-password"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_realm: "master"
        auth_username: "admin"
        name: "TestRealm"
        realm: "test-realm"
        state: "present"
      register: keycloak_realm

    - name: Display output
      debug:
        var: keycloak_realm