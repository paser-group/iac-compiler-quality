---
- name: Test playbook for latent type-related bugs
  hosts: localhost
  gather_facts: false
  vars:
    # API credentials
    api_key: "YOUR_API_KEY"
    auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
    tenant_id: "YOUR_TENANT_ID"
    tenant_name: "YOUR_TENANT_NAME"
    username: "YOUR_USERNAME"

    # Networking details
    node_subnet: "10.1.1.0/24"
    node_gateway: "10.1.1.254"
    nodes:
      - name: ubuntu1
        ip: ""
      - name: alpine1
        ip: ""
      - name: centos1
        ip: ""
      - name: redhat1
        ip: ""

  tasks:
    - name: Generate random IP addresses for nodes
      block:
        - name: Include hidden_vars task
          include_tasks: hidden_vars.yml

        - name: Debug nodes
          debug:
            var: nodes

    - name: Configure networking for nodes
      block:
        - name: Configure network for nodes
          include_tasks: configure_network.yml

    - name: Manipulate Rackspace Cloud Block Storage attachments
      block:
        - name: Manipulate CBS attachments
          include_tasks: manipulate_cbs_attachments.yml