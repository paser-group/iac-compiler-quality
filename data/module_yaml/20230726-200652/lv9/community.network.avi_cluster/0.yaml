---
- name: Test playbook for community.network.avi_cluster module
  hosts: localhost
  gather_facts: false
  vars:
    api_version: "21.1.1"
    controller: "https://avi-controller.example.com"
    username: "admin"
    password: "password"
    tenant: "default"
    virtual_ip: "10.1.1.10"

  tasks:
    - name: Configure Avi cluster
      community.network.avi_cluster:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        nodes:
          - name: "ubuntu1"
            ip: "10.1.1.1"
            cluster_group_ref: "group_ref1"
          - name: "alpine1"
            ip: "10.1.1.2"
            cluster_group_ref: "group_ref2"
          - name: "centos1"
            ip: "10.1.1.3"
            cluster_group_ref: "group_ref3"
          - name: "redhat1"
            ip: "10.1.1.4"
            cluster_group_ref: "group_ref4"
        virtual_ip: "{{ virtual_ip }}"
        state: present
      register: result

    - name: Debug output
      debug:
        var: result