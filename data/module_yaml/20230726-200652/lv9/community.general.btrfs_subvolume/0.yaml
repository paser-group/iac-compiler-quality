---
- name: Test playbook for community.general.btrfs_subvolume module
  hosts: localhost
  gather_facts: false

  vars:
    automount: "{{ ['true', 'false'] | random }}"
    default: "{{ ['true', 'false'] | random }}"
    filesystem_device: "{{ ['dev/sda1', '/dev/sdb1'] | random }}"
    filesystem_label: "{{ ['btrfs1', 'btrfs2'] | random }}"
    filesystem_uuid: "{{ ['c3a48a63-379e-4a88-8fda-496cddc83bc7', 'd6b751f7-862d-4f7c-b669-3f679ed207d6'] | random }}"
    name: "{{ ['subvol1', 'subvol2'] | random }}"
    recursive: "{{ ['true', 'false'] | random }}"
    snapshot_conflict: "{{ ['oldest', 'newest'] | random }}"
    snapshot_source: "{{ ['subvol1', 'subvol2'] | random }}"
    state: "{{ ['present', 'absent'] | random }}"

  tasks:
    - name: Create btrfs subvolume
      community.general.btrfs_subvolume:
        automount: "{{ automount }}"
        default: "{{ default }}"
        filesystem_device: "{{ filesystem_device }}"
        filesystem_label: "{{ filesystem_label }}"
        filesystem_uuid: "{{ filesystem_uuid }}"
        name: "{{ name }}"
        recursive: "{{ recursive }}"
        snapshot_conflict: "{{ snapshot_conflict }}"
        snapshot_source: "{{ snapshot_source }}"
        state: "{{ state }}"
      register: result

    - name: Print task output
      debug:
        var: result