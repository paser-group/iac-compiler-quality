---
- name: Heuristic Test for community.network.aruba_config module
  hosts: localhost
  gather_facts: false

  vars:
    aruba_api_username: "admin"
    aruba_api_password: "password"
    aruba_host: "10.1.1.1"

  tasks:
    - name: Generate random IP addresses
      shell: python -c 'import random; import socket; import struct; print(socket.inet_ntoa(struct.pack(">I", random.randint(1,0xffffffff))))'
      register: random_ip_address

    - name: Configure Aruba Switch
      community.network.aruba_config:
        aruba_api_username: "{{ aruba_api_username }}"
        aruba_api_password: "{{ aruba_api_password }}"
        aruba_host: "{{ aruba_host }}"
        backup: True
        encrypt: True

      register: aruba_config_result

    - name: Debug Aruba configuration result
      debug:
        var: aruba_config_result