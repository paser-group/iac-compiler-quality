---
- name: Test community.network.pn_role module
  hosts: localhost
  gather_facts: false

  vars:
    pn_role_attributes:
      pn_name: "TestRole"
      pn_scope: "shared"
      pn_shell: true
      pn_sudo: true
      state: "present"
    random_ip_address: "{{ range(1,5) | random }}"

  tasks:
    - name: Create a role
      become: yes
      community.network.pn_role:
        pn_name: "{{ pn_role_attributes.pn_name }}"
        pn_scope: "{{ pn_role_attributes.pn_scope }}"
        pn_shell: "{{ pn_role_attributes.pn_shell }}"
        pn_sudo: "{{ pn_role_attributes.pn_sudo }}"
        pn_cliswitch: "management-interface ip address {{ random_ip_address }}/24"
        state: "{{ pn_role_attributes.state }}"
      register: result

    - debug:
        var: result