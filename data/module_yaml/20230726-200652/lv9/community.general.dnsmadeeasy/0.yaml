---
- name: Test dnsmadeeasy module
  hosts: localhost
  gather_facts: false
  
  vars:
    account_key: "your_account_key"
    account_secret: "your_account_secret"

  tasks:
    - name: Create A record with random IP addresses
      community.general.dnsmadeeasy:
        state: present
        domain: example.com
        record_name: www
        record_type: A
        record_ttl: 3600
        record_value: "{{ item }}"
        validate_certs: false
      with_items:
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"

    - name: Update A record with random IP addresses
      community.general.dnsmadeeasy:
        state: present
        domain: example.com
        record_name: www
        record_type: A
        record_ttl: 3600
        record_value: "{{ item }}"
        validate_certs: false
      with_items:
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='0123456789') }}"


    - name: Create MX record with random IP addresses
      community.general.dnsmadeeasy:
        state: present
        domain: example.com
        record_name: mail
        record_type: MX
        record_ttl: 3600
        record_value: "{{ 'mail.' + item }}"
        validate_certs: false
      with_items:
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"

    - name: Update MX record with random IP addresses
      community.general.dnsmadeeasy:
        state: present
        domain: example.com
        record_name: mail
        record_type: MX
        record_ttl: 3600
        record_value: "{{ 'mail.' + item }}"
        validate_certs: false
      with_items:
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"
        - "{{ lookup('community.general.random_string', length=10, chars='abcdefghijklmnopqrstuvwxyz') }}"