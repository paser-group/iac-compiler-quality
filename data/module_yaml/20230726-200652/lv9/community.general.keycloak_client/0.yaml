---
- name: Test playbook for keycloak_client module
  hosts: localhost
  gather_facts: false

  vars:
    client_attributes:
      some_key: some_value

  tasks:
    - name: Set random IP address for network module
      set_fact:
        ip_address: "{{ (1..254)|random }}"

    - name: Create Keycloak client
      community.general.keycloak_client:
        server_url: "https://{{ ip_address }}"
        admin_username: admin
        admin_password: admin
        realm: myrealm
        client_id: myclient
        state: present
        always_display_in_console: false
        attributes: "{{ client_attributes }}"
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        authentication_flow_binding_overrides: "{{ authentication_flow_binding_overrides }}"
        authorization_services_enabled: true
        authorization_settings: "{{ authorization_settings }}"
        base_url: "https://{{ ip_address }}"
        bearer_only: false
        client_authenticator_type: "client-authenticator-type"
        client_template: "client-template"
        connection_timeout: 10
        consent_required: true
        default_client_scopes: "{{ default_client_scopes }}"
        default_roles: "{{ default_roles }}"
        description: "Client description"
        direct_access_grants_enabled: true
        enabled: true
        frontchannel_logout: false
        full_scope_allowed: true
        http_agent: "HTTP Agent"
        implicit_flow_enabled: false
        name: "Client name"
        node_re_registration_timeout: 30
        not_before: 1617772800
        optional_client_scopes: "{{ optional_client_scopes }}"
        protocol: openid-connect
        protocol_mappers: "{{ protocol_mappers }}"
        public_client: false
        realm: "{{ realm }}"
        redirect_uris: ["https://example.com/redirect"]
        registered_nodes: "{{ registered_nodes }}"
        registration_access_token: "{{ registration_access_token }}"
        root_url: "https://{{ ip_address }}"
        secret: "{{ secret }}"
        service_accounts_enabled: true
        standard_flow_enabled: false
        state: present
        surrogate_auth_required: true
        token: "{{ token }}"
        use_template_config: false
        use_template_mappers: false
        use_template_scope: false
        validate_certs: true
        web_origins: ["https://example.com"]

      register: result

    - name: Debug result
      debug:
        var: result