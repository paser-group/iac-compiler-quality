- name: Configure BFD Global
  hosts: node-net
  gather_facts: false

  tasks:
    - name: Configure BFD Global
      community.network.ce_bfd_global:
        bfd_enable: "{{ random_bfd_enable }}"
        damp_init_wait_time: "{{ random_damp_init_wait_time }}"
        damp_max_wait_time: "{{ random_damp_max_wait_time }}"
        damp_second_wait_time: "{{ random_damp_second_wait_time }}"
        default_ip: "{{ random_ip }}"
        delay_up_time: "{{ random_delay_up_time }}"
        state: "{{ random_state }}"
        tos_exp_dynamic: "{{ random_tos_exp_dynamic }}"
        tos_exp_static: "{{ random_tos_exp_static }}"
      register: bfd_global_result

    - name: Debug BFD Global
      debug:
        var: bfd_global_result

  vars:
    random_bfd_enable: "{{ ['True', 'False'] | random }}"
    random_damp_init_wait_time: "{{ range(1, 10) | random }}"
    random_damp_max_wait_time: "{{ range(1, 10) | random }}"
    random_damp_second_wait_time: "{{ range(1, 10) | random }}"
    random_ip: "{{ hostvars[inventory_hostname]['ansible_default_ipv4']['address'] }}"
    random_delay_up_time: "{{ range(1, 10) | random }}"
    random_state: "{{ ['present', 'absent'] | random }}"
    random_tos_exp_dynamic: "{{ range(0, 8) | random }}"
    random_tos_exp_static: "{{ range(0, 8) | random }}"