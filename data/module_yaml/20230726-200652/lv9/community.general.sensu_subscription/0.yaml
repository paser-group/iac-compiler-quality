---
- name: Test playbook for sensu_subscription module
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Create sensu subscription
      community.general.sensu_subscription:
        backup: "{{ random_bool }}"
        name: "{{ random_string }}"
        path: "{{ random_string }}"
        state: "{{ random_state }}"
      vars:
        random_bool: "{{ random(['True', 'False']) }}"
        random_string: "{{ random_string(10) }}"
        random_state: "{{ random(['present', 'absent']) }}"
        
  vars:
    random_ip_address: "{{ random_string | regex_replace('^[a-z]', '10.1.1.') }}"
    random_string: "{{ random_string(10) }}"
  
  tasks:
    - name: Generate random IP address
      debug:
        msg: "{{ random_ip_address }}"
      run_once: true