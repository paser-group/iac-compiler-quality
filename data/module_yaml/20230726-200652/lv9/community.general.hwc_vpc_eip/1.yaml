---
- name: Create VPC EIP resource
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Generate random IP addresses
      set_fact:
        ipv4_address: "{{ range(4)|map('random_int', 1, 255)|join('.') }}"
        
    - name: Create VPC EIP resource
      community.general.hwc_vpc_eip:
        dedicated_bandwidth:
          name: Dedicated Bandwidth Test
          size: 100
        domain: example.com
        enterprise_project_id: '123456'
        id: 'eip-12345'
        identity_endpoint: 'https://identity.example.com'
        ip_version: 4
        ipv4_address: "{{ ipv4_address }}"
        password: 'secret'
        port_id: '123'
        project: 'my_project'
        region: 'us-east-1'
        shared_bandwidth_id: 'eip-bw-123'
        state: present
        timeouts:
          create: 300
          delete: 300
        type: dynamic
        user: 'admin'
      register: result

    - name: Display result
      debug:
        var: result