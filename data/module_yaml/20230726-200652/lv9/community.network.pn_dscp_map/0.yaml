- name: Test pn_dscp_map module
  hosts: localhost
  gather_facts: false

  vars:
    pn_cliswitch: "switch1"
    pn_name: "dscp_map1"
    pn_scope: null
    state: "present"

  tasks:
    - name: Generate random IP addresses
      set_fact:
        ip_addresses: "{{ item }}"
      loop:
        - "192.168.0.{{ 1 + (ansible_play_hosts.index(inventory_hostname) | default(0)) }}"
        - "10.0.0.{{ 1 + (ansible_play_hosts.index(inventory_hostname) | default(0)) }}"
    
    - name: Create pn_dscp_map
      community.network.pn_dscp_map:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        pn_scope: "{{ pn_scope }}"
        state: "{{ state }}"
        pn_ipv4networks:
          - "{{ ip_addresses }}"