---
- name: Manage Sensu client
  hosts: localhost
  gather_facts: false

  vars:
    # Random IP addresses for the networking modules
    address: "10.1.{{ (1,2,3,4)|random }}"

  tasks:
    - name: Configure Sensu client
      community.general.sensu_client:
        address: "{{ address }}"
        chef:
          option1: value1
          option2: value2
        deregister: false
        deregistration:
          option3: value3
          option4: value4
        ec2:
          option5: value5
          option6: value6
        keepalive:
          option7: value7
          option8: value8
        keepalives: true
        name: "sensu-client-{{ inventory_hostname }}"
        puppet:
          option9: value9
          option10: value10
        redact:
          - secret1
          - secret2
        registration:
          option11: value11
          option12: value12
        safe_mode: true
        servicenow:
          option13: value13
          option14: value14
        socket:
          option15: value15
          option16: value16
        state: present
        subscriptions:
          - webserver
          - database

      register: sensu_client_result

    - name: Debug Sensu client result
      debug:
        var: sensu_client_result