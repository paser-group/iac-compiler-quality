---
- name: Manage static routes on HUAWEI devices
  hosts: target_device
  gather_facts: false

  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ '10.1.1.' + (1 + (item|int)) | string }}"
      loop: "{{ range(4) | list }}"

    - name: Configure static route
      community.network.ce_static_route:
        aftype: "ipv4"
        description: "To example network"
        destvrf: ""
        mask: "24"
        next_hop: "{{ random_ip }}"
        nhp_interface: "eth0"
        pref: "1"
        prefix: "192.168.1.0"
        state: "present"
        tag: ""
        vrf: ""
      loop: "{{ range(4) | list }}"
      loop_control:
        loop_var: item