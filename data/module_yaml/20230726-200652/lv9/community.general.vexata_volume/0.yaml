---
- name: Manage Vexata Volumes
  hosts: localhost
  gather_facts: false
  become: true

  tasks:
    - name: Create Vexata Volume
      community.general.vexata_volume:
        array: "vexata1"
        name: "my_volume"
        password: "my_password"
        size: "10G"
        state: "present"
        user: "admin"
        validate_certs: false
      register: vol_result

    - name: Debug Vexata Volume Creation
      debug:
        var: vol_result

    - name: Delete Vexata Volume
      community.general.vexata_volume:
        array: "vexata1"
        name: "my_volume"
        password: "my_password"
        size: "10G"
        state: "absent"
        user: "admin"
        validate_certs: false
      register: del_result

    - name: Debug Vexata Volume Deletion
      debug:
        var: del_result

    - name: Test latent type-related bug (IP address)
      debug:
        var: "{{ hostvars[item].ansible_default_ipv4.address }}"
      with_items: "{{ groups['all'] }}"
      when: hostvars[item].ansible_default_ipv4.address is defined