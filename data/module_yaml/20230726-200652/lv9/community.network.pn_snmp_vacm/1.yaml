- name: Test playbook for pn_snmp_vacm module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ hostvars['localhost'].ansible_default_ipv4.address.split('.')[0] }}.{{ hostvars['localhost'].ansible_default_ipv4.address.split('.')[1] }}.{{ hostvars['localhost'].ansible_default_ipv4.address.split('.')[2] }}.{{ (1..254)|random }}"

    - name: Create SNMP user
      community.network.pn_snmp_vacm:
        pn_user_name: "{{ user_name }}"
        pn_user_type: "{{ user_type }}"
        pn_auth: "{{ auth }}"
        pn_priv: "{{ priv }}"
        pn_oid_restrict: "{{ oid_restrict }}"
        pn_cliswitch: "{{ cliswitch }}"
        state: "{{ state }}"
      vars:
        user_name: random_username
        user_type: random_usertype
        auth: random_boolean
        priv: random_boolean
        oid_restrict: random_string
        cliswitch: "{{ random_ip }}"
        state: random_state