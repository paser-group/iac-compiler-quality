---
- name: Test playbook for community.general.utm_proxy_frontend
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create reverse proxy frontend
      community.general.utm_proxy_frontend:
        name: Proxy1
        domain: example.com
        address: "{{ item.address }}"
        port: 80
        type: "{{ item.type }}"
        utm_host: utm.example.com
        utm_port: 8443
        utm_protocol: https
        utm_token: my_token
        allowed_networks: ["{{ item.allowed_networks }}"]
        validate_certs: "{{ item.validate_certs }}"
        state: present
      loop:
        - { address: 10.1.1.1, type: tcp, allowed_networks: "10.1.1.0/24", validate_certs: true }
        - { address: 10.1.1.2, type: http, allowed_networks: "10.1.1.0/24", validate_certs: false }
        - { address: 10.1.1.3, type: tcp, allowed_networks: "10.1.1.0/24", validate_certs: true }

  handlers:
    - name: Debug existing proxies
      debug:
        var: existing_proxies