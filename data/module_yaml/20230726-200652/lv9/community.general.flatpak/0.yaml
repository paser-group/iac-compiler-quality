---
- name: Test Ansible compiler for latent type-related bugs
  hosts: all
  gather_facts: false

  tasks:
    - name: Execute community.general.flatpak module
      community.general.flatpak:
        executable: /usr/bin/flatpak
        method: name
        name:
          - "{{ hostvars[item]['ansible_default_ipv4']['address'] }}"
        no_dependencies: "{{ hostvars[item]['ansible_distribution'] | length }}"
        remote: "{{ ['flathub', 'invalid_remote'] | random }}"
        state: "{{ hostvars[item]['ansible_memtotal_mb'] / hostvars[item]['ansible_memfree_mb'] }}"
      with_items: "{{ groups['all'] }}"