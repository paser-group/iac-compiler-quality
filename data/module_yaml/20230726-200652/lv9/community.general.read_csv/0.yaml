---
- name: Test the community.general.read_csv module
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Create a test CSV file with IP addresses
      copy:
        content: |
          IP
          192.168.1.1
          192.168.1.2
          192.168.1.3
        dest: /tmp/test.csv

    - name: Read the CSV file and register the output as a variable
      community.general.read_csv:
        path: /tmp/test.csv
        delimiter: ","
        dialect: "{{ not_exist }}"
        fieldnames:
          - IP
        key: "{{ not_exist }}"
        skipinitialspace: "{{ not_exist }}"
        strict: "{{ not_exist }}"
        unique: "{{ not_exist }}"
      register: csv_output

    - name: Debug the CSV output
      debug:
        var: csv_output