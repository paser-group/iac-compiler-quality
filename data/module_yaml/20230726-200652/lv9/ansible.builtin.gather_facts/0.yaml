---
- name: Gather Facts Playbook
  hosts: all
  gather_facts: false
  tasks:
    - name: Create network bridge
      docker_network:
        name: node-net
        state: present
        subnet: "10.1.1.0/24"
        gateway: "10.1.1.254"

    - name: Create Docker containers
      docker_container:
        name: "{{ item.name }}"
        image: "{{ item.image }}"
        state: started
        networks_cli_compatible: true
        network_mode: bridge
        networks:
          - name: node-net
        env:
          VAR1: "{{ item.ip }}"
      loop:
        - { name: "ubuntu1", image: "ubuntu:latest", ip: "10.1.1.1" }
        - { name: "alpine1", image: "alpine:latest", ip: "10.1.1.2" }
        - { name: "centos1", image: "centos:latest", ip: "10.1.1.3" }
        - { name: "redhat1", image: "redhat:latest", ip: "10.1.1.4" }

    - name: Gather facts
      ansible.builtin.gather_facts:
        parallel: True
      register: gathered_facts

    - name: Print gathered facts
      debug:
        var: gathered_facts