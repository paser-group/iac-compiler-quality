- name: Add hosts to inventory
  hosts: localhost
  gather_facts: false
  vars:
    ip_range: "10.1.1."
  tasks:
    - name: Generate random IP addresses
      set_fact:
        random_ip: "{{ ip_range + (1..4 | random |string) }}"
    
    - name: Add hosts dynamically
      ansible.builtin.add_host:
        name: "{{ item.name }}"
        groups: "{{ item.groups }}"
        ansible_host: "{{ item.ip }}"
      loop:
        - name: ubuntu1
          groups:
            - ubuntu
          ip: "{{ random_ip }}"
        - name: alpine1
          groups:
            - alpine
          ip: "{{ random_ip }}"
        - name: centos1
          groups:
            - centos
          ip: "{{ random_ip }}"
        - name: redhat1
          groups:
            - redhat
          ip: "{{ random_ip }}"