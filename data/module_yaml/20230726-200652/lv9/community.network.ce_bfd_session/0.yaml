---
- name: Manage BFD session configuration
  hosts: network_devices
  gather_facts: false

  tasks:
    - name: Generate random IP addresses
      vars:
        random_ip_subnet: "10.0.0.0/24"
        random_ip_address: "{{ random_ip_subnet | ipaddr('address') }}"
      debug:
        var: random_ip_address

    - name: Configure BFD session
      community.network.ce_bfd_session:
        addr_type: "{{ none | default(omit) }}"       # Set addr_type value
        create_type: "{{ none | default(omit) }}"     # Set create_type value
        dest_addr: "{{ random_ip_address }}"          # Set dest_addr value
        local_discr: "{{ none | default(omit) }}"     # Set local_discr value
        out_if_name: "{{ none | default(omit) }}"     # Set out_if_name value
        remote_discr: "{{ none | default(omit) }}"    # Set remote_discr value
        session_name: "{{ none | default(omit) }}"    # Set session_name value
        src_addr: "{{ none | default(omit) }}"        # Set src_addr value
        state: "{{ none | default(omit) }}"           # Set state value
        use_default_ip: "{{ bool | default(omit) }}"  # Set use_default_ip value
        vrf_name: "{{ none | default(omit) }}"        # Set vrf_name value
      register: bfd_result

    - name: Display result
      debug:
        var: bfd_result