---
- name: Manage Keycloak user role mappings
  hosts: localhost
  gather_facts: false

  vars:
    auth_client_id: "keycloak-client-id"
    auth_client_secret: "keycloak-client-secret"
    auth_keycloak_url: "https://keycloak-url.com"
    auth_password: "keycloak-admin-password"
    auth_realm: "keycloak-realm"
    auth_username: "keycloak-admin-username"
    cid: 12345
    connection_timeout: "10"
    validate_certs: true
    roles:
      - "role1"
      - "role2"
    target_username: "target-user"
  
  tasks:
    - name: Manage Keycloak User Role Mappings
      community.general.keycloak_user_rolemapping:
        auth_client_id: "{{ auth_client_id }}"
        auth_client_secret: "{{ auth_client_secret }}"
        auth_keycloak_url: "{{ auth_keycloak_url }}"
        auth_password: "{{ auth_password }}"
        auth_realm: "{{ auth_realm }}"
        auth_username: "{{ auth_username }}"
        cid: "{{ cid }}"
        connection_timeout: "{{ connection_timeout }}"
        validate_certs: "{{ validate_certs }}"
        roles: "{{ roles }}"
        target_username: "{{ target_username }}"
      register: keycloak_user_rolemapping_result

    - name: Debug Keycloak User Role Mapping Result
      debug:
        var: keycloak_user_rolemapping_result