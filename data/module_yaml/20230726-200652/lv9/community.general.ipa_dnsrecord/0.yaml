- hosts: localhost
  gather_facts: false

  tasks:
    - name: Create IPA DNS record
      community.general.ipa_dnsrecord:
        ipa_host: "ipa.example.com"
        ipa_user: "admin"
        ipa_pass: "password"
        ipa_port: 443
        ipa_prot: "https"
        ipa_timeout: 30
        record_name: "test-record"
        record_ttl: 3600
        record_type: "A"
        record_value: "{{ hostvars[inventory_hostname]['ansible_default_ipv4']['address'] }}"
        state: present
        validate_certs: false
        zone_name: "example.com"

    - name: Update IPA DNS record with multiple values
      community.general.ipa_dnsrecord:
        ipa_host: "ipa.example.com"
        ipa_user: "admin"
        ipa_pass: "password"
        ipa_port: 443
        ipa_prot: "https"
        ipa_timeout: 30
        record_name: "test-record"
        record_ttl: 3600
        record_type: "A"
        record_values:
          - "10.1.1.1"
          - "10.1.1.2"
          - "10.1.1.3"
        state: present
        validate_certs: false
        zone_name: "example.com"

    - name: Delete IPA DNS record
      community.general.ipa_dnsrecord:
        ipa_host: "ipa.example.com"
        ipa_user: "admin"
        ipa_pass: "password"
        ipa_port: 443
        ipa_prot: "https"
        ipa_timeout: 30
        record_name: "test-record"
        record_type: "A"
        state: absent
        validate_certs: false
        zone_name: "example.com"