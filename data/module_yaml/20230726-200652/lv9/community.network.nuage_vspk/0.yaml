- name: Test playbook for exposing latent type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    network_nodes:
      - { name: "ubuntu1", ip: "10.1.1.1", distribution: "Ubuntu" }
      - { name: "alpine1", ip: "10.1.1.2", distribution: "Alpine" }
      - { name: "centos1", ip: "10.1.1.3", distribution: "CentOS" }
      - { name: "redhat1", ip: "10.1.1.4", distribution: "Red Hat" }

  tasks:
    - name: Configure Docker network
      docker_network:
        name: node-net
        subnet: "10.1.1.0/24"
        gateway: "10.1.1.254"
        state: present
      
    - name: Create Docker nodes
      docker_container:
        name: "{{ item.name }}"
        image: "{{ item.distribution }}"
        state: started
        networks:
          - name: node-net
            ipv4_address: "{{ item.ip }}"
      loop: "{{ network_nodes }}"