- name: Retrieve facts from RHEL nodes
  hosts: all
  gather_facts: false

  tasks:
    - name: Set facts for RHEL nodes
      ansible.posix.rhel_facts:
        gather_subset:
          - network

    - name: Debug facts
      debug:
        var: ansible_facts.network_interfaces

- name: Formulate random IP addresses for networking modules
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random IP addresses
      shell: |
        python -c "import random; import socket; print(socket.inet_ntoa(struct.pack('>I', random.randint(1, 0xffffffff))))"
      register: random_ip

    - name: Debug random IP addresses
      debug:
        var: random_ip.stdout_lines