---
- name: Manage Eth-Trunk interfaces on HUAWEI devices
  hosts: huawei_devices
  gather_facts: false

  vars:
    collector_delay: 10
    fast_timeout: 600
    global_priority: 200
    max_active_linknumber: 2
    mixed_rate_link_enable: false
    mode: slow
    port_id_extension_enable: true
    preempt_delay: 5
    preempt_enable: true
    priority: 100
    select: 1
    state: present
    state_flapping: false
    system_id: '0011-2233-4455'
    timeout_type: slow
    trunk_id: 10
    unexpected_mac_disable: false

  tasks:
    - name: Configure Eth-Trunk interface
      community.network.ce_lacp:
        collector_delay: "{{ collector_delay }}"
        fast_timeout: "{{ fast_timeout }}"
        global_priority: "{{ global_priority }}"
        max_active_linknumber: "{{ max_active_linknumber }}"
        mixed_rate_link_enable: "{{ mixed_rate_link_enable }}"
        mode: "{{ mode }}"
        port_id_extension_enable: "{{ port_id_extension_enable }}"
        preempt_delay: "{{ preempt_delay }}"
        preempt_enable: "{{ preempt_enable }}"
        priority: "{{ priority }}"
        select: "{{ select }}"
        state: "{{ state }}"
        state_flapping: "{{ state_flapping }}"
        system_id: "{{ system_id }}"
        timeout_type: "{{ timeout_type }}"
        trunk_id: "{{ trunk_id }}"
        unexpected_mac_disable: "{{ unexpected_mac_disable }}"
      register: result

    - name: Display result
      debug:
        var: result

- name: Random IP Addresses Test
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random IP addresses
      set_fact:
        random_ip: "{{ (1, 1, 1, 1) | random('range', 256) }}.{{ (1, 1, 1, 1) | random('range', 256) }}.{{ (1, 1, 1, 1) | random('range', 256) }}.{{ (1, 1, 1, 1) | random('range', 256) }}"
      
    - name: Display random IP address
      debug:
        var: random_ip