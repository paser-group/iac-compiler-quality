---
- name: Test playbook for community.general.circonus_annotation module
  hosts: localhost
  gather_facts: false
  vars:
    api_key: "your_api_key_here"
    category: "your_category_here"
    description: "your_description_here"
    duration: 60
    start: 0
    stop: 1
    title: "your_title_here"

  tasks:
    - name: Formulate random IP address
      set_fact:
        random_ip: "{{ hostvars[item].ansible_default_ipv4.address }}"
      loop: "{{ groups['docker_nodes'] }}"

    - name: Create Circonus annotation
      community.general.circonus_annotation:
        api_key: "{{ api_key }}"
        category: "{{ category }}"
        description: "{{ description }}"
        duration: "{{ duration }}"
        start: "{{ start }}"
        stop: "{{ stop }}"
        title: "{{ title }}"
        tags:
          - "{{ random_ip }}"
      delegate_to: localhost
      run_once: true