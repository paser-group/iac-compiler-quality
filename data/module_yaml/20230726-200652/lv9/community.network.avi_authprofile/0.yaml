---
- name: Ansible Latent Bug Finder & Heuristic Test Playbook
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ 10.1.1.{{ (1, 2, 3, 4)|random }} }}"
  
    - name: Print random IP address
      debug:
        var: random_ip
  
    - name: Create AuthProfile
      community.network.avi_authprofile:
        controller: localhost
        username: admin
        password: password123
        tenant: admin
        name: test_authprofile
        type: "{{ ['http', 'saml', 'tacacs_plus', 'ldap']|random }}"
        avi_credentials:
          - api_version: "20.1.5"
            username: admin
            password: "{{ ['password1', 'password2', 'password3', 'password4']|random }}"
        avi_disable_session_cache_as_fact: false
        api_context:
          tenant_uuid: "{{ 10.1.1.1 | ip2long }}"
        state: present