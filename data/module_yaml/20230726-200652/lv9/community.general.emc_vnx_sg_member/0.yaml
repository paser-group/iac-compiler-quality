---
- name: Test playbook for 'emc_vnx_sg_member' module
  hosts: localhost
  gather_facts: false
  vars:
    sg_name: "storage_group"
    sp_user: "admin"
    sp_password: "password"
    lun_id: "{{ 100 | random(100, 999) }}"  # Generate a random LUN ID

    # Generate random IP addresses for network setup
    sp_address: "{{ 10.{{ random(10, 99) }}.{{ random(10, 99) }}.{{ random(10, 99) }} }}/24"

  tasks:
    - name: Create storage group
      community.general.emc_vnx_sg_member:
        name: "{{ sg_name }}"
        state: present
        sp_user: "{{ sp_user }}"
        sp_password: "{{ sp_password }}"
        sp_address: "{{ sp_address }}"
        lunid: "{{ lun_id }}"
      register: storage_group_result

    - name: Debug storage group creation result
      debug:
        var: storage_group_result