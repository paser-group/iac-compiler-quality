---
- name: IPA HBACRule Test
  hosts: localhost
  gather_facts: false

  vars:
    ipa_host: "your_ipa_host"
    ipa_user: "your_ipa_user"
    ipa_pass: "your_ipa_pass"
    ipa_port: 443
    ipa_prot: "https"
    ipa_timeout: 10
    validate_certs: false

  tasks:
    - name: Create HBACRule
      community.general.ipa_hbacrule:
        cn: "test_hbacrule"
        description: "Testing HBACRule"
        host:
          - "host1"
          - "host2"
        hostgroup:
          - "hostgroup1"
        ipa_host: "{{ ipa_host }}"
        ipa_user: "{{ ipa_user }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        ipa_timeout: "{{ ipa_timeout }}"
        validate_certs: "{{ validate_certs }}"
      register: hbacrule_result

    - name: Debug HBACRule result
      debug:
        var: hbacrule_result