---
- name: homebrew_tap_role
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Generate random IP addresses
      set_fact:
        random_ip_address: "{{ hostvars[item].ansible_default_ipv4.address }}"
      delegate_to: "{{ item }}"
      loop: "{{ groups['network_nodes'] }}"
      when: "'community.general.network' in facts.networking_modules | map(attribute='module_name')"

    - name: Print random IP addresses
      debug:
        var: random_ip_address