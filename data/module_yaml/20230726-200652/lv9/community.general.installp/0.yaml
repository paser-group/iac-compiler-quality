---
- name: Install packages playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random IP address
      set_fact:
        random_ip_address: "{{ ansible_become_pass | random(seed=inventory_hostname[0]) }}"

    - name: Install packages
      community.general.installp:
        accept_license: "{{ random_ip_address }}"
        name:
          - package1
          - package2
        repository_path: "/path/to/repository"
        state: latest