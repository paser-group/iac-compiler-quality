---
- name: Ansible Latent Bug Finder Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create or cancel a virtual machine
      community.general.sl_vm:
        cpus: "{{ random_int(1, 8) }}"
        datacenter: "{{ random_item(['dal10', 'sjc03']) }}"
        dedicated: "{{ random_bool }}"
        disks: "{{ random_disks() }}"
        domain: "{{ random_item(['example.com', 'test.local']) }}"
        flavor: "{{ random_item(['B1_1X2X100', 'C1_1X2X25']) }}"
        hostname: "{{ random_hostname() }}"
        hourly: "{{ random_bool }}"
        image_id: "{{ random_item(['20', '30', '40']) }}"
        instance_id: "{{ random_instance_id() }}"
        local_disk: "{{ random_bool }}"
        memory: "{{ random_int(2, 16) }}"
        nic_speed: "{{ random_int(1000, 10000) }}"
        os_code: "{{ random_item(['UBUNTU_14_64', 'RHEL_7_64']) }}"
        post_uri: "{{ random_item(['http://example.com/post_install_script', 'http://test.local/post_install_script']) }}"
        private: "{{ random_bool }}"
        private_vlan: "{{ random_vlan() }}"
        public_vlan: "{{ random_vlan() }}"
        ssh_keys: "{{ random_ssh_keys() }}"
        state: "{{ random_item(['present', 'absent']) }}"
        tags: "{{ random_item(['webserver', 'database', 'appserver']) }}"
        wait: "{{ random_bool }}"
        wait_time: "{{ random_int(60, 120) }}"
      register: result

    - debug:
        var: result