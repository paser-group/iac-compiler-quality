- name: Create and manage IPA hostgroup
  hosts: localhost
  gather_facts: false

  tasks:

  - name: Create new hostgroup
    community.general.ipa_hostgroup:
      state: present
      cn: test_group
      description: Test group

  - name: Add hosts to hostgroup
    community.general.ipa_hostgroup:
      state: present
      cn: test_group
      host:
        - ubuntu1.example.com
        - alpine1.example.com
        - centos1.example.com
        - redhat1.example.com

  - name: Remove hosts from hostgroup
    community.general.ipa_hostgroup:
      state: absent
      cn: test_group
      host:
        - ubuntu1.example.com
        - alpine1.example.com

  - name: Delete hostgroup
    community.general.ipa_hostgroup:
      state: absent
      cn: test_group