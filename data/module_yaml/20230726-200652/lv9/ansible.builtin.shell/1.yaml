---
- name: Execute shell commands
  hosts: all
  gather_facts: false

  vars:
    network_subnet: "10.1.1.0/24"
    network_gateway: "10.1.1.254"
    node_ips:
      ubuntu1: "10.1.1.1"
      alpine1: "10.1.1.2"
      centos1: "10.1.1.3"
      redhat1: "10.1.1.4"

  tasks:
    - name: Generate random IP address
      ansible.builtin.command: /usr/bin/openssl rand -hex 4
      args:
        chdir: "{{ inventory_dir }}"
      register: random_ip_output

    - name: Set random IP address fact
      set_fact:
        random_ip: "10.1.1.{{ random_ip_output.stdout }}"

    - name: Debug random IP address
      debug:
        var: random_ip