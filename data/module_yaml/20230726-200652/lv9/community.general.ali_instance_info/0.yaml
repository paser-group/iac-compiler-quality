- name: Gather instance information
  hosts: localhost
  gather_facts: False
  tasks:
    - name: Get instance info
      community.general.ali_instance_info:
        alicloud_access_key: "{{ lookup('env', 'ALICLOUD_ACCESS_KEY') }}"
        alicloud_secret_key: "{{ lookup('env', 'ALICLOUD_SECRET_KEY') }}"
        alicloud_region: "ap-southeast-1"
      register: instance_info

    - name: Debug instance info
      debug:
        var: instance_info

- name: Test recently introduced networking modules
  hosts: localhost
  gather_facts: False
  tasks:
    - name: Generate random IP addresses
      set_fact:
        random_ip_address: "{{ hostvars['localhost'].ansible_default_ipv4.address | default('10.1.1.1') }}"

    - name: Debug random IP address
      debug:
        var: random_ip_address