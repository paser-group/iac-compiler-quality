---
- name: Test playbook for community.network.avi_pool module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Include avinetworks collection
      include_role:
        name: avinetworks.ansible_collection

    - name: Create Avi Pool
      community.network.avi_pool:
        controller: "{{ controller }}"
        api_version: "{{ api_version }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        uuid: "{{ uuid }}"
        name: "{{ pool_name }}"
        lb_algorithm: "{{ lb_algorithm }}"
        servers: "{{ servers }}"
        state: "{{ pool_state }}"
      register: avi_pool

    - name: Debug avi_pool variable
      debug:
        var: avi_pool