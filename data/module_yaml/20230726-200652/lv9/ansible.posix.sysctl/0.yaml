---
- name: Test ansible.posix.sysctl module
  hosts: all
  gather_facts: no
  
  tasks:
    - name: Set sysctl value
      ansible.posix.sysctl:
        ignoreerrors: "{{ ignoreerrors | default(false) }}"
        name: "{{ name }}"
        reload: "{{ reload | default(false) }}"
        state: "{{ state | default('present') }}"
        sysctl_file: "{{ sysctl_file }}"
        sysctl_set: "{{ sysctl_set | default(true) }}"
        value: "{{ value }}"
      register: sysctl_result

    - name: Show sysctl value
      ansible.posix.sysctl:
      register: show_sysctl_result

    - name: Debug sysctl result
      debug:
        var: sysctl_result

    - name: Debug show sysctl result
      debug:
        var: show_sysctl_result

    - name: Generate random IP address
      set_fact:
        random_ip: "{{ hostvars['localhost']['ansible_default_ipv4']['address'] }}"
  
    - name: Debug random IP address
      debug:
        var: random_ip