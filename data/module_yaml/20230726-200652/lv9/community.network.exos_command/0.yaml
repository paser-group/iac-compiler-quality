---
- name: Execute commands on remote devices
  hosts: all
  gather_facts: false
  tasks:
    - name: Run command on remote device
      community.network.exos_command:
        commands: "{{ command }}"
        interval: "{{ interval }}"
        match: "{{ match }}"
        retries: "{{ retries }}"
        wait_for: "{{ wait_for }}"
      register: result

  vars:
    command: "{{ lookup('file', './commands.txt') }}"
    interval: "{{ lookup('env', 'INTERVAL') }}"
    match: 10
    retries: "{{ unknown_variable }}"
    wait_for: 20