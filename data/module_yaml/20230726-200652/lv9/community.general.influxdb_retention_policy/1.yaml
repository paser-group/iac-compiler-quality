---
- name: Generate random IP addresses
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate subnet IP address
      set_fact:
        subnet: "10.1.1.0/24"
        gateway: "10.1.1.254"

    - name: Generate random IP address
      set_fact:
        random_ip: "{{ subnet.split('/')[0] | ipaddr(IPaddr.options(nobroadcast=True, nostart=True, nomask=True)) }}"

    - debug:
        var: random_ip