---
- name: Manage InfluxDB retention policy
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create retention policy
      community.general.influxdb_retention_policy:
        hostname: "localhost"
        port: 8086
        username: "admin"
        password: "password"
        database_name: "mydb"
        policy_name: "mypolicy"
        duration: "7d"
        shard_group_duration: "1w"
        default: true
        state: present
      register: result

    - debug:
        var: result