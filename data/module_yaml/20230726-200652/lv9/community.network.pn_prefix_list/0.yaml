---
- name: Test playbook for community.network.pn_prefix_list module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create random IP address
      set_fact:
        random_ip_address: "{{ range(4)|map('random','1..254')|join('.') }}"

    - name: Create prefix list with random IP addresses
      community.network.pn_prefix_list:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        pn_scope: "{{ pn_scope }}"
        state: present
        prefix_lists:
          - name: prefix1
            ip_prefix: "{{ random_ip_address }}/32"
            remark: Test prefix list
          - name: prefix2
            ip_prefix: "{{ random_ip_address }}/32"
            remark: Test prefix list

  vars:
    pn_cliswitch: "ansible_network_os"
    pn_name: "TestPrefixList"
    pn_scope: "local"

# Define the random_ip_address filter
filters:
  random_ip_address: "{{ range(4)|map('random','1..254')|join('.') }}"