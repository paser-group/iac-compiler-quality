---
- name: Test playbook for community.general.pagerduty_change module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random IP addresses
      set_fact:
        ip_address_1: "{{ 10 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random }}"
        ip_address_2: "{{ 10 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random }}"
        ip_address_3: "{{ 10 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random }}"
        ip_address_4: "{{ 10 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random ~ '.' ~ 1 | random }}"

    - name: Test the community.general.pagerduty_change module
      community.general.pagerduty_change:
        environment: "production"
        integration_key: "your_integration_key"
        link_text: "Link Text"
        link_url: "https://example.com"
        repo: "ansible"
        revision: "12345"
        source: "github"
        summary: "An infrastructure change has occurred"
        url: "https://example.com"
        user: "ansible"
        validate_certs: false
        ip_address_1: "{{ ip_address_1 }}"
        ip_address_2: "{{ ip_address_2 }}"
        ip_address_3: "{{ ip_address_3 }}"
        ip_address_4: "{{ ip_address_4 }}"
      register: result
      
    - name: Display the result
      debug:
        var: result