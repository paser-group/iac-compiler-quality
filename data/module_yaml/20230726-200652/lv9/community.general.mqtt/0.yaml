- name: Publish MQTT message
  hosts: localhost
  tasks:
    - name: Publish message
      community.general.mqtt:
        server: "{{ mqtt_server }}"
        port: "{{ mqtt_port }}"
        client_id: "{{ mqtt_client_id }}"
        username: "{{ mqtt_username }}"
        password: "{{ mqtt_password }}"
        topic: "{{ mqtt_topic }}"
        payload: "{{ mqtt_payload }}"
        qos: "{{ mqtt_qos }}"
        retain: "{{ mqtt_retain }}"
      register: mqtt_publish_result

    - name: Display MQTT publish result
      debug:
        var: mqtt_publish_result