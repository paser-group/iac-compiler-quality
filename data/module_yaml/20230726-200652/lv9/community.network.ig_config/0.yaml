---
- hosts: localhost
  gather_facts: false
  vars:
    node_ips:
      - "{{ random | ipaddr(10, 1, 1, 1, 24) }}"
      - "{{ random | ipaddr(10, 1, 1, 2, 24) }}"
      - "{{ random | ipaddr(10, 1, 1, 3, 24) }}"
      - "{{ random | ipaddr(10, 1, 1, 4, 24) }}"
  tasks:
    - name: Configure network interfaces
      community.network.ig_config:
        path: "{{ item.path }}"
        add: "{{ item.add }}"
        delete: "{{ item.delete }}"
        modify: "{{ item.modify }}"
        no_response: "{{ item.no_response }}"
        revert: "{{ item.revert }}"
        store: "{{ item.store }}"
        table: "{{ item.table }}"
      loop:
        - { path: "{{ node_ips.0 }}", add: true, delete: false, modify: false, no_response: false, revert: false, store: false, table: "node-net" }
        - { path: "{{ node_ips.1 }}", add: true, delete: false, modify: false, no_response: false, revert: false, store: false, table: "node-net" }
        - { path: "{{ node_ips.2 }}", add: true, delete: false, modify: false, no_response: false, revert: false, store: false, table: "node-net" }
        - { path: "{{ node_ips.3 }}", add: true, delete: false, modify: false, no_response: false, revert: false, store: false, table: "node-net" }