- name: Test playbook for 'community.general.rax_meta' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random IP addresses for network nodes
      ansible.builtin.set_fact:
        ubuntu1_ip: "{{ '10.1.1.' ~ (1 + 4 * (ansible_random | int)) }}"
        alpine1_ip: "{{ '10.1.1.' ~ (2 + 4 * (ansible_random | int)) }}"
        centos1_ip: "{{ '10.1.1.' ~ (3 + 4 * (ansible_random | int)) }}"
        redhat1_ip: "{{ '10.1.1.' ~ (4 + 4 * (ansible_random | int)) }}"

    - name: Configure metadata for RAX
      community.general.rax_meta:
        address: "{{ ubuntu1_ip }}"
        api_key: "your_api_key"  # replace with actual API key
        auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0"
        credentials: "/path/to/credentials"
        env: "rax"
        id: "your_meta_id"  # replace with actual meta ID
        identity_type: "api_key"
        meta:
          server:
            name: "my_server"
        name: "rax_meta_test"
        region: "DFW"
        tenant_id: "your_tenant_id"  # replace with actual tenant ID
        tenant_name: "your_tenant_name"  # replace with actual tenant name
        username: "your_username"  # replace with actual username
        validate_certs: true

      register: result

    - name: Display result
      debug:
        var: result