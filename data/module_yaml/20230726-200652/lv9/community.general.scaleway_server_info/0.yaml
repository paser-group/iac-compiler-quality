---
- name: Gather information about Scaleway servers
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Gather server info
      community.general.scaleway_server_info:
        api_token: "{{ lookup('env', 'SCALEWAY_API_TOKEN') }}"
        api_url: "{{ lookup('env', 'SCALEWAY_API_URL') }}"
        region: "ams1"
        validate_certs: False
      register: server_info

    - name: Print server info
      debug:
        var: server_info

- name: Generate random IP address for networking modules
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Generate random IP
      set_fact:
        random_ip: "{{ hostvars['localhost']['ansible_all_ipv4_addresses'] | random }}"
    
    - name: Debug random IP
      debug:
        var: random_ip