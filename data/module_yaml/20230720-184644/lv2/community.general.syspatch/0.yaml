---
- name: Syspatch Heuristic Test
  hosts: all
  gather_facts: false
  tasks:
    - name: Check if syspatch module is available
      assert:
        that: "'syspatch' in lookup('ansible_modules', wantlist=True)"
        msg: "syspatch module is not available. Please install the 'community.general' collection."

    - name: Patch the system
      community.general.syspatch:
        revert: "False"

    - name: Verify syspatch operation
      community.general.syspatch_info:
      register: syspatch_output

    - name: Debug syspatch_output
      debug:
        var: syspatch_output