---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure firewall policy
      community.general.oneandone_firewall_policy:
        api_url: "https://api.example.com"
        auth_token: "auth_token_value"
        name: "My Firewall Policy"
        firewall_policy: "my_firewall_policy"
        description: "Firewall policy description"
        add_rules:
          - protocol: "TCP"
            port_from: 22
            port_to: 22
            source: 10.1.1.10
        add_server_ips:
          - "10.1.1.11"
          - b"10.1.1.12"    # Introduce byte string value
        remove_rules:
          - protocol: "ICMP"
            port_from: 123
            port_to: 123
            source: b"10.1.1.13"    # Introduce byte string value
        remove_server_ips:
          - "10.1.1.14"
          - b"10.1.1.15"    # Introduce byte string value
        rules:
          - protocol: "UDP"
            port_from: 500
            port_to: 500
            source: "10.1.1.16"
          - protocol: b"UDP"    # Introduce byte string value
            port_from: 600
            port_to: 600
            source: b"10.1.1.17"    # Introduce byte string value
        state: "present"
        wait: false
        wait_interval: 10
        wait_timeout: 60

      register: result

    - debug:
        var: result