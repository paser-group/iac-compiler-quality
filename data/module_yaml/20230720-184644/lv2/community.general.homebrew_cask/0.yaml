---
- name: Test playbook for community.general.homebrew_cask module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install Homebrew
      command: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
      args:
        creates: /usr/local/bin/brew

    - name: Install homebrew_cask module
      command: brew install ansible

    - name: Install and update Homebrew casks
      community.general.homebrew_cask:
        name:
          - bbedit
          - iterm2
          - visual-studio-code
        state: present
        update_homebrew: yes
        upgrade_all: yes
        accept_external_apps: true
        greedy: true
        install_options:
          - "--force"
          - "--no-quarantine"
          - "--no-sandbox"
        path: /Applications
        sudo_password: ansible

    # Other tasks go here...