---
- name: Test playbook for latent type-related bugs in community.general.ldap_entry module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Add LDAP entry with regular string values
      community.general.ldap_entry:
        dn: "cn=John Doe,ou=Users,dc=example,dc=com"
        objectClass:
          - top
          - person
        attributes:
          givenName: "John"
          sn: "Doe"
          cn: "John Doe"
          mail: "johndoe@example.com"
        state: present

    - name: Add LDAP entry with byte string values
      community.general.ldap_entry:
        dn: "cn=Jane Smith,ou=Users,dc=example,dc=com"
        objectClass:
          - top
          - person
        attributes:
          givenName: "{{ '\x4a\x61\x6e\x65' | from_json }}"
          sn: "{{ '\x53\x6d\x69\x74\x68' | from_json }}"
          cn: "{{ '\x4a\x61\x6e\x65\x20\x53\x6d\x69\x74\x68' | from_json }}"
          mail: "{{ '\x6a\x61\x6e\x65\x73\x6d\x69\x74\x68\x40\x65\x78\x61\x6d\x70\x6c\x65\x2e\x63\x6f\x6d' | from_json }}"
        state: present