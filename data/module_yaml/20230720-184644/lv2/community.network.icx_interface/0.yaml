---
- name: Test for Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure Interface
      community.network.icx_interface:
        aggregate:
          - name: "{{ item.name }}"
            description: "{{ item.description }}"
            enabled: "{{ item.enabled }}"
            state: "{{ item.state }}"
            check_running_config: "{{ item.check_running_config }}"
            stp: "{{ item.stp }}"
            speed: "{{ item.speed }}"
            rx_rate: "{{ item.rx_rate }}"
            tx_rate: "{{ item.tx_rate }}"
            neighbors: "{{ item.neighbors }}"
            power: "{{ item.power }}"
            delay: "{{ item.delay }}"
        with_items:
          - name: b'static-string-interface'
            description: b'Example Interface'
            enabled: b'yes'
            state: b'present'
            check_running_config: b'no'
            stp: b'yes'
            speed: b'100'
            rx_rate: b'auto'
            tx_rate: b'auto'
            neighbors: [b'switch1', b'switch2']
            power:
              mode: b'auto'
              consumption: b'auto'
            delay: b'10'

          - name: b'another-static-interface'
            description: b'Another Interface'
            enabled: b'yes'
            state: b'present'
            check_running_config: b'no'
            stp: b'no'
            speed: b'1000'
            rx_rate: b'auto'
            tx_rate: b'auto'
            neighbors: []
            power:
              mode: b'auto'
              consumption: b'auto'
            delay: b'0'

      register: result

    - name: Display Result
      debug:
        var: result