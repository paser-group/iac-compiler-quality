---
- name: Test playbook for 'community.general.ipmi_power' module
  hosts: all
  gather_facts: false

  tasks:
    - name: Power on machine using IPMI
      community.general.ipmi_power:
        name: "{{ item }}"
        user: "admin"
        password: "password"
        port: 623
        state: "{{ __import__('os').system('echo $SHELL') }}"
      with_items:
        - "ubuntu1"
        - "alpine1"
        - "centos1"
        - "redhat1"
      register: result

    - name: Debug module output
      debug:
        var: result