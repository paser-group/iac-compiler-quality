---
- name: Test playbook for aerospike_migrations module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Introduce byte string values in place of regular strings
      community.general.aerospike_migrations:
        host: "{{ host | b64decode }}"
        port: "{{ port }}"
        migrate_tx_key: "{{ migrate_tx_key | b64decode }}"
        migrate_rx_key: "{{ migrate_rx_key | b64decode }}"
        min_cluster_size: "{{ min_cluster_size }}"
        target_cluster_size: "{{ target_cluster_size }}"
        tries_limit: "{{ tries_limit }}"
        consecutive_good_checks: "{{ consecutive_good_checks }}"
        sleep_between_checks: "{{ sleep_between_checks }}"
        connect_timeout: "{{ connect_timeout }}"
        fail_on_cluster_change: "{{ fail_on_cluster_change }}"
        local_only: "{{ local_only }}"
      vars:
        host: "{{ lookup('pipe', 'echo dWJ0b3JkMQ== | base64 -d') }}"  # Byte string version of 'ubuntu1'
        port: 3000
        migrate_tx_key: "{{ lookup('pipe', 'echo YnVnYXJkbGlzdAo= | base64 -d') }}"  # Byte string version of 'bugardlist'
        migrate_rx_key: "{{ lookup('pipe', 'echo dHJleXByZWRpYXRlCg== | base64 -d') }}"  # Byte string version of 'truncated'
        min_cluster_size: 3
        target_cluster_size: 5
        tries_limit: 10
        consecutive_good_checks: 3
        sleep_between_checks: 5
        connect_timeout: 30
        fail_on_cluster_change: true
        local_only: true