---
- name: Test Consul Session Module
  hosts: localhost
  gather_facts: false

  vars:
    datacenter: "DC1"
    node: "node1"
    checks:
      - "check1"
      - "check2"

  tasks:
    - name: Create Consul Session with Byte String Values
      community.general.consul_session:
        name: vvv
        node: !vault |
          $ANSIBLE_VAULT;1.2;AES256;mysecretpassword
          66323135386237343061343335383334336238333631373135323435323261656130333864313966
          3366313231363932653632623136363663646636626464660a633965653539623361393338343237
          33306564363234316234303339383436383031396331313330343038303339666166343238636537
          3364313162373961640a633866636532613538376538386537383639656364336131653439356264
          3039
        datacenter: 123
        checks: "{{ checks }}"
        state: present
      register: result

    - name: Debug Module Output
      debug:
        var: result