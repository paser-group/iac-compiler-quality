- name: Generate AIX system backup
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Backup AIX system
      community.general.mksysb:
        name: "{{ b'backup_' + inventory_hostname }}"
        storage_path: "/tmp/backups/{{ inventory_hostname }}"
        use_snapshot: True
        software_packing: False
        create_map_files: True
        exclude_files: True
        exclude_wpar_files: True
        extended_attrs: True
        backup_dmapi_fs: True
        backup_crypt_files: True
        new_image_data: True
      register: backup_result

    - name: Debug backup result
      debug:
        var: backup_result