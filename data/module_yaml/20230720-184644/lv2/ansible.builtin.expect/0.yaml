- name: Execute command with expect
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Execute command with expect
      ansible.builtin.expect:
        command: "ls {{ inventory_hostname }}"
        responses:
          - "file exists"
        timeout: 5
      register: result
      
    - name: Debug output
      debug:
        var: result.stdout_lines