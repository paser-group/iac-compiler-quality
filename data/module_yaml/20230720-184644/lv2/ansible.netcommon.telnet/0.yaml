- name: Test playbook for ansible.netcommon.telnet module
  hosts: localhost
  gather_facts: false
  
  tasks:
  
    - name: Install telnet
      apt:
        name: telnet
        state: present
      become: true
      become_user: root
      when: ansible_distribution == 'Ubuntu'

    - name: Install telnet
      apk:
        name: busybox-extras
        state: present
      become: true
      become_user: root
      when: ansible_distribution == 'Alpine'

    - name: Install telnet
      yum:
        name: telnet
        state: present
      become: true
      become_user: root
      when: ansible_distribution == 'CentOS'

    - name: Install telnet
      yum:
        name: telnet
        state: present
      become: true
      become_user: root
      when: ansible_distribution == 'RedHat'

    - name: Execute telnet command with byte string values
      ansible.netcommon.telnet:
        host: "10.1.1.1"
        port: 23
        login_prompt: "$(echo -e 'Login:\n\r')"
        password: b'password'
        password_prompt: b'Password:'
        prompts:
          - b"$"
        command:
          - b'echo "Hello World!"'
        send_newline: no
        timeout: 10
        user: b'admin'