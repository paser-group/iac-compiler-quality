- name: Manage GitLab hook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create GitLab hook
      community.general.gitlab_hook:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: b"API_TOKEN"
        project: "my-project"
        hook_url: "https://my-webhook.com"
        state: present
      register: hook_result

    - name: Debug hook result
      debug:
        var: hook_result

    - name: Modify GitLab hook
      community.general.gitlab_hook:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "API_TOKEN"
        project: b"my-project"
        hook_url: b"https://my-updated-webhook.com"
        state: present
      register: modified_hook_result

    - name: Debug modified hook result
      debug:
        var: modified_hook_result

    - name: Delete GitLab hook
      community.general.gitlab_hook:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: b"API_TOKEN"
        project: "my-project"
        state: absent
      register: delete_result

    - name: Debug delete result
      debug:
        var: delete_result