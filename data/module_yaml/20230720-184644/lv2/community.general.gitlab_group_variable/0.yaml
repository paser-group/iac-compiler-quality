---
- name: Test playbook for gitlab_group_variable module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create GitLab group variable
      community.general.gitlab_group_variable:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "your_token_here"
        group: "example-group"
        state: "present"
        variables:
          - key: "variable1"
            value: b"byte string value"
          - key: "variable2"
            value: "regular string value"
      register: create_result
      ignore_errors: true

    - name: Debug create_result
      debug:
        var: create_result

    - name: Update GitLab group variable
      community.general.gitlab_group_variable:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "your_token_here"
        group: "example-group"
        state: "present"
        variables:
          - key: "variable1"
            value: "updated byte string value"
          - key: "variable2"
            value: b"updated regular string value"
      register: update_result
      ignore_errors: true

    - name: Debug update_result
      debug:
        var: update_result

    - name: Delete GitLab group variable
      community.general.gitlab_group_variable:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "your_token_here"
        group: "example-group"
        state: "absent"
        variables:
          - key: "variable1"
          - key: "variable2"
      register: delete_result
      ignore_errors: true

    - name: Debug delete_result
      debug:
        var: delete_result