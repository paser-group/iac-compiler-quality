---
# inventory file content:
# node1 ansible_host=10.1.1.1 ansible_connection=docker
# node2 ansible_host=10.1.1.2 ansible_connection=docker
# node3 ansible_host=10.1.1.3 ansible_connection=docker
# node4 ansible_host=10.1.1.4 ansible_connection=docker

- name: Test Ansible Latent Type-Related Bugs
  hosts: all
  gather_facts: false
  vars:
    auth_token: "{{ lookup('env', 'PACKET_AUTH_TOKEN') }}"
    cidr: "10.0.0.0/29"
    device_count: 1
    device_id: "device123"
    hostname: "ansible_node"
    project_id: "project123"
    state: "present"

  tasks:
    - name: Assign IP subnet to Packet
      community.general.packet_ip_subnet:
        auth_token: "{{ auth_token }}"
        cidr: "{{ cidr }}"
        device_count: "{{ device_count }}"
        device_id: "{{ device_id }}"
        hostname: "{{ hostname }}"
        project_id: "{{ project_id }}"
        state: "{{ state }}"
      register: result

    - debug:
        var: result