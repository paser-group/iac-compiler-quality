---
- name: Expose Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Define variables
      set_fact:
        username: b"{{ username }}"
        password: b"{{ password }}"

    - name: Debug variable types
      debug:
        var: "{{ item }}"
      loop: "{{ [username, password, api_version] }}"

    - name: Introduce byte string
      set_fact:
        api_version: "{{ api_version | b64encode }}"

    - name: Convert byte string to int
      set_fact:
        api_version: "{{ api_version | int }}"

    - name: Introduce byte string in inventory
      lineinfile:
        path: inventory.yml
        line: "ansible_host={{ item }} ansible_user=b'{{ username }}' ansible_password=b'{{ password }}'"
      loop:
        - "10.1.1.1"
        - "10.1.1.2"
        - "10.1.1.3"
        - "10.1.1.4"

    - name: Include nonexistent playbook
      include_playbook: "{{ nonexistent_playbook }}"

    - name: Introduce undefined variable
      debug:
        var: "{{ undefined_variable }}"