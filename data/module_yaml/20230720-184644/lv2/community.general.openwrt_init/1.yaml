---
- name: Test playbook for latent type-related bugs in community.general.openwrt_init module
  hosts: localhost
  gather_facts: False

  vars:
    openwrt_devices:
      - enabled: true
        name: b'openwrt1'   # Using byte string value
        pattern: 'openwrt-*'
        state: present
      - enabled: false
        name: b'openwrt2'   # Using byte string value
        pattern: 'openwrt-*'
        state: absent
      - enabled: true
        name: b'openwrt3'   # Using byte string value
        pattern: 'openwrt-*'
        state: latest

  tasks:
    - name: Ensure OpenWrt devices are initialized
      community.general.openwrt_init:
       enabled: "{{ item.enabled }}"
       name: "{{ item.name }}"
       pattern: "{{ item.pattern }}"
       state: "{{ item.state }}"
      loop: "{{ openwrt_devices }}"