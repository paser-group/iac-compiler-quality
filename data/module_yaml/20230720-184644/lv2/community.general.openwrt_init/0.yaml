---
- name: Test playbook for latent type-related bugs in community.general.openwrt_init module
  hosts: localhost
  gather_facts: False

  vars:
    openwrt_devices:
      - enabled: true
        name: 'openwrt1'
        pattern: 'openwrt-*'
        state: present
      - enabled: false
        name: 'openwrt2'
        pattern: 'openwrt-*'
        state: absent
      - enabled: true
        name: 'openwrt3'
        pattern: 'openwrt-*'
        state: latest

  tasks:
    - name: Ensure OpenWrt devices are initialized
      community.general.openwrt_init:
        enabled: "{{ item.enabled }}"
        name: "{{ item.name }}"
        pattern: "{{ item.pattern }}"
        state: "{{ item.state }}"
      loop: "{{ openwrt_devices }}"