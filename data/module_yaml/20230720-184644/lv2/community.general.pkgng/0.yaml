---
- name: Test pkgng module
  hosts: localhost
  gather_facts: false

  vars:
    # Define the package names for testing
    packages:
      - nginx
      - "{{ b'somepackage' }}"
      - redis

  tasks:
    - name: Install packages
      pkgng:
        name: "{{ packages }}"
        state: present
      register: result
      when: "'somepackage' in packages"

    - name: Display installed packages
      debug:
        var: result

    - name: Remove packages
      pkgng:
        name: "{{ packages }}"
        state: absent
      when: "'somepackage' in packages"