---
- name: Test playbook for 'community.general.statsd' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set test variables
      vars:
        delta: true
        host: "10.1.1.1"
        metric: "metric_test"
        metric_prefix: "prefix_test"
        metric_type: "counter"
        port: 8125
        protocol: "udp"
        state: "present"
        timeout: 5.0
        value: 100

    - name: Introduce byte string values in place of regular strings
      set_fact:
        host: !vault |
          'gAAAAABgSM7-s8sj0z2HdPRpaAPFuG04qV4aCivXL64jnGzBU__B_RwxH8vmirZA
           E4EUuNlHz9RLumkzM0y2wiHTrPH8p3S0Lw=='
        metric: !vault |
          'gAAAAABgSM7-yKUz2w6JtTGTNJYiY95Gatg_YwOJbJh2-Byem1Rcm5n-8ymzotGW
           B7__cv0dK0KU9pqN7ixkvLJlTTr6XJARWw=='
        metric_prefix: !vault |
          'gAAAAABgSM7-7YQiyr8ZKpskeCrdS6U0kRT47T-4kTCLB3Z0dXeJx9Ofc57HnH-W
           EyjzLV2wXMmhkduAG2LeLbIf47crrsW11w=='
        metric_type: !vault |
          'gAAAAABgSM7-oBQRmtG2Th_MsBrlN5exrW36gKer19TpELvIKHU0Cl0qkEaixF7P
           QomVNSBsGHUTrFCAhpeVa2drKDhmAwcS2g=='
        protocol: !vault |
          'gAAAAABgSM7-R-XVKiEMbWXRGsR5SifV-X5SMTk8yUAZVVzkQxVyBWZ3NdTavH7u
           dMxxOZXHDUqITMfE5KuXQybrf7CS_c3Nwg=='
        state: !vault |
          'gAAAAABgSM7-1Wr-B-Eg-GIs19F1zA7-gY-nw6D0akprnZUkYoKQfJ7g-nRLEk1v
           Ig8hD__pykuRe1FdjfVbfBQEGCpGfyAxhQ=='

    - name: Debug byte string values
      debug:
        var:
          host: "{{ host }}"
          metric: "{{ metric }}"
          metric_prefix: "{{ metric_prefix }}"
          metric_type: "{{ metric_type }}"
          protocol: "{{ protocol }}"
          state: "{{ state }}"

    - name: Run 'community.general.statsd' module with byte string values
      community.general.statsd:
        delta: "{{ delta }}"
        host: "{{ host }}"
        metric: "{{ metric }}"
        metric_prefix: "{{ metric_prefix }}"
        metric_type: "{{ metric_type }}"
        port: "{{ port }}"
        protocol: "{{ protocol }}"
        state: "{{ state }}"
        timeout: "{{ timeout }}"
        value: "{{ value }}"