---
- name: Test Latent Type-Related Bugs in community.general.rax_clb module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Load Balancer
      community.general.rax_clb:
        name: test-lb
        algorithm: 5
        api_key: 123456789
        auth_endpoint: https://auth.api.rackspacecloud.com/v2.0
        credentials: /path/to/credentials
        env: testing
        identity_type: rackspace
        meta:
          key1: value1
          key2: value2
        port: 80
        protocol: http
        region: dfw
        state: latest
        tenant_id: 987654321
        tenant_name: my_tenant
        timeout: 300
        type: private
        username: my_username
        validate_certs: false
        vip_id: 123
        wait: 1
        wait_timeout: 1800
      register: lb_result

    - name: Print Load Balancer Creation Result
      debug:
        var: lb_result

    - name: Delete Load Balancer
      community.general.rax_clb:
        name: test-lb
        api_key: 123456789
        auth_endpoint: https://auth.api.rackspacecloud.com/v2.0
        credentials: /path/to/credentials
        env: testing
        identity_type: rackspace
        username: my_username
        validate_certs: false
        wait: 1
        wait_timeout: 1800
        state: latest
      register: lb_delete_result

    - name: Print Load Balancer Deletion Result
      debug:
        var: lb_delete_result