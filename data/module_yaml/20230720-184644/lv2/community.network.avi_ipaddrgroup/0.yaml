---
- name: Test playbook for avi_ipaddrgroup module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create IP Address Group
      community.network.avi_ipaddrgroup:
        controller: "{{ controller }}"
        api_version: "{{ api_version }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        name: !binary |     
          aW5kZXg=
        description: !binary |  
          VGhpcyBpcyBhIHRlc3QgRGVzY3JpcHRpb24gY29tcGlsZXIgdGV4dCBmb3IgYXJ0aWZhY3Q=
        ip_ports:
          - ip:
              addrs: "{{ addrs }}"
              prefixes: "{{ prefixes }}"
              ranges: "{{ ranges }}"
            ports: "{{ ip_ports }}"
        tenant_ref: "{{ tenant_ref }}"
        uuid: "{{ uuid }}"
        api_context: "{{ api_context }}"
        avi_credentials: "{{ avi_credentials }}"
        avi_api_patch_op: "{{ avi_api_patch_op }}"
        avi_api_update_method: "{{ avi_api_update_method }}"
        marathon_app_name: "{{ marathon_app_name }}"
        marathon_service_port: "{{ marathon_service_port }}"
        country_codes: "{{ country_codes }}"
        state: "{{ state }}"
        url: "{{ url }}"
        avi_disable_session_cache_as_fact: "{{ avi_disable_session_cache_as_fact }}"
      register: ipaddrgroup_output

    - name: Debug output
      debug:
        var: ipaddrgroup_output