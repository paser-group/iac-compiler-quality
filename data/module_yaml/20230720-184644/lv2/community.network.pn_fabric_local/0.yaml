---
- name: Test playbook for pn_fabric_local
  hosts: localhost
  gather_facts: false

  vars:
    pn_cliswitch: ansible_connection=local
    pn_vlan: "100"
    pn_control_network: null
    pn_fabric_advertisement_network: null
    pn_fabric_network: null
    state: present

  tasks:
    - name: Install the 'pynetbox' package
      pip:
        name: pynetbox
        state: present

    - name: Create a local fabric network in PN Fabric
      community.network.pn_fabric_local:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_vlan: "{{ pn_vlan }}"
        pn_control_network: "{{ pn_control_network }}"
        pn_fabric_advertisement_network: "{{ pn_fabric_advertisement_network }}"
        pn_fabric_network: "{{ pn_fabric_network }}"
        state: "{{ state }}"
      register: result

    - name: Debug PN Fabric result
      debug:
        var: result