---
- name: Manage VLANs on Extreme Networks switches
  hosts: switches
  gather_facts: false

  vars:
    vlans:
      - { id: 10, name: b'VLAN 10', state: b'absent' }
      - { id: 20, name: b'VLAN 20', state: b'present', config: b'create vlan VLAN-20 tag 20' }
    
  tasks:
    - name: Configure VLANs
      community.network.exos_vlans:
        config: "{{ item.config }}"
        id: "{{ item.id }}"
        name: "{{ item.name }}"
        state: "{{ item.state }}"
        provider:
          command_string: "b'ssh username@{{ inventory_hostname }}'"
      loop: "{{ vlans }}"