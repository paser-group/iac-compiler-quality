- hosts: localhost
  gather_facts: false
  tasks:
    - name: Install required module
      pip:
        name: community.general

- hosts: all
  gather_facts: false
  tasks:
    - name: Track code or infrastructure change as a PagerDuty event
      community.general.pagerduty_change:
        environment: "production"
        integration_key: "YOUR_INTEGRATION_KEY"
        link_text: "Code Repository"
        link_url: "https://github.com/your-repo"
        repo: "Your Repository"
        revision: "abc123"
        source: "Ansible Playbook"
        summary: "Code or Infrastructure Change"
        url: "https://example.com"
        user: "John Doe"
        validate_certs: false
      register: pagerduty_result

    - name: Debug PagerDuty response
      debug:
        var: pagerduty_result