---
- name: Test playbook for community.general.sudoers module
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Test with byte string value for command
      community.general.sudoers:
        name: "%b'\x74\x65\x73\x74'"
        state: present
        sudoers_path: "/etc/sudoers"
        command:
          - "%b'\x65\x63\x68\x6f'"
          - "%b'\x6e\x61\x70\x73\x68\x6f\x74'"

    - name: Test with byte string value for group
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        group: "%b'\x67\x72\x6f\x75\x70'"

    - name: Test with byte string value for host
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        host: "%b'\x68\x6f\x73\x74'"

    - name: Test with byte string value for nopassword
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        nopassword: "%b'\x31'"

    - name: Test with byte string value for runas
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        runas: "%b'\x72\x75\x6e\x61\x73'"

    - name: Test with byte string value for setenv
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        setenv: "%b'\x30'"

    - name: Test with byte string value for sudoers_path
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "%b'\x2f\x65\x74\x63\x2f\x73\x75\x64\x6f\x65\x72\x73'"
        user: "testuser"

    - name: Test with byte string value for user
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        user: "%b'\x75\x73\x65\x72'"

    - name: Test with byte string value for validation
      community.general.sudoers:
        name: "test"
        state: present
        sudoers_path: "/etc/sudoers"
        validation: "%b'\x74\x65\x73\x74'"