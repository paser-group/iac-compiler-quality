---
- name: Test playbook for latent type-related bugs
  hosts: localhost
  gather_facts: false
  become: false

  vars:
    package_id: 'blueprint-1'
    package_params:
      param1: 'value1'
      param2: 'value2'
    server_ids:
      - 'server1'
      - 'server2'
    state: 'present'
    wait: 'yes'

  tasks:
    - name: Set byte string values
      set_fact:
        package_id_byte: b'blueprint-1'
        package_params_byte: "{ param1: b'value1', param2: b'value2' }"
        server_ids_byte: "[ b'server1', b'server2' ]"
        state_byte: b'present'
        wait_byte: b'yes'

    - name: Deploy blueprint package with regular string values
      community.general.clc_blueprint_package:
        package_id: "{{ package_id }}"
        package_params: "{{ package_params }}"
        server_ids: "{{ server_ids }}"
        state: "{{ state }}"
        wait: "{{ wait }}"
      register: result_regular_strings

    - name: Deploy blueprint package with byte string values
      community.general.clc_blueprint_package:
        package_id: "{{ package_id_byte }}"
        package_params: "{{ package_params_byte }}"
        server_ids: "{{ server_ids_byte }}"
        state: "{{ state_byte }}"
        wait: "{{ wait_byte }}"
      register: result_byte_strings

    - name: Print regular string results
      debug:
        var: result_regular_strings

    - name: Print byte string results
      debug:
        var: result_byte_strings