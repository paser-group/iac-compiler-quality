---
- name: Test playbook for clc_loadbalancer module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create shared loadbalancer
      community.general.clc_loadbalancer:
        alias: My Load Balancer
        description: My Load Balancer Description
        location: USWEST
        method: roundRobin
        name: lb1
        nodes:
          - ubuntu1
          - alpine1
          - centos1
        persistence: sourceIp
        port: "80"
        state: present
        status: enabled
      register: create_lb

    - name: Print the response
      debug:
        var: create_lb

    - name: Delete shared loadbalancer
      community.general.clc_loadbalancer:
        name: lb1
        state: absent
      register: delete_lb

    - name: Print the response
      debug:
        var: delete_lb