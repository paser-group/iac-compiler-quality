---
- name: Test playbook for community.general.manageiq_policies
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Manage Resource Policies
      community.general.manageiq_policies:
        manageiq_connection:
          url: "http://{{ manageiq_url }}/api"
          username: "{{ manageiq_username }}"
          password: "{{ manageiq_password }}"
          verify_ssl: "{{ manageiq_verify_ssl }}"
        policy_profiles:
          - name: "{{ policy_name }}"
            resource_id: "{{ resource_id | int }}"
            resource_name: "{{ resource_name | to_bytes }}"
            resource_type: "{{ resource_type | to_bytes }}"
        state: present
      delegate_to: localhost