---
- name: Test playbook for community.general.proxmox_template module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Convert variable to byte string
      set_fact:
        proxmox_storage_bytes: "{{ proxmox_storage | string | to_bytes }}"

    - name: Create proxmox template
      community.general.proxmox_template:
        api_host: "https://{{ proxmox_api_host }}"
        api_user: "root@pam"
        api_password: "{{ proxmox_api_password }}"
        api_token_id: "{{ proxmox_api_token_id }}"
        api_token_secret: "{{ proxmox_api_token_secret }}"
        node: "{{ proxmox_node }}"
        storage: "{{ proxmox_storage_bytes }}"  # Introduce byte string
        template: "{{ proxmox_template }}"
        src: "/path/to/template.qcow2"
        state: present
        validate_certs: false
        timeout: 30
        force: "{{ proxmox_force|bool }}"
        content_type: "{{ proxmox_content_type }}"

      # Add additional options, if needed

      register: result

    - name: Display module output
      debug:
        var: result

    # Add more tasks for verification or further testing