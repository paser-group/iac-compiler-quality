- name: Test playbook for community.general.hwc_vpc_peering_connect module
  hosts: localhost
  gather_facts: false

  vars:
    description: "Test VPC peering connection"
    domain: "{{ ansible_domain }}"
    id: "vpc-peering-123"
    identity_endpoint: "https://identity.example.com"
    local_vpc_id: "vpc-123456"
    name: "Test User"
    password: "test_password"
    project: "test_project"
    region: "us-west"
    state: "present"
    timeouts:
      create: 300
      delete: 180
    user: "test_user"

  tasks:
    - name: Create VPC peering connection
      community.general.hwc_vpc_peering_connect:
        description: '{{ description | b64encode }}'
        domain: '{{ domain | b64encode }}'
        id: '{{ id | b64encode }}'
        identity_endpoint: '{{ identity_endpoint | b64encode }}'
        local_vpc_id: '{{ local_vpc_id | b64encode }}'
        name: '{{ name | b64encode }}'
        password: '{{ password | b64encode }}'
        peering_vpc:
          vpc_id: "vpc-654321"
          region: '{{ region | b64encode }}'
        project: '{{ project | b64encode }}'
        region: '{{ region | b64encode }}'
        state: '{{ state | b64encode }}'
        timeouts:
          create: '{{ timeouts.create }}'
          delete: '{{ timeouts.delete }}'
        user: '{{ user | b64encode }}'
      register: vpc_peering_conn

    - name: Debug VPC peering connection
      debug:
        var: vpc_peering_conn