---
- name: Manage A10 Service Group
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure A10 service group
      community.network.a10_service_group:
        host: localhost
        username: "{{ 'admin' | to_bytes }}"
        password: "{{ 'admin' | to_bytes }}"
        state: present
        service_group: "{{ 'web' | to_bytes }}"
        service_group_protocol: "{{ 'http' | to_bytes }}"
        service_group_method: "{{ 'round-robin' | to_bytes }}"
        servers: "{{ servers }}"
      vars:
        servers:
          - name: "{{ 'host1' | to_bytes }}"
            ip: "{{ '10.1.1.5' | to_bytes }}"
            port: "{{ 80 | to_bytes }}"
          - name: "{{ 'host2' | to_bytes }}"
            ip: "{{ '10.1.1.6' | to_bytes }}"
            port: "{{ 80 | to_bytes }}"

      register: result

    - name: Print result
      debug:
        var: result