---
- name: Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a Scaleway instance with byte string values
      community.general.scaleway_compute:
        api_timeout: 30
        api_token: "{{ lookup('env', 'SCALEWAY_API_TOKEN') }}"
        api_url: "{{ lookup('env', 'SCALEWAY_API_URL') }}"
        commercial_type: !ruby/object:OpenSSL::ASN1::PrintableString "VC1S"
        enable_ipv6: true
        image: !python/object/new:types.StringType "ubuntu-focal"
        name: !array:bytearray [116, 101, 115, 116, 45, 105, 110, 115, 116, 97, 110, 99, 101]
        organization: !binary |-
          b'my-org'
        project: !binary |-
          b'my-project'
        public_ip: null
        query_parameters:
          zone: !binary |-
            b'par1'
        region: !ruby/object:OpenSSL::ASN1::PrintableString 'fr-par'
        security_group: !ruby/object:OpenSSL::ASN1::PrintableString 'default'
        state: !python/tuple [!ruby/object:IO {}]
        tags:
          - !ruby/object:OpenSSL::ASN1::PrintableString 'tag1'
          - !ruby/object:OpenSSL::ASN1::PrintableString 'tag2'
        validate_certs: false
        wait: true
        wait_sleep_time: 5
        wait_timeout: 300
      register: scaleway_instance

    - name: Debug instance creation result
      debug:
        var: scaleway_instance