- name: Create Keycloak client
  hosts: localhost
  gather_facts: false

  vars:
    admin_url: "https://example.com/auth"
    auth_username: "admin"
    auth_password: "admin123"
    realm: "myrealm"
    client_id: "myclient"
    client_secret: "supersecret"

  tasks:
    - name: Create Keycloak client
      community.general.keycloak_client:
        admin_url: "{{ admin_url }}"
        auth_username: "{{ auth_username }}"
        auth_password: "{{ auth_password }}"
        realm: "{{ realm }}"
        client_id: "{{ client_id }}"
        client_secret: "{{ client_secret }}"
        redirect_uris:
          - "https://example.com/callback"

  # Test Case 1: Introduce byte string value for admin_url
    - name: Test Case 1 - Introduce byte string value for admin_url
      community.general.keycloak_client:
        admin_url: !!binary |
          aHR0cHM6Ly9leGFtcGxlLmNvbS9hdXRoCg==
        auth_username: "{{ auth_username }}"
        auth_password: "{{ auth_password }}"
        realm: "{{ realm }}"
        client_id: "{{ client_id }}"
        client_secret: "{{ client_secret }}"
        redirect_uris:
          - "https://example.com/callback"

  # Test Case 2: Introduce byte string value for client_id
    - name: Test Case 2 - Introduce byte string value for client_id
      community.general.keycloak_client:
        admin_url: "{{ admin_url }}"
        auth_username: "{{ auth_username }}"
        auth_password: "{{ auth_password }}"
        realm: "{{ realm }}"
        client_id: !!binary |
          bXljLWNsaWVudA==
        client_secret: "{{ client_secret }}"
        redirect_uris:
          - "https://example.com/callback"

  # Test Case 3: Introduce byte string value for client_secret
    - name: Test Case 3 - Introduce byte string value for client_secret
      community.general.keycloak_client:
        admin_url: "{{ admin_url }}"
        auth_username: "{{ auth_username }}"
        auth_password: "{{ auth_password }}"
        realm: "{{ realm }}"
        client_id: "{{ client_id }}"
        client_secret: !!binary |
          c3VwZXJzZWNyZXQK
        redirect_uris:
          - "https://example.com/callback"