---
- name: Test playbook for 'community.network.icx_config' module
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Configure Ruckus ICX device
      community.network.icx_config:
        backup: true
        before:
          - show configuration
        running_config: "{{ lookup('file', 'running_config.txt') }}"
        src: "{{ inventory_hostname }}_config.txt"
        match: strict
      register: config_result

    - name: Display configuration diff
      debug:
        var: config_result.diff

    - name: Display backup file path
      debug:
        var: config_result.backup_path