---
- name: Manage VPN instance address family
  hosts: localhost
  gather_facts: false
  vars:
    evpn: true
    route_distinguisher: "test-rd"
    state: present
    vpn_target_state: present
    vpn_target_type: import
    vpn_target_value: ["target:value"]
    vrf: "test-vrf"
    vrf_aftype: ipv4
  tasks:
    - name: Manage VPN instance address family
      community.network.ce_vrf_af:
        provider: "{{ cli }}"
        evpn: "{{ evpn }}"
        route_distinguisher: "{{ route_distinguisher }}"
        state: "{{ state }}"
        vpn_target_state: "{{ vpn_target_state }}"
        vpn_target_type: "{{ vpn_target_type }}"
        vpn_target_value: "{{ vpn_target_value }}"
        vrf: "{{ vrf }}"
        vrf_aftype: "{{ vrf_aftype }}"
      register: result

    - debug:
        var: result