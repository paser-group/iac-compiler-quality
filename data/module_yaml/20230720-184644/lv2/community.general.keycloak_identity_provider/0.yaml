---
- name: Test playbook for community.general.keycloak_identity_provider module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install keycloak python module
      pip:
        name: "keycloak"
        state: present

    - name: Ensure Keycloak identity provider is configured
      community.general.keycloak_identity_provider:
        state: present
        realm: my-realm
        provider_id: my-provider
        alias: !binary "|ZmxhZyA9IGRvbw=="  # Introduce byte string value
        token: "{{ 'my-token' }}"  # Use regular string
        auth_realm: !binary |  # Introduce byte string value using YAML block style
          |
          YXV0aC1yZWFsbTogdXBkYXRlZA==
        auth_password: "{{ 'auth-password' | b64encode }}"  # Encode regular string to byte string
        auth_username: "{{ 'auth-username' }}"  # Use regular string
      register: result

    - debug:
        var: result