---
- name: Test Webfaction DB Module
  hosts: localhost
  gather_facts: false

  vars:
    login_name: ansible_user
    login_password: ansible_password
    machine: ansible_hostname
    name: mydatabase
    password: mypassword
    state: present
    type: postgresql

  tasks:

    # Test case 1: Introduce byte string values in place of regular strings
    - name: Introduce byte strings
      community.general.webfaction_db:
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        machine: "{{ machine }}"
        name: "{{ name | b64encode }}"
        password: "{{ password | b64encode }}"
        state: "{{ state | b64encode }}"
        type: "{{ type | b64encode }}"
      register: result_1
      ignore_errors: true

    - debug:
        var: result_1

    # Test case 2: Normal execution without byte string values
    - name: Normal execution
      community.general.webfaction_db:
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        machine: "{{ machine }}"
        name: "{{ name }}"
        password: "{{ password }}"
        state: "{{ state }}"
        type: "{{ type }}"
      register: result_2
      ignore_errors: true

    - debug:
        var: result_2