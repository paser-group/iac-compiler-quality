---
- name: Configure NIC of a Qemu(KVM) VM
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set network configuration
      community.general.proxmox_nic:
        api_host: "https://{{ ansible_host }}"
        api_user: "{{ api_user }}"
        api_password: "{{ api_password }}"
        api_token_id: "{{ api_token_id }}"
        api_token_secret: "{{ api_token_secret }}"
        vmid: "{{ vmid }}"
        name: "{{ name | b64encode }}"
        interface: "{{ interface | b64encode }}"
        mac: "{{ mac | b64encode }}"
        model: "{{ model | b64encode }}"
        mtu: "{{ mtu }}"
        bridge: "{{ bridge | b64encode }}"
        rate: "{{ rate }}"
        queues: "{{ queues }}"
        trunks: "{{ trunks }}"
        tag: "{{ tag }}"
        link_down: "{{ link_down }}"
        firewall: "{{ firewall }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"

      register: result

    - name: Debug the result
      debug:
        var: result