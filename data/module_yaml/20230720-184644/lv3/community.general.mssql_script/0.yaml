---
- name: Execute SQL script using mssql_script module
  hosts: localhost
  gather_facts: false

  vars:
    login_host: 127.0.0.1
    login_user: sa
    login_password: password123
    login_port: "1433"
    name: Test Script
    output: stdout
    params:
      database: SampleDB
    script: |
      SELECT *
      FROM sample_table;

  tasks:
    - name: Execute mssql_script
      community.general.mssql_script:
        login_host: "{{ login_host }}"
        login_user: "{{ login_user }}"
        login_password: "{{ login_password }}"
        login_port: "{{ login_port }}"
        name: "{{ name }}"
        output: "{{ output }}"
        params: "{{ params }}"
        script: "{{ script }}"
      register: result

    - name: Debug result
      debug:
        var: result