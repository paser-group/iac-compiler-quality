---
- name: Schedule command or script execution
  hosts: all
  gather_facts: false

  tasks:
    - name: Schedule command execution
      ansible.posix.at:
        command: "{{ item.command }}"
        count: "{{ item.count }}"
        state: "{{ item.state }}"
        unique: "{{ item.unique | default(true) }}"
        units: "{{ item.units | default('minutes') }}"
      register: result
      loop:
        - { command: "echo {{ '\"Hello, world!\"' }}", count: 1, state: "present" }
        - { command: "ls -l", count: 1, state: "absent" }
        - { command: "date > {{ '/tmp/date.txt' }}", count: 1, state: "present", units: "hours" }
        # Add more test cases based on the heuristic

    - name: Print scheduled command result
      debug:
        var: result