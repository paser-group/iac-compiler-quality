---
- name: Test playbook for community.general.rax_mon_entity module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Rackspace Cloud Monitoring Entity
      community.general.rax_mon_entity:
        agent_id: !binary |-
          agent1
        api_key: !binary |-
          some_api_key
        auth_endpoint: !binary |-
          https://identity.api.rackspacecloud.com/v2.0
        credentials: !binary |-
          /path/to/credentials.pem
        env: !binary |-
          prod
        identity_type: !binary |-
          rackspace
        label: !binary |-
          My_Entity
        metadata: 
          key1: !binary |-
            value1
          key2: !binary |-
            value2
        named_ip_addresses:
          ip_address1:
            version: !binary |-
              ipv4
            address: !binary |-
              192.168.0.1
          ip_address2:
            version: !binary |-
              ipv6
            address: !binary |-
              ::1
        region: !binary |-
          DFW
        state: !binary |-
          present
        tenant_id: !binary |-
          abc123
        tenant_name: !binary |-
          my_tenant
        username: !binary |-
          my_username
        validate_certs: True
      register: entity_creation_result

    - name: Show creation result
      debug:
        var: entity_creation_result

    - name: Delete Rackspace Cloud Monitoring Entity
      community.general.rax_mon_entity:
        agent_id: !binary |-
          agent1
        api_key: !binary |-
          some_api_key
        auth_endpoint: !binary |-
          https://identity.api.rackspacecloud.com/v2.0
        credentials: !binary |-
          /path/to/credentials.pem
        env: !binary |-
          prod
        identity_type: !binary |-
          rackspace
        label: !binary |-
          My_Entity
        metadata: 
          key1: !binary |-
            value1
          key2: !binary |-
            value2
        named_ip_addresses:
          ip_address1:
            version: !binary |-
              ipv4
            address: !binary |-
              192.168.0.1
          ip_address2:
            version: !binary |-
              ipv6
            address: !binary |-
              ::1
        region: !binary |-
          DFW
        state: !binary |-
          absent
        tenant_id: !binary |-
          abc123
        tenant_name: !binary |-
          my_tenant
        username: !binary |-
          my_username
        validate_certs: True
      register: entity_deletion_result

    - name: Show deletion result
      debug:
        var: entity_deletion_result