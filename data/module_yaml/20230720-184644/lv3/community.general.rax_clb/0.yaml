---
- name: Create a Rackspace load balancer
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a load balancer
      community.general.rax_clb:
        region: "dfw"
        credentials: "/path/to/credentials"
        name: "my-lb"
        port: 80
        protocol: "HTTP"
        wait: true
        wait_timeout: 900
        validate_certs: true
        identity_type: "v1"
        tenant_name: "my-tenant"
        username: "my-username"
        api_key: "my-api-key"
        type: "PUBLIC"

      register: lb_result

    - name: Print load balancer creation result
      debug:
        var: lb_result

    - name: Delete load balancer
      community.general.rax_clb:
        region: "dfw"
        credentials: "/path/to/credentials"
        name: "my-lb"
        state: "absent"
        validate_certs: true
        identity_type: "v1"
        tenant_name: "my-tenant"
        username: "my-username"
        api_key: "my-api-key"

      register: lb_delete_result

    - name: Print load balancer deletion result
      debug:
        var: lb_delete_result