---
- name: Test ansible.syspatch module
  hosts: all
  gather_facts: false

  tasks:
    - name: Install syspatch if not already installed
      package:
        name: syspatch
        state: present

    - name: Trigger syspatch execution
      community.general.syspatch:
        revert: "{{ revert_var | default('no') }}"
      register: syspatch_output
      changed_when: false

    - name: Debug syspatch output
      debug:
        var: syspatch_output