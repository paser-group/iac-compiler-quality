- name: Manage packages using dnf
  hosts: all
  become: true
  tasks:
    - name: Install packages
      dnf:
        name:
          - httpd
          - python3
          - nano
        state: present
        validate_certs: true
        download_only: false
        releasever: '32'
        security: false
        sslverify: true
        conf_file: "/etc/dnf/dnf.conf"
        disable_excludes:
          - update
        update_cache: true
        enable_plugin:
          - plugin1
          - plugin2
      register: dnf_output

    - name: Debug dnf output
      debug:
        var: dnf_output.stdout_lines

    - name: Remove packages
      dnf:
        name:
          - nano
        state: absent
        validate_certs: false
        download_only: false
        releasever: '32'
        security: true
        sslverify: false
        conf_file: "/etc/dnf/dnf.conf"
        disable_excludes: ''
        update_cache: false
        enable_plugin:
          - plugin1
          - plugin2
      register: dnf_output2

    - name: Debug dnf output 2
      debug:
        var: dnf_output2.stdout_lines