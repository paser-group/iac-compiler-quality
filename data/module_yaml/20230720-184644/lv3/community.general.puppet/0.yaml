- name: Execute puppet module
  hosts: all
  gather_facts: false

  tasks:
    - name: Run puppet module
      community.general.puppet:
        certname: "puppet-cert"
        confdir: "/etc/puppet"
        debug: true
        environment: "production"
        execute: "apply"
        facter_basename: "/usr/bin/facter"
        facts:
          fact1: "value1"
          fact2: "value2"
        logdest: "/var/log/puppet.log"
        manifest: "/etc/puppet/manifests/site.pp"
        modulepath: "/etc/puppet/modules"
        noop: false
        puppetmaster: "puppet-master"
        show_diff: true
        skip_tags:
          - tag1
          - tag2
        summarize: true
        tags:
          - tag3
        timeout: "30s"
        use_srv_records: true
        verbose: true
      register: puppet_output

    - name: Debug puppet output
      debug:
        var: puppet_output