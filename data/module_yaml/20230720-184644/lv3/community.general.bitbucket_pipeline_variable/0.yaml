---

- name: Manage Bitbucket Pipeline Variables
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Bitbucket Pipeline Variable
      community.general.bitbucket_pipeline_variable:
        client_id: "my_client_id"              # Specify the Bitbucket App client_id
        client_secret: "my_client_secret"      # Specify the Bitbucket App client_secret
        name: "my_variable_name"               # Specify the name of the pipeline variable
        password: "my_password"                # Specify the Bitbucket password
        repository: "my_repository"            # Specify the name of the Bitbucket repository
        secured: False                         # Set to True if the variable should be secured
        state: "present"                        # Specify "present" to create/update the variable
        user: "my_username"                     # Specify the Bitbucket username
        value: "{{ my_variable_value }}"       # Specify the value of the pipeline variable
        workspace: "my_workspace"               # Specify the Bitbucket workspace

      vars:
        my_variable_value: b'my_value'          # Example byte value

      register: result
      ignore_errors: true

    - name: Print result
      debug:
        var: result