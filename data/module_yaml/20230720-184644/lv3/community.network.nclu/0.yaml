---
- name: Configure network using community.network.nclu module
  hosts: all
  gather_facts: False

  tasks:
    - name: Configure network settings
      community.network.nclu:
        abort: true
        atomic: true
        commands: "{{ commands }}"
        commit: true
        description: "{{ description }}"
        template: "{{ template | default('network.j2') | string }}"