---
- name: Test playbook to uncover latent type-related bugs in community.general.vertica_role module
  hosts: localhost
  gather_facts: false

  vars:
    assigned_roles: 'user1,user2'
    cluster: 'vertica-cluster'
    db: 'test_db'
    login_password: 'password'
    login_user: 'admin'
    port: '5433'
    role: 'test_role'
    state: 'present'
  
  tasks:
    - name: Install community.general collection
      ansible.builtin.shell: ansible-galaxy collection install community.general

    - name: Create Vertica database role
      community.general.vertica_role:
        assigned_roles: "{{ assigned_roles }}" # string attribute
        cluster: "{{ cluster }}" # string attribute
        db: "{{ db }}" # string attribute
        login_password: "{{ login_password }}" # string attribute
        login_user: "{{ login_user }}" # string attribute
        port: "{{ port }}" # string attribute
        role: "{{ role }}" # string attribute
        state: "{{ state }}" # string attribute
      register: result
  
    - debug:
        var: result