- name: Execute groovy script in Jenkins
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include vars file
      include_vars:
        file: vars.yml

    - name: Execute jenkins_script
      community.general.jenkins_script:
        url: "{{ jenkins_url }}"
        user: "{{ jenkins_user }}"
        password: "{{ jenkins_password }}"
        script: "{{ script_content.encode('utf-8') }}"
        timeout: "{{ script_timeout }}"
        validate_certs: "{{ validate_certificates }}"
      register: script_output

    - name: Debug script output
      debug:
        var: script_output