- name: Gather facts from remote CNOS device
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Include vars for device details
      include_vars:
        file: device.yml
  
    - name: Gather CNOS facts
      community.network.cnos_facts:
        host: "{{ inventory_hostname }}"
        username: "{{ username }}"
        auth_pass: "{{ auth_pass }}"
        # Set the authorize option to trigger the type-related bug
        authorize: "{{ authorize }}"
        gather_subset:
          - "!hardware,gather_subset"
      register: cnos_facts
    
    - name: Print gathered facts
      debug:
        var: cnos_facts