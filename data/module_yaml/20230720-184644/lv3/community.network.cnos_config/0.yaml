---
- name: Test cnos_config module
  hosts: cnos_devices
  gather_facts: false

  vars:
    config_commands:
      - "interface Ethernet1/1"
      - "description {{ 'bytes' | to_bytes }}"
      - "ip address {{ '10.1.1.1' | to_ip('ansible_default_ipv4.network')  }}/24"
      - "no shutdown"

  tasks:
    - name: Configure Lenovo CNOS devices
      community.network.cnos_config:
        admin: yes
        backup: yes
        backup_options:
          backup: yes
          backup_options:
            dir_path: "/tmp"
        config: "{{ config_commands }}"
      register: result

    - debug:
        var: result