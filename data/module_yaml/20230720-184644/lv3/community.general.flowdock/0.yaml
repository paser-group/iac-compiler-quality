---
- name: Test Ansible Flowdock Module
  hosts: localhost
  become: false
  gather_facts: false

  vars:
    # Test cases with configuration values incorporating both bytes and strings
    test_cases:
      - external_user_name: foo
        from_address: b'bar@example.com'
        from_name: baz
        link: b'https://example.com'
        msg: b'Testing Flowdock message'
        project: foo_project
        reply_to: b'reply@example.com'
        source: b'source_code'
        subject: Testing Flowdock
        tags: b'ansible,test'
        token: b'your_flowdock_token'
        type: b'type1'
        validate_certs: true
      - external_user_name: example
        from_address: 'baz@example.com'
        from_name: 'John Doe'
        link: 'https://google.com'
        msg: 'Hello from Ansible'
        project: ansible_project
        reply_to: 'reply@example.com'
        source: 'source_code'
        subject: 'Greetings'
        tags: 'ansible,test,validation'
        token: 'your_flowdock_token'
        type: 'type2'
        validate_certs: false

  tasks:
    - name: Send message to Flowdock
      community.general.flowdock:
        external_user_name: "{{ item.external_user_name }}"
        from_address: "{{ item.from_address }}"
        from_name: "{{ item.from_name }}"
        link: "{{ item.link }}"
        msg: "{{ item.msg }}"
        project: "{{ item.project }}"
        reply_to: "{{ item.reply_to }}"
        source: "{{ item.source }}"
        subject: "{{ item.subject }}"
        tags: "{{ item.tags }}"
        token: "{{ item.token }}"
        type: "{{ item.type }}"
        validate_certs: "{{ item.validate_certs }}"
      loop: "{{ test_cases }}"