---
- name: Test playbook for manageiq_policies module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create policy profiles
      community.general.manageiq_policies:
        manageiq_connection:
          url: https://manageiq.example.com
          username: admin
          password: secret
          verify_ssl: false
        policy_profiles:
          - name: Profile1
            state: present
          - name: Profile2
            state: present
      register: profiles_result

    - name: Debug policy profiles
      debug:
        var: profiles_result

    - name: Create resource policies
      community.general.manageiq_policies:
        manageiq_connection:
          url: https://manageiq.example.com
          username: admin
          password: secret
          verify_ssl: false
        policy_profiles:
          - name: Profile1
            resource_id: 1
            resource_name: Resource1
            resource_type: bytes
            state: present
          - name: Profile2
            resource_id: 2
            resource_name: Resource2
            resource_type: "string"
            state: present
      register: policies_result

    - name: Debug resource policies
      debug:
        var: policies_result