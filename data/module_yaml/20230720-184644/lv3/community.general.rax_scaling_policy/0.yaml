---
- name: Test playbook for 'community.general.rax_scaling_policy'
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install required dependencies
      pip:
        name: "openstacksdk"
        state: present

    - name: Create configuration values that incorporate both bytes and strings
      set_fact:
        policy_type: "{{ 'UP' | to_uuid }}"
        change: "{{ '1' }}"
        cooldown: "{{ '1800' }}"
        desired_capacity: "{{ '2' }}"
        is_percent: False

    - name: Manipulate Rackspace Cloud Auto Scaling policies
      community.general.rax_scaling_policy:
        api_key: "YOUR_RACKSPACE_API_KEY"
        at: "{{ '2022-01-01T00:00:00Z' }}"
        auth_endpoint: "https://identity.api.rackspacecloud.com/v2.0/"
        change: "{{ change }}"
        cooldown: "{{ cooldown }}"
        credentials: "/path/to/credentials"
        cron: "0 0 * * *"
        desired_capacity: "{{ desired_capacity }}"
        env: "dev"
        identity_type: "rackspace"
        is_percent: "{{ is_percent }}"
        name: "scaling-policy"
        policy_type: "{{ policy_type }}"
        region: "ORD"
        scaling_group: "autoscaling-group"
        state: "present"
        tenant_id: "YOUR_TENANT_ID"
        tenant_name: "YOUR_TENANT_NAME"
        username: "YOUR_RACKSPACE_USERNAME"
        validate_certs: False
      register: result

    - name: Print module output
      debug:
        var: result