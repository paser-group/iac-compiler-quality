---
- name: Configure Intel Optane Persistent Memory
  hosts: localhost
  gather_facts: false
  
  vars:
    appdirect: 16384    # int
    appdirect_interleaved: yes    # bool
    memorymode: 1    # int
    namespace:
      - "pmem0"
      - "pmem1"    # list of strings
    namespace_append: no    # bool
    reserved: 4096    # int
    socket: 
      - "0"
      - "1"    # list of strings
  
  tasks:
    - name: Configure Intel Optane Persistent Memory
      community.general.pmem:
        appdirect: "{{ appdirect }}"
        appdirect_interleaved: "{{ appdirect_interleaved }}"
        memorymode: "{{ memorymode }}"
        namespace: "{{ namespace }}"
        namespace_append: "{{ namespace_append }}"
        reserved: "{{ reserved }}"
        socket: "{{ socket }}"
      register: pmem_config

    - name: Debugging information
      debug:
        var: pmem_config