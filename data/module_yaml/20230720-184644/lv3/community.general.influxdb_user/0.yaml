---
- name: Ansible Latent Bug Finder Playbook
  hosts: localhost
  gather_facts: false
  vars:
    influxdb_user_config:
      admin: true
      grants: ['ALL PRIVILEGES']
      hostname: b'10.1.1.1'
      password: b'strong_pass'
      path: b'/var/influx'
      port: 8086
      proxies:
        http: b'proxy.example.com:8080'
        https: b'proxy.example.com:8080'
      retries: 3
      ssl: true
      state: present
      timeout: 30
      udp_port: 4444
      use_udp: true
      user_name: b'admin'
      user_password: b'admin_pass'
      username: b'admin_user'
      validate_certs: false
  
  tasks:
    - name: Create InfluxDB User
      community.general.influxdb_user:
        name: "{{ influxdb_user_config.user_name }}"
        password: "{{ influxdb_user_config.user_password }}"
        host: "{{ influxdb_user_config.hostname }}"
        port: "{{ influxdb_user_config.port }}"
      register: influxdb_user_result

    - name: Debug InfluxDB User Result
      debug:
        var: influxdb_user_result