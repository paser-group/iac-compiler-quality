---
- hosts: localhost
  gather_facts: no
  tasks:
    - name: Create link aggregation group
      community.network.cnos_linkagg:
        aggregate: "{{ item.aggregate }}"
        group: "{{ item.group }}"
        members: "{{ item.members }}"
        mode: "{{ item.mode }}"
        purge: "{{ item.purge }}"
        state: "{{ item.state }}"
      with_items:
        - { aggregate: 1000, group: "lag1", members: "eth1,eth2", mode: 1, purge: false, state: "present" }
        - { aggregate: "2000", group: "lag2", members: "eth3,eth4,eth5", mode: 2, purge: true, state: "absent" }
        - { aggregate: None, group: "lag3", members: "eth7,eth8", mode: "active-backup", purge: true, state: "present" }
        - { aggregate: "3000", group: "lag4", members: "eth9,eth10,eth11,eth12", mode: None, purge: true, state: None }
        - { aggregate: "4000", group: None, members: "eth13,eth14", mode: 4, purge: true, state: "present" }
        - { aggregate: "5000", group: "lag5", members: None, mode: 5, purge: false, state: "absent" }
        - { aggregate: "6000", group: "lag6", members: "eth17,eth18,eth19,eth20", mode: "balance-xor", purge: None, state: "present" }
        - { aggregate: "7000", group: "lag7", members: "eth21,eth22,eth23,eth24", mode: 7, purge: "True", state: "absent" }
        - { aggregate: "8000", group: "lag8", members: "eth25,eth26,eth27,eth28", mode: "lacp-passive", purge: false, state: None }
        - { aggregate: "9000", group: "lag9", members: "eth29,eth30,eth31,eth32", mode: "lacp-active", purge: 1, state: "present" }
    - debug:
        var: ansible_facts['community_network_cnosi_linkagg']