---
- name: Manage local users on CNOS devices
  hosts: cnos_devices
  gather_facts: no

  tasks:
    - name: Create configuration with bytes and strings
      community.network.cnos_user:
        aggregate: "{{ None }}"
        configured_password: "{{ None }}"
        name: "{{ item }}"
        purge: "{{ purge | default(false) }}"
        role: "{{ None }}"
        sshkey: "{{ None }}"
        state: "{{ None }}"
        update_password: "{{ None }}"
      loop:
        - bytes_user
        - strings_user

- name: Check if bytes user exists
  hosts: cnos_devices
  gather_facts: no

  tasks:
    - name: Check if bytes user exists
      community.network.cnos_user:
        aggregate: "{{ None }}"
        configured_password: "{{ None }}"
        name: bytes_user
        purge: "{{ purge | default(false) }}"
        role: "{{ None }}"
        sshkey: "{{ None }}"
        state: "{{ None }}"
        update_password: "{{ None }}"
      register: bytes_user_result

    - name: Print bytes user result
      debug:
        var: bytes_user_result

- name: Check if strings user exists
  hosts: cnos_devices
  gather_facts: no

  tasks:
    - name: Check if strings user exists
      community.network.cnos_user:
        aggregate: "{{ None }}"
        configured_password: "{{ None }}"
        name: strings_user
        purge: "{{ purge | default(false) }}"
        role: "{{ None }}"
        sshkey: "{{ None }}"
        state: "{{ None }}"
        update_password: "{{ None }}"
      register: strings_user_result

    - name: Print strings user result
      debug:
        var: strings_user_result