---
- name: Test Ansible Latent Type-Related Bug
  hosts: localhost
  gather_facts: False
  tasks:
    - name: Create GitLab project variable
      community.general.gitlab_project_variable:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "your_token"
        project: "your_project"
        state: "present"
        variables:
          - key: "VAR1"
            value: "This is a string variable"
          - key: "VAR2"
            value: b64encode('This is a bytes variable'.encode("utf-8")).decode("utf-8")
          - key: "VAR3"
            value: b"This is another bytes variable"
          - key: "VAR4"
            value: "This is another string variable"
          - key: "VAR5"
            value: some_nonexistent_variable  # This variable does not exist
      register: result

    - name: Print result
      debug:
        var: result

    - name: Delete GitLab project variable
      community.general.gitlab_project_variable:
        api_url: "https://gitlab.example.com/api/v4"
        api_token: "your_token"
        project: "your_project"
        state: "absent"
        variables:
          - key: "VAR1"
          - key: "VAR2"
          - key: "VAR3"
          - key: "VAR4"
          - key: "VAR5"
      register: result

    - name: Print result
      debug:
        var: result