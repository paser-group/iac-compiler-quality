---
- name: Test playbook for community.general.scaleway_compute module
  hosts: localhost
  gather_facts: false
  
  vars:
    api_timeout: 60
    api_token: "YOUR_SCALEWAY_API_TOKEN"
    api_url: "https://api.scaleway.com"
    commercial_type: "DEV1-S"
    enable_ipv6: false
    image: "ubuntu-focal"
    name: "test-instance"
    organization: "YOUR_SCALEWAY_ORGANIZATION_ID"
    project: "YOUR_SCALEWAY_PROJECT_ID"
    public_ip: "51.12.34.56"
    query_parameters: {}
    region: "par1"
    security_group: "default"
    state: "present"
    tags: ["tag1", "tag2"]
    validate_certs: true
    wait: true
    wait_sleep_time: 5
    wait_timeout: 300

  tasks:
    - name: Create Scaleway compute instance with bytes and strings configuration values
      community.general.scaleway_compute:
        api_timeout: "{{ api_timeout }}"
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        commercial_type: "{{ commercial_type }}"
        enable_ipv6: "{{ enable_ipv6 }}"
        image: "{{ image }}"
        name: "{{ name }}"
        organization: "{{ organization }}"
        project: "{{ project }}"
        public_ip: "{{ public_ip | b64encode }}"  # Use bytes configuration value
        query_parameters: "{{ query_parameters | to_json }}"
        region: "{{ region }}"
        security_group: "{{ security_group }}"
        state: "{{ state }}"
        tags: "{{ tags }}"
        validate_certs: "{{ validate_certs }}"
        wait: "{{ wait }}"
        wait_sleep_time: "{{ wait_sleep_time }}"
        wait_timeout: "{{ wait_timeout }}"
      register: result
      
    - name: Debug output
      debug:
        var: result