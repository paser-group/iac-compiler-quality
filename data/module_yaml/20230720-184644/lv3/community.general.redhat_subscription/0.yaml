---
- name: Test Playbook
  hosts: localhost
  gather_facts: no
  vars:
    activationkey: my_activation_key
    auto_attach: false
    consumer_id: my_consumer_id
    consumer_name: my_consumer_name
    consumer_type: my_consumer_type
    environment: production
    force_register: true
    org_id: my_org_id
    password: my_password
    pool: my_pool
    pool_ids:
      - pool_id_1
      - pool_id_2
    release: latest
    rhsm_baseurl: http://my.rhsm.baseurl
    rhsm_repo_ca_cert: /path/to/ca/certificate.pem
    server_hostname: my.server.hostname
    server_insecure: false
    server_port: 443
    server_prefix: /rhsm
    server_proxy_hostname: my.proxy.hostname
    server_proxy_password: my_proxy_password
    server_proxy_port: 8080
    server_proxy_scheme: http
    server_proxy_user: my_proxy_user
    state: present
    syspurpose:
      rhsm:
        enabled: true
    token: my_token
    username: my_username
  tasks:
    - name: Register and subscribe to RHSM
      redhat_subscription:
        activationkey: "{{ activationkey }}"
        auto_attach: "{{ auto_attach }}"
        consumer_id: "{{ consumer_id }}"
        consumer_name: "{{ consumer_name }}"
        consumer_type: "{{ consumer_type }}"
        environment: "{{ environment }}"
        force_register: "{{ force_register }}"
        org_id: "{{ org_id }}"
        password: "{{ password }}"
        pool: "{{ pool }}"
        pool_ids: "{{ pool_ids }}"
        release: "{{ release }}"
        rhsm_baseurl: "{{ rhsm_baseurl }}"
        rhsm_repo_ca_cert: "{{ rhsm_repo_ca_cert }}"
        server_hostname: "{{ server_hostname }}"
        server_insecure: "{{ server_insecure }}"
        server_port: "{{ server_port }}"
        server_prefix: "{{ server_prefix }}"
        server_proxy_hostname: "{{ server_proxy_hostname }}"
        server_proxy_password: "{{ server_proxy_password }}"
        server_proxy_port: "{{ server_proxy_port }}"
        server_proxy_scheme: "{{ server_proxy_scheme }}"
        server_proxy_user: "{{ server_proxy_user }}"
        state: "{{ state }}"
        syspurpose: "{{ syspurpose }}"
        token: "{{ token }}"
        username: "{{ username }}"