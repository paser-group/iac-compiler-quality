- name: Test playbook for packet_device module
  hosts: localhost
  gather_facts: false
  vars:
    always_pxe: true
    auth_token: "my-auth-token"
    count: 2
    count_offset: 1
    device_ids:
      - "device-id-1"
      - "device-id-2"
    facility: "my-facility"
    features:
      - "feature-1"
      - "feature-2"
    hostnames:
      - "hostname-1"
      - "hostname-2"
    ipxe_script_url: "https://example.com/ipxe_script"
    locked: true
    operating_system: "ubuntu_18_04"
    plan: "baremetal_0"
    project_id: "my-project-id"
    state: "present"
    tags:
      - "tag-1"
      - "tag-2"
    user_data: "echo 'Hello, world!'"
    wait_for_public_IPv: 4
    wait_timeout: 300

  tasks:
    - name: Manage bare metal servers
      community.general.packet_device:
        always_pxe: "{{ always_pxe }}"
        auth_token: "{{ auth_token }}"
        count: "{{ count }}"
        count_offset: "{{ count_offset }}"
        device_ids: "{{ device_ids }}"
        facility: "{{ facility }}"
        features: "{{ features }}"
        hostnames: "{{ hostnames }}"
        ipxe_script_url: "{{ ipxe_script_url }}"
        locked: "{{ locked }}"
        operating_system: "{{ operating_system }}"
        plan: "{{ plan }}"
        project_id: "{{ project_id }}"
        state: "{{ state }}"
        tags: "{{ tags }}"
        user_data: "{{ user_data }}"
        wait_for_public_IPv: "{{ wait_for_public_IPv }}"
        wait_timeout: "{{ wait_timeout }}"
      register: result

    - name: Display the result
      debug:
        var: result