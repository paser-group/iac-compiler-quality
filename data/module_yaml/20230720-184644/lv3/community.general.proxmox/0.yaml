---
- hosts: all
  gather_facts: False
  vars:
    api_host: 10.1.1.1  # This should be a string, but we're using an integer
    api_password: your_proxmox_api_password
    api_token_id: your_proxmox_api_token_id
    api_token_secret: your_proxmox_api_token_secret
    api_user: your_proxmox_api_user
    clone: 0
    clone_type: ""
    cores: 1
    cpus: 1
    cpuunits: 1000
    description: "Test VM"
    disk: "local-lvm:10"
    features:
      - "acpi"
      - 123  # This should be a string, but we're using an integer
    force: False
    hookscript: /path/to/hookscript.sh  # This should be a string, but we're not quoting it
    hostname: testvm
    ip_address: 10.1.1.5  # This should be a string, but we're not quoting it
    memory: 1024
    mounts:
      "/mnt/data":
        mountpoint: /mnt/data  # This should be a string, but we're not quoting it
        storage: local-lvm
        content: iso
        size: 10G
    nameserver: 8.8.8.8 # This should be a string, but we're not quoting it
    netif:
      "net0":
        bridge: vmbr0  # This should be a string, but we're not quoting it
        model: virtio
    node: pve  # This should be a string, but we're not quoting it
    onboot: True
    ostemplate: local:iso/mytemplate.iso  # This should be a string, but we're not quoting it
    password: your_vm_password
    pool: your_vm_pool  # This should be a string, but we're not quoting it
    proxmox_default_behavior: present  # This should be a string, but we're not quoting it
    pubkey: /path/to/pubkey.pub  # This should be a string, but we're not quoting it
    purge: False
    searchdomain: example.com  # This should be a string, but we're not quoting it
    state: started  # This should be a string, but we're not quoting it
    storage: local  # This should be a string, but we're not quoting it
    swap: 512
    tags:
      - "test"
    timeout: 120
    unprivileged: False
    validate_certs: True
    vmid: 100

  tasks:
    - name: Create Proxmox VM
      community.general.proxmox:
        api_host: "{{ api_host }}"
        api_user: "{{ api_user }}"
        api_password: "{{ api_password }}"
        clone: "{{ clone }}"
        clone_type: "{{ clone_type }}"
        cores: "{{ cores }}"
        cpus: "{{ cpus }}"
        cpuunits: "{{ cpuunits }}"
        description: "{{ description }}"
        disk: "{{ disk }}"
        features: "{{ features }}"
        force: "{{ force }}"
        hookscript: "{{ hookscript }}"
        hostname: "{{ hostname }}"
        ip_address: "{{ ip_address }}"
        memory: "{{ memory }}"
        mounts: "{{ mounts }}"
        nameserver: "{{ nameserver }}"
        netif: "{{ netif }}"
        node: "{{ node }}"
        onboot: "{{ onboot }}"
        ostemplate: "{{ ostemplate }}"
        password: "{{ password }}"
        pool: "{{ pool }}"
        proxmox_default_behavior: "{{ proxmox_default_behavior }}"
        pubkey: "{{ pubkey }}"
        purge: "{{ purge }}"
        searchdomain: "{{ searchdomain }}"
        state: "{{ state }}"
        storage: "{{ storage }}"
        swap: "{{ swap }}"
        tags: "{{ tags }}"
        timeout: "{{ timeout }}"
        unprivileged: "{{ unprivileged }}"
        validate_certs: "{{ validate_certs }}"
        vmid: "{{ vmid }}"
      register: result
      
    - name: Print Result
      debug:
        var: result
        
    - name: Check Configuration
      debug:
        msg: "VM configuration check completed"