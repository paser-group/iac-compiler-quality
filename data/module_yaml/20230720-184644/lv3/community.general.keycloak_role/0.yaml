---
- name: Test Keycloak Role
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Keycloak Realm
      community.general.keycloak_role:
        auth_client_id: admin-cli
        auth_client_secret: "{{ keycloak_admin_secret }}"
        auth_keycloak_url: "http://{{ keycloak_hostname }}:8080/auth"
        auth_password: "{{ keycloak_admin_password }}"
        auth_realm: master
        auth_username: "{{ keycloak_admin_username }}"
        client_id: "{{ keycloak_client_id }}"
        connection_timeout: 10
        description: Keycloak Realm
        http_agent: custom-agent
        name: realm1
        realm: realm1
        state: present
        token: "{{ keycloak_admin_token }}"
        validate_certs: false
      vars:
        keycloak_admin_secret: "admin-secret"
        keycloak_hostname: "keycloak-server"
        keycloak_admin_password: "admin-password"
        keycloak_admin_username: "admin"
        keycloak_client_id: "test-client"
        keycloak_admin_token: "admin-token"

    - name: Test Keycloak Role with bytes and strings
      community.general.keycloak_role:
        auth_client_id: admin-cli
        auth_client_secret: "{{ keycloak_admin_secret | b64encode }}"
        auth_keycloak_url: "http://{{ keycloak_hostname | b64encode }}:8080/auth"
        auth_password: "{{ keycloak_admin_password | b64encode }}"
        auth_realm: master
        auth_username: "{{ keycloak_admin_username | b64encode }}"
        client_id: "{{ keycloak_client_id | b64encode }}"
        connection_timeout: "10"
        description: "Keycloak Realm"
        http_agent: "custom-agent"
        name: "realm1"
        realm: "realm1"
        state: "present"
        token: "{{ keycloak_admin_token | b64encode }}"
        validate_certs: "false"
      vars:
        keycloak_admin_secret: "{{ 'admin-secret' | b64encode }}"
        keycloak_hostname: "{{ 'keycloak-server' | b64encode }}"
        keycloak_admin_password: "{{ 'admin-password' | b64encode }}"
        keycloak_admin_username: "{{ 'admin' | b64encode }}"
        keycloak_client_id: "{{ 'test-client' | b64encode }}"
        keycloak_admin_token: "{{ 'admin-token' | b64encode }}"