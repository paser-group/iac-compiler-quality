---
- name: Test Ansible Latent Type-Related Bugs with PagerDuty Alert Module
  hosts: localhost
  gather_facts: false

  vars:
    api_key: "YOUR_PAGERDUTY_API_KEY"
    integration_key: "YOUR_PAGERDUTY_INTEGRATION_KEY"
    service_key: "YOUR_PAGERDUTY_SERVICE_KEY"

  tasks:
    - name: Trigger PagerDuty Alert with byte and string values
      community.general.pagerduty_alert:
        api_key: "{{ api_key | encode_base64 }}"
        integration_key: "{{ integration_key | to_bytes }}"
        service_key: "{{ service_key }}"
        desc: "This is a test alert"
        state: trigger

    - name: Acknowledge PagerDuty Alert with byte and string values
      community.general.pagerduty_alert:
        api_key: "{{ api_key | encode_base64 }}"
        integration_key: "{{ integration_key | to_bytes }}"
        service_key: "{{ service_key }}"
        incident_key: "INCIDENT_KEY"
        desc: "Acknowledging the test alert"
        state: acknowledge

    - name: Resolve PagerDuty Alert with byte and string values
      community.general.pagerduty_alert:
        api_key: "{{ api_key | encode_base64 }}"
        integration_key: "{{ integration_key | to_bytes }}"
        service_key: "{{ service_key }}"
        incident_key: "INCIDENT_KEY"
        desc: "Resolving the test alert"
        state: resolve