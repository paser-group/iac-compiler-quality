---
- name: Test Ansible Latent Type-Related Bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create user with mixed byte and string values
      community.general.udm_user:
        name: testuser
        state: present
        birthday: "{{ {'value': '29'}|to_json }}"
        city: "{{ {'value': 'New York'}|to_json }}"
        country: "{{ {'value': 'USA'}|to_json }}"
        department_number: "{{ {'value': 'D123'}|to_json }}"
        description: "{{ {'value': 'Test User'}|to_json }}"
        display_name: "{{ {'value': 'Test User'}|to_json }}"
        email: "{{ [{'value':'testuser@example.com'}] }}"
        employee_number: "{{ {'value': '1234'}|to_json }}"
        employee_type: "{{ {'value': 'Full Time'}|to_json }}"
        firstname: "{{ {'value': 'Test'}|to_json }}"
        gecos: "{{ {'value': 'Test User'}|to_json }}"
        groups: "{{ [{'value':'admins'}] }}"
        home_share: "{{ {'value': 'share1'}|to_json }}"
        home_share_path: "{{ {'value': '/home/share1'}|to_json }}"
        home_telephone_number: "{{ [{'value': '+1234567890'}] }}"
        homedrive: "{{ {'value': 'C:'}|to_json }}"
        lastname: "{{ {'value': 'User'}|to_json }}"
        mail_alternative_address: "{{ [{'value':'testuser1@example.com'},{'value':'testuser2@example.com'}] }}"
        mail_home_server: "{{ {'value': 'mail.host.com'}|to_json }}"
        mail_primary_address: "{{ {'value': 'testuser@example.com'}|to_json }}"
        mobile_telephone_number: "{{ [{'value': '+1234567890'}] }}"
        organisation: "{{ {'value': 'ABC Company'}|to_json }}"
        ou: "{{ {'value': 'Users'}|to_json }}"
        overridePWHistory: "{{ {'value': true}|to_json }}"
        overridePWLength: "{{ {'value': true}|to_json }}"
        pager_telephonenumber: "{{ [{'value': '+1234567890'}] }}"
        password: "{{ {'value': 'Password123'}|to_json }}"
        phone: "{{ [{'value': '+1234567890'}] }}"
        position: "{{ {'value': 'Tester'}|to_json }}"
        postcode: "{{ {'value': '12345'}|to_json }}"
        primary_group: "{{ {'value': 'users'}|to_json }}"
        profilepath: "{{ {'value': '\\\\server\\profiles\\testuser'}|to_json }}"
        pwd_change_next_login: "{{ {'value': 'False'}|to_json }}"
        room_number: "{{ {'value': '123'}|to_json }}"
        samba_privileges: "{{ [{'value':'SeDiskOperatorPrivilege'}] }}"
        samba_user_workstations: "{{ [{'value':'workstation1'},{'value':'workstation2'}] }}"
        sambahome: "{{ {'value': '\\\\server\\profiles\\testuser'}|to_json }}"
        scriptpath: "{{ {'value': '\\\\server\\scripts\\testuser'}|to_json }}"
        secretary: "{{ [{'value':'secretary1'},{'value':'secretary2'}] }}"
        serviceprovider: "{{ [{'value':'provider1'},{'value':'provider2'}] }}"
        shell: "{{ {'value': '/bin/bash'}|to_json }}"
        street: "{{ {'value': '123 Test St.'}|to_json }}"
        subpath: "{{ {'value': 'ou=users'}|to_json }}"
        title: "{{ {'value': 'Test User'}|to_json }}"
        unixhome: "{{ {'value': '/home/testuser'}|to_json }}"
        update_password: "{{ {'value': 'always'}|to_json }}"
        userexpiry: "{{ {'value': '2022-12-31'}|to_json }}"
        username: "{{ {'value': 'testuser'}|to_json }}"
      
      register: result

    - debug:
        var: result