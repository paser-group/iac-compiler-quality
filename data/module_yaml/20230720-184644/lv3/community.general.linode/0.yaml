---
- name: Create Linode instances
  hosts: localhost
  gather_facts: false

  vars:
    # Configuration values
    additional_disks:
      - size: 10
        label: additional_disk_1
      - size: 20
        label: additional_disk_2
    alert_bwin_enabled: false
    alert_bwin_threshold: 0
    alert_bwout_enabled: false
    alert_bwout_threshold: 0
    alert_bwquota_enabled: false
    alert_bwquota_threshold: 0
    alert_cpu_enabled: false
    alert_cpu_threshold: 0
    alert_diskio_enabled: false
    alert_diskio_threshold: 0
    api_key: <your-linode-api-key>
    backupweeklyday: 0
    backupwindow: 0
    datacenter: 1
    displaygroup: my_displaygroup
    distribution: 235
    kernel_id: 237
    linode_id: 123
    name: my_linode_instance
    password: my_linode_password
    payment_term: 1
    plan: 1
    private_ip: false
    ssh_pub_key: |
      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD... <your-public-key>
    state: present
    swap: 2048
    wait: true
    wait_timeout: 600
    watchdog: true

  tasks:
    - name: Create Linode instance
      linode:
        api_key: "{{ api_key }}"
        name: "{{ name }}"
        password: "{{ password }}"
        state: "{{ state }}"
        plan: "{{ plan }}"
        datacenter: "{{ datacenter }}"
        distribution: "{{ distribution }}"
        kernel_id: "{{ kernel_id }}"
        swap: "{{ swap }}"
        additional_disks: "{{ additional_disks }}"
        private_ip: "{{ private_ip }}"
        backupweeklyday: "{{ backupweeklyday }}"
        backupwindow: "{{ backupwindow }}"
        displaygroup: "{{ displaygroup }}"
        ssh_pub_key: "{{ ssh_pub_key }}"
        alert_cpu_enabled: "{{ alert_cpu_enabled }}"
        alert_cpu_threshold: "{{ alert_cpu_threshold }}"
        alert_diskio_enabled: "{{ alert_diskio_enabled }}"
        alert_diskio_threshold: "{{ alert_diskio_threshold }}"
        alert_bwout_enabled: "{{ alert_bwout_enabled }}"
        alert_bwout_threshold: "{{ alert_bwout_threshold }}"
        alert_bwin_enabled: "{{ alert_bwin_enabled }}"
        alert_bwin_threshold: "{{ alert_bwin_threshold }}"
        alert_bwquota_enabled: "{{ alert_bwquota_enabled }}"
        alert_bwquota_threshold: "{{ alert_bwquota_threshold }}"
        watchdog: "{{ watchdog }}"
        wait: "{{ wait }}"
        wait_timeout: "{{ wait_timeout }}"
      delegate_to: localhost
      register: linode_output

    - name: Debug Linode instance creation
      debug:
        var: linode_output