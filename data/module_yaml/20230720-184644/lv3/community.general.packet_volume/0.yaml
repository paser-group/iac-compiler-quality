---
- name: Test Ansible module for 'community.general.packet_volume'
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a new volume
      community.general.packet_volume:
        auth_token: "YOUR_AUTH_TOKEN"
        billing_cycle: "hourly"
        description: "Test volume"
        facility: "ewr1"
        locked: false
        name: "test-volume"
        plan: "storage_1"
        project_id: "YOUR_PROJECT_ID"
        size: 1024
        snapshot_policy:
          frequency: "daily"
          keep_count: 7
          prefix: "test"
        state: "present"
      register: result_create

    - debug:
        var: result_create

    - name: Delete the created volume
      community.general.packet_volume:
        auth_token: "YOUR_AUTH_TOKEN"
        id: "{{ result_create.volume.id }}"
        state: "absent"
      register: result_delete

    - debug:
        var: result_delete