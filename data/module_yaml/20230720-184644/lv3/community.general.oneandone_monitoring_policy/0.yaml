---
- name: Test Ansible latent type-related bugs
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Configure monitoring policy
      community.general.oneandone_monitoring_policy:
        api_url: "https://api_url"
        auth_token: "auth_token"
        name: "Test Policy"
        description: "Test Policy Description"
        state: present
        add_servers:
          - name: "ubuntu1"
            ip_address: "10.1.1.1"
          - name: "alpine1"
            ip_address: "10.1.1.2"
          - name: "centos1"
            ip_address: "10.1.1.3"
          - name: "redhat1"
            ip_address: "10.1.1.4"
        add_ports:
          - port: 80
            protocol: "http"
        add_processes:
          - name: "process1"
            process_regex: "regex1"
        thresholds:
          - metric: "cpu"
            warning: "90%"
            critical: "95%"
        wait: true
        wait_interval: 5
        wait_timeout: 60
      register: result

    - name: Debug result
      debug:
        var: result