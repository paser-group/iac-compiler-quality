---
- name: Test Ansible module for GitLab protected branches
  hosts: localhost
  gather_facts: false

  vars:
    api_url: "https://gitlab.example.com/api/v4"
    api_token: "my_api_token"
    project: "my_project"
    name: "my_protected_branch"

  tasks:
    - name: Protect GitLab branch with token
      community.general.gitlab_protected_branch:
        api_url: "{{ api_url }}"
        api_token: "{{ api_token }}"
        project: "{{ project }}"
        name: "{{ name }}"
        state: present
      delegate_to: localhost
      register: result

    - name: Display the result
      debug:
        var: result