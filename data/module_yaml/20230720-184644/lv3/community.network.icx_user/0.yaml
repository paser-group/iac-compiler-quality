---
- name: Test playbook for community.network.icx_user module
  hosts: localhost
  gather_facts: false
  vars:
    icx_users:
      - name: "{{ 'admin' | to_bytes }}"
        state: present
        nopassword: true
      - name: "{{ 'ansible' | to_bytes }}"
        state: present
        configured_password: "{{ 'my_password' | to_bytes }}"
        state: present
        privilege: "{{ '4' | to_bytes }}"
        access_time: "{{ '5' | to_bytes }}"
  tasks:
    - name: Manage ICX users
      community.network.icx_user:
        aggregate: true
        check_running_config: true
        purge: true
        update_password: on_create
        users: "{{ icx_users }}"