- name: Test playbook for the community.network.pn_prefix_list_network module
  hosts: localhost
  gather_facts: false
  
  vars:
    pn_cliswitch: "ansible"
    pn_name: "test_prefix_list"
    pn_netmask: "255.255.255.0"
    pn_network: "10.1.1.0"
  
  tasks:
    - name: Install the required dependencies
      pip:
        name:
          - ansible
          - ansible_collections.community.network
  
    - name: Add prefix list network
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        pn_netmask: "{{ pn_netmask }}"
        pn_network: "{{ pn_network }}"
        state: present
  
    - name: Verify the prefix list network exists
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        state: query
      register: prefix_list_result
  
    - name: Debug output of the prefix list network
      debug:
        var: prefix_list_result
  
    - name: Remove prefix list network
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        state: absent
      ignore_errors: true
  
    - name: Verify the prefix list network is removed
      community.network.pn_prefix_list_network:
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_name: "{{ pn_name }}"
        state: query
      register: prefix_list_result_removed
  
    - name: Debug output of the removed prefix list network
      debug:
        var: prefix_list_result_removed