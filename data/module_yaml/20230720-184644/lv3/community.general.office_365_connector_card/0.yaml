---
- name: Test playbook for 'community.general.office_365_connector_card' module
  hosts: localhost
  gather_facts: false

  vars:
    webhook: "https://example.com/webhook"
    actions:
      - "Action 1"
      - "Action 2"
    color:
      bytes_value: !!binary |
        Y29vbAo=
      string_value: "red"
    sections:
      - title: "Section 1"
        text: "This is section 1"
      - title: "Section 2"
        text: "This is section 2"
    summary:
      bytes_value: !!binary |
        Y29vbAo=
      string_value: "Summary text"
    text:
      bytes_value: !!binary |
        Y29vbAo=
      string_value: "Text content"
    title:
      bytes_value: !!binary |
        Y29vbAo=
      string_value: "Title"

  tasks:
    - name: Test 'community.general.office_365_connector_card' module
      community.general.office_365_connector_card:
        webhook: "{{ webhook }}"
        actions: "{{ actions }}"
        color: "{{ color }}"
        sections: "{{ sections }}"
        summary: "{{ summary }}"
        text: "{{ text }}"
        title: "{{ title }}"
      register: result

    - name: Print result
      debug:
        var: result