- name: Test playbook for community.network.avi_serverautoscalepolicy
  hosts: localhost
  connection: local
  gather_facts: False

  tasks:
    - name: Create ServerAutoScalePolicy
      community.network.avi_serverautoscalepolicy:
        controller: "{{ controller }}"
        username: "{{ username }}"
        password: "{{ password }}"
        tenant: "{{ tenant }}"
        name: "Test Policy"
        description: "Test policy description"
        min_size: 2
        max_size: 10
        scaleout_cooldown: 120
        scalein_cooldown: 300
        intelligent_autoscale: True
        intelligent_scaleout_margin: "10MB"
        intelligent_scalein_margin: "5%"
        use_predicted_load: True
        avi_credentials:
          api_version: "{{ api_version }}"
          api_context: "{{ api_context }}"

      register: result

    - name: Debug result
      debug:
        var: result