- name: Test playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Run asynchronous task
      command: echo "Hello, World!"
      async: 300
      poll: 0
      register: async_result

    - name: Wait for async task to complete
      async_status:
        jid: "{{ async_result.ansible_job_id | b64encode }}"
        mode: "{{ async_result.ansible_job_mode | b64encode }}"
      register: async_status

    - name: Print async task status
      debug:
        var: async_status.status