---
- name: Test playbook to reveal latent type-related bugs in the Ansible 'pkgin' module
  hosts: localhost
  gather_facts: false

  vars:
    pkgin_packages:
      - pkgin
      - nginx

  tasks:
    - name: Install packages using 'community.general.pkgin' module
      community.general.pkgin:
        name: "{{ item }}"
        state: present
        update_cache: yes
        upgrade: yes
        clean: true
        full_upgrade: true
        force: yes
      loop: "{{ pkgin_packages }}"

    - name: Print debug information
      debug:
        var: ansible_pkg_mgr

    - name: Remove packages using 'community.general.pkgin' module
      community.general.pkgin:
        name: "{{ item }}"
        state: absent
        update_cache: no
        upgrade: no
        clean: false
        full_upgrade: false
        force: no
      loop: "{{ pkgin_packages }}"