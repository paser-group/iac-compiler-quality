---
- name: Test playbook for community.general.xenserver_guest module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a XenServer VM
      community.general.xenserver_guest:
        hostname: "{{ xenserver_host }}"
        username: "{{ xenserver_username }}"
        password: "{{ xenserver_password }}"
        validate_certs: false
        name: "vm{{ vm_name_suffix }}"
        template: "{{ template_uuid }}"
        disks:
          - size: "10G"
            sr: "Local storage"
          - size: 20G
            sr: "Local storage"
        hardware:
          memory: "4GiB"
          vcpus: 2
          cpu_weight: '256'
        networks:
          - name: "{{ network_name }}"

      register: vm_creation_result

    - name: Print VM creation result
      debug:
        var: vm_creation_result