---
- name: Configure gslb vserver
  hosts: localhost
  gather_facts: False

  vars:
    nitro_user: "admin"
    nitro_pass: "password"
    nitro_protocol: "http"
    nitro_timeout: 10
    validate_certs: False

  tasks:
    - name: Create gslb vserver
      community.network.netscaler_gslb_vserver:
        nsip: "{{ nsip }}"
        name: "gslb-vserver"
        servicetype: "HTTP"
        timeout: "{{ timeout }}"
        comment: "{{ comment }}"
        lbmethod: "{{ lbmethod }}"
        persistencetype: "{{ persistencetype }}"
        persistenceid: "{{ persistenceid }}"
        persistmask: "{{ persistmask }}"
        v6netmasklen: "{{ v6netmasklen }}"
        v6persistmasklen: "{{ v6persistmasklen }}"
        service_bindings:
          - servicename: "{{ servicename }}"
            weight: "{{ weight }}"
        domain_bindings:
          - domainname: "{{ domainname }}"
            ttl: "{{ ttl }}"
        backuplbmethod: "{{ backuplbmethod }}"
        disableprimaryondown: "{{ disableprimaryondown }}"
        tcpbuffsize: 8190
        maxbandwidth: 0
        maxclient: 0
        state: present
        validate_certs: "{{ validate_certs }}"
      register: result

    - debug:
        var: result