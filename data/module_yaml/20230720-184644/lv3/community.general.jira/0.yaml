---
- name: Create and Modify Jira Issues
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create Jira Issue with bytes and strings
      community.general.jira:
        uri: "https://example-jira.com"
        username: "admin"
        password: "admin"
        project: "PROJ"
        issuetype: "Bug"
        summary: "Test Issue"
        description: "This is a test issue"
        fields:
          - summary: "Test Summary"
            description: "bytes and strings"
            attachment:
              path: "/path/to/attachment.docx"
              name: "attachment.docx"
            comment:
              body: "Test Comment"
              visibility:
                type: "role"
                value: "Administrators"
        timeout: 30
        validate_certs: False
      register: create_issue

    - name: Print the Result of Create Issue
      debug:
        var: create_issue

    - name: Modify Jira Issue
      community.general.jira:
        uri: "https://example-jira.com"
        username: "admin"
        password: "admin"
        issue: "{{ create_issue.json.key }}"
        fields:
          - summary: "Updated Summary"
            description: "Updated Description"
            comment:
              body: "Updated Comment"
              visibility:
                type: "role"
                value: "Developers"
        timeout: 30
        validate_certs: False
      register: modify_issue

    - name: Print the Result of Modify Issue
      debug:
        var: modify_issue