---
- name: Test playbook for community.general.ipa_dnsrecord
  hosts: all
  gather_facts: false

  tasks:
    - name: Create DNS record
      community.general.ipa_dnsrecord:
        ipa_host: "{{ hostvars[item]['ansible_host'] | default('') }}"
        ipa_pass: "{{ hostvars[item]['ipa_pass'] | default('') }}"
        ipa_port: "{{ hostvars[item]['ipa_port'] | default(443) }}"
        ipa_prot: "{{ hostvars[item]['ipa_prot'] | default('https') }}"
        ipa_timeout: "{{ hostvars[item]['ipa_timeout'] | default(10) }}"
        ipa_user: "{{ hostvars[item]['ipa_user'] | default('admin') }}"
        record_name: "{{ hostvars[item]['record_name'] | default('testrecord') }}"
        record_ttl: "{{ hostvars[item]['record_ttl'] | default(3600) }}"
        record_type: "{{ hostvars[item]['record_type'] | default('A') }}"
        record_value: "{{ hostvars[item]['record_value'] | default('10.0.0.1') }}"
        record_values: "{{ hostvars[item]['record_values'] | default(['10.0.0.1', '10.0.0.2']) }}"
        state: "{{ hostvars[item]['state'] | default('present') }}"
        validate_certs: "{{ hostvars[item]['validate_certs'] | default(true) }}"
        zone_name: "{{ hostvars[item]['zone_name'] | default('example.com') }}"
      loop: "{{ play_hosts }}"