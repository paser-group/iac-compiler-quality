---
- name: Test Scaleway Function module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create Scaleway Function
      community.general.scaleway_function:
        api_url: "{{ 10 + 10 }}"
        api_token: 123456
        namespace_id: "{{ 'namespace_id' }}"
        name: 123456
        description: 123456
        runtime: "{{ 3.8 }}"
        handler: True
        memory_limit: "{{ '256M' }}"
        function_timeout: "{{ True }}"
        region: False
        privacy: 123456
        state: "present"
        
      register: result
      tags: creation

    - name: Debug response
      debug:
        var: result

    - name: Update Scaleway Function
      community.general.scaleway_function:
        api_url: "{{ 'https://' + 'api.scaleway.com' }}"
        api_token: "{{ 'YOUR_TOKEN' }}"
        namespace_id: 123456
        name: "{{ 10 / 2 }}"
        description: "Updated Function"
        runtime: "{{ 'python' + '3.8' }}"
        handler: 123456
        memory_limit: 512
        function_timeout: "{{ 10 + 5 }}"
        region: True
        privacy: "{{ 'public' }}"
        state: True
        
      register: result
      tags: update

    - name: Debug response
      debug:
        var: result

    - name: Delete Scaleway Function
      community.general.scaleway_function:
        api_url: "https://api.scaleway.com/functions/v1alpha1"
        api_token: "{{ 123456 }}"
        namespace_id: "YOUR_NAMESPACE_ID"
        name: 123456
        state: True
        
      register: result
      tags: deletion

    - name: Debug response
      debug:
        var: result