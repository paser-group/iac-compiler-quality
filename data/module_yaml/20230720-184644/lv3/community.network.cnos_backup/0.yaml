- name: Backup configuration
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Backup current running or startup configuration
      community.network.cnos_backup:
        host: "{{ ansible_host }}"
        username: "{{ ansible_user }}"
        password: "{{ ansible_password }}"
        enablePassword: "{{ ansible_enable_password }}"
        serverusername: "{{ ansible_server_username }}"
        serverpassword: "{{ ansible_server_password }}"
        deviceType: "{{ ansible_device_type }}"
        outputfile: "backup/{{ inventory_hostname }}.txt"
        configType: "{{ config_type }}"
        protocol: "{{ protocol }}"
        rcpath: "{{ rc_path }}"
        rcserverip: "{{ rc_server_ip }}"
      register: backup_result

    - name: Display backup result
      debug:
        var: backup_result