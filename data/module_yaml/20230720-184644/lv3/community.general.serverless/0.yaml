- name: Test playbook for 'community.general.serverless' module
  hosts: localhost
  gather_facts: false

  vars:
    deploy: "true"
    force: true
    region: "us-east-1"
    serverless_bin_path: "/usr/local/bin/serverless"
    service_path: !binary |-
      SGVsbG8gd29ybGQ=
    stage: 1
    state: "present"
    verbose: "true"

  tasks:
    - name: Install community.general collection
      ansible.builtin.shell: |
        ansible-galaxy collection install community.general
      changed_when: false

    - name: Manage serverless
      community.general.serverless:
        deploy: "{{ deploy }}"
        force: "{{ force }}"
        region: "{{ region }}"
        serverless_bin_path: "{{ serverless_bin_path }}"
        service_path: "{{ service_path }}"
        stage: "{{ stage }}"
        state: "{{ state }}"
        verbose: "{{ verbose }}"