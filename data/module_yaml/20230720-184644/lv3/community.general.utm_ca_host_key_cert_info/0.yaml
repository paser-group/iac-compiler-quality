- name: Gather info for ca host_key_cert
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set headers
      set_fact:
        ca_headers:
          Authorization: "{{ 'Basic ' + utm_token | b64encode }}"
      vars:
        utm_token: "default_token"

    - name: Get info for ca host_key_cert
      community.general.utm_ca_host_key_cert_info:
        name: ca_key_cert
        state: present
        utm_host: "10.1.1.1"
        utm_port: 8443
        utm_protocol: "https"
        utm_token: "{{ utm_token }}"
        validate_certs: true
        headers: "{{ ca_headers }}"
      register: result

    - name: Verify result
      debug:
        var: result