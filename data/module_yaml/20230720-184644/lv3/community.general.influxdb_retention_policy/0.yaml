- name: Test playbook for influxdb_retention_policy module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create retention policies
      community.general.influxdb_retention_policy:
        state: present
        hostname: 10.1.1.1
        port: "8086"
        username: ansible
        password: "password"
        database_name: mydb

        policy_name: "policy1"
        duration: "1h"
        shard_group_duration: "1w"
        replication: "2"
        default: "true"

        validate_certs: "false"
        ssl: "true"

        retries: "3"
        timeout: "30"

        use_udp: "true"
        udp_port: "8085"

        proxies:
          http: http://proxy.example.com
          https: https://proxy.example.com

        path: "/etc/influxdb/"

      register: result

    - name: Show result
      debug:
        var: result