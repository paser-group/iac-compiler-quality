---
- name: Manage advanced ACL configuration on HUAWEI devices
  hosts: localhost
  gather_facts: false
  vars:
    acl_description: 10       # Bug: Description should be a string, not integer
    acl_name: ACL_Test
    acl_num: "10"
    acl_step: "5"
    dest_ip: 10.1.1.0         # Bug: IP address should be enclosed in double quotes
    dest_mask: 255.255.255.0
    dest_pool_name: None      # Bug: Pool name should be a string, not None
    dest_port_begin: 80
    dest_port_end: 443
    dest_port_op: "eq"
    dest_port_pool_name: DestinationPortPool
    dscp: 30
    established: 1            # Bug: Established should be boolean, not integer
    frag_type: "is-frag"
    icmp_code: 6
    icmp_name: icmp_name
    icmp_type: echo-reply
    igmp_type: leave
    log_flag: 1               # Bug: log_flag should be boolean, not integer
    precedence: "5"
    protocol: tcp
    rule_action: permit
    rule_description: "Test rule"
    rule_id: "1"
    rule_name: Rule_Test
    source_ip: 10.2.2.0       # Bug: IP address should be enclosed in double quotes
    src_mask: 255.255.255.0
    src_pool_name: "SourcePool"
    src_port_begin: "1024"
    src_port_end: "65535"
    src_port_op: "range"
    src_port_pool_name: SourcePortPool
    state: present
    syn_flag: "non-syn"
    tcp_flag_mask: "ack"
    time_range: None          # Bug: Time range should be a string, not None
    tos: "10"
    ttl_expired: 1            # Bug: ttl_expired should be boolean, not integer
    vrf_name: VRF_Test

  tasks:
    - name: Manage advanced ACL
      community.network.ce_acl_advance:
        acl_description: "{{ acl_description }}"
        acl_name: "{{ acl_name }}"
        acl_num: "{{ acl_num }}"
        acl_step: "{{ acl_step }}"
        dest_ip: "{{ dest_ip }}"
        dest_mask: "{{ dest_mask }}"
        dest_pool_name: "{{ dest_pool_name }}"
        dest_port_begin: "{{ dest_port_begin }}"
        dest_port_end: "{{ dest_port_end }}"
        dest_port_op: "{{ dest_port_op }}"
        dest_port_pool_name: "{{ dest_port_pool_name }}"
        dscp: "{{ dscp }}"
        established: "{{ established }}"
        frag_type: "{{ frag_type }}"
        icmp_code: "{{ icmp_code }}"
        icmp_name: "{{ icmp_name }}"
        icmp_type: "{{ icmp_type }}"
        igmp_type: "{{ igmp_type }}"
        log_flag: "{{ log_flag }}"
        precedence: "{{ precedence }}"
        protocol: "{{ protocol }}"
        rule_action: "{{ rule_action }}"
        rule_description: "{{ rule_description }}"
        rule_id: "{{ rule_id }}"
        rule_name: "{{ rule_name }}"
        source_ip: "{{ source_ip }}"
        src_mask: "{{ src_mask }}"
        src_pool_name: "{{ src_pool_name }}"
        src_port_begin: "{{ src_port_begin }}"
        src_port_end: "{{ src_port_end }}"
        src_port_op: "{{ src_port_op }}"
        src_port_pool_name: "{{ src_port_pool_name }}"
        state: "{{ state }}"
        syn_flag: "{{ syn_flag }}"
        tcp_flag_mask: "{{ tcp_flag_mask }}"
        time_range: "{{ time_range }}"
        tos: "{{ tos }}"
        ttl_expired: "{{ ttl_expired }}"
        vrf_name: "{{ vrf_name }}"