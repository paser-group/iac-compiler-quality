- name: Configure FreeIPA OTP
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install python-ldap package
      package:
        name: python-ldap
        state: present
      become: true

    - name: Configure FreeIPA OTP
      community.general.ipa_otpconfig:
        ipa_host: "ipa.example.com"
        ipa_user: "admin"
        ipa_pass: "password"
        ipa_prot: "https"
        ipa_port: 443
        ipa_timeout: 30
        ipatokenhotpauthwindow: 60
        ipatokenhotpsyncwindow: 30
        ipatokentotpauthwindow: 60
        ipatokentotpsyncwindow: 30
        validate_certs: false
      register: otp_config