- name: Manage VXLAN tunnel configuration
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create VXLAN tunnel configuration
      community.network.ce_vxlan_tunnel:
        bridge_domain_id: "{{ item.bridge_domain_id }}"
        nve_mode: "{{ item.nve_mode }}"
        nve_name: "{{ item.nve_name }}"
        peer_list_ip: "{{ item.peer_list_ip }}"
        protocol_type: "{{ item.protocol_type }}"
        source_ip: "{{ item.source_ip }}"
        state: "{{ item.state }}"
        vni_id: "{{ item.vni_id }}"
      loop:
        - bridge_domain_id: None
          nve_mode: None
          nve_name: None
          peer_list_ip: None
          protocol_type: None
          source_ip: None
          state: None
          vni_id: None
        - bridge_domain_id: 10
          nve_mode: "vtep"
          nve_name: "nve1"
          peer_list_ip: "10.1.1.2"
          protocol_type: "vxlan"
          source_ip: "10.1.1.1"
          state: "present"
          vni_id: 1000
        - bridge_domain_id: "abc"
          nve_mode: 123
          nve_name: "nve2"
          peer_list_ip: "10.1.1.3"
          protocol_type: "vxlan"
          source_ip: "10.1.1.1"
          state: "absent"
          vni_id: "xyz"

    - debug:
        var: item.msg
      loop: "{{ ansible_loop.results }}"