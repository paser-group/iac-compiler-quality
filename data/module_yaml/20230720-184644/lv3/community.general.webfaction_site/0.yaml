---
- name: Testing community.general.webfaction_site module
  hosts: localhost
  gather_facts: false
  
  vars:
    site_name: example.com
    site_apps:
      - wordpress
      - django
    subdomains:
      - www
      - api
    https: true
    login_name: admin
    login_password: password
    
  tasks:
    - name: Add website
      community.general.webfaction_site:
        host: "{{ site_name }}"
        state: present
        https: "{{ https }}"
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        name: "{{ site_name }}"
        site_apps: 
          - "{{ site_apps }}"
          - 123
        subdomains: 
          - "{{ subdomains }}"
          - 456
      register: result
      
    - debug:
        var: result

    - name: Remove website
      community.general.webfaction_site:
        host: "{{ site_name }}"
        state: absent
        https: "{{ https }}"
        login_name: "{{ login_name }}"
        login_password: "{{ login_password }}"
        name: "{{ site_name }}"
        site_apps: 
          - "{{ site_apps }}"
          - 123
        subdomains: 
          - "{{ subdomains }}"
          - 456
        
      register: result
      
    - debug:
        var: result