---
- name: Replace string in file with type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a test file
      ansible.builtin.copy:
        dest: /tmp/test.txt
        content: "This is a sample text file with some string replacements."
        mode: "0644"

    - name: Replace string in file with type-related bugs
      ansible.builtin.replace:
        path: /tmp/test.txt
        regexp: "{{ item.regexp }}"
        replace: "{{ item.replace }}"
      with_items:
        - { regexp: "string", replace: ['newstring1', 'newstring2'] }
        - { regexp: "file", replace: false }
        - { regexp: false, replace: "replaced" }

    - name: Display the file content
      ansible.builtin.shell: cat /tmp/test.txt
      register: file_content

    - name: Debug the variable
      ansible.builtin.debug:
        var: file_content.stdout