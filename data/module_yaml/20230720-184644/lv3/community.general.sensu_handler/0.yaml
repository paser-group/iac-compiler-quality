---
- name: Test Sensu Handler Module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install Sensu Handler Module
      pip:
        name: sensu-handler
        state: present

    - name: Create Sensu Handler Configuration
      community.general.sensu_handler:
        name: my_handler
        type: pipe
        command: /path/to/command
        filter: my_filter
        filters: string_value
        handle_flapping: true
        handle_silenced: false
        handlers:
          - handler1
          - handler2
        mutator: my_mutator
        severities: critical
        state: present