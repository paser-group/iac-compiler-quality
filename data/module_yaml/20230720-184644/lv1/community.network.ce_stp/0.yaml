---
- name: Manage STP configuration on HUAWEI devices
  hosts: switches
  gather_facts: false

  tasks:
    - name: Configure STP
      community.network.ce_stp:
        bpdu_filter: 123
        bpdu_protection: "enabled"
        cost: "100"
        edged_port: true
        interface: "ethernet1/1"
        loop_protection: false
        root_protection: true
        state: "active"
        stp_converge: 10
        stp_enable: false
        stp_mode: "normal"
        tc_protection: true
        tc_protection_interval: 5
        tc_protection_threshold: 500

    - name: Debug STP configuration
      debug:
        var: community_network_ce_stp