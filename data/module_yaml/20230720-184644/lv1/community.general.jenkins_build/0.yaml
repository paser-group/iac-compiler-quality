---
- name: Test ansible latent type-related bug
  hosts: localhost
  gather_facts: false

  vars:
    url: "http://{{ item }}/jenkins"
    user: admin
    password: secret
    name: my_build
    build_number: "10"
    token: "{{ TOKEN }}"
    state: present

  tasks:
    - name: Create Jenkins build job
      community.general.jenkins_build:
        url: "{{ url }}"
        user: "{{ user }}"
        password: "{{ password }}"
        name: "{{ name }}"
        build_number: "{{ build_number }}"
        token: "{{ token }}"
        state: "{{ state }}"
      register: result
      
    - name: Debug result
      debug:
        var: result
        verbosity: 2

- name: Print variables
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Print variables
      debug:
        var: item
      loop:
        - url
        - user
        - password
        - name
        - build_number
        - token
        - state
      when: item in ansible_facts.keys()