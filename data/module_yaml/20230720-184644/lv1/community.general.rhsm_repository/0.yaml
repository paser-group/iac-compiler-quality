- hosts: all
  gather_facts: false
  tasks:
    - name: Manage RHSM repositories
      community.general.rhsm_repository:
        name: "{{ item.name }}"
        purge: "{{ item.purge | default(false) }}"
        state: "{{ item.state | default('present') }}"
      loop:
        - { name: 'Repository1', purge: true, state: 'present' }
        - { name: 'Repository2', purge: false, state: 'absent' }
        - { name: 'repository3', purge: true, state: 'present' }
        - { name: 'REPOSITORY4', purge: false, state: 'absent' }