---
- name: Test playbook for community.general.clc_alert_policy module
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Create Alert Policy
      community.general.clc_alert_policy:
        alias: "Test Policy"
        name: "Test Policy"
        metric: "CpuUsage"
        threshold: 90
        duration: "PT30M"
        alert_recipients:
          - "john.doe@example.com"
        state: present
      register: create_policy

    - debug:
        var: create_policy

    - name: Modify Alert Policy
      community.general.clc_alert_policy:
        id: "{{ create_policy.id }}"
        name: "Modified Policy"
        metric: "POSTFailureRate"
      register: modify_policy

    - debug:
        var: modify_policy

    - name: Delete Alert Policy
      community.general.clc_alert_policy:
        id: "{{ create_policy.id }}"
        state: absent
      register: delete_policy

    - debug:
        var: delete_policy