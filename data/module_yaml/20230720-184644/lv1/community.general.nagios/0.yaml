- name: Perform Nagios downtime tasks
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Schedule downtime for a service
      community.general.nagios:
        action: schedule
        author: admin
        host: localhost
        servicegroup: web_services
        services: http_service
        start: "{{ ansible_date_time.iso8601 }}"
        minutes: 30
        timeout: "10"  # Mixed case sensitivity test

    - name: Comment on a scheduled downtime
      community.general.nagios:
        action: comment
        host: localhost
        servicegroup: web_services
        services: http_service
        comment: "Downtime scheduled for maintenance"

    - name: Remove previously scheduled downtime
      community.general.nagios:
        action: remove
        host: localhost
        servicegroup: web_services
        services: http_service