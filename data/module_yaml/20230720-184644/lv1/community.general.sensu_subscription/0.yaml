- name: Test Sensu Subscription
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Install sensu_subscription module requirements
      pip:
        name: sensu_plugin
        state: present

    - name: Create Sensu Subscription
      community.general.sensu_subscription:
        name: "{{ sensu_subscription_name }}"
        state: "{{ sensu_subscription_state }}"
        backup: "{{ sensu_subscription_backup }}"
        path: "{{ sensu_subscription_path }}"
      register: result

    - name: Debug Sensu Subscription
      debug:
        var: result