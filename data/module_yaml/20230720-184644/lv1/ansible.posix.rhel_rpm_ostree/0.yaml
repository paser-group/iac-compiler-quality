---
- name: Manage packages on RHEL for Edge systems
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install packages using 'ansible.posix.rhel_rpm_ostree' module
      ansible.posix.rhel_rpm_ostree:
        name: "{{ item.name }}"
        state: "{{ item.state }}"
      with_items:
        - { name: 'Package1', state: 'present' }
        - { name: 'Package2', state: 'present' }
        - { name: 'Package3', state: 'absent' }

    - name: Debug package installation
      debug:
        msg: "{{ item }} package was {{ ansible.posix.rhel_rpm_ostree_packages[item].state }}"
      with_items:
        - Package1
        - Package2
        - Package3