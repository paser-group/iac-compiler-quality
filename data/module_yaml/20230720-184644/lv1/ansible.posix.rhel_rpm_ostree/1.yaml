---
- name: Manage packages on RHEL for Edge systems
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install packages using 'ansible.posix.rhel_rpm_ostree' module (Heuristic Test)
      ansible.posix.rhel_rpm_ostree:
        name: "{{ item.Name }}"
        state: "{{ item.State }}"
      with_items:
        - { Name: 'Package1', State: 'present' }
        - { Name: 'Package2', State: 'present' }
        - { Name: 'Package3', State: 'absent' }

    - name: Debug package installation (Heuristic Test)
      debug:
        msg: "{{ item }} package was {{ ansible.posix.rhel_rpm_ostree_packages[item].state }}"
      with_items:
        - Package1
        - Package2
        - Package3