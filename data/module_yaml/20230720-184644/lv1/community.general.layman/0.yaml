- name: Manage Gentoo overlays
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Add Gentoo overlay
      community.general.layman:
        name: "{{ item.name }}"
        state: "{{ item.state }}"
        list_url: "{{ item.list_url }}"
        validate_certs: "{{ item.validate_certs }}"
      loop:
        - name: overlay1
          state: present
          list_url: https://example.com/overlay1.xml
          validate_certs: "true"
        - name: overlay2
          state: "absent"
          list_url: "{{ hostvars[groups['localhost'][0]].var }}"
          validate_certs: "{{ hostvars[groups['localhost'][0]].bool_var }}"