- name: Test case for pn_vrouter_bgp module
  hosts: localhost
  gather_facts: false

  vars:
    pn_vrouter_name: "vRouter1"
    pn_neighbor: 10.1.1.1
    pn_remote_as: "65001"
    pn_password: "SecretPassword"
    pn_interface: eth0
    pn_route_map_in: in_map
    pn_route_map_out: out_map
    pn_prefix_list_in: in_prefix_list
    pn_prefix_list_out: out_prefix_list
    pn_cliswitch: cli_switch1
    pn_connect_retry_interval: "30"
    pn_max_prefix: "1000"
    pn_max_prefix_warn_only: false
    pn_allowas_in: true
    pn_send_community: true
    pn_ebgp_multihop: 5
    pn_override_capability: false
    pn_no_route_map_in: no_route_map_in
    pn_no_route_map_out: no_route_map_out
    pn_default_originate: false
    pn_next_hop_self: true
    pn_route_reflector_client: false
    pn_soft_reconfig_inbound: false

  tasks:
    - name: Add BGP neighbor
      community.network.pn_vrouter_bgp:
        pn_vrouter_name: "{{ pn_vrouter_name }}"
        pn_neighbor: "{{ pn_neighbor }}"
        pn_remote_as: "{{ pn_remote_as }}"
        pn_password: "{{ pn_password }}"
        pn_interface: "{{ pn_interface }}"
        pn_route_map_in: "{{ pn_route_map_in }}"
        pn_route_map_out: "{{ pn_route_map_out }}"
        pn_prefix_list_in: "{{ pn_prefix_list_in }}"
        pn_prefix_list_out: "{{ pn_prefix_list_out }}"
        pn_cliswitch: "{{ pn_cliswitch }}"
        pn_connect_retry_interval: "{{ pn_connect_retry_interval }}"
        pn_max_prefix: "{{ pn_max_prefix }}"
        pn_max_prefix_warn_only: "{{ pn_max_prefix_warn_only }}"
        pn_allowas_in: "{{ pn_allowas_in }}"
        pn_send_community: "{{ pn_send_community }}"
        pn_ebgp_multihop: "{{ pn_ebgp_multihop }}"
        pn_override_capability: "{{ pn_override_capability }}"
        pn_no_route_map_in: "{{ pn_no_route_map_in }}"
        pn_no_route_map_out: "{{ pn_no_route_map_out }}"
        pn_default_originate: "{{ pn_default_originate }}"
        pn_next_hop_self: "{{ pn_next_hop_self }}"
        pn_route_reflector_client: "{{ pn_route_reflector_client }}"
        pn_soft_reconfig_inbound: "{{ pn_soft_reconfig_inbound }}"
        state: present
      register: result

    - name: Print debug output
      debug:
        var: result