---
- name: Test emc_vnx_sg_member module for type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    test_sg:
      - name: Test_SG
        lunid: 0
        sp_address: "10.1.1.1"
        sp_user: "admin"
        sp_password: "password"
        state: present
      - name: test_sg
        lunid: "1"
        sp_address: "10.1.1.2"
        sp_user: "admin"
        sp_password: "password"
        state: absent

  tasks:
    - name: Create test storage group with mixed-case name
      community.general.emc_vnx_sg_member:
        storage_group: "{{ item.name }}"
        lunid: "{{ item.lunid }}"
        sp_address: "{{ item.sp_address }}"
        sp_user: "{{ item.sp_user }}"
        sp_password: "{{ item.sp_password }}"
        state: "{{ item.state }}"
      loop: "{{ test_sg }}"
      register: result

    - name: Debug result
      debug:
        var: result