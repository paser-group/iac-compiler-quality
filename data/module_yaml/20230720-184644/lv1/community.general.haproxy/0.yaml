---
- name: Manage HAProxy backend servers
  hosts: localhost
  gather_facts: false

  tasks:

    - name: Enable backend server
      community.general.haproxy:
        socket: /var/run/haproxy.sock
        backend: backend1
        host: server1
        state: ENABLED
      register: result
      ignore_errors: true

    - name: Disable backend server
      community.general.haproxy:
        socket: /var/run/haproxy.sock
        backend: backend1
        host: server2
        state: disabled
      register: result
      ignore_errors: true

    - name: Set weight for backend server
      community.general.haproxy:
        socket: /var/run/haproxy.sock
        backend: backend1
        host: server3
        weight: '100'
      register: result
      ignore_errors: true

    - name: Test case for mixed case sensitivity - state
      community.general.haproxy:
        socket: /var/run/haproxy.sock
        backend: backend1
        host: server4
        state: ENABLED
      register: result
      ignore_errors: true

    - name: Test case for mixed case sensitivity - weight
      community.general.haproxy:
        socket: /var/run/haproxy.sock
        backend: backend1
        host: server5
        weight: '100'
      register: result
      ignore_errors: true