---
- name: Configure InfluxDB database
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Create InfluxDB database
      community.general.influxdb_database:
        database_name: "{{ item.name }}"
        hostname: "{{ item.hostname }}"
        port: "{{ item.port }}"
        username: "{{ item.username }}"
        password: "{{ item.password }}"
        state: "{{ item.state }}"
      register: result
      with_items:
        - { name: "mydb", hostname: "localhost", port: 8086, username: "admin", password: "Password123", state: "present" }
        - { name: "myDB", hostname: "localhost", port: 8086, username: "admin", password: "Password123", state: "present" }

    - name: Debug output
      debug:
        var: result

    - name: Delete InfluxDB database
      community.general.influxdb_database:
        database_name: "{{ item }}"
        hostname: "localhost"
        port: 8086
        username: "admin"
        password: "Password123"
        state: "absent"
      with_items:
        - "mydb"
        - "myDB"