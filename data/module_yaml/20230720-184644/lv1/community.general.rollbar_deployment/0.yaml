---
- name: Test Rollbar Deployment
  hosts: localhost
  gather_facts: false
  become: false

  vars:
    rollbar_env: "Production"
    rollbar_token: "1234567890"
    rollbar_url: "https://api.rollbar.com"
    rollbar_user: "myuser"
    rollbar_revision: "1.0.0"
    rollbar_comment: "Rollbar deployment from Ansible"
    rollbar_validate_certs: false

  tasks:
    - name: Notify Rollbar about deployment
      community.general.rollbar_deployment:
        env: "{{ rollbar_env }}"
        token: "{{ rollbar_token }}"
        url: "{{ rollbar_url }}"
        user: "{{ rollbar_user }}"
        revision: "{{ rollbar_revision }}"
        comment: "{{ rollbar_comment }}"
        validate_certs: "{{ rollbar_validate_certs }}"
      register: rollbar_result

    - name: Debug Rollbar result
      debug:
        var: rollbar_result