---
- name: Test playbook for community.general.macports module
  hosts: localhost
  gather_facts: false

  vars:
    macports_packages:
      - name: gcc
        selfupdate: yes
        state: present
        upgrade: no
        variant: debug

  tasks:
    - name: Install MacPorts package
      community.general.macports:
        name: "{{ item.name }}"
        selfupdate: "{{ item.selfupdate | default(false) | bool }}"
        state: "{{ item.state | default('present') }}"
        upgrade: "{{ item.upgrade | default(false) | bool }}"
        variant: "{{ item.variant | default('') }}"
      loop: "{{ macports_packages }}"
      register: macports_result

    - name: Display macports_result
      debug:
        var: macports_result