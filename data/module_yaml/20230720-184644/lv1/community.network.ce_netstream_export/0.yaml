- name: Test Playbook for community.network.ce_netstream_export
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set netstream export options
      community.network.ce_netstream_export:
        provider:
          host: "{{ host_ip }}"
          port: "{{ host_port }}"
          username: "{{ ansible_user }}"
          password: "{{ ansible_password }}"
          transport: cli
          platform: huawei
        state: "{{ state }}"
        as_option: "{{ as_option }}"
        bgp_nexthop: "{{ bgp_nexthop }}"
        host_vpn: "{{ host_vpn }}"
        source_ip: "{{ source_ip }}"
        type: "{{ type }}"
        version: "{{ version }}"
      register: result

    - name: Debug module output
      debug:
        var: result

  vars:
    host_ip: "{{ host_ip | lower }}"
    host_port: "{{ host_port | upper }}"
    ansible_user: "{{ ansible_user | capitalize }}"
    ansible_password: "{{ ansible_password | swapcase }}"
    state: "{{ state | title }}"
    as_option: "{{ as_option | reverse }}"
    bgp_nexthop: "{{ bgp_nexthop | lower }}"
    host_vpn: "{{ host_vpn | upper }}"
    source_ip: "{{ source_ip | lower }}"
    type: "{{ type | upper }}"
    version: "{{ version | capitalize }}"