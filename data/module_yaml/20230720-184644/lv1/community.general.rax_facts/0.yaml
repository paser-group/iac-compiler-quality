- name: Gather Rackspace Facts
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Include 'community.general.rax_facts' module
      include_vars:
        file: "rax_facts.yml"
        name: "rax_facts_params"

    - name: Gather Rackspace Facts
      community.general.rax_facts:
        address: "{{ rax_facts_params.address | default('10.1.1.1') }}"
        api_key: "{{ rax_facts_params.api_key | default('my_api_key') }}"
        auth_endpoint: "{{ rax_facts_params.auth_endpoint | default('https://auth.api.rackspacecloud.com/v2.0') }}"
        credentials: "{{ rax_facts_params.credentials | default('/path/to/credentials') }}"
        env: "{{ rax_facts_params.env | default('production') }}"
        id: "{{ rax_facts_params.id | default('my_rackspace_server_id') }}"
        identity_type: "{{ rax_facts_params.identity_type | default('rackspace') }}"
        name: "{{ rax_facts_params.name | default('my_rackspace_server') }}"
        region: "{{ rax_facts_params.region | default('us-east-1') }}"
        tenant_id: "{{ rax_facts_params.tenant_id | default('my_tenant_id') }}"
        tenant_name: "{{ rax_facts_params.tenant_name | default('my_tenant_name') }}"
        username: "{{ rax_facts_params.username | default('my_username') }}"
        validate_certs: "{{ rax_facts_params.validate_certs | default(true) }}"
      register: rax_facts_result

    - name: Debug Rackspace Facts
      debug:
        var: rax_facts_result