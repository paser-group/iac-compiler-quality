---
- name: Test playbook for Ansible XML module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create the XML file
      community.general.xml:
        path: /tmp/test.xml
        namespaces:
          ns: "http://example.com"
        xpath: "/ns:root"
        state: "touch"

    - name: Add child elements to the XML file
      community.general.xml:
        path: /tmp/test.xml
        xpath: "/ns:root"
        add_children:
          - name: "ChildElement"
            attribute: "attributeValue"
            content: "Hello from child element"
        namespaces:
          ns: "http://example.com"

    - name: Set attribute value of an element
      community.general.xml:
        path: /tmp/test.xml
        xpath: "/ns:root/ChildElement"
        attribute: "attributeValue"
        value: "NewAttributeValue"
        namespaces:
          ns: "http://example.com"

    - name: Remove a child element from the XML file
      community.general.xml:
        path: /tmp/test.xml
        xpath: "/ns:root/ChildElement"
        state: "absent"
        namespaces:
          ns: "http://example.com"

    - name: Search for elements using XPath
      community.general.xml:
        path: /tmp/test.xml
        xpath: "/ns:root"
        print_match: true
        namespaces:
          ns: "http://example.com"

    - name: Update the XML file using XML string
      community.general.xml:
        path: /tmp/test.xml
        xmlstring: "<ns:root xmlns:ns='http://example.com'><ChildElement>Modified content</ChildElement></ns:root>"
        namespaces:
          ns: "http://example.com"

    - name: Update the XML file using a file as input
      community.general.xml:
        path: /tmp/test.xml
        input_type: "file"
        content: "/tmp/xml_content.xml"
        namespaces:
          ns: "http://example.com"