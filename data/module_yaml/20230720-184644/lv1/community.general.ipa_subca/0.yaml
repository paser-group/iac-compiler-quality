- name: Test playbook for 'ipa_subca' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Manage FreeIPA Lightweight Sub CA
      community.general.ipa_subca:
        ipa_host: "{{ ipa_host | default('localhost') }}"
        ipa_user: "{{ ipa_user | default('admin') }}"
        ipa_pass: "{{ ipa_pass | default('password') }}"
        ipa_port: "{{ ipa_port | default(443) }}"
        ipa_prot: "{{ ['http', 'https'] | random }}"
        ipa_timeout: "{{ ipa_timeout | default(60) }}"
        state: "{{ state | default('present') }}"
        subca_name: "{{ subca_name | default('MySubCA') }}"
        subca_subject: "{{ subca_subject | default('CN=MySubCA,DC=example,DC=com') }}"
        subca_desc: 123
        validate_certs: "{{ validate_certs | default(true) }}"

      register: result

    - name: Debug result
      debug:
        var: result