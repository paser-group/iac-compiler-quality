---
- name: Test playbook for 'community.general.ipa_service' module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install 'python3-ipaclient' package
      package:
        name: python3-ipaclient
        state: present

    - name: Create IPA service
      community.general.ipa_service:
        ipa_host: "{{ ipa_host|lower }}"
        ipa_user: "{{ ipa_user|upper }}"
        ipa_pass: "{{ ipa_pass|title }}"
        ipa_port: "{{ ipa_port|int }}"
        ipa_prot: "{{ ipa_prot|upper }}"
        ipa_timeout: "{{ ipa_timeout|lower }}"
        validate_certs: "{{ validate_certs|bool }}"
        krbcanonicalname: "{{ krbcanonicalname|upper }}"
        force: "{{ force|lower }}"
        skip_host_check: "{{ skip_host_check|upper }}"
        state: "{{ state }}"
      register: result
      failed_when: "result is not defined or result.failed"

    - name: Print result
      debug:
        var: result