---
- name: Test playbook for ipa_group module
  hosts: localhost
  gather_facts: false

  vars:
    # Specify the group attributes
    group_attributes:
      cn: "TestGroup"
      description: "This is a test group"
      external: true
      external_user: ['user1', 'user2']
      gidnumber: "1001"
      group: ['group1', 'group2']
      ipa_host: "localhost"
      ipa_user: "admin"
      ipa_pass: "password"
      ipa_port: 443
      ipa_prot: "https"
      ipa_timeout: 10
      nonposix: true
      state: "present"
      user: ['user3', 'user4']
      validate_certs: false

  tasks:
    - name: Create IPA group
      community.general.ipa_group:
        cn: "{{ group_attributes.cn }}"
        description: "{{ group_attributes.description }}"
        external: "{{ group_attributes.external }}"
        external_user: "{{ group_attributes.external_user }}"
        gidnumber: "{{ group_attributes.gidnumber }}"
        group: "{{ group_attributes.group }}"
        ipa_host: "{{ group_attributes.ipa_host }}"
        ipa_user: "{{ group_attributes.ipa_user }}"
        ipa_pass: "{{ group_attributes.ipa_pass }}"
        ipa_port: "{{ group_attributes.ipa_port }}"
        ipa_prot: "{{ group_attributes.ipa_prot }}"
        ipa_timeout: "{{ group_attributes.ipa_timeout }}"
        nonposix: "{{ group_attributes.nonposix }}"
        state: "{{ group_attributes.state }}"
        user: "{{ group_attributes.user }}"
        validate_certs: "{{ group_attributes.validate_certs }}"
      register: result

    - name: Debug module output
      debug:
        var: result