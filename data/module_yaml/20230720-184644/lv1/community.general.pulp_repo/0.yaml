---
- name: Add or remove Pulp repository
  hosts: localhost
  tasks:
    - name: Add Pulp repository
      community.general.pulp_repo:
        name: "{{ item }}"
        state: present
        pulp_host: "http://{{ hostvars[item].ansible_ssh_host }}"
        feed: "https://{{ hostvars[item].ansible_distribution | lower }}.example.com/repo"
        force: true
        use_proxy: false
      loop:
        - ubuntu1
        - alpine1
        - centos1
        - redhat1

    - name: Remove Pulp repository
      community.general.pulp_repo:
        name: "{{ item }}"
        state: absent
        pulp_host: "http://{{ hostvars[item].ansible_ssh_host }}"
        force: true
      loop:
        - ubuntu1
        - alpine1
        - centos1
        - redhat1