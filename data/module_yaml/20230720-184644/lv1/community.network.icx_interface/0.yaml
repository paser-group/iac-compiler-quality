---

- name: Manage ICX interfaces
  hosts: switches
  gather_facts: False
  tasks:
    - name: Configure ICX interfaces
      community.network.icx_interface:
        aggregate:
          - name: "{{ interface_name }}"
            delay: "{{ interface_delay }}"
            description: "{{ interface_description }}"
            enabled: "{{ interface_enabled }}"
            neighbors: "{{ interface_neighbors }}"
            power:
              enable: "{{ interface_power_enable }}"
              priority: "{{ interface_power_priority }}"
            rx_rate: "{{ interface_rx_rate }}"
            speed: "{{ interface_speed }}"
            state: "{{ interface_state }}"
            stp: "{{ interface_stp }}"
            tx_rate: "{{ interface_tx_rate }}"
      vars:
        interface_name: Ethernet1/1
        interface_delay: 5
        interface_description: My interface
        interface_enabled: True
        interface_neighbors:
          - 192.168.0.1
          - 192.168.0.2
        interface_power_enable: True
        interface_power_priority: high
        interface_rx_rate: 1000
        interface_speed: auto
        interface_state: up
        interface_stp: True
        interface_tx_rate: 1000