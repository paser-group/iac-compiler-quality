---
- name: Collect facts from remote device
  hosts: all
  gather_facts: false

  tasks:
    - name: Include the required module
      include_vars:
        file: "{{ playbook_dir }}/vars.yml"
        name: cnos_facts_vars

    - name: Collect CNOS facts
      community.network.cnos_facts:
        auth_pass: "{{ cnos_facts_vars.auth_pass }}"
        authorize: "{{ cnos_facts_vars.authorize }}"
        gather_subset: "{{ cnos_facts_vars.gather_subset }}"
      register: cnos_facts_result

    - name: Debug the facts
      debug:
        var: cnos_facts_result