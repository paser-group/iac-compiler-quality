---
- name: Test netscaler_ssl_certkey module
  hosts: localhost
  gather_facts: false

  vars:
    nitro_user: "admin"
    nitro_pass: "admin"
    nitro_protocol: "https"
    nitro_timeout: 10
    nsip: "10.1.1.1"
    state: "present"

  tasks:
    - name: Create a certkey record
      community.network.netscaler_ssl_certkey:
        cert: "{{ cert_file }}"
        certkey: "{{ certkey_file }}"
        expirymonitor: "{{ expiry_monitor }}"
        inform: "{{ inform_value }}"
        key: "{{ key_file }}"
        nitro_pass: "{{ nitro_pass }}"
        nitro_protocol: "{{ nitro_protocol }}"
        nitro_timeout: "{{ nitro_timeout }}"
        nitro_user: "{{ nitro_user }}"
        notificationperiod: "{{ notification_period }}"
        nsip: "{{ nsip }}"
        passplain: "{{ plain_pass }}"
        password: "{{ password }}"
        save_config: "{{ save_config }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"

      vars:
        cert_file: "my_cert.pem"
        certkey_file: "my_certkey.pem"
        expiry_monitor: "enabled"
        inform_value: "https://my-webhook.com"
        key_file: "my_key.pem"
        notification_period: 60
        plain_pass: "my_password"
        password: "my_encrypted_password"
        save_config: true
        validate_certs: false

      register: certkey_result

    - debug:
        msg: "{{ certkey_result }}"