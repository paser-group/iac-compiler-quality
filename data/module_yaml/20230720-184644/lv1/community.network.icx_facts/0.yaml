---
- name: Collect facts from Ruckus ICX switches
  hosts: switches
  gather_facts: no

  tasks:
    - name: Gather facts
      community.network.icx_facts:
        gather_subset:
          - hardware
          - interfaces
          - vlans
        provider:
          username: admin
          password: "{{ switch_password }}"
          host: "{{ inventory_hostname }}"
          network_os: icx
          transport: cli

      register: switch_facts

    - name: Print switch facts
      debug:
        var: switch_facts