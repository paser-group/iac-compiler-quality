---
- name: Send Telegram notification
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Include required collections
      include_collections:
        - community.general

    - name: Set configuration variables
      vars:
        api_args:
          text: "{{ notification_message }}"
          chat_id: "{{ chat_id }}"
        api_method: "{{ api_method }}"
        token: "{{ token }}"

    - name: Send notification message
      community.general.telegram:
        api_args: "{{ api_args }}"
        api_method: "{{ api_method }}"
        token: "{{ token }}"
      register: result

    - name: Debug result
      debug:
        var: result