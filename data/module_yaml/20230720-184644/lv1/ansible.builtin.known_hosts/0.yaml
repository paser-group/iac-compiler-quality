---
- name: Add or remove host from known_hosts file
  hosts: localhost
  gather_facts: false

  vars:
    host_name: ubuntu1
    host_ip: 10.1.1.1
    known_hosts_path: /path/to/known_hosts/file

  tasks:
    - name: Add host to known_hosts file
      known_hosts:
        path: "{{ known_hosts_path }}"
        name: "{{ host_name }}"
        key: "{{ host_ip }}"
        hash_host: true
        state: present
      tags: add_host

    - name: Remove host from known_hosts file
      known_hosts:
        path: "{{ known_hosts_path }}"
        name: "{{ host_name }}"
        key: "{{ host_ip }}"
        hash_host: true
        state: absent
      tags: remove_host

- name: Debug output
  hosts: localhost
  gather_facts: false
  tasks:
    - debug:
        var: ansible_facts.ansible_known_hosts