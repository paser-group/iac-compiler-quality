---

- name: Identify latent type-related bugs in Ansible compiler
  hosts: localhost
  gather_facts: false

  vars:
    nitro_user: admin
    nitro_pass: admin
    nitro_protocol: http
    nitro_timeout: 10
    nsip: 10.1.1.1

  tasks:

    - name: Create a load balancing vserver
      community.network.netscaler_lb_vserver:
        nsip: "{{ nsip }}"
        nitro_user: "{{ nitro_user }}"
        nitro_pass: "{{ nitro_pass }}"
        nitro_protocol: "{{ nitro_protocol }}"
        nitro_timeout: "{{ nitro_timeout }}"
        name: "{{ random_string(10, 'abcdefghijklmnopqrstuvwxyz') }}"  # Random string with lowercase characters only
        servicetype: "{{ random_choice(['HTTP', 'HTTPS']) | lower }}"  # Randomly select HTTP or HTTPS and convert to lowercase
        state: present
      register: result