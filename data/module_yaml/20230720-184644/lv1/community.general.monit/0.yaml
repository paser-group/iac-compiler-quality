---
- name: Test Playbook for Ansible Latent Type-Related Bug Discovery
  hosts: localhost
  gather_facts: false

  vars:
    program_name: test_program
    program_state: running
    program_timeout: 5

  tasks:
    - name: Ensure program is running
      community.general.monit:
        name: "{{ program_name }}"
        state: "{{ program_state }}"
        timeout: "{{ program_timeout }}"
      register: result

    - name: Debug result
      debug:
        var: result

    - name: Ensure program is stopped
      community.general.monit:
        name: "{{ program_name }}"
        state: Stopped
        timeout: 0
      register: stopped_result

    - name: Debug stopped_result
      debug:
        var: stopped_result

    - name: Ensure program is not present
      community.general.monit:
        name: "{{ program_name }}"
        state: Absent
      register: absent_result

    - name: Debug absent_result
      debug:
        var: absent_result