---
- name: Manage L3 attributes for IPv4 and IPv6 interfaces on HUAWEI
  hosts: huawei_devices
  gather_facts: false

  tasks:
    - name: Configure IPv4 interface
      community.network.ce_ip_interface:
        addr: "{{ item.addr }}"
        interface: "{{ item.interface | lower }}"
        ipv4_type: "{{ item.ipv4_type }}"
        mask: "{{ item.mask }}"
        state: "{{ item.state }}"
        version: "{{ item.version }}"
      with_items:
        - { addr: "192.168.1.1", interface: "GigabitEthernet0/0/0", ipv4_type: "address", mask: "255.255.255.0", state: "present", version: "ipv4" }
        - { addr: "192.168.2.1", interface: "GigabitEthernet0/0/1", ipv4_type: "address", mask: "255.255.255.0", state: "present", version: "ipv4" }

    - name: Configure IPv6 interface
      community.network.ce_ip_interface:
        addr: "{{ item.addr }}"
        interface: "{{ item.interface | upper }}"
        ipv4_type: "{{ item.ipv4_type }}"
        mask: "{{ item.mask }}"
        state: "{{ item.state }}"
        version: "{{ item.version }}"
      with_items:
        - { addr: "2001:db8::1", interface: "GigabitEthernet0/0/0", ipv4_type: "address", mask: "64", state: "present", version: "ipv6" }
        - { addr: "2001:db8::2", interface: "GigabitEthernet0/0/1", ipv4_type: "address", mask: "64", state: "present", version: "ipv6" }