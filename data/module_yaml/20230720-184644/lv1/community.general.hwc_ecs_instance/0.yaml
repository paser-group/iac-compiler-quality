---
- name: Test playbook to uncover type-related bugs in Ansible hwc_ecs_instance module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create ECS instance with mixed case sensitivity in string values
      community.general.hwc_ecs_instance:
        state: present
        name: Test_Instance
        image_id: Ubuntu1
        flavor_name: m1.small
        admin_pass: MySecretPassword
        password: MyP@ssw0rd
        timeouts:
          create: 120
        description: "{{ 'Multiline description\nLine 2\nLine 3' }}"
        user_data: |
          #!/bin/bash
          echo "User data script"
        nics:
          - vpc_id: MyVPC
            subnet_id: MySubnet
            security_groups:
              - MySecurityGroup
        root_volume:
          size: 100
          type: SSD
        data_volumes:
          - name: data1
            size: 200
            type: HDD
        server_tags:
          key1: value1
          Key2: Value2
        server_metadata:
          meta1: data1
          Meta2: Data2
        ssh_key_name: MySSHKey

      register: result

    - name: Display result
      debug:
        var: result

    - name: Test case with mixed case sensitivity in 'name' attribute
      community.general.hwc_ecs_instance:
        state: present
        Name: Test_Instance
        image_id: Ubuntu1
        flavor_name: m1.small
        admin_pass: MySecretPassword
        password: MyP@ssw0rd
        timeouts:
          create: 120
        description: "{{ 'Multiline description\nLine 2\nLine 3' }}"
        user_data: |
          #!/bin/bash
          echo "User data script"
        nics:
          - vpc_id: MyVPC
            subnet_id: MySubnet
            security_groups:
              - MySecurityGroup
        root_volume:
          size: 100
          type: SSD
        data_volumes:
          - name: data1
            size: 200
            type: HDD
        server_tags:
          key1: value1
          Key2: Value2
        server_metadata:
          meta1: data1
          Meta2: Data2
        ssh_key_name: MySSHKey

      register: result_case_insensitive

    - name: Display test case result
      debug:
        var: result_case_insensitive