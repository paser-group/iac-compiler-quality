- name: Test playbook for community.general.scaleway_function_info module
  hosts: localhost
  gather_facts: false

  vars:
    api_timeout: 30
    api_token: "your_api_token"
    api_url: "https://api.scaleway.com/functions/v1alpha2"
    name: "your_function_name"
    namespace_id: "your_namespace_id"
    query_parameters:
      query_option: "your_query_option"
    region: "your_region"
    validate_certs: "true"

  tasks:
    - name: Include scaleway_function_info module
      include_role:
        name: community.general.scaleway_function_info

      vars:
        api_timeout: "{{ api_timeout }}"
        api_token: "{{ api_token }}"
        api_url: "{{ api_url }}"
        name: "{{ name }}"
        namespace_id: "{{ namespace_id }}"
        query_parameters: "{{ query_parameters }}"
        region: "{{ region }}"
        validate_certs: "{{ validate_certs }}"

      register: func_info

    - name: Print function information
      debug:
        var: func_info

    - name: Display the response
      debug:
        msg: "{{ func_info.stdout }}"

    - name: Assert the response contains the expected function name
      assert:
        that:
          - "'your_function_name' in func_info.stdout"
        fail_msg: "Function name not found in response"

    - name: Assert the response contains the expected namespace ID
      assert:
        that:
          - "'your_namespace_id' in func_info.stdout"
        fail_msg: "Namespace ID not found in response"

    - name: Assert the response contains the expected query option
      assert:
        that:
          - "'your_query_option' in func_info.stdout"
        fail_msg: "Query option not found in response"

    - name: Assert the response contains the expected region
      assert:
        that:
          - "'your_region' in func_info.stdout"
        fail_msg: "Region not found in response"

    - name: Assert the response contains the expected validate_certs value
      assert:
        that:
          - "'true' in func_info.stdout"
        fail_msg: "Validate certs value not found in response"

    - name: Assert the response contains the expected api URL
      assert:
        that:
          - "'https://api.scaleway.com/functions/v1alpha2' in func_info.stdout"
        fail_msg: "API URL not found in response"