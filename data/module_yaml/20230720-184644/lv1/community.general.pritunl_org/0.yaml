---
- name: Manage Pritunl Organizations
  hosts: localhost
  gather_facts: false

  vars:
    org_name: "MyOrg"
    pritunl_api_secret: "mysecret"
    pritunl_api_token: "mytoken"
    pritunl_url: "http://pritunl.example.com"
    validate_certs: false

  tasks:
    - name: Create Organization
      community.general.pritunl_org:
        force: true
        name: "{{ org_name }}"
        pritunl_api_secret: "{{ pritunl_api_secret }}"
        pritunl_api_token: "{{ pritunl_api_token }}"
        pritunl_url: "{{ pritunl_url }}"
        state: present
        validate_certs: "{{ validate_certs }}"
      register: result_create

    - name: Debug result_create
      debug:
        var: result_create

    - name: Modify Organization
      community.general.pritunl_org:
        force: true
        name: "{{ org_name }}"
        pritunl_api_secret: "{{ pritunl_api_secret }}"
        pritunl_api_token: "{{ pritunl_api_token }}"
        pritunl_url: "{{ pritunl_url }}"
        state: present
        validate_certs: "{{ validate_certs }}"
      register: result_modify

    - name: Debug result_modify
      debug:
        var: result_modify

    - name: Delete Organization
      community.general.pritunl_org:
        force: true
        name: "{{ org_name }}"
        pritunl_api_secret: "{{ pritunl_api_secret }}"
        pritunl_api_token: "{{ pritunl_api_token }}"
        pritunl_url: "{{ pritunl_url }}"
        state: absent
        validate_certs: "{{ validate_certs }}"
      register: result_delete

    - name: Debug result_delete
      debug:
        var: result_delete