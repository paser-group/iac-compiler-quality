---
- name: Run arbitrary command on HUAWEI device
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Execute command
      community.network.ce_command:
        command: "{{ item }}"
        interval: 5
        match: regex
        retries: 3
        wait_for: 10
      loop:
        - "display version"
        - "display interface brief"
        - "display routing-table"
        - "display ip interface brief"
      register: command_output
  
    - name: Debug output
      debug:
        msg: "{{ item.stdout }}"
      loop: "{{ command_output.results }}"