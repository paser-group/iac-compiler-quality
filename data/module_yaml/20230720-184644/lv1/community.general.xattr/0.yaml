- name: Manage user-defined extended attributes using xattr module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set extended attribute 'key1' with value 'value1' on the path '/tmp/test.txt'
      community.general.xattr:
        path: /tmp/test.txt
        key: key1
        value: value1
        state: present
        follow: yes
        namespace: system
      register: result_set

    - name: Print the result of setting the extended attribute
      debug:
        var: result_set

    - name: Get the value of the extended attribute 'key1' on the path '/tmp/test.txt'
      community.general.xattr:
        path: /tmp/test.txt
        key: KEY1
        follow: yes
        namespace: system
      register: result_get

    - name: Print the retrieved value of the extended attribute
      debug:
        var: result_get

    - name: Remove the extended attribute 'key1' on the path '/tmp/test.txt'
      community.general.xattr:
        path: /tmp/test.txt
        key: KeY1
        state: absent
        follow: yes
        namespace: system
      register: result_remove

    - name: Print the result of removing the extended attribute
      debug:
        var: result_remove