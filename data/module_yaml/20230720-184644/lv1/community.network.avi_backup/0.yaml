---
- name: Avi Backup Playbook
  hosts: all
  gather_facts: false

  tasks:
    - name: Configure Avi backup
      community.network.avi_backup:
        avi_credentials:
          controller: "{{ controller | default('localhost') }}"
          username: "{{ username | default('admin') }}"
          password: "{{ password | default('admin') }}"
          tenant: "{{ tenant | default('admin') }}"
        state: present
        file_name: "{{ file_name | default('backup_file') }}"
        url: "{{ url | default('http://example.com/backup') }}"
        uuid: "{{ uuid | default('12345678-1234-1234-1234-1234567890ab') }}"
        api_context: "{{ api_context | default({'foo': 'bar'}) }}"
        api_version: "{{ api_version | default(1.0) }}"
        avi_api_patch_op: "{{ avi_api_patch_op | default(None) }}"
        avi_api_update_method: "{{ avi_api_update_method | default(None) }}"
        avi_disable_session_cache_as_fact: "{{ avi_disable_session_cache_as_fact | default(false) }}"
        backup_config_ref: "{{ backup_config_ref | default(None) }}"
        local_file_url: "{{ local_file_url | default(None) }}"
        remote_file_url: "{{ remote_file_url | default(None) }}"
        scheduler_ref: "{{ scheduler_ref | default(None) }}"
        tenant_ref: "{{ tenant_ref | default(None) }}"
        tenant_uuid: "{{ tenant_uuid | default('12345678-1234-1234-1234-1234567890ab') }}"
        timestamp: "{{ timestamp | default(None) }}"
      register: backup_config

    - name: Debug Avi backup configuration
      debug:
        var: backup_config