---
- name: LDAP Search
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Perform LDAP search
      community.general.ldap_search:
        server_uri: 'ldap://127.0.0.1:389'
        bind_dn: 'CN=Admin,DC=example,DC=com'
        bind_pw: 'password'
        dn: 'DC=users,DC=example,DC=com'
        filter: '(objectClass=user)'
        scope: 'subtree'
        ca_path: '/etc/ssl/ca.crt'
        start_tls: false
        validate_certs: true
        referrals_chasing: 'always'

      register: ldap_result

    - name: Debug LDAP search result
      debug:
        var: ldap_result