- name: Assemble configuration files with type-related bugs
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create configuration files
      ansible.builtin.assemble:
        src: "{{ item.src }}"
        dest: "{{ item.dest }}"
        backup: "{{ item.backup | default(false) }}"
        mode: "{{ item.mode | default('') }}"
        owner: "{{ item.owner | default('') }}"
        group: "{{ item.group | default('') }}"
        unsafe_writes: "{{ item.unsafe_writes | default(false) }}"
        decrypt: "{{ item.decrypt | default(false) }}"
        validate: "{{ item.validate | default('') }}"
        delimiter: "{{ item.delimiter | default('') }}"
        ignore_hidden: "{{ item.ignore_hidden | default(false) }}"
        remote_src: "{{ item.remote_src | default(false) }}"
        selevel: "{{ item.selevel | default('') }}"
        serole: "{{ item.serole | default('') }}"
        setype: "{{ item.setype | default('') }}"
        seuser: "{{ item.seuser | default('') }}"
        regexp: "{{ item.regexp | default('') }}"
      loop:
        - { src: 'templates/bytes_config.j2', dest: '/tmp/bytes_config.txt' }
        - { src: 'templates/strings_config.j2', dest: '/tmp/strings_config.txt' }