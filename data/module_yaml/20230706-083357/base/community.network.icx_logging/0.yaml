- name: Heuristic-based Test Playbook for community.network.icx_logging module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set random MAC address
      set_fact:
        mac_address: "{{ [ '00:11:22:33:44:55', 'AA:BB:CC:DD:EE:FF' ] | random }}"

    - name: Set random port number
      set_fact:
        port_number: "{{ [ '10', '20', '30' ] | random }}"

    - name: Create icx_logging configuration
      community.network.icx_logging:
        aggregate: ['facility.local1', 'facility.local2']
        check_running_config: true
        dest: "/var/log/syslog"
        facility: "{{ ['facility.local0'] | random }}"
        level: ["debug", "info"]
        name: "icx_logging"
        state: "present"
        udp_port: "514"
        mac_address: "{{ mac_address }}"
        port_number: "{{ port_number }}"
      register: icx_logging_result

    - name: Debug icx_logging module output
      debug:
        var: icx_logging_result