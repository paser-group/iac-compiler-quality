- name: Test Ansible Compiler with community.general.pubnub_blocks module
  hosts: localhost
  gather_facts: false

  vars:
    account: "example_account"
    application: "example_application"
    cache:
      - name: "cache1"
        ttl: 300
      - name: "cache2"
        ttl: 600
    changes:
      - type: "change1"
        name: "change1_name"
      - type: "change2"
        name: "change2_name"
    description: "example_description"
    email: "test@example.com"
    event_handlers:
      - name: "event_handler1"
        type: "handler1_type"
      - name: "event_handler2"
        type: "handler2_type"
    keyset: "example_keyset"
    name: "example_name"
    password: "example_password"
    state: "present"
    validate_certs: true

  tasks:
    - name: Create PubNub blocks
      community.general.pubnub_blocks:
        account: "{{ account }}"
        application: "{{ application }}"
        cache: "{{ cache }}"
        changes: "{{ changes }}"
        description: "{{ description }}"
        email: "{{ email }}"
        event_handlers: "{{ event_handlers }}"
        keyset: "{{ keyset }}"
        name: "{{ name }}"
        password: "{{ password }}"
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"
      register: pubnub_result

    - name: Print PubNub result
      debug:
        var: pubnub_result