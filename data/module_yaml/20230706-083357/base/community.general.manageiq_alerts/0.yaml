- name: Heuristic-based testing for community.general.manageiq_alerts module
  hosts: localhost
  gather_facts: false

  vars:
    manageiq_connection:
      url: "https://manageiq.example.com"
      username: "admin"
      password: "password"

    alert_1:
      description: "Test alert 1"
      enabled: true
      expression:
        EQUALS:
          foo: bar
      expression_type: EQUALS
      manageiq_connection: "{{ manageiq_connection }}"
      options:
        notification_type: email
        notification_frequency: immediate
      resource_type: Vm
      state: present

    alert_2:
      description: "Test alert 2"
      enabled: false
      expression:
        LIKE:
          baz: "qux"
      expression_type: LIKE
      manageiq_connection: "{{ manageiq_connection }}"
      options:
        notification_type: sms
        notification_frequency: daily
      resource_type: Container
      state: absent

  tasks:
    - name: Create alert 1
      community.general.manageiq_alerts:
        description: "{{ alert_1.description }}"
        enabled: "{{ alert_1.enabled }}"
        expression: "{{ alert_1.expression }}"
        expression_type: "{{ alert_1.expression_type }}"
        manageiq_connection: "{{ alert_1.manageiq_connection }}"
        options: "{{ alert_1.options }}"
        resource_type: "{{ alert_1.resource_type }}"
        state: "{{ alert_1.state }}"
  
    - name: Create alert 2
      community.general.manageiq_alerts:
        description: "{{ alert_2.description }}"
        enabled: "{{ alert_2.enabled }}"
        expression: "{{ alert_2.expression }}"
        expression_type: "{{ alert_2.expression_type }}"
        manageiq_connection: "{{ alert_2.manageiq_connection }}"
        options: "{{ alert_2.options }}"
        resource_type: "{{ alert_2.resource_type }}"
        state: "{{ alert_2.state }}"