- name: Heuristic Test Playbook for community.network.ce_vxlan_tunnel
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate random MAC address
      set_fact:
        mac_address: "{{ lookup('pipe', 'python -c \"import random; import string; mac=':'.join(random.choice(string.hexdigits.upper()) + random.choice(string.hexdigits.upper()) for _ in range(6))); print(mac)\"') }}"

    - name: Generate random encoded string
      set_fact:
        encoded_string: "{{ lookup('pipe', 'python -c \"import random; import string; import base64; encoded=base64.b64encode(''.join(random.choice(string.ascii_letters + string.digits) for _ in range(10)).encode()); print(encoded.decode())\"') }}"

    - name: Generate random IP address
      set_fact:
        ip_address: "{{ lookup('pipe', 'python -c \"import random; ip='.'.join(str(random.randint(0, 255)) for _ in range(4))); print(ip)\"') }}"

    - name: Test community.network.ce_vxlan_tunnel module
      community.network.ce_vxlan_tunnel:
        bridge_domain_id: "{{ mac_address }}"
        nve_mode: "{{ encoded_string }}"
        nve_name: "{{ ip_address }}"
        state: present