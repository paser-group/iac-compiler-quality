- name: Heuristic-based test playbook for community.general.ip_netns module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a network namespace
      community.general.ip_netns:
        name: TestNamespace
        state: present

    - name: Check if the network namespace exists
      community.general.ip_netns:
        name: TestNamespace
        state: query
      register: namespace_info

    - name: Display network namespace info
      debug:
        var: namespace_info

    - name: Rename the network namespace
      community.general.ip_netns:
        name: TestNamespace
        new_name: RenamedNamespace
        state: present

    - name: Check if the network namespace is renamed
      community.general.ip_netns:
        name: RenamedNamespace
        state: query
      register: renamed_ns_info

    - name: Display renamed network namespace info
      debug:
        var: renamed_ns_info

    - name: Remove the network namespace
      community.general.ip_netns:
        name: RenamedNamespace
        state: absent

    - name: Check if the network namespace is removed
      community.general.ip_netns:
        name: RenamedNamespace
        state: query
      register: removed_ns_info

    - name: Display removed network namespace info
      debug:
        var: removed_ns_info