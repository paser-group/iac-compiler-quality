- name: Test community.general.kibana_plugin module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install Kibana plugin
      community.general.kibana_plugin:
        allow_root: "{{ allow_root }}"
        force: "{{ force }}"
        name: "{{ name }}"
        plugin_bin: "{{ plugin_bin }}"
        plugin_dir: "{{ plugin_dir }}"
        state: "{{ state }}"
        timeout: "{{ timeout }}"
        url: "{{ url }}"
        version: "{{ version }}"
      register: result

    - name: Uninstall Kibana plugin
      community.general.kibana_plugin:
        name: "{{ name }}"
        plugin_dir: "{{ plugin_dir }}"
        state: "absent"
      register: result