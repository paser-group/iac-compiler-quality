---
- name: Test Ansible playbook for community.general.sudoers module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure sudoers
      community.general.sudoers:
        name: "{{ item.name }}"
        state: "{{ item.state }}"
        user: "{{ item.user }}"
        commands: "{{ item.commands | default(omit) }}"
        nopassword: "{{ item.nopassword | default(false) }}"
      loop:
        - name: Test1
          state: present
          user: testuser
          commands:
            - /usr/bin/ls
            - /usr/bin/ping
        - name: Test2
          state: absent
          user: testuser2
          commands:
            - /usr/bin/test

      register: sudoers_result

    - name: Debug Module
      debug:
        var: ansible_module_community_general_sudoers

    - name: Debug Facts
      debug:
        var: ansible_facts

    # Add further tasks to test other attributes and options of the community.general.sudoers module

    - name: Debug Sudoers Result
      debug:
        var: sudoers_result