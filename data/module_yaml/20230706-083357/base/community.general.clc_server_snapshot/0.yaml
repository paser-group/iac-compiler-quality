---
- name: Heuristic-based test scenario for community.general.clc_server_snapshot
  hosts: localhost
  gather_facts: false
  vars:
    expiration_days: 7
    server_ids:
      - server1
      - server2
      - server3
    state: present
    wait: yes

  tasks:
    - name: Generate random IP address
      set_fact:
        random_ip: "{{ '%d.%d.%d.%d'|format(1|random, 1|random, 1|random, 1|random) }}"

    - name: Create server snapshot with random IP
      community.general.clc_server_snapshot:
        expiration_days: "{{ expiration_days }}"
        server_ids: "{{ server_ids }}"
        state: "{{ state }}"
        wait: "{{ wait }}"
        ip_address: "{{ random_ip }}"
      register: snapshot_result

    - name: Print snapshot result
      debug:
        var: snapshot_result