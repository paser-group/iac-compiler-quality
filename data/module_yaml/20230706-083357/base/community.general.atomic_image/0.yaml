---
- name: Heuristic Test Playbook for community.general.atomic_image module
  hosts: localhost
  gather_facts: false

  vars:
    # Heuristic 1: Mixed case sensitivity for string configuration values
    name: "atomICimAge"
    backend: "DoCEkr"
    started: yes
    state: "Present"

    # Heuristic 2: Introduce byte string values
    byte_name: !binary |-
      aW5jbHVkZSBieXRlcyBpbWFnZXMgYXJlIGNvbW1vbmx5IHVzZWQgZm9yIHRlc3QKaW5jbHVkZSBieXRlcyBkZ
      WZpbml0ZWx5IGluIFhNTCBhcHBsaWNhdGlvbmluZyBmaWxlCg==
  
    # Heuristic 3: Create configuration values that incorporate both bytes and strings
    mixed_value: [!binary |-
      a2V5MQ==, "string2", !binary |-
      a2V5Mw==]

    # Heuristic 4: Generate random MAC addresses
    mac_address: "{{ ([0,0,0,0,0,0]|randomize[:2]) + [0x42] + ([0,0,0,0,0,0]|randomize[:3])|join(':') }}"

    # Heuristic 5: Produce random port numbers
    port_number: "{{ 1024 + range(0, 10000)|random }}"

    # Heuristic 6: Generate strings with varied encodings
    encoded_string: !base64 |
      aGVsbG8gd29ybGQ=

    # Heuristic 7: Implement division-based operations when assigning limit-related values
    limit_value: "{{ 100/5 }}"

    # Heuristic 8: Use !null as configuration values in manifests
    null_value: !null

    # Heuristic 9: Formulate random IP addresses for networking modules
    ip_address: "{{ range(0,4)|random + 10 }}.{{ range(0,4)|random + 10 }}.{{ range(0,4)|random + 10 }}.{{ range(0,4)|random + 10 }}"

  tasks:
    - name: Test community.general.atomic_image module
      community.general.atomic_image:
        name: "{{ name }}"
        backend: "{{ backend }}"
        started: "{{ started }}"
        state: "{{ state }}"
        byte_name: "{{ byte_name }}"
        mixed_value: "{{ mixed_value }}"
        mac_address: "{{ mac_address }}"
        port_number: "{{ port_number }}"
        encoded_string: "{{ encoded_string }}"
        limit_value: "{{ limit_value }}"
        null_value: "{{ null_value }}"
        ip_address: "{{ ip_address }}"
      register: result

    - debug:
        var: result
...