---
- name: Ansible Compiler Debugger & Heuristic Test Playbook
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Run heuristic-based test scenarios for community.network.vdirect_file module
      community.network.vdirect_file:
        file_name: "{{ item.file_name }}"
        validate_certs: "{{ item.validate_certs | default(true) }}"
        vdirect_http_port: "{{ item.vdirect_http_port }}"
        vdirect_https_port: "{{ item.vdirect_https_port }}"
        vdirect_ip: "{{ item.vdirect_ip }}"
        vdirect_password: "{{ item.vdirect_password }}"
        vdirect_secondary_ip: "{{ item.vdirect_secondary_ip }}"
        vdirect_timeout: "{{ item.vdirect_timeout }}"
        vdirect_use_ssl: "{{ item.vdirect_use_ssl | default(true) }}"
        vdirect_user: "{{ item.vdirect_user }}"
        vdirect_wait: "{{ item.vdirect_wait | default(true) }}"
      with_items:
        - file_name: null
          validate_certs: true
          vdirect_http_port: null
          vdirect_https_port: null
          vdirect_ip: null
          vdirect_password: "{{ random_string }}"
          vdirect_secondary_ip: "{{ random_ip_address }}"
          vdirect_timeout: 60
          vdirect_use_ssl: true
          vdirect_user: "{{ random_string }}"
          vdirect_wait: true

        - file_name: "{{ random_string }}"
          validate_certs: true
          vdirect_http_port: "{{ random_port }}"
          vdirect_https_port: "{{ random_port }}"
          vdirect_ip: "{{ random_ip_address }}"
          vdirect_password: "{{ random_string }}"
          vdirect_secondary_ip: null
          vdirect_timeout: 60
          vdirect_use_ssl: true
          vdirect_user: "{{ random_string }}"
          vdirect_wait: null

      vars:
        random_string: "{{ random_string(10, chars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789') }}"
        random_port: "{{ range(1024, 65535) | random }}"
        random_ip_address: "{{ random_integer }}.{{ random_integer }}.{{ random_integer }}.{{ random_integer }}"