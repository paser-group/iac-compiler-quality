---
- name: Ansible Compiler Debugger & Heuristic Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Test mixed case sensitivity
      community.general.airbrake_deployment:
        environment: "pRoDuCtIoN"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
      register: result_mixed_case

    - name: Test byte string values
      community.general.airbrake_deployment:
        environment: !binary |-
          MGZiZjZjYzZlN2RhMGJhMzYxMzc5ZTUwYzczZmYwMDQ=
        project_id: !binary |-
          MTIzNDU2
        project_key: !binary |-
          YWJjZGVmZw==
        repo: !binary |-
          bXlyZXBv
        revision: !binary |-
          bWFzdGVy
        url: !binary |-
          aHR0cHM6Ly9leGFtcGxlLmNvbQ==
        user: !binary |-
          YWRtaW4=
        validate_certs: true
        version: !binary |-
          MS4w
      register: result_byte_string

    - name: Test mixed string and byte string values
      community.general.airbrake_deployment:
        environment: !binary |-
          MHhkYzg4
        project_id: "123456"
        project_key: !binary |-
          YWJjZGVmZw==
        repo: "myrepo"
        revision: !binary |-
          bWFzdGVy
        url: "https://example.com"
        user: !binary |-
          YWRtaW4=
        validate_certs: true
        version: !binary |-
          MS4w
      register: result_mixed_string_byte_string

    - name: Test random MAC addresses
      community.general.airbrake_deployment:
        environment: "production"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
        mac_address: "00:01:02:03:04:05"
      register: result_random_mac

    - name: Test random port numbers
      community.general.airbrake_deployment:
        environment: "production"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
        port: 8080
      register: result_random_port

    - name: Test string encoding variations
      community.general.airbrake_deployment:
        environment: "production"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
        encoding: "utf-16"
      register: result_string_encoding

    - name: Test division-based operations for limit
      community.general.airbrake_deployment:
        environment: "production"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
        limit: "{{ 100 / 0 }}"
      register: result_division_limit

    - name: Test !null as configuration value
      community.general.airbrake_deployment:
        environment: "production"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
        manifest: !null
      register: result_null_value

    - name: Test random IP addresses
      community.general.airbrake_deployment:
        environment: "production"
        project_id: "123456"
        project_key: "abcdefg"
        repo: "myrepo"
        revision: "master"
        url: "https://example.com"
        user: "admin"
        validate_certs: true
        version: "1.0"
        ip_address: "192.168.{{ range(1,255) | random }}.{{ range(1,255) | random }}"
      register: result_random_ip

    - debug:
        var: item
      loop:
        - result_mixed_case
        - result_byte_string
        - result_mixed_string_byte_string
        - result_random_mac
        - result_random_port
        - result_string_encoding
        - result_division_limit
        - result_null_value
        - result_random_ip