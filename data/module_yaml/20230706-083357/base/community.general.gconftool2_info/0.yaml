---
- name: Heuristic-based test scenario to expose Ansible compiler bugs
  hosts: localhost
  gather_facts: false

  vars:
    key: "desktop/gnome/url-handlers/http/enabled"
    byte_string_value: !!binary |
      UHJpbnRlciBNZXNzYWdl
    mixed_value: "{{ byte_string_value }} + Some text"
    mac_address: "{{ '%012x' % (random.randint(0, 0xfffffffffff)) }}"
    random_port: "{{ random.randint(1024, 65535) }}"
    utf8_encoded_string: !!python/unicode |
      \u00C3\u00BCber
    limit: "{{ 100/3 }}"
    null_value: !null
    random_ip_address: "{{ random.randint(1, 254) }}.{{ random.randint(1, 254) }}.{{ random.randint(1, 254) }}.{{ random.randint(1, 254) }}"

  tasks:
    - name: Retrieve gconftool2 info
      community.general.gconftool2_info:
        key: "{{ key }}"

    - name: Set byte string value with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ byte_string_value }}"

    - name: Set mixed value with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ mixed_value }}"

    - name: Set random MAC address with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ mac_address }}"

    - name: Set random port number with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ random_port }}"

    - name: Set UTF-8 encoded string with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ utf8_encoded_string }}"

    - name: Set limit value with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ limit }}"

    - name: Set null value with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ null_value }}"

    - name: Set random IP address with gconftool2
      community.general.gconftool2:
        key: "{{ key }}"
        value: "{{ random_ip_address }}"