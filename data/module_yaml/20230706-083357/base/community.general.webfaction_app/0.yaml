---
- name: Heuristic Test Playbook for community.general.webfaction_app
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Install community.general.webfaction_app with heuristic test scenarios
      community.general.webfaction_app:
        name: "{{ ['my_app', 'another_app'] | random }}"
        type: "{{ ['django', 'flask'] | random }}"
        machine: "{{ ['machine1', 'machine2'] | random }}"
        login_name: "{{ ['user1', 'user2'] | random }}"
        login_password: "{{ ['pass123', 'pass456'] | random }}"
        extra_info: "{{ ['info1', 'info2'] | random }}"
        state: "{{ ['present', 'absent'] | random }}"
        autostart: "{{ ['yes', 'no'] | random }}"
        port_open: "{{ ['yes', 'no'] | random }}"
        mac_address: "{{ '00:16:3e:' + '%02x:%02x:%02x' | format(0, 0, item) }}"
        port: "{{ range(1000, 10000) | random }}"
        ip_address: "{{ random_ip_address }}"
      vars:
        random_ip_address: "{{ hostvars[groups['localhost'][0]]['ansible_default_ipv4']['address'] | ipaddr('network') | ipaddr('next_usable') }}"
      register: app_result

    - name: Debug community.general.webfaction_app installation result
      debug:
        var: app_result