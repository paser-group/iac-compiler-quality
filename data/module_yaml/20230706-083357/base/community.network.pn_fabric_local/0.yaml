- name: Test pn_fabric_local module
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Set random MAC address
      set_fact:
        random_mac_address: "{{ '%012x' | format((range(0, 281474976710656) | random)) }}"

    - name: Set random port number
      set_fact:
        random_port: "{{ range(1, 65535) | random }}"

    - name: Set random encoding
      set_fact:
        random_encoding: "{{ ['utf-8', 'utf-16', 'ascii'] | random }}"

    - name: Set random IP address
      set_fact:
        random_ip_address: "{{ range(1, 254) | random }}.{{ range(1, 254) | random }}.{{ range(1, 254) | random }}.{{ range(1, 254) | random }}"

    - name: Test pn_fabric_local module with heuristic scenarios
      community.network.pn_fabric_local:
        pn_cliswitch: "cli-switch"
        pn_control_network: "{{ random_ip_address }}"
        pn_fabric_advertisement_network: "{{ random_ip_address }}"
        pn_fabric_network: "{{ random_ip_address }}"
        pn_vlan: "100"
        state: present
        mac_address: "{{ random_mac_address }}"
        port: "{{ random_port }}"
        encoding: "{{ random_encoding }}"
        limit: 10
        limit_type: "{{ random_encoding }}"