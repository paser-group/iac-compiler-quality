---
- name: Heuristic-based Test Playbook
  hosts: all
  gather_facts: false
  become: true

  tasks:
    - name: Test mixed case sensitivity for string configuration values
      community.general.cargo:
        name: 'CaRgO'
        path: '/usr/local/bin/cargo'
        state: present
        version: '1.0.0'

    - name: Test byte string values in configuration
      community.general.cargo:
        name: !!binary 'Q2FyZ28='
        path: '/usr/local/bin/cargo'
        state: present
        version: !!binary 'MS4xLjAuMQ=='

    - name: Test configuration values with bytes and strings
      community.general.cargo:
        name: !!binary 'Q2FyZ28='
        path: !!binary 'L3Vzci9sb2NhbC9iaW4vY2FyZ28='
        state: present
        version: '1.2.0'

    - name: Generate random MAC address
      set_fact:
        random_mac: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(ansible_random.randint(0, 255), ansible_random.randint(0, 255), ansible_random.randint(0, 255), ansible_random.randint(0, 255), ansible_random.randint(0, 255), ansible_random.randint(0, 255)) }}"

    - name: Test random MAC address
      community.general.cargo:
        name: 'cargo'
        path: '/usr/local/bin/cargo'
        state: present
        version: '1.0.0'
        mac: "{{ random_mac }}"

    - name: Generate random port number
      set_fact:
        random_port: "{{ ansible_random.randint(1024, 65535) }}"

    - name: Test random port number
      community.general.cargo:
        name: 'cargo'
        path: '/usr/local/bin/cargo'
        state: present
        version: '1.0.0'
        port: "{{ random_port }}"

    - name: Generate random strings with varied encodings
      set_fact:
        random_string: "{{ 'Cargo' | b64encode }}"

    - name: Test strings with varied encodings
      community.general.cargo:
        name: "{{ random_string }}"
        path: !!binary 'L3Vzci9sb2NhbC9iaW4vY2FyZ28='
        state: present
        version: '1.0.0'

    - name: Generate limit-related values
      set_fact:
        random_limit: "{{ 100 / ansible_random.randint(1, 10) }}"

    - name: Test limit-related values
      community.general.cargo:
        name: 'cargo'
        path: '/usr/local/bin/cargo'
        state: present
        version: '1.0.0'
        limit: "{{ random_limit }}"

    - name: Test !null configuration values
      community.general.cargo:
        name: 'cargo'
        path: '/usr/local/bin/cargo'
        state: present
        version: '1.0.0'
        limit: '!null'

    - name: Generate random IP address
      set_fact:
        random_ip: "{{ ansible_random.randint(0, 255) }}.{{ ansible_random.randint(0, 255) }}.{{ ansible_random.randint(0, 255) }}.{{ ansible_random.randint(0, 255) }}"

    - name: Test random IP address
      community.general.cargo:
        name: 'cargo'
        path: '/usr/local/bin/cargo'
        state: present
        version: '1.0.0'
        ip: "{{ random_ip }}"