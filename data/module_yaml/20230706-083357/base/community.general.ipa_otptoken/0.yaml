- name: Heuristic-based test scenario for community.general.ipa_otptoken module
  hosts: localhost
  gather_facts: no

  vars:
    algorithm: "sha1"
    counter: 10
    description: "Test OTP token"
    digits: 6
    enabled: true
    interval: 30
    ipa_host: "example.com"
    ipa_pass: "password"
    ipa_port: 443
    ipa_prot: "https"
    ipa_timeout: 5
    ipa_user: "admin"
    model: "RSA"
    newuniqueid: "newtoken"
    notafter: "2022-12-31"
    notbefore: "2021-01-01"
    offset: 5
    otptype: "hotp"
    owner: "testuser"
    secretkey: "abcdefghijklmnopqrstuvwxyz"
    serial: "1234567890"
    state: "present"
    uniqueid: "tok123"
    validate_certs: true
    vendor: "Vendor"

  tasks:
    - name: Test mixed case sensitivity for string configuration values
      community.general.ipa_otptoken:
        algorithm: "SHA1"
        description: "Test Mixed Case"
        otptype: "Hotp"
        secretkey: "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
        state: "Present"
      register: mixed_case_result
      ignore_errors: yes

    - name: Test byte string values in place of regular strings
      community.general.ipa_otptoken:
        description: !binary |-
          YmFzZTY0IGVuY29kaW5n
      register: byte_string_result
      ignore_errors: yes

    - name: Test configuration values with both bytes and strings
      community.general.ipa_otptoken:
        description: !binary |-
          VGhpcyBpcyBhIGJ5dGVzIG9mIHRoaXMgdGV4dC4=
        secretkey: "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
      register: mixed_bytes_strings_result
      ignore_errors: yes