---
- name: Heuristic-driven test scenarios for community.general.ipa_hbacrule
  hosts: localhost
  gather_facts: false
  
  tasks:
  - name: Test Scenario 1 - Mixed Case Sensitivity
    community.general.ipa_hbacrule:
      cn: "{{ item }}"
      description: Testing mixed case sensitivity
      state: present
    loop:
      - mixedCase
      - mixedcase
      - MIXEDCASE

  - name: Test Scenario 2 - Byte String Values
    community.general.ipa_hbacrule:
      cn: byte_string
      description: !!binary |
        QmFzZTY0IFRleHQ=
      state: present

  - name: Test Scenario 3 - Configuration Values with Mixed Types
    community.general.ipa_hbacrule:
      cn: mixed_types
      description:
        - 1
        - 2
        - three
      state: present

  - name: Test Scenario 4 - Random MAC Addresses
    community.general.ipa_hbacrule:
      cn: "{{ item }}"
      description: Testing random MAC addresses
      state: present
    loop:
      - "00:11:22:33:44:55"
      - "aa:bb:cc:dd:ee:ff"
      - e4:a5:e6:17:39:12

  - name: Test Scenario 5 - Random Port Numbers
    community.general.ipa_hbacrule:
      cn: "{{ item }}"
      description: Testing random port numbers
      state: present
    loop:
      - 8080
      - 443
      - 1234

  - name: Test Scenario 6 - Varied Encodings
    community.general.ipa_hbacrule:
      cn: "{{ item }}"
      description: "{{ lookup('pipe', 'echo -n Testing varied encodings | base64') }}"
      state: present
    loop:
      - varied_encodings_1
      - varied_encodings_2
      - varied_encodings_3

  - name: Test Scenario 7 - Division-based Limit
    community.general.ipa_hbacrule:
      cn: "{{ item }}"
      description: Testing division-based limit
      state: present
      maxlimit: "{{ 10 / 2 }}"
    loop:
      - division_based_limit_1
      - division_based_limit_2
      - division_based_limit_3

  - name: Test Scenario 8 - !null Configuration Value
    community.general.ipa_hbacrule:
      cn: null_value
      description: !null
      state: present

  - name: Test Scenario 9 - Random IP Addresses
    community.general.ipa_hbacrule:
      cn: "{{ item }}"
      description: Testing random IP addresses
      state: present
      ipa_host: "{{ item }}/32"
    loop:
      - 192.168.0.1
      - 10.0.0.1
      - 172.16.0.1

  - name: Test Scenario 10 - Complete Scenario
    community.general.ipa_hbacrule:
      cn: complete_scenario
      description: Complete test scenario
      state: present
      host: ["host1", "host2"]
      hostcategory: category1
      hostgroup: ["group1", "group2"]
      ipa_host: "ipa.example.com"
      ipa_port: 1234
      ipa_pass: "password"
      ipa_timeout: 10
      ipa_user: "admin"
      service: ["service1", "service2"]
      servicecategory: category2
      servicegroup: ["group3", "group4"]
      sourcehost: ["source1", "source2"]
      sourcehostcategory: category3
      sourcehostgroup: ["group5", "group6"]
      state: present
      user: ["user1", "user2"]
      usercategory: category4
      usergroup: ["group7", "group8"]
      validate_certs: false