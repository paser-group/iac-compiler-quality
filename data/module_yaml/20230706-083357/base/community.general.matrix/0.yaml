---
- name: Heuristic-based test scenarios for community.general.matrix Ansible module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Test random IP addresses for networking modules
      community.general.matrix:
        hs_url: "https://matrix.example.com"
        msg_html: "<b>Hello, Ansible!</b>"
        msg_plain: "Hello, Ansible!"
        password: "password123"
        room_id: "!room_id:matrix.example.com"
        token: "token123"
        user_id: "@user_id:matrix.example.com"
        ip_address: "{{ hostvars[item].ansible_default_ipv4.address }}"
      register: ip_address_test
      with_items: "{{ groups['localhost'] }}"

    - name: Debug results
      debug:
        var: item
      loop: "{{ ip_address_test.results }}"