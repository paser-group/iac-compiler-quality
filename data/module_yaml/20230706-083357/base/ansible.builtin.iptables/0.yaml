---
- name: Heuristic-based Test Playbook for ansible.builtin.iptables
  hosts: localhost
  gather_facts: false

  vars:
    # Test scenarios
    action: "ACCEPT"
    chain: "INPUT"
    chain_management: true
    comment: "Test comment"
    destination: "1.2.3.4"
    destination_port: "22"
    flush: true
    goto: "FORWARD"
    in_interface: "eth0"
    ip_version: "ipv6"
    log_level: "info"
    log_prefix: "TEST"
    protocol: "tcp"
    rule_num: "5"
    state: "present"
    table: "nat"

  tasks:
    - name: Test ansible.builtin.iptables module
      ansible.builtin.iptables:
        action: "{{ action }}"
        chain: "{{ chain }}"
        chain_management: "{{ chain_management }}"
        comment: "{{ comment }}"
        destination: "{{ destination }}"
        destination_port: "{{ destination_port }}"
        flush: "{{ flush }}"
        goto: "{{ goto }}"
        in_interface: "{{ in_interface }}"
        ip_version: "{{ ip_version }}"
        log_level: "{{ log_level }}"
        log_prefix: "{{ log_prefix }}"
        protocol: "{{ protocol }}"
        rule_num: "{{ rule_num }}"
        state: "{{ state }}"
        table: "{{ table }}"
      register: result

    - name: Debug result
      debug:
        var: result