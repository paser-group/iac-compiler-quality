- name: Heuristic-based test scenarios for community.general.iptables_state module
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Save iptables state into a file with attribute options
      community.general.iptables_state:
        counters: "{{ [True, False] | random }}"
        ip_version: "{{ ['ipv4', 'ipv6'] | random }}"
        modprobe: "{{ ['/sbin/modprobe', '/usr/sbin/modprobe'] | random }}"
        noflush: "{{ [True, False] | random }}"
        path: "{{ '/etc/iptables/rules-save' | random }}"
        state: "{{ ['create', 'flush'] | random }}"
        table: "{{ ['filter', 'nat', 'mangle'] | random }}"
        wait: "{{ 1 + random() * 10 | int }}"