- name: Heuristic-based testing playbook for community.general.clc_loadbalancer module
  hosts: localhost
  gather_facts: false

  vars:
    # Heuristics
    mixed_case_string: "{{ ['TeSt', 'tEsT', 'tEsT'] | random }}"
    byte_strings: [b'Test1', b'Test2', b'Test3']
    mixed_byte_string: "{{ ['Test1', b'Test2', 'Test3'] | random }}"
    random_mac: "{{ '%02x:%02x:%02x:%02x:%02x:%02x' | format(ansible_random | random, ansible_random | random, ansible_random | random, ansible_random | random, ansible_random | random, ansible_random | random) }}"
    random_port: "{{ 1024 + range(64511) | random }}"
    encoded_strings: ['áéíóú', 'ÄÖÜäöüß', 'русский', '中文', '日本語']
    limit_value: "{{ 65535 / 2 | int }}"
    null_value: "!null"
    random_ip: "{{ range(10, 256) | random }}.{{ range(10, 256) | random }}.{{ range(10, 256) | random }}.{{ range(10, 256) | random }}"

  tasks:
    - name: Create shared loadbalancer
      community.general.clc_loadbalancer:
        alias: "{{ mixed_case_string }}"
        description: "{{ mixed_case_string }}"
        location: "{{ mixed_case_string }}"
        method: "{{ mixed_case_string }}"
        name: "{{ mixed_case_string }}"
        nodes: "{{ byte_strings }}"
        persistence: "{{ mixed_byte_string }}"
        port: "{{ random_port }}"
        state: "{{ mixed_case_string }}"
        status: "{{ mixed_case_string }}"
      register: lb_created

    - name: Print loadbalancer creation result
      debug:
        var: lb_created

    - name: Delete shared loadbalancer
      community.general.clc_loadbalancer:
        alias: "{{ mixed_case_string }}"
        state: absent

    - name: Print loadbalancer deletion result
      debug:
        var: lb_deleted