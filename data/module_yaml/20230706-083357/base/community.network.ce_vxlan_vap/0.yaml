---
- name: Ansible Compiler Debugger & Heuristic Test Playbook
  hosts: localhost
  gather_facts: false

  vars:
    # Define variables for network architecture
    network_name: "node-net"
    subnet: "10.1.1.0/24"
    gateway: "10.1.1.254"
    nodes:
      - name: "node1"
        ip: "10.1.1.1"
      - name: "node2"
        ip: "10.1.1.2"
      - name: "node3"
        ip: "10.1.1.3"

    # Define heuristics for test scenarios
    mixed_case_sensitivity_strings:
      - "TestString"
      - "tEStStrINg"
    byte_strings:
      - !binary |-
        SGVsbG8gd29ybGQ=
      - !binary |-
        R29vZCBtb3JlIHN0cmluZw==
    mixed_byte_strings:
      - !binary |-
        SGVsbG8gd29ybGQ=
      - "Hello world"
    random_mac_address: "{{ '%012x'|format(ansible_date_time.epoch|int) }}"
    random_port_number: "{{ 32768 + (omit|int | random(seed=inventory_hostname)|int) }}"
    varied_encoding_strings:
      - "Hel̄l̆o̗ ̩W̆o̎r̆l̩d̏"
      - "Γειά σου Κόσμε"
    division_based_operations: "{{ 1024 // (omit|int | random(seed=inventory_hostname)|int) }}"
    null_configurations: null
    random_ip_address: "{{ random_octet() }}.{{ random_octet() }}.{{ random_octet() }}.{{ random_octet() }}"
  
  tasks:
    - name: Print test scenarios
      debug:
        var: mixed_case_sensitivity_strings

    - name: Print test scenarios
      debug:
        var: byte_strings

    - name: Print test scenarios
      debug:
        var: mixed_byte_strings

    - name: Print test scenarios
      debug:
        var: random_mac_address

    - name: Print test scenarios
      debug:
        var: random_port_number

    - name: Print test scenarios
      debug:
        var: varied_encoding_strings

    - name: Print test scenarios
      debug:
        var: division_based_operations

    - name: Print test scenarios
      debug:
        var: null_configurations

    - name: Print test scenarios
      debug:
        var: random_ip_address

    - name: Test community.network.ce_vxlan_vap module 
      community.network.ce_vxlan_vap:
        bind_vlan_id: "{{ item }}"
        bridge_domain_id: "{{ item }}"
        ce_vid: "{{ item }}"
        encapsulation: "{{ item }}"
        l2_sub_interface: "{{ item }}"
        pe_vid: "{{ item }}"
        state: "{{ item }}"
      loop:
        - "{{ mixed_case_sensitivity_strings }}"
        - "{{ byte_strings }}"
        - "{{ mixed_byte_strings }}"
        - "{{ random_mac_address }}"
        - "{{ random_port_number }}"
        - "{{ varied_encoding_strings }}"
        - "{{ division_based_operations }}"
        - "{{ null_configurations }}"
        - "{{ random_ip_address }}"
      register: result

    - name: Display module output
      debug:
        var: result

  # Helper function to generate random octets for IP address
  vars:
    random_octet: "{{ 1 + (omit|int | random(seed=inventory_hostname)|int) % 254 }}"