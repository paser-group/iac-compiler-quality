---
- name: Heuristic-based test playbook for community.general.ipa_pwpolicy module
  hosts: localhost
  gather_facts: false

  vars:
    failinterval: "2h"
    group: "developers"
    historylength: "10"
    ipa_host: "ipa.example.com"
    ipa_pass: "password"
    ipa_port: 389
    ipa_prot: "http"
    ipa_timeout: 60
    ipa_user: "admin"
    lockouttime: "30m"
    maxfailcount: "3"
    maxpwdlife: "90d"
    minclasses: "2"
    minlength: "8"
    minpwdlife: "7d"
    priority: "100"
    state: "present"
    validate_certs: false

  tasks:
    - name: Test mixed case sensitivity in string configuration values
      community.general.ipa_pwpolicy:
        failinterval: FaIlInTeRvAl
        group: GrOuP
        historylength: HiStOrYlEnGtH
        ipa_host: "{{ ipa_host }}"
        ipa_pass: "{{ ipa_pass }}"
        ipa_port: "{{ ipa_port }}"
        ipa_prot: "{{ ipa_prot }}"
        ipa_timeout: "{{ ipa_timeout }}"
        ipa_user: "{{ ipa_user }}"
        lockouttime: LoCkOuTtImE
        maxfailcount: MaXfAiLcOuNt
        maxpwdlife: MaXpWdLiFe
        minclasses: MiNcLaSsEs
        minlength: MiNlEnGtH
        minpwdlife: MiNpWdLiFe
        priority: PrIoRiTy
        state: "{{ state }}"
        validate_certs: "{{ validate_certs }}"