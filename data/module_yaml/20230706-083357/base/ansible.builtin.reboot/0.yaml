- name: Heuristic-based test scenario for the ansible.builtin.reboot module
  hosts: all
  gather_facts: false

  tasks:
    - name: Test Scenario - Mixed case sensitivity
      ansible.builtin.reboot:
        msg: "Testing mixed case sensitivity"
        reboot_command: "ReBoOt"
        post_reboot_delay: "5"
        search_paths:
          - "/usr/bin"
          - "/sbin"
      ignore_errors: true

    - name: Test Scenario - Varied string encodings
      ansible.builtin.reboot:
        msg: "Testing varied string encodings"
        reboot_command: "{{ b'Reboot'.decode('utf-8') }}"
        post_reboot_delay: "5"
        search_paths:
          - "/usr/bin"
          - "/sbin"
      ignore_errors: true

    - name: Test Scenario - Division-based operations for limit-related values
      vars:
        limit_value: "{{ (ansible_processor_vcpus | default(1) | int) + (range(1, 5) | random | int) }}"
      ansible.builtin.reboot:
        msg: "Testing division-based operations for limit-related values"
        reboot_command: "REBOOT"
        post_reboot_delay: "5"
        search_paths:
          - "/usr/bin"
          - "/sbin"
        limit: "{{ limit_value }}%"
      ignore_errors: true

    - name: Test Scenario - Random IP addresses
      vars:
        ip_address: "{{ range(1, 256) | random | int }}.{{ range(1, 256) | random | int }}.{{ range(1, 256) | random | int }}.{{ range(1, 256) | random | int }}"
      ansible.builtin.reboot:
        msg: "Testing random IP addresses"
        reboot_command: "REBOOT"
        post_reboot_delay: "5"
        search_paths:
          - "/usr/bin"
          - "/sbin"
        test_command: "ping -c 1 -W 1 {{ ip_address }}"
      ignore_errors: true