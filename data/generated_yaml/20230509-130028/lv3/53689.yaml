
---
- name: Testing 'slack' callback plugin
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Send Slack message
      slack:
        token: "invalid-token" # Error prone field
        msg: "Testing the 'slack' callback plugin"
        channel: "#general"
      register: slack_result # Capture the result of the Slack message send request

    - name: Print Slack message
      debug: var=slack_result

- name: Exit the Playbook with an error
  meta:
    end_play: true
  when: slack_result.status != 200 # 404 error case, when the message is not sent because of invalid token
