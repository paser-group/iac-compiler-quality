
- name: Configure VTP domain on Nexus switch 
  hosts: switch
  gather_facts: no
  vars:
    vtp_domain: mydomain
  tasks:
  - name: Configure the VTP domain name 
    nxos_vtp_domain:
      name: "{{ vtp_domain }}"
    register: result
  - name: Ensure idempotence
    nxos_vtp_domain:
      name: "{{ vtp_domain }}"
    when: vtp_domain.changed
