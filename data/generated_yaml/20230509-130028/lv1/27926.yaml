yaml
---
- name: Test removal of nxos_vxlan_vtep_vni
  hosts: your_hosts  # Replace this with the hosts that you want to run this play on
  gather_facts: no
  tasks:
    - name: Remove VNI configuration
      nxos_vxlan_vtep_vni:
        vni: "100"
        vtep_source_interface: "loopback0"
        vtep_ip: "10.0.0.1"
        state: absent
      register: result

    - name: Debugging task
      debug:
        var: result

    - name: Fail the playbook if non-idempotent
      fail:
        msg: "The VNI is not idempotent"
      when: not result.changed and result.exists is defined
