yaml
---
- name: Configure an ELB
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Configure the ELB
      ec2_elb_lb:
        name: my-elb
        state: present
        listeners:
          - protocol: http
            load_balancer_port: 80
            instance_port: 8080
        subnets:
          - subnet-1234abcd
        security_groups:
          - sg-5678efgh
        region: us-east-1
      register: elb_result

    - name: Show result of ELB configuration
      debug:
        var: elb_result

    - name: Ensure ELB configuration is idempotent
      ec2_elb_lb:
        name: my-elb
        state: present
        listeners:
          - protocol: http
            load_balancer_port: 80
            instance_port: 8080
        subnets:
          - subnet-1234abcd
        security_groups:
          - sg-5678efgh
        region: us-east-1
      register: idempotent_result

    - name: Show result of idempotent ELB configuration
      debug:
        var: idempotent_result
