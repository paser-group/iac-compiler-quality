
- name: Test authentication errors with callback plugin
  hosts: all
  tasks:
  - name: Run task with callback plugin
    example_callback_plugin:
      some_arg: foo
    register: result
  - name: Check for Authentication error
    assert:
      that: "'Authentication error' in result.stderr"

- name: Test callback plugin compatibility with compiler
  hosts: all
  tasks:
  - name: Run task with callback plugin
    example_callback_plugin:
      some_arg: foo
    register: result_a
  - name: Run task without callback plugin
    command: ls
    register: result_b
  - name: Check compatibility
    assert:
      that: "(result_a.stdout == result_b.stdout) and (result_a.stderr == result_b.stderr)"
