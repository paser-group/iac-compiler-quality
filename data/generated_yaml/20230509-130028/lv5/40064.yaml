
- name: Configure device with specific settings
  ios_config:
    lines:
      - "interface Loopback0"
      - " ip address 192.0.2.1 255.255.255.0"

- name: Modify device settings to the same values
  ios_config:
    lines:
      - "interface Loopback0"
      - " ip address 192.0.2.1 255.255.255.0"

- name: Verify idempotency
  ios_command:
    commands: "show running-config interface Loopback0 | include ip address 192.0.2.1"
    register: output

- name: Fail if idempotency test fails
  assert:
    that:
      - output.stdout_lines|length == 1
      - output.stdout_lines[0] == " ip address 192.0.2.1 255.255.255.0"
