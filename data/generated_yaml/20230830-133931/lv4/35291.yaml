---
- name: Check user existence
  hosts: all
  gather_facts: false

  tasks:
    - name: Get user details
      command: "getent passwd {{ ansible_user }}"
      register: user_details
      ignore_errors: true

    - name: Debug user details
      debug:
        var: user_details.stdout.split(":")

    - name: Remove user
      user:
        name: "{{ ansible_user }}"
        state: absent
      when: "'_SC_OLC_ROOTDN' not in user_details.stdout"