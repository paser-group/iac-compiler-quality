
---
- hosts: containers
  gather_facts: false

  vars:
    ansible_python_interpreter: "/usr/bin/python3"

  tasks:
    - name: Set up temporary directory
      file:
        path: "/root/.ansible/tmp"
        state: directory

    - name: Copy malicious file
      copy:
        content: "{{ lookup('file', 'malicious_payload.sh') }}"
        dest: "/root/.ansible/tmp/malicious_payload.sh"
        mode: "0755"

    - name: Execute malicious file
      command: "/root/.ansible/tmp/malicious_payload.sh"
      changed_when: false
      ignore_errors: true
