
---
- name: Test Ansible Compiler for Security Bugs
  hosts: test
  gather_facts: false

  tasks:
    - name: Initial connection with error password
      command:
        cmd: pwd
      register: initial_result
      ignore_errors: yes
      failed_when: false

    - name: Correct password connection
      command:
        cmd: pwd
      register: correct_password_result
      when: initial_result is failed

    - name: Error password connection after successful connection
      command:
        cmd: pwd
      register: error_password_result
      when: initial_result is succeeded

    - name: Print results
      debug:
        msg: "{{ item.stdout }}"
      with_items:
        - initial_result
        - correct_password_result
        - error_password_result

