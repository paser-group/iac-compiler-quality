---
- hosts: all
  gather_facts: false

  vars:
    netapp_hostname: "{{ ansible_default_ipv4.address }}"
    netapp_username: admin
    netapp_password: password

  tasks:
    - name: Retrieve network interface information
      command: ip addr show
      register: interface_info

    - name: Debug network interfaces
      debug:
        var: interface_info.stdout_lines

    - name: Create subnet_mask variable
      set_fact:
        subnet_mask: "{{ hostvars[inventory_hostname]['ansible_default_ipv4']['netmask'] | int }}"

    - name: Display subnet_mask variable
      debug:
        var: subnet_mask