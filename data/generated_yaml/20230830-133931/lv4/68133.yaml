---
- name: Test Ansible Latent Bug
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create invalid instance with mismatched types
      gcp_compute_instance:
        name: test-instance
        machine_type: true
        disks:
          - auto_delete: true
            boot: true
            initialize_params:
              source_image_family: ubuntu-1804-lts
              source_image_project: ubuntu-os-cloud
        network_interfaces:
          - subnetwork: default
        tags:
          items:
            - http-server
        zone: us-central1-a
        project: my-gcp-project
      register: instance

    - name: Debug instance creation
      debug:
        var: instance