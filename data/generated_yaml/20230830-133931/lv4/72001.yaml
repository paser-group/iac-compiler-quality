---
- name: Inventory-based Bug Finder
  hosts: all
  gather_facts: False

  tasks:
    - name: Set ansible_virtualization_role to 'guest'
      set_fact:
        ansible_virtualization_role: "guest"

    - name: Set ansible_virtualization_type to 'kvm'
      set_fact:
        ansible_virtualization_type: "kvm"

    - name: Include inventory file
      include_vars:
        file: inventory.yml

    - name: Debug variables
      debug:
        var: ansible_facts

    - name: Test invalid symlink path with space
      shell: "ln -s /tmp/some dir/file /tmp/symlink_space"
      args:
        warn: no
      ignore_errors: True

    - name: Test malformed unicode string
      shell: >
        echo -e "\x1b[1;31m\xe2\x9d\xa4\xef\xb8\x8f" > /tmp/malformed_unicode
      args:
        warn: no
      ignore_errors: True

    - name: Test negative cache timeout value
      set_fact:
        ansible_cache_valid_time: -1

    # Additional tasks go here