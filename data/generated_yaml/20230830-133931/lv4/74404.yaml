- name: Ansible Inventory Type Bug Finder
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Initialize variables
      set_fact:
        inventory_data:
          - name: ubuntu1
            ip: 10.1.1.1
            os: ['Ubuntu']
          - name: alpine1
            ip: 10.1.1.2
            os: ['Alpine']
          - name: centos1
            ip: 10.1.1.3
            os: ['CentOS']
          - name: redhat1
            ip: 10.1.1.4
            os: ['Red Hat']
    
    - name: Generate inventory file
      copy:
        content: |
          [nodes]
          {% for host in inventory_data %}
          {{ host.name }}
          {% endfor %}
          
          [nodes:vars]
          {% for host in inventory_data %}
          {{ host.name }}_ip={{ host.ip }}
          {{ host.name }}_os={{ host.os }}
          {% endfor %}
        
        dest: "/etc/ansible/hosts"