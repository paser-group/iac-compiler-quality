---
- hosts: all
  gather_facts: false

  tasks:
    - name: Create network
      docker_network:
        name: node-net
        subnet: "10.1.1.0/24"
        gateway: "10.1.1.254"
      register: network

    - name: Create Docker nodes
      docker_container:
        name: "{{ item.name }}"
        image: "{{ item.image }}"
        state: running
        network_mode: "node-net"
        ip: "{{ item.ip }}"
      with_items:
        - { name: "ubuntu1", image: "ubuntu:latest", ip: "10.1.1.1" }
        - { name: "alpine1", image: "alpine:latest", ip: "10.1.1.2" }
        - { name: "centos1", image: "centos:latest", ip: "10.1.1.3" }
        - { name: "redhat1", image: "redhat:latest", ip: "10.1.1.4" }

    - name: Ping nodes
      ansible.builtin.ping:

    - name: Destroy network
      docker_network:
        name: node-net
        state: absent
...