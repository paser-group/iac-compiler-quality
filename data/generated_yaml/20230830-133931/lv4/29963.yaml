ansible
- name: Provision Users
  hosts: all
  gather_facts: false

  tasks:
    - name: Create temporary user directory
      shell: "mkdir -p /tmp/usermodule"

    - name: Create missing interpreter line file
      copy:
        dest: "/tmp/usermodule/usermodule"
        content: "#!/usr/bin/python"

    - name: Set execute permission for usermodule file
      file:
        path: "/tmp/usermodule/usermodule"
        mode: "u+x"

    - name: Execute user module
      user:
        name: joe.bloe
