
---
- name: Ansible Latent Bug Finder
  hosts: all
  gather_facts: false

  tasks:
    - name: Ping all hosts
      ping:

    - name: Gather network facts
      gather_facts:
        network_os: "{{ ansible_network_os }}"
        transport: "{{ ansible_connection }}"

    - name: Provision network devices
      ios_command:
        commands:
          - show version
        register: show_version_result
        provider:
          host: "{{ ansible_host }}"
          username: "{{ network_username }}"
          password: "{{ network_password }}"

    - name: Print command output
      debug:
        var: show_version_result.stdout_lines
