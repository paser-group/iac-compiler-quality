---
- name: Ansible Latent Bug Playbook
  hosts: all
  gather_facts: false

  tasks:
    - name: Check if inventory file exists
      stat:
        path: "{{ inventory_file }}"
      register: inventory_file_stat
      tags: inventory_check

    - name: Show IP address
      debug:
        msg: "{{ hostvars[inventory_hostname]['ansible_default_ipv4']['address'] }}"
      when:
        - "'ubuntu' in ansible_distribution"
        - inventory_file_stat.stat.exists

    - name: Show OS distribution
      debug:
        msg: "{{ ansible_distribution }}"
      when:
        - "'alpine' in ansible_distribution"
        - inventory_file_stat.stat.exists

    - name: Show OS version
      debug:
        msg: "{{ ansible_distribution_version }}"
      when:
        - "'centos' in ansible_distribution"
        - inventory_file_stat.stat.exists

    - name: Show hostname
      debug:
        msg: "{{ ansible_hostname }}"
      when:
        - "'redhat' in ansible_distribution"
        - inventory_file_stat.stat.exists