
---
- hosts: all
  gather_facts: false
  become: true

  tasks:
    - name: Configure proxy settings for apt
      blockinfile:
        path: "/etc/apt/apt.conf"
        block: |
          Acquire::http::proxy "http://proxy.example.com:8080";
          Acquire::https::proxy "http://proxy.example.com:8080";

    - name: Add a repository without using proxy
      apt_repository:
        repo: 'deb http://bad-repo.example.com/ubuntu focal main'
        state: present
