---
- name: Gather facts from Cisco Nexus devices
  hosts: all
  gather_facts: false  # Disable gathering of facts by default

  tasks:
    - name: Enable network_cli connection
      set_fact:
        ansible_connection: network_cli
        ansible_network_os: nxos

    - name: Gather facts using nxos_facts module
      nxos_facts:
        gather_subset: interfaces