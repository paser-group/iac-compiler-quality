
---
- name: Run commands on nodes
  hosts: all
  gather_facts: false

  tasks:
    - name: Set node names
      set_fact:
        nodes:
          - ubuntu
          - alpine
          - centos
          - redhat
    
    - name: Set node IPs
      set_fact:
        node_ips: "{{ nodes | map('regex_replace', '(.*)$', '10.1.1.\\1') | list }}"
    
    - name: Print node names and IPs
      debug:
        var: item
      with_items: "{{ nodes }}"
    
    - name: Ping nodes
      ping:
      delegate_to: "{{ item }}"
      with_items: "{{ node_ips }}"
