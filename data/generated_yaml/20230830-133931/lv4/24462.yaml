
---
- name: Latent Bug Finder
  hosts: targets
  become: true
  gather_facts: false

  vars:
    subnet: "10.1.1.0/24"
    gateway: "10.1.1.254"

  tasks:
    - name: Verify subnet and gateway
      assert:
        that:
          - subnet is string
          - gateway is string
          - subnet | regex_search('^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/\\d{1,2}$')
          - gateway | regex_search('^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$')
        success_msg: "Valid subnet and gateway provided"
        fail_msg: "Invalid subnet or gateway provided"
