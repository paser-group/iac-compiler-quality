---
- name: Testing delegate_to
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Set the delegate_to host
      set_fact:
        delegate_host: "{{ hostvars['delhost'].ansible_host }}"

    - name: Delegate task to host
      delegate_to: "{{ delegate_host }}"
      shell: |
        echo "This is a delegate task"