---
- name: Test playbook for latent bugs
  hosts: localhost
  gather_facts: false

  vars:
    network_subnet: "10.1.1.0/24"
    network_gateway: "10.1.1.254"
    docker_nodes:
      - name: ubuntu1
        ip: "10.1.1.1"
        distribution: "ubuntu"
      - name: alpine1
        ip: "10.1.1.2"
        distribution: "alpine"
      - name: centos1
        ip: "10.1.1.3"
        distribution: "centos"
      - name: redhat1
        ip: "10.1.1.4"
        distribution: "redhat"

  tasks:
    - name: Setup Docker network
      debug:
        msg: "Creating Docker network with subnet {{ network_subnet }} and gateway {{ network_gateway }}"

    - name: Configure Docker containers
      debug:
        msg: "Configuring Docker container {{ item.name }} with IP address {{ item.ip }} and distribution {{ item.distribution }}"
      loop: "{{ docker_nodes }}"

    - name: Set host-specific facts
      debug:
        msg: "Setting facts for container {{ item.name }}: ansible_hostname={{ item.name }}, ansible_host={{ item.ip }}, ansible_distribution={{ item.distribution }}"
      loop: "{{ docker_nodes }}"