- name: Test playbook to expose latent type-related bugs
  hosts: localhost
  gather_facts: false
  
  vars:
    inventory:
      - name: ubuntu1
        ip: "10.1.1.1"
        user: "root"
      - name: alpine1
        ip: "10.1.1.2"
        user: "root"
      - name: centos1
        ip: "10.1.1.3"
        user: "root"
      - name: redhat1
        ip: "10.1.1.4"
        user: "root"

  tasks:
    - name: Display inventory
      ansible.builtin.debug:
        var: inventory
      
    - name: Create symlink path with space
      ansible.builtin.file:
        src: "/tmp/symlink path"
        dest: "/tmp/symlink_test"
        state: link

    - name: Generate malformed unicode string
      shell: echo -e "\xe9" >> "/tmp/malformed_unicode_{{ item.name }}"
      loop: "{{ inventory }}"
      
    - name: Set variable with incorrect type
      set_fact:
        cache_timeout: "600"
  
    - name: Use variable with incorrect type
      ansible.builtin.debug:
        msg: "Cache timeout is {{ cache_timeout|int }} seconds"