---
- name: Restart NetworkManager service if running
  hosts: all
  gather_facts: false
  tasks:
    - name: Get NetworkManager service status
      command: systemctl is-active NetworkManager
      register: status

    - name: Restart NetworkManager service if running
      service:
        name: NetworkManager
        state: restarted
      when: status.stdout == 'active'

    - name: Print message
      debug:
        msg: "Service restart task completed."