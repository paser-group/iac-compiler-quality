- name: Run shell commands on nodes
  hosts: all
  gather_facts: false
  tasks:
    - name: Define the variable
      set_fact:
        my_var: "{{ 'foobar' }}"

    - name: Execute a shell command with a variable
      shell: echo "{{ my_var }}"
      register: result

    - name: Print the result
      debug:
        var: result.stdout