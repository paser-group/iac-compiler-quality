---
- name: Ansible Latent Type-Related Bug Explorer
  hosts: all
  gather_facts: false

  tasks:
    - name: Set up inventory file
      blockinfile:
        path: inventory.ini
        block: |
          [nodes]
          ubuntu1 ansible_host=10.1.1.1
          alpine1 ansible_host=10.1.1.2
          centos1 ansible_host=10.1.1.3
          redhat1 ansible_host=10.1.1.4

          [nodes:vars]
          ansible_connection=docker

    - name: Generate malformed unicode string for inventory
      copy:
        dest: inventory.ini
        content: "{{ '\udfff' }}"
        force: true

    - name: Execute command on nodes
      debug:
        msg: "{{ item }}"
      with_items: "{{ groups['nodes'] }}"
      loop_control:
        loop_var: node