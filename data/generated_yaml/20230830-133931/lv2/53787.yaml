- hosts: all
  gather_facts: no

  tasks:
    - name: Create symlink paths with space
      shell: "ln -s /tmp/symlink '/tmp/symlink space'"
      delegate_to: "{{ item }}"
      loop:
        - "ubuntu1"
        - "alpine1"
        - "centos1"
        - "redhat1"

    - name: Generate malformed unicode strings for inventory
      set_fact:
        inventory_data: "{{ inventory_data|default({})|combine({item: '\ud800\udc00'}) }}"
      loop:
        - "ubuntu1"
        - "alpine1"
        - "centos1"
        - "redhat1"

    - name: Negative cache timeout
      set_fact:
        cache_timeout: -1

    - name: Create a topic and subscription for test
      gcpubsub:
        topic: "ping-test"
        subscription:
          name: "test-message"
        state: present
      register: pubsub_result

  handlers:
    - name: Print pubsub result
      debug:
        var: pubsub_result