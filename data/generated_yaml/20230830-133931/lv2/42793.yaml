---
- name: Ansible Latent Bug Finder
  hosts: all
  gather_facts: false

  tasks:
    - name: Define inventory file variables
      set_fact:
        subnet: "10.1.1.0/24"
        gateway: "10.1.1.254"
        nodes:
          - name: ubuntu1
            ip: "10.1.1.1"
            distribution: "Ubuntu"
          - name: alpine1
            ip: "10.1.1.2"
            distribution: "Alpine"
          - name: centos1
            ip: "10.1.1.3"
            distribution: "CentOS"
          - name: redhat1
            ip: "10.1.1.4"
            distribution: "Red Hat"

    - name: Generate inventory file
      copy:
        dest: /tmp/inventory
        content: |
          [nodes]
          {% for node in nodes %}
          {{ node.name }} ansible_host={{ node.ip }} distribution={{ node.distribution }}
          {% endfor %}