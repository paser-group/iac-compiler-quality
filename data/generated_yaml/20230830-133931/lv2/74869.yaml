---
- name: Test Ansible Compiler Latent Type-Related Bugs
  hosts: all
  gather_facts: false

  vars:
    docker_nodes:
      - name: ubuntu1
        ip: 10.1.1.1
        distro: ubuntu
      - name: alpine1
        ip: 10.1.1.2
        distro: alpine
      - name: centos1
        ip: 10.1.1.3
        distro: centos
      - name: redhat1
        ip: 10.1.1.4
        distro: redhat

  tasks:
    - name: Create docker network
      docker_network:
        name: node-net
        subnet: 10.1.1.0/24
        gateway: 10.1.1.254

    - name: Create docker nodes
      docker_container:
        name: "{{ item.name }}"
        image: "{{ item.distro }}"
        detach: yes
        network_mode: node-net
        ip: "{{ item.ip }}"
      loop: "{{ docker_nodes }}"

    - name: Gather host facts
      setup:
        gather_subset:
          - network
          - hardware

    - name: Check Ansible version
      debug:
        var: ansible_version

    - name: Verify host interfaces
      debug:
        var: ansible_interfaces

    - name: Verify host default interface
      debug:
        var: ansible_default_ipv4.interface