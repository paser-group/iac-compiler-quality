- name: Test Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Test case - Type-related bug
      vars:
        network_config:
          - name: ovirtmgmt
            address: 10.1.1.1/24
            gateway: 10.1.1.254
          - name: alpinemgmt
            address: 10.1.1.2/24
            gateway: 10.1.1.254
          - name: centosmgmt
            address: 10.1.1.3/24
            gateway: 10.1.1.254
          - name: redhatmgmt
            address: 10.1.1.4/24
            gateway: 10.1.1.254
      set_fact:
        default_gateway: "{{ hostvars[inventory_hostname]['network_config'] | map(attribute='gateway') | first }}"

    - name: Print default gateway
      debug:
        msg: "Default gateway: {{ default_gateway }}"