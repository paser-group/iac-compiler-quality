- name: Unveiling Latent Type-related Bugs in Ansible Compiler
  hosts: all
  gather_facts: false
  
  vars:
    inventory_path: "/etc/ansible/hosts"

  tasks:
    - name: Create invalid integer value in inventory
      lineinfile:
        dest: "{{ inventory_path }}"
        line: "host1 ansible_host=10.1.1.1 ansible_port=yes"

    - name: Attempt to SSH to the host with invalid port value
      shell: "echo 'ping' | nc {{ inventory_hostname }} {{ hostvars[inventory_hostname]['ansible_port'] }}"

    - name: Display debug information about the variable
      debug:
        var: hostvars[inventory_hostname]['ansible_port']