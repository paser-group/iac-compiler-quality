---
- name: Ansible Latent Bug Playbook
  hosts: all
  gather_facts: false

  tasks:
    - name: Set subnet and gateway
      set_fact:
        ansible_default_ipv4_subnet: "10.1.1.0/24"
        ansible_default_ipv4_gateway: "10.1.1.254"

    - name: Check network configuration
      debug:
        var: ansible_default_ipv4

    - name: Ping all hosts
      ping:

    - name: Ensure SSH connection
      wait_for_connection:
        connect_timeout: 5

    - name: Gather facts
      gather_facts: true

    - name: Display network information
      debug:
        var: ansible_default_ipv4