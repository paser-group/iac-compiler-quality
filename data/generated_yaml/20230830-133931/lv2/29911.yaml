---
- name: Ansible Latent Bug Finder Playbook
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create a symlink path with space
      file:
        src: "/tmp/symlink with space"
        dest: "/tmp/symlink"
        state: link

    - name: Generate malformed unicode string for inventory
      copy:
        content: "{{ lookup('pipe', 'echo -e \"\\xDC\\x80\\n\\xDC\\x81\\n\\xDC\\x82\\n\\xDC\\x83\"') }}"
        dest: "/tmp/unicode_inven"
        mode: 0666

    - name: Negative cache timeout value
      lineinfile:
        path: "/tmp/cache_config.yml"
        line: "cache_time: -1"

    - name: Create Docker network and nodes
      docker_network:
        name: node-net
        ipam_subnet: 10.1.1.0/24
        ipam_gateway: 10.1.1.254

    - name: Create Ubuntu node
      docker_container:
        name: ubuntu1
        image: ubuntu:latest
        networks:
          - name: node-net
            ipv4_address: 10.1.1.1

    - name: Create Alpine node
      docker_container:
        name: alpine1
        image: alpine:latest
        networks:
          - name: node-net
            ipv4_address: 10.1.1.2

    - name: Create CentOS node
      docker_container:
        name: centos1
        image: centos:latest
        networks:
          - name: node-net
            ipv4_address: 10.1.1.3

    - name: Create Red Hat node
      docker_container:
        name: redhat1
        image: redhat:latest
        networks:
          - name: node-net
            ipv4_address: 10.1.1.4