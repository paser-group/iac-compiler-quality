---
- name: User Account Management
  hosts: all
  gather_facts: false

  vars:
    ssh_users:
      - name: 'alex'
        groups: ['users']
        comment: 'Alex'
        shell: '/bin/bash'
      - name: 'nic'
        groups: ['users']
        comment: 'Nic'
        shell: '/bin/bash'
      - name: 'john'
        groups: ['users']
        comment: 'Jon'
        shell: '/bin/bash'

  tasks:
    - name: Create user accounts
      user:
        name: "{{ item.name }}"
        groups: "{{ item.groups }}"
        comment: "{{ item.comment }}"
        shell: "{{ item.shell }}"
        password: "{{ item.password }}"
        state: present
      with_items: "{{ ssh_users }}"