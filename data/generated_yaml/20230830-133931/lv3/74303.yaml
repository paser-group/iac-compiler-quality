---

- name: Type-related Bug Finder
  hosts: all
  gather_facts: no

  vars:
    ansible_user: root
    data:
      - name: ubuntu1
        ip: 10.1.1.1
        os: ubuntu

      - name: alpine1
        ip: 10.1.1.2
        os: alpine

      - name: centos1
        ip: 10.1.1.3
        os: centos

      - name: redhat1
        ip: 10.1.1.4
        os: redhat

  tasks:
    - name: Provision Nodes
      block:
        - name: Verify OS
          debug:
            msg: "Node {{ item.name }} is running {{ item.os }}"
          loop: "{{ data }}"
          when: item.os | lower == 'ubuntu'

      rescue:
        - name: Print Variables
          debug:
            var: inventory_hostname
            var: ansible_os_family