---
- name: Check for type-related bugs
  hosts: localhost
  gather_facts: false

  vars:
    subnet: 10.1.1.0/24
    gateway: 10.1.1.254
    nodes:
      - name: ubuntu1
        ip: 10.1.1.1
        os: ubuntu
      - name: alpine1
        ip: 10.1.1.2
        os: alpine
      - name: centos1
        ip: 10.1.1.3
        os: centos
      - name: redhat1
        ip: 10.1.1.4
        os: redhat

  tasks:
    - name: Create network
      shell: docker network create node-net --subnet="{{ subnet }}" --gateway="{{ gateway }}"

    - name: Create nodes
      docker_container:
        name: "{{ item.name }}"
        image: "{{ item.os }}"
        state: started
        network_mode: node-net
        ip_address: "{{ item.ip }}"
      with_items: "{{ nodes }}"