
---
- name: Test playbook for INVENTORY bug detection
  hosts: all
  gather_facts: false

  tasks:
    - name: Create symlink with space
      file:
        src: "{{ playbook_dir }}/link with space"
        dest: "{{ playbook_dir }}/symlink with space"
        state: link

    - name: Generate malformed unicode string for inventory
      shell: echo -n -e '\xff' > inventory/{{ inventory_hostname }}

    - name: Set negative cache timeout
      lineinfile:
        path: /etc/ansible/ansible.cfg
        line: "cache_timeout = -1"

  vars:
    ansible_python_interpreter: /usr/bin/python3
