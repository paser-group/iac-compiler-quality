---
- name: Verify ping functionality
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Ping target host
      ping:
      register: ping_result

    - debug:
        var: ping_result

    - fail:
        msg: "Failed to ping target host."
      when: "'SUCCESS' not in ping_result['ping']"