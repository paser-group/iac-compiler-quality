
---
- name: Create Nested Snapshots
  hosts: all
  gather_facts: false

  tasks:
    - name: Snapshot Nested
      vmware_guest_snapshot:
        hostname: "{{ inventory_hostname }}"
        username: "{{ ansible_user }}"
        password: "{{ ansible_password }}"
        validate_certs: no
        name: snapshot001
        state: present
      register: snapshot_result

    - name: Debug Snapshot Result
      debug:
        var: snapshot_result
