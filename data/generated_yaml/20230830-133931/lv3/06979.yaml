
---
- name: Test Inventory Provisioning
  hosts: all
  gather_facts: false

  tasks:
    - name: Set webserver_root variable
      set_fact:
        webserver_root: '/var/www'

    - name: Set webserver_user variable
      set_fact:
        webserver_user: 'nginx'

    - name: Set instances variable
      set_fact:
        instances:
          - name: 'dev'
            docroot: '{{ webserver_root }}/dev'
          - name: 'stage'
            docroot: '{{ webserver_root }}/stage'

    - name: Debug webserver_root
      debug:
        var: webserver_root

    - name: Debug instances/items
      debug:
        msg: '{{ item.docroot }}'
      with_items: '{{ instances }}'

    - name: Debug instances single item
      debug:
        msg: '{{ instances[0].docroot }}'
