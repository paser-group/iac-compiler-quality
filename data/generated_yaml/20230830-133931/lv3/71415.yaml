
---
- name: Latent Bug Finder Playbook
  hosts: all
  gather_facts: false

  tasks:
    - name: Create symlink paths with spaces
      command: ln -s /some/symlink/path "{{ item }}"
      with_items:
        - "/tmp/symlink with spaces"
        - "/tmp/another symlink with spaces"

    - name: Generate malformed unicode strings for inventory
      shell: echo "{{ item }}" > {{ inventory_hostname }}
      with_items:
        - "\ufffdunicode_string"
        - "\u0627\u0644\u0627\u0646\u062a\u062e\u0627\u0628_\u0627\u0644\u062b\u0627\u0628\u062a"

    - name: Negative cache timeout values
      lineinfile:
        path: /etc/ansible/ansible.cfg
        line: "cache_timeout = -1"

  post_tasks:
    - name: Gather Facts
      setup:
        filter: ansible_distribution*

    - name: Display hostname and ansible_distribution facts
      debug:
        var: inventory_hostname
      register: facts_result
    - name: Debug facts_result
      debug:
        var: facts_result
