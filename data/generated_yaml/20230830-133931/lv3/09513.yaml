---
- name: Test for latent type-related bug in Ansible compiler
  hosts: all
  gather_facts: false

  tasks:
    - name: Set variable with incorrect type
      set_fact:
        my_var: "{{ 10 }}"

    - name: Validate variable type
      fail:
        msg: "Expected string type for my_var."
      when: my_var | string | type_debug != 'str'