---
- name: Ansible Latent Bug Finder
  hosts: all
  gather_facts: false

  tasks:
    - name: Check if state is 'absent'
      ansible.builtin.debug:
        msg: "State is 'absent'"
      when: state_var == 'absent'
      vars:
        state_var: absent

    - name: Check if state is 'present'
      ansible.builtin.debug:
        msg: "State is 'present'"
      when: state_var == 'present'
      vars:
        state_var: present