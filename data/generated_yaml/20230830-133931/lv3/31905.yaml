---
- name: Ansible Latent Bug Finder Playbook
  hosts: all
  gather_facts: false

  tasks:
    - name: Create symlink path with space
      file:
        path: "/tmp/symlink with space"
        state: link
        src: "/some/path"
      when: "'myhost' in groups['all']"

    - name: Generate malformed unicode strings for inventory
      file:
        path: "/tmp/unicode_inventory_file"
        state: touch
      delegate_to: localhost
      vars:
        malformed_unicode_string: "\\xZZ"

    - name: Negative cache timeout value
      lineinfile:
        path: "/etc/ansible/hosts"
        line: "localhost ansible_cache_valid_time=-1"
        insertafter: EOF
      when: "'localhost' in inventory_hostname"