---
- name: Test playbook for Ansible Latent Bug Explorer
  hosts: all
  gather_facts: false

  vars:
    nodes:
      - name: ubuntu1
        ip: 10.1.1.1
        distro: ubuntu
      - name: alpine1
        ip: 10.1.1.2
        distro: alpine
      - name: centos1
        ip: 10.1.1.3
        distro: centos
      - name: redhat1
        ip: 10.1.1.4
        distro: redhat

  tasks:
    - name: Set network subnet and gateway
      shell: ip addr add 10.1.1.{{ item.ip.split('.')[3] }}/24 dev eth0 && ip route add default via 10.1.1.254
      with_items: "{{ nodes }}"
      become: true

    - name: Print node details
      debug:
        msg: "Node {{ item.name }} - IP: {{ item.ip }} - Distro: {{ item.distro }}"
      with_items: "{{ nodes }}"