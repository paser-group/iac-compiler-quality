ansible
---
- name: Configure network interfaces
  hosts: all
  gather_facts: false

  tasks:
    - name: Set interface attributes
      set_fact:
        interface_attributes:
          - name: eth0
            ip_address: "{{ item.ip }}"
            gateway: 10.1.1.254
          - name: eth1
            ip_address: "{{ item.ip | int + 1 }}"
            gateway: 10.1.1.254
      with_items:
        - { ip: '10.1.1.1' }
        - { ip: '10.1.1.2' }
        - { ip: '10.1.1.3' }
        - { ip: '10.1.1.4' }

    - name: Update network interfaces
      nios_interfaces:
        state: "{{ item.state }}"
        interface: "{{ item.name }}"
        ip_address: "{{ item.ip_address }}"
        gateway: "{{ item.gateway }}"
      with_items: "{{ interface_attributes }}"
