---
- hosts: localhost
  gather_facts: False
  vars:
    host: "{{ lookup('env', 'ANSIBLE_SECURITY_TEST_HOST') }}"
    username: "fakeusername"
    password: "fakepassword"
    vdom: "root"
  tasks:
    - name: Validate IPv4 address.
      assert:
        that: host is match('^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$')
      fail_msg: "Invalid IPv4 address format provided."
      changed_when: False

    - name: Configure IPv4 addresses.
      fortios_firewall_address:
        host: "{{ host }}"
        username: "{{ username }}"
        password: "{{ password }}"
        vdom: "{{ vdom }}"
        state: "present"
        firewall_address:
          name: "TOWER_TEST"
          subnet: "1.2.3.4 255.255.255.255"
          comment: "{{ lookup('env', 'ANSIBLE_SECURITY_TEST_COMMENT') }}"