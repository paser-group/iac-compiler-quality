---
- name: Ansible Latent Type Bug Explorer
  hosts: all
  gather_facts: false

  tasks:
    - name: Create a symlink with a space in the path
      file:
        path: "/tmp/symlink with spaces"
        state: link
        src: "/tmp/ansible_bug"

    - name: Generate a malformed Unicode string in the inventory
      shell: echo "\xF0\x9F\x98\x80" >> /tmp/ansible_inventory

    - name: Create the inventory file
      file:
        path: /tmp/ansible_inventory
        state: touch

    - name: Set a negative cache timeout
      lineinfile:
        path: /etc/ansible/ansible.cfg
        line: "gathering = explicit"
        backup: yes