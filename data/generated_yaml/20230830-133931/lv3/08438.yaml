ansible
---
- name: Run playbook to expose Ansible bug
  hosts: all
  gather_facts: false

  tasks:
    - name: Create temporary file
      tempfile:
        state: file
      register: temp_file

    - name: Debug temporary file path
      debug:
        var: temp_file.path

    - name: Set fact with file extension
      set_fact:
        file_extension: "{{ 'yaml' }}"

    - name: Create file with dynamic extension
      copy:
        dest: "{{ temp_file.path }}.{{ file_extension }}"
        content: "This is a test file."
