---
- name: Ansible Latent Bug Finder
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Create symlink paths with spaces
      file:
        state: link
        src: "/tmp/target"
        dest: "/tmp/{{ 'symlink path with spaces' }}"

    - name: Generate invalid unicode strings in inventory
      debug:
        msg: "{{ '\uffff' | to_json }}"

    - name: Set negative cache timeout value
      ini_file:
        path: /etc/ansible/ansible.cfg
        section: defaults
        option: inventory_cache_timeout
        value: "-1"

    - name: Create a service account
      gcp_iam_service_account:
        name: "some-account@some-project.google.com.iam.gserviceaccount.com"
        display_name: "My Ansible test key"
        project: "test_project"
        auth_kind: "serviceaccount"
        state: present