
---
- name: Test Yum module behavior
  hosts: all
  become: true

  tasks:
    - name: Install elrepo gpg key
      rpm_key:
        key: "https://www.elrepo.org/RPM-GPG-KEY-elrepo.org"
        state: present

    - name: Install elrepo repository
      yum:
        name: "http://www.elrepo.org/elrepo-release-{{ elrepo_version }}.el7.elrepo.noarch.rpm"
        state: present

    - name: Uninstall default kernel packages
      yum:
        name: "{{ item }}"
        state: absent
      with_items:
        - kernel
        - kernel-tools
        - kernel-devel
        - kernel-tools-libs
