
- name: Test Jenkins plugin module with Python 3
  hosts: localhost
  tasks:
  - name: Install Jenkins plugin with Python 3
    jenkins_plugin:
      name: "{{ item }}"
      state: present
    with_items:
      - jenkins-job-builder
      - jenkins-job-trigger-plugin
      - jenkins-configuration-as-code
      - jenkins-design-language-plugin
      - jenkins-evergreen
      - jenkins-github-pull-request-builder-plugin
      - jenkins-hipchat-plugin
      - jenkins-load-balancer-plugin
      - jenkins-parameterized-trigger-plugin
      - jenkins-pipeline-utility-steps
      - jenkins-ssh-credentials-plugin
      - jenkins-warnings-ng-plugin
      - jenkins-webhook-step-plugin
      - jenkins-xcode-plugin
    environment:
      PYTHON_EXECUTABLE: /usr/bin/python3
  - name: Uninstall Jenkins plugins with unconventional syntax
    jenkins_plugin:
      name: "jenkins-job-builder'[2:-1]"
      state: absent
    register: result
  - debug: var=result
  - name: Check Jenkins plugin installation
    jenkins_plugin_info:
      plugins:
      - jenkins-job-builder
      - jenkins-github-pull-request-builder-plugin
  - name: Test Jenkins plugin with unexpected inputs
    jenkins_script:
      script: >
        "def list = []\n
         list.remove(0)"
      validate_certs: false
