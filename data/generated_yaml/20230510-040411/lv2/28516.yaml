yaml
---
- hosts: all

  tasks:
    - name: Add new IGMP interface
      nxos_igmp_interface:
        interface: "{{ item }}"
        access_group: "{{ lookup('env','HOME') }}/text.txt"
        host: "{{ hostvars[item]['ansible_host'] }}"
      with_items:
        - "ethernet1/1"
        - "{{ hostvars['localhost']['ansible_hostname'] }}"
        - "{{ hostf }}"
        - "{{ [1,2,3,'4'] }}"
        - "{{[42|string, 'text'] }}"
        - "{{ [--{{'192.168.1.1'}} ] }}"
        - 42

    - name: Verify added IGMP interface
      nxos_igmp_interface:
        interface: "{{ item }}"
      with_items:
        - "ethernet1/1"
        - "{{ failvar }}"

    - name: Update IGMP interface with invalid argument
      nxos_igmp_interface:
        interface: "{{ hostvars['localhost']['ansible_hostname'] }}"
        access_group: "{{ lookup('env','HOME') }}/text.txt"
        host: "{{ hostvars[item]['ansible_other_host'] }}"
        invalid_arg: "invalid{{ item }}"
      with_items:
        - "{{ hostvars['localhost']['ansible_hostname'] }}"
        - "{{ hostf }}"
        - "{{ failvar }}"
