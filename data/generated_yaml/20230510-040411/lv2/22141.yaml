
---
- name: Attempt to run a command that has access denied
  hosts: localhost
  gather_facts: no
  tasks:
  - name: Execute the command with sudo access
    become: yes
    shell: "ls /var/log/nginx/error.log"
    register: result

  - name: Print the result
    debug:
      var: result.stdout_lines

  - name: Execute the command without sudo access
    shell: "tail -1 /etc/shadow"
    become: false
    register: result_without_sudo

  - name: Print the result
    debug:
      var: result_without_sudo.stdout_lines

  - name: Execute the command with unconventional syntax
    shell: "tail -1 `cat</etc/shadow`"
    become: yes
    register: result_unconventional_syntax

  - name: Print the result
    debug:
      var: result_unconventional_syntax.stdout_lines

  - name: Execute the command with unexpected inputs
    shell: "ls /*|echo 1 >/tmp/1.html||cat /tmp/1.html"
    become: yes
    register: result_unexpected_inputs

  - name: Print the result
    debug:
      var: result_unexpected_inputs.stdout_lines

  - name: Execute the command with piping and redirect
    shell: "echo 'test' | cat > /dev/null"
    become: yes
    register: result_piping_redirect

  - name: Print the result
    debug:
      var: result_piping_redirect.stdout_lines

  - name: Execute the command with edge cases
    shell: "echo \"\\033[31mred\\033[0m\""
    become: yes
    register: result_edge_cases

  - name: Print the result
    debug:
      var: result_edge_cases.stdout_lines
