yaml
- name: Test playbook for with_items and some_dict
  hosts: localhost
  gather_facts: false
  vars:
    some_existing_key: 1
    some_dict:
      key_1: value_1
      key_2: value_2
  tasks:
    - name: Test with_items using some_dict.some_existing_key
      debug:
        var: item
      with_items: "{{ some_dict[ some_existing_key ] }}"

    - name: Test with_items using square brackets in string
      debug:
        var: item
      with_items: "{{ some_dict[key_{{2-1}}] }}"

    - name: Test with_items using double braces
      debug:
        var: item
      with_items: "{{ some_dict['key_{{some_existing_key}}'] }}"

    - name: Test with_items using concatenated string
      debug:
        var: item
      with_items: "{{ some_dict['key_' ~ some_existing_key] }}"

    - name: Test with_items using ternary operator
      debug:
        var: item
      with_items: "{{ some_dict[ some_existing_key == 1 ? 'key_1' : 'key_2' ] }}"

    - name: Test with_items using negative index
      debug:
        var: item
      with_items: "{{ some_dict[-1] }}"

    - name: Test with_items using out-of-bounds index
      debug:
        var: item
      with_items: "{{ some_dict[10] }}"

    - name: Test with_items using non-integer index
      debug:
        var: item
      with_items: "{{ some_dict['key_1.5'] }}"

    - name: Test with_items with invalid expression
      debug:
        var: item
      with_items: "{{ some_dict[ some_existing_key / 0 ] }}"
