yaml
---
- hosts: localhost
  tasks:
    - name: Test json_query filter with edge cases
      vars:
        list_with_null: [1, null, "2"]
        dict_with_null: {"a": 1, "b": null, "c": "2"}
        empty_list: []
        empty_dict: {}
        not_a_dict: "not a dict"
        non_json_string: "foo: bar"
      debug:
        var: item|json_query("child")
      loop:
        # Test with different types
        - "{{ list_with_null }}"
        - "{{ dict_with_null }}"
        - "{{ empty_list }}"
        - "{{ empty_dict }}"
        - "{{ not_a_dict }}"
        - "{{ non_json_string }}"

        # Test with invalid queries
        - "{{ dict_with_null|json_query('[') }}"
        - "{{ dict_with_null|json_query('a.+') }}"

        # Test with missing properties
        - "{{ dict_with_null|json_query('.d') }}"
        - "{{ empty_dict|json_query('.a.b.c') }}"
