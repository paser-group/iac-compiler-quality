yaml
- name: Hostgroup vars issues test playbook
  hosts: localhost
  become: true

  vars:
    all:
      ansible_hostgroups:
        - webserver
        - dbserver
    webserver:
      host_var1: "Webserver host_var1"
      host_var2: "Webserver host_var2"
      host_var3: "Webserver host_var3"
      group_var1: "Webserver group_var1"
      group_var2: "Webserver group_var2"
    dbserver:
      host_var1: "Dbserver host_var1"
      host_var2: "Dbserver host_var2"
      host_var3: "Dbserver host_var3"
      group_var1: "Dbserver group_var1"
      group_var2: "Dbserver group_var2"
    group_vars:
      webserver:
        group_var1: "Webserver group_var1"
        group_var2: "Webserver group_var2"
        group_var3: "Webserver group_var3"
      dbserver:
        group_var1: "Dbserver group_var1"
        group_var2: "Dbserver group_var2"
        group_var3: "Dbserver group_var3"

  tasks:
    - name: Print hostvars and groupvars
      debug:
        msg: |
          Webserver:
          host_var1: {{ hostvars.webserver.host_var1 }}
          host_var2: {{ hostvars.webserver.host_var2 }}
          host_var3: {{ hostvars.webserver.host_var3 }}
          group_var1: {{ hostvars.webserver.group_var1 }}
          group_var2: {{ hostvars.webserver.group_var2 }}
          group_var3: {{ group_vars.webserver.group_var3 }}

          Dbserver:
          host_var1: {{ hostvars.dbserver.host_var1 }}
          host_var2: {{ hostvars.dbserver.host_var2 }}
          host_var3: {{ hostvars.dbserver.host_var3 }}
          group_var1: {{ hostvars.dbserver.group_var1 }}
          group_var2: {{ hostvars.dbserver.group_var2 }}
          group_var3: {{ group_vars.dbserver.group_var3 }}

    - name: Print hostgroup vars methods
      debug:
        var: ansible_hostgroups[0]
    - debug:
        msg: "{{ lookup('template', 'example.j2') }}"
      vars:
        some_data_for_template:
          data:
            - foo: 42
              bar: 23
          bar: foobar
          nested_dict:
            a: 10
            b: 20
            c:
              - "nested"
              - "list"

    - name: Test for unexpected errors
      fail:
        msg: "Unexpected error occurred"
