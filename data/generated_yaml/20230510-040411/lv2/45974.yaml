
- name: Test playbook for with_items and when condition error
  hosts: localhost
  gather_facts: no
  
  tasks:
    - name: Test task 1
      debug:
        var: item
      with_items:
        - "{{range(5)}}"
        - "{{range(5)}}"
      when: item < 3 or item > 5 or item is not divisible by 2

    - name: Test task 2
      debug:
        msg: "{{ item }} file exists."
      with_items:
        - /etc/passwd
        - /etc/shadow
      when: item is match('/etc/passwd') and 'root' not in lookup('file', item)

    - name: Test task 3
      debug:
        msg: "{{ item }} is a valid number."
      with_items:
        - 6
        - 1.5
        - hello
      when: item is number

    - name: Test task 4
      debug:
        msg: "This is a test message."
      with_items:
        - "{{range(10)}}"
      when: "'hello' in item or item is undefined"
    
    - name: Test task 5
      set_fact:
        my_list: "{{ my_list + [item] }}"
      with_items:
        - "{{range(10)}}"
      when: item < 7
      
    - name: Test task 6
      debug:
        var: my_list
