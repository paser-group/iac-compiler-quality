
- name: oVirt NIC errors
  hosts: localhost
  gather_facts: false
  vars:
    datacenter_name: "BUA"
    network_name: "infra-prod"

  tasks:
    - name: find network
      ovirt_network:
        auth: '{{ ovirt_auth }}'
        datacenter: '{{ datacenter_name }}'
        name: '{{ network_name }}'
      register: network

    - name: create nic if network is found
      ovirt_nic:
        auth: '{{ ovirt_auth }}'
        vm: '{{ ovirt_vm }}'
        name: '{{ network["network"]["name"] if network["network"] else "non-existent-network" }}'
        network: '{{ network["network"]["id"] if network["network"] else "0" }}'
      ignore_errors: true
