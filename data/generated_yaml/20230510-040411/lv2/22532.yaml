
- hosts: localhost
  gather_facts: false
  tasks:
    - name: Create ESG
      esg_asg:
        name: test-esg
        state: present
        wait: 100
        wait_timeout: 120
        tags: ["1", "2"]
        rules:
          - direction: ingress
            protocol: tcp
            ports: 80
    - name: Update ESG with incorrect syntax
      esg_asg:
        name: test-esg
        state: updated
        wait: 100
        wait_timeout: 120
        tags: ["1", "2"]
        rules:
          - direction: ingress
            protocol: ssh
            ports: "80"
    - name: Delete non-existent ESG
      esg_asg:
        name: non-existent-esg
        state: absent
        wait: 50
        wait_timeout: 60
    - name: Attempt to add invalid tags
      esg_asg:
        name: test-esg
        state: present
        wait: 100
        wait_timeout: 120
        tags: ["<script>alert('Vulnerability!')</script>", "+", "3"]
        rules:
          - direction: ingress
            protocol: tcp
            ports: 80
