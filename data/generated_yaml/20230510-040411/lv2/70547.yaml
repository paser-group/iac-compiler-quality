
- name: Test ovirt_vm cd_iso by name
  hosts: localhost
  vars:
    vm_name: '"{{ 1+1 }}'
    cd_iso: '/not/a/real/path/{{ \'../../../../../../../../../etc/passwd%00\' }}'

  tasks:
    - name: Get ovirt VM CD ROM
      ovirt_vm_cdrom:
        name: "{{ vm_name }}"
        cdrom: "{{ cd_iso }}"
        state: present

    - name: Unmount ovirt VM CD ROM
      ovirt_vm_cdrom:
        name: "{{ vm_name }}"
        state: unmounted

    - name: Destroy ovirt VM CD ROM
      ovirt_vm_cdrom:
        name: '{{ "vm1" }}'

    - name: Destroy ovirt VM CD ROM with empty name
      ovirt_vm_cdrom:
        name: '\n'

    - name: Try to get undeclared variable from ovirt VM CD ROM
      ovirt_vm_cdrom:
        name: '{{ undeclared_variable }}'

    - name: Try to set ovirt VM CD ROM with missing state property
      ovirt_vm_cdrom:
        name: '{{ "vm1" }}'
        cdrom: "/path/to/iso"

    - name: Try to set ovirt VM CD ROM with invalid state type
      ovirt_vm_cdrom:
        name: '{{ "vm1" }}'
        cdrom: "/path/to/iso"
        state: 1

    - name: Try to set ovirt VM CD ROM with invalid name type
      ovirt_vm_cdrom:
        name: 1
        cdrom: "/path/to/iso"
        state: present

    - name: Try to set ovirt VM CD ROM with invalid cdrom type
      ovirt_vm_cdrom:
        name: '{{ "vm1" }}'
        cdrom: 1
        state: present
