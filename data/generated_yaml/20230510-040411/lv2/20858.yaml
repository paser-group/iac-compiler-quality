
- name: Become return timeout with sudo over local connection if host cannot resolve hostname
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Execute command as sudo on a host with invalid DNS entry
      become: yes
      become_method: sudo
      become_user: root
      command: cat /etc/hosts
      ignore_errors: true

    - name: Execute command as sudo on an unreachable host
      become: yes
      become_method: sudo
      become_user: root
      command: cat /etc/hosts
      ignore_errors: true
      delegate_to: 192.0.2.1

    - name: Execute command as sudo without specifying become_method
      become: yes
      become_user: root
      command: cat /etc/hosts
      ignore_errors: true

    - name: Execute command as non-existent user with sudo
      become: yes
      become_method: sudo
      become_user: nonexistuser
      command: cat /etc/hosts
      ignore_errors: true

    - name: Execute command as sudo with invalid become_method
      become: yes
      become_method: invalidmethod
      become_user: root
      command: cat /etc/hosts
      ignore_errors: true

    - name: Execute command as sudo with extra become arguments
      become: yes
      become_method: sudo
      become_user: root
      become_extra_args: "--timeout=5 -k"
      command: cat /etc/hosts
      ignore_errors: true
