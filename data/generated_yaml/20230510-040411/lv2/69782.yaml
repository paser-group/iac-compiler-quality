
---
- name: CVE-2020-10744 testing playbook
  hosts: all
  gather_facts: no

  tasks:
  - name: attempt to trigger CVE-2020-10744
    command: echo 'hosts: <invalid yaml>'
    register: failed_playbook

  - name: print failed playbook debug info
    debug:
      var: failed_playbook

  - name: unconventional syntax
    shell: |
      {% for i in range(5, 0, -1) %}
      "{{ item[i] }}"
      {% endfor %}
    loop:
      - [1, 2, 3, 4, 5]

  - name: unexpected input - command line
    command: |
      ansible localhost -m shell -a "rm -rf /tmp/foo"

  - name: unexpected input - module
    shell: >
      ansible localhost -m script -a "/path/to/script && rm -rf /tmp/foo"
