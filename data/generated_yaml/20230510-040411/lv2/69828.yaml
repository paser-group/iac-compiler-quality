
- name: Test ansible_winrm_transport credssp connection error
  hosts: windows
  gather_facts: no
  
  vars:
    username: Administrator
    password: This!sAStr0ngP@ssword!
  
  tasks:
  - win_rm:
      uri: "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\15\\ISAPI\\owssvr.dll"
      hostname: "{{ host }}"
      username: "{{ username }}"
      password: "{{ password }}"
      transport: 'credssp'
      kerberos_hostname_override: "{{ ansible_fqdn }}"
    delegate_to: localhost
    register: owssvr_response
  
  - debug:
      msg: "'owssvr.dll' API response: {{ owssvr_response.stdout }}"
