
- name: Get Azure Security Group Facts
  hosts: localhost
  gather_facts: False

  tasks:
    - name: Azure authentication
      azure_rm_auth:
        method: ad_service_principal
        subscription_id: "{{ subscription_id }}"
        client_id: "{{ client_id }}"
        secret: "{{ secret }}"
        tenant: "{{ tenant }}"

    - name: Get Security Group Facts
      azure_rm_securitygroup_facts:
        resource_group: "{{ resource_group }}"
        api_profile: "{{ api_profile }}"
        cert_validation_mode: "{{ cert_validation_mode }}"
        proxy: "{{ proxy }}"
        proxy_username: "{{ proxy_username }}"
        proxy_password: "{{ proxy_password }}"

  vars:
    subscription_id: "12345"
    client_id: "abcdef"
    secret: "xyz123"
    tenant: "example.com"
    resource_group: "test-group"
    api_profile: "2019-08-01-hybrid"
    cert_validation_mode: "Don'tValidate"
    proxy: "https://example-proxy.com"
    proxy_username: "proxy_user"
    proxy_password: "proxy_password"
