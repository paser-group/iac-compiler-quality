
- name: Create a directory with custom permissions if it doesn't exist already
  become: true
  file:
    path: /path/to/directory/
    state: directory
    owner: user
    group: group
    mode: "0640"
    recurse: yes
    backup: yes
    force: yes
  when: not test_user_file.stat.exists
  vars:
    test_user_file: "{{ lookup('file', '/path/to/directory/') }}"
    path: "{{ test_user_file.path if test_user_file.stat.exists else '/path/to/directory/' }}"
