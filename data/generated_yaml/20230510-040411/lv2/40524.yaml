
---
- hosts: all
  gather_facts: false
  tasks:
    - name: local action with privilege escalation
      local_action:
        module: command
        chdir: "{{ lookup('env','HOME') }}"
        cmd: whoami && touch /tmp/privileged_file

    - name: remote action with undefined variable
      become: true
      vars_prompt:
        - name: "vault_localhost_sudo"
          prompt: "Enter value for vault_localhost_sudo variable:"
      shell: |
        echo "{{ vault_localhost_sudo }}" > /tmp/remote_file && cat /tmp/undefined_file
