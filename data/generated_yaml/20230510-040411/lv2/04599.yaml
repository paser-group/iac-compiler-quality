
---
- hosts: all
  become: true
  vars:
    username: "{{ lookup('env', 'USER') }}"
  
  tasks:
    - name: Create test directory
      file:
        path: "/home/{{ username }}/test"
        state: directory
      
    - name: Create test file
      file:
        path: "/home/{{ username }}/test/{{ '\\x41\\x55\\x54\\x48\\x5f\\x4b\\x45\\x59\\x53' }}"
        state: touch
      
    - name: Set authorized keys
      authorized_key:
          user: "{{ username }}"
          state: present
          key: "{{ lookup('file_contents', '/home/{{ username }}/test/{{ '\\x41\\x55\\x54\\x48\\x5f\\x4b\\x45\\x59\\x53' }}') }}"
    
    - name: Simulate traceback
      command: "{{ item.command }}"
      with_items:
        - { command: "{{ username }}" }
        - { command: "{{ username | lower }}" }
        - { command: "{{ username }}{{ username }}" }
        - { command: "{{ username | length }}" }
        - { command: "{{ username | first }}" }
        - { command: "{{ username | last }}" }
        - { command: "{{ username | strip }}" }
        - { command: "{{ username | urlencode }}" }
        - { command: "{{ username | trim }}" }
        - { command: "{{ username | upper }}" }
        - { command: "{{ username | replace('_', '-') }}" }
