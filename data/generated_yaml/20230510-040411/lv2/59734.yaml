
---
- name: ansible-galaxy login -c CERT error Playbook

  hosts: localhost
  gather_facts: no

  tasks:
    - name: Generate self-signed certificate
      openssl_certificate:
        provider: selfsigned
        common_name: "{{ ansible_hostname }}"
      register: cert

    - name: Configure ansible-galaxy
      command: ansible-galaxy login -c --cert="{{ cert.cert }}" my_org
      ignore_errors: yes

    - name: Validate ansible-galaxy configuration
      stat:
        path: /home/ubuntu/.ansible_galaxy/certificates/my_org.crt
