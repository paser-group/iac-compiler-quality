
- name: Generate ios_facts and print tunnel MAC address
  hosts: all
  gather_facts: no

  tasks:
  - name: Gather ios_facts
    ios_facts:

  - name: Print tunnel MAC address
    debug:
      var: ansible_net_all_ipv4_addresses[0] + "/32" | ipv4('mac')

  - name: Try unconventional syntax
    debug:
      var: ansible_net_all_ipv4_addresses.0"/32" | ipv4('mac')

  - name: Try unexpected input
    debug:
      var: ansible_net_all_ipv4_addresses[0] + "/32" | ipv4('fake')

  - name: Test edge case 1
    debug:
      var: ansible_net_all_ipv4_addresses[0] + "/24" | ipv4('mac')

  - name: Test edge case 2
    debug:
      var: ansible_net_all_ipv4_addresses[0] + "/255.255.255.0" | ipv4('mac')

  - name: Test edge case 3
    debug:
      var: ansible_net_all_ipv4_addresses[0].split('.')[0:2] | join('.') + '.1' | ipv4('mac')

  - name: Test edge case 4
    debug:
      var: ansible_net_all_ipv4_addresses[0].split('.')[3] + '.' + ansible_net_all_ipv4_addresses[0].split('.')[2] + '.' + ansible_net_all_ipv4_addresses[0].split('.')[1] + '.' + ansible_net_all_ipv4_addresses[0].split('.')[0] + '/32' | ipv4('mac')
