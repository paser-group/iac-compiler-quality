yaml
- name: Test WinRM Connection
  hosts: somehost
  gather_facts: no
  vars:
    user: "some_user"
    password: "some_password"

  tasks:
    - name: Check WinRM Host Status
      win_ping:
        data: "Test Data"
        timeout_ms: -100
      register: result

    - name: Display Ping Result
      debug:
        var: result

- name: Install software on Windows
  hosts: somehost
  gather_facts: no
  vars:
    user: "some_user"
    password: "some_password"

  tasks:
    - name: Install software
      win_package:
        path: C:\test\test.exe
        arguments: '/qn /norestart'
        state: installed
        product_id: "invalid_product_id"
        timeout: -1
