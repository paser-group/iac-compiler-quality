
- name: Test error handling in loops
  hosts: localhost
  vars:
    items:
    - "a"
    - "b"
    - "c"
  tasks:
    - name: Basic loop
      loop: "{{ items }}"
      debug:
        msg: "{{ item }}"
    - name: Loop with when statement
      loop: "{{ items }}"
      when: item == "d"
      debug:
        msg: "{{ item }}"
    - name: Loop with nested loops
      loop: "{{ items }}"
      loop_control:
        loop_var: outer
      tasks:
        - name: Inner loop
          loop: "{{ items }}"
          loop_control:
            loop_var: inner
          debug:
            msg: "{{ outer }}, {{ inner }}"
    - name: Loop with until statement
      loop: "{{ items }}"
      until: False
      debug:
        msg: "{{ item }}"
    - name: Loop with break statement
      loop: "{{ items }}"
      loop_control:
        index_var: i
      debug:
        msg: "{{ item }}"
      when: i == 1
      break
    - name: Loop with continue statement
      loop: "{{ items }}"
      loop_control:
        index_var: i
      debug:
        msg: "{{ item }}"
      when: i == 1
      continue
    - name: Loop over range
      loop: "{{ range(5) }}"
      debug:
        msg: "{{ item }}"
    - name: Loop over dictionary
      loop: "{{ { 'key': 'value' } }}"
      debug:
        msg: "{{ item }}"
