
- name: Test Ansible's 'defaults' module
  hosts: localhost
  vars:
    my_value: "value1"

  tasks:
  - name: Set variable using 'defaults' module
    set_fact:
      my_var1: "{{ my_value | default('default_value') }}"
      my_var2: "{{ my_value | default(omit) }}"
      my_var3: "{{ my_value | default('1', true) }}"
      my_var4: "{{ my_value | default(True, false, default='default_value') }}"
    register: result1

  - name: Display variable values
    debug:
      var: item
    loop:
      - "{{ my_var1 }}"
      - "{{ my_var2 }}"
      - "{{ my_var3 }}"
      - "{{ my_var4 }}"

  - name: Override default value
    set_fact:
      my_value: "value2"

  - name: Set variable using 'defaults' module after overriding value
    set_fact:
      my_var5: "{{ my_value | default('default_value') }}"
      my_var6: "{{ my_value | default(omit) }}"
      my_var7: "{{ my_value | default('1', true) }}"
      my_var8: "{{ my_value | default(True, false, default='default_value') }}"
    register: result2

  - name: Display variable values after overriding value
    debug:
      var: item
    loop:
      - "{{ my_var5 }}"
      - "{{ my_var6 }}"
      - "{{ my_var7 }}"
      - "{{ my_var8 }}"
