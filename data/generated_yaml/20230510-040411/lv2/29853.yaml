yaml
- name: Test IAM Policy Module 
  hosts: localhost 

  tasks:
  - name: Create User 
    iam_user:
      name: "{{ user_name }}"
      state: present
      password: "{{ user_password }}"

  - name: Create Policy 
    iam_policy:
      name: "{{ policy_name }}"
      policy_json: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "{{ policy_effect }}",
              "Action": {
                "Service": "{{ policy_service }}",
                "Action": [
                  "{{ policy_action }}"
                ]
              },
              "Resource": "{{ policy_resource }}",
              "Condition": {{ policy_condition }}
            }
          ]
        }
      state: present

  - name: Update Policy 
    iam_policy:
      name: "{{ policy_name }}"
      policy_json: 
        "Version": "2012-10-17",
        "Statement": {
          "Effect": "{{ policy_effect }}",
          "Action": "{{ policy_action }}",
          "Resource": "{{ policy_resource }}"
        }
      state: present

  - name: Delete Policy 
    iam_policy:
      name: "{{ policy_name }}"
      state: absent
