
- name: Test set_fact bug with array
  hosts: localhost
  vars:
    my_array:
      - element1
      - element2

  tasks:
    - name: Set fact using array
      set_fact:
        my_fact: "{{ item }}"
      with_items: "{{ my_array }}"
      
    - name: Verify that my_fact is set to the last element in the array
      assert:
        that:
          - my_fact == "{{ my_array[-1] }}"
