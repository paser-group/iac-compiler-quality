
---
- name: ios_facts socket connection playbook
  hosts: remote_device
  gather_facts: no

  tasks:
    - name: attempt ios facts socket connection with bad attribute, expect NoneType error
      ios_facts:
        provider:
          host: "{{ host }}"
          port: "{{ port }}"
          username: "{{ username }}"
          password: "{{ password }}"
        bad_attribute: "bad_value"
      register: ios_facts_result

    - name: expect to see an error message for NoneType error
      debug:
        var: ios_facts_result

    - name: ios_facts socket connection with no host, expect bad request error
      ios_facts:

    - name: ios_facts socket connection with no credentials, expect authentication error
      ios_facts:
        provider:
          host: "{{ host }}"
          port: "{{ port }}"
    
    - name: ios_facts socket connection with non-existent host, expect to see a connection error
      ios_facts:
        provider:
          host: "non_existent_host"
          
    - name: ios_facts socket connection with wrong port, expect to see a connection error
      ios_facts:
        provider:
          host: "{{ host }}"
          port: "123"
          username: "{{ username }}"
          password: "{{ password }}"
