
- name: Encrypting a file with Ansible Vault
  hosts: localhost
  tasks:
    - name: Create a file with special characters
      copy:
        content: "\xc5\x81\xc3\xb3\xc5\xbck\xc4\x99.txt"
        dest: "{{ playbook_dir }}/test.txt"
    - name: Encrypt the file with a password file
      vars:
        password_file: "{{ playbook_dir }}/password_file.txt"
      ansible.builtin.vault:
        encrypt_string: no
        encrypt: yes
        content: "{{ lookup('file', playbook_dir + '/test.txt') }}"
        secret: "{{ lookup('file', password_file) }}"
    - name: Encrypt the file with a password prompt
      ansible.builtin.vault:
        encrypt_string: no
        encrypt: yes
        content: "{{ lookup('file', playbook_dir + '/test.txt') }}"
        secret: "{{ lookup('env', 'VAULT_PASSWORD', 'password') }}"
