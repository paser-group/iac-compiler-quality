
- name: Test playbook
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Update firewall rule
      gcp_compute_firewall:
        name: "test-firewall-{{ random_string(10, 'alpha_num') }}"
        network: "{{ gce_net | default('default') }}"
        allow:
          - protocol: tcp
            ports:
              - 22
              - '80'
              - ''
              - []
              - {}
              - 'invalid'
              - 65536
              - -1
              - 0.5
              - 1.0
              - -1.0
            source_ranges:
              - 0.0.0.0/0
        state: present
      register: result

    - debug:
        var: result
