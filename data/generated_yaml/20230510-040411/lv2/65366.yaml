
---
- name: "Test Ansible compiler for ANSIBLE_DUPLICATE_YAML_DICT_KEY error"
  hosts: localhost
  vars:
    my_dict:
      key1: val1
      key2: val2
      key3: val3
      key1: val4 # duplicate key

  tasks:
    - name: "Test duplicate keys in a dictionary"
      assert:
        that:
          - my_dict is mapping
          - my_dict | length == 3

    - name: "Test duplicate keys in a list"
      set_fact:
        my_list: [1, 2, 3, 2]

    - name: "Test invalid variable name"
      set_fact:
        invalid variable name: "Test"

    - name: "Test invalid filter syntax"
      debug:
        msg: "{{ my_var | ???? }}"

    - name: "Test invalid module name"
      non_existent_module_name:
        param: value

    - name: "Test executing a shell command"
      shell: "echo 'Hello, world!'"

    - name: "Test using invalid loop syntax"
      command: "echo {{ item }}"
      with_dict: "{{ my_dict }}"
      loop_control:
        key: item

    - name: "Test including an invalid YAML file"
      include_vars: "invalid_yaml_file.yml"

    - name: "Test using an undefined variable"
      debug:
        msg: "{{ undefined_variable }}"
