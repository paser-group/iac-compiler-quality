
---
- hosts: localhost
  tasks:
    - name: Generate a templating error
      ec2:
        key_name: "{{ item.key }}"
        image: "{{ item.image|default('ami-0c55b159cbfafe1f0') }}"
        instance_type: "{{ item.type|default('t2.micro') }}"
        tags:
          Name: "{{ item.name }}"
      loop:
        - { key: 'key1', name: 'instance1', type: 't2.nano' }
        - { key: 'key2', image: 'badimage', name: 'instance2', type: 't2.micro' }
        - { key: 'key3', image: '{{ undefined_variable }}', name: 'instance3', type: 't2.nano' }
        - { key: 'key4', image: 'ami-123456789', name: 'instance4', type: 'invalid_type' }
