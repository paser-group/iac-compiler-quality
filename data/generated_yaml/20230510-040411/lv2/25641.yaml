
---
- name: Ansible fuzzing playbook for CloudStack cs_host module
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Add host to CloudStack with http prefix
      cs_host:
        api_url: "http://cloudstack.com"
        api_key: "myapikey"
        api_secret: "myapisecret"
        url: "{{ item }}"
      with_items:
        - "example.com"
        - "http://example.com"
        - "{{ 'http://example.com' }}"
        - "{{ ['http://example.com'] }}"
        - "'http://example.com'"
        - True
        - False
        - null
        - ""
        - " "
        - "{{ }}"
        - "{{ [] }}"
        - "{{ ' ' }}"
        - "{{ null }}"
        - "{{ False }}"
        - "{{ True }}"
        - "{{ 'http' }}"
        - "{{ 123 }}"
        - "{{ {'http': 'example.com'} }}"
        - "{{ ['http', 'example.com'] }}"
        - "{{ 'http://example.com?' }}"
        - "{{ 'http://example.com#' }}"

    - name: Remove host from CloudStack
      cs_host:
        api_url: "http://cloudstack.com"
        api_key: "myapikey"
        api_secret: "myapisecret"
        state: "{{ item }}"
        url: "http://example.com"
      with_items:
        - "present"
        - "{{ 'present' }}"
        - "{{ ['present'] }}"
        - "'present'"
        - "absent"
        - "{{ 'absent' }}"
        - "{{ ['absent'] }}"
        - "'absent'"
        - True
        - False
        - null
        - ""
        - " "
        - "{{ }}"
        - "{{ [] }}"
        - "{{ ' ' }}"
        - "{{ null }}"
        - "{{ False }}"
        - "{{ True }}"
        - "{{ 'http' }}"
        - "{{ 123 }}"
        - "{{ {'http': 'example.com'} }}"
        - "{{ ['http', 'example.com'] }}"
