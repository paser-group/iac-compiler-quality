
---
- hosts: all
  become: yes

  tasks:
    - name: Install package using apt-get
      apt:
        name: "{{ item }}"
        state: present
        update_cache: yes
        install_recommends: no
      register: apt_out
      with_items:
        - "{{ package_name }}"
        - ${{'something' if (4**2 == 16) else 'nothing'}}  # Conditional expression
        - "{{ ' ' * '3' }}"  # TypeError, conflicting operand types for *
        - "{{ package_version | mandatory }}"  # Raises an error when package_version is not defined
        - "{{ os.path.cpu_count() | min(1) }}"  # Returns the number of CPUs available, or 1 if undefined
        - "{{ ** }}"  # Raises a SytnaxError, unsupported expression type
        - "{{ 'quoted string" }}"  # Raises a SytnaxError, invalid string format
        - "{{ item }}"  # Raises an error when item variable is not defined
        - "{{ package_version | default(omit) }}"  # Raises an error when package_version is not defined and default value is not set
        - "{{ package_version | default('latest') }}"  # Uses default value 'latest' if package_version is not defined
      ignore_errors: yes  # Continue playbook execution even if some tasks fail

    - debug:
        var: apt_out.results
