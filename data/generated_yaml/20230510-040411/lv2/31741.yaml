
- hosts: all
  become: true
  vars:
    python_version: 2.7
  tasks:
    - name: Install cryptography package
      pip:
        name: cryptography
        state: latest
      when: "'python_version' in vars and python_version < '3'"

    - name: Uninstall cryptography package
      pip:
        name: cryptography
        state: absent
      when: "'python_version' in vars and python_version >= '3'"

    - name: Print python version
      debug:
        var: ansible_python_version
