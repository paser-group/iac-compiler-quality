
- name: Delete AWS Security Group
  hosts: localhost
  gather_facts: false

  vars:
    security_group_id: "<your_security_group_id>"
    region: "<your_region>"
  
  tasks:
  - name: Unconventional EC2 group syntax
    ec2_group:
      name: "non-existing_group"
      purge_rules: true
      purge_rules_egress: true
      cascade: true
      profile: "{{ aws_default_profile }}"
      aws_secret_key: "{{ aws_secret_key }}"
      aws_access_key: "{{ aws_access_key }}"
      state: absent

  - name: Delete security group under a different AWS account
    ec2_group:
      id: "{{ security_group_id }}"
      aws_access_key: "dummy"
      aws_secret_key: "dummy"
      region: "{{ region }}"
      state: absent

  - name: Swap the input parameters
    ec2_group:
      name: "{{ region }}"
      id: "{{ security_group_id }}"
      state: absent
    
  - name: Insert unexpected inputs
    ec2_group:
      non_existing_parameter: "this_should_fail"
      state: absent
