
- hosts: all
  gather_facts: no
  tasks:
    - name: Test Win Firewall
      win_firewall:
        # Edge case: empty rule name
        name: ""
        direction: in
        protocol: tcp
        local_port: "{{ random(range(1, 65535)) }}"

        # Unconventional syntax: string instead of list for source and destination
        remote_ip_address: "{{ lookup('env', 'COMPUTERNAME') }}"
        remote_port: "3389"
        enabled: yes

        # Unexpected input: integer instead of string of rule description
        description: 123456

        # Edge case: Duplicate rule name and direction
        rule_1:
          name: "Test Rule"
          direction: in
          action: allow
          protocol: tcp
          local_port: "{{ random(range(1, 65535)) }}"
        rule_2:
          name: "Test Rule"
          direction: in
          action: allow
          protocol: tcp
          local_port: "{{ random(range(1, 65535)) }}"
