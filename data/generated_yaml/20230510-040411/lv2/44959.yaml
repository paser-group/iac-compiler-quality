
- hosts: cisco_ios
  tasks:
   - name: upload ios image over http 
     net_put:
       host: "{{ inventory_hostname }}"
       username: "{{ ansible_user }}"
       password: "{{ ansible_password }}"
       protocol: http
       src: /path/to/ios/image
       dest: /flash/ios/image
     register: result

   - name: verify ios image upload
     assert:
       that:
         - "'HTTP/1.1 200 OK' in result.headers.msg"
         - "'Connection: close' in result.headers.msg"
         - "'Content-Length' in result.headers.msg"
         - "'no-cache' in result.headers.msg"
         - "'Pragma' in result.headers.msg"
