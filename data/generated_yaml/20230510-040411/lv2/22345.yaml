
---
- hosts: all
  vars:
    role_name: 'my_role'
    my_var: "{{ default_var }}"
  defaults:
    default_var: 'default_value'

  tasks:
    - name: Unconventional syntax
      command: "{{ item }} {{ my_var }}"
      with_items:
        - echo
        - printf
        - ls

    - name: Unexpected input
      file:
        path: "{{ item }}"
        state: directory
      with_items:
        - "{{ role_name }}"
        - "{{ role_name }}/"
        - "{{ role_name + '/' }}"
        - "{{ [role_name] }}"

    - name: Edge cases
      debug:
        var: "{{ my_var.split('/')[3:].pop()|regex_replace('[^a-zA-Z0-9]','_') }}"
