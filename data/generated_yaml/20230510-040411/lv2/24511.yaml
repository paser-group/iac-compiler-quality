
- name: Create VMware snapshot
  vmware_guest_snapshot:
    hostname: "{{ inventory_hostname }}"
    username: "{{ guest_username }}"
    password: "{{ guest_password }}"
    validate_certs: no
    name: "{{ vm_name }}"
    state: "{{ random_string|default('present') }}"
    description: "{{ vm_description|string()|truncate(128, True, '...') }}"
    wait_for_ip_timeout: "{{ 60|int }}"
    retry_timeout: "{{ 300|int }}"
    retry_interval: "{{ 2|int }}"
  register: result

- name: Debug snapshot result
  debug:
    var: result
