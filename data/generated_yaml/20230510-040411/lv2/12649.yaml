
- name: Test playbook for variable passing issues
  hosts: all
  vars:
    variable_1: foo
    variable_2: bar
    variable_3:
      - baz
      - qux

  gather_facts: no

  tasks:
    - name: Set variables with incorrect key value pairs
      set_fact:
        "{{ item }}_wrong_key": "{{ vars[item] }}"
      with_items:
        - variable_1
        - variable_2
        - variable_3
        
    - name: Pass incorrect variables to included task
      include_tasks: "{{ item }}"
      with_items:
        - tasks/task_1.yml
        - tasks/task_2.yml
        
    - name: Pass missing variable to included task
      include_tasks: tasks/task_3.yml
      vars:
        missing_variable: "{{ variable_4 }}"
