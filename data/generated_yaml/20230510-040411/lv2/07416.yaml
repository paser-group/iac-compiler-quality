
- name: Test uri module for status == 304
  hosts: all
  tasks:
    - name: Send uri GET request with status 304
      uri:
        url: "http://example.com"
        method: GET
        status_code: 304
      register: response

    - name: Check if response is OK
      debug:
        var: response.status

    - name: Verify response headers
      assert:
        that:
          - response.headers['ACCEPT'] == 'application/json'
          - response.headers['Content-Length'] > 0

    - name: Test uri redirection
      uri:
        url: "http://redirect.com"
        follow_redirects: true
        validate_certs: false

    - name: Send uri POST request with file upload
      uri:
        url: "http://example.com/upload"
        method: POST
        body_format: multipart/form-data
        body:
          file: "/tmp/testfile.txt"
