
- name: Test nxos_facts and ansible_connection=network_cli
  hosts: localhost
  connection: local

  tasks:
  - name: Gather facts using nxos_facts and network_cli connection plugin
    nxos_facts:
      gather_subset: hardware
      provider:
        host: "switch1"
        username: "admin"
        password: "password"
      ansible_connection: network_cli
      
  - name: Print the gathered facts
    debug:
      msg: "{{ nxos_facts }}"
    
  - name: Generate error by using unauthorized username
    nxos_facts:
      provider:
        host: "switch1"
        username: "fakeadmin"
        password: "password"
      ansible_connection: network_cli

  - name: Try to use unsupported gather_subset
    nxos_facts:
      gather_subset: unsupported_subset
      provider:
        host: "switch1"
        username: "admin"
        password: "password"
      ansible_connection: network_cli
    
  - name: Try to provide an invalid password
    nxos_facts:
      gather_subset: hardware
      provider:
        host: "switch1"
        username: "admin"
        password: "invalid-password"
      ansible_connection: network_cli
