
---
- name: Test playbook for EAPI connection issue
  hosts: all
  gather_facts: no
  
  tasks:
    - name: Connect to EAPI with unusual port number
      eos_command:
        host: "{{ inventory_hostname }}"
        username: "admin"
        password: "password"
        commands:
          - "show version"
        port: "{{ 65536 }}"
      register: command_output
    
    - name: Display output from unusual port number
      debug:
        var: command_output
    
    - name: Connect to EAPI using wrong password
      eos_command:
        host: "{{ inventory_hostname }}"
        username: "admin"
        password: "wrong_password"
        commands:
          - "show version"
      register: command_output
      
    - name: Display output from wrong password
      debug:
        var: command_output

    - name: Terminate the connection with an invalid command
      eos_command:
        host: "{{ inventory_hostname }}"
        username: "admin"
        password: "password"
        commands:
          - "invalid command"
      register: command_output
      
    - name: Display output from an invalid command
      debug:
        var: command_output
      
