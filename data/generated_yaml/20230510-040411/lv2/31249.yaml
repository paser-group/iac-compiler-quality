
- hosts: all
  gather_facts: no
  tasks:
    - name: Test unexpected exception
      fail:
        msg: "This is a test for an unexpected exception with 'NoneType'"
        when: >
          {% if not some_var is defined %}
          {% for item in none_list %}
          {% set a = item %}
          {% endfor %}
          {% endif %}
