
- name: Test Copy Module
  hosts: localhost
  tasks:
    - name: Copy a directory to a file
      copy:
        src: /tmp/directory/
        dest: /tmp/dest_file
        mode: 0755
        backup: yes
        force: yes
        validate: 'echo validation'
        remote_src: no
        checksum: md5
        follow: no
    - name: Copy with a regex excluding files that match pattern
      copy:
        src: /tmp/dir_S*
        dest: /tmp/dest/
        excludes: 'test*.log, *.tmp'
    - name: Copy with a regex including only files that match pattern
      copy:
        src: /tmp/dir_S*
        dest: /tmp/dest/
        includes: '*.txt'
    - name: Copy file only if it has changed
      copy:
        src: /tmp/file.txt
        dest: /tmp/file1.txt
        backup: yes
        checksum: md5
        follow: no
    - name: Copy with a wildcard as source
      copy:
        src: /tmp/*
        dest: /usr/share/
        backup: yes
        checksum: sha1
    - name: Copy a directory recursively and preserve owner and group
      copy:
        src: /tmp/directory/
        dest: /tmp/dest/
        recursive: yes
        preserve_mode: yes
        preserve_owner: yes
        preserve_timestamps: yes
    - name: Copy a directory recursively by symlinks
      copy:
        src: /tmp/directory/
        dest: /tmp/dest/
        dereference: yes
    - name: Copy only source files newer than flattened target dir
      copy:
        src: /tmp/directory/
        dest: /tmp/new/
        flatten: yes
        compare_dest: yes
        check_mode: yes
    - name: Copy from Windows source
      win_copy:
        src: '\\192.0.2.0\share\file.txt'
        dest: 'C:\temp\file.txt'
        force: yes
        copy_hidden: yes
        checksum: md5
