
- name: Auto Scaling Policy Failure Fuzzer
  hosts: localhost
  gather_facts: no
  vars:
    object_name: "{{ ['cluster1', 'cluster2', 'cluster3'] }}"
    policy_state: "{{ ['disabled', 'enabled', 'paused'] }}"
    invalid_input: "{{ ['<script>alert("XSS");</script>', '&& rm -rf /', '123DROP TABLE'] }}"
  tasks:
  - name: Auto Scaling Policy Failure 1
    ec2_scaling_policy:
      name: "{{ object_name[0] }}"
      state: "{{ policy_state[0] }}"
    register: output1

  - name: Auto Scaling Policy Failure 2
    ec2_scaling_policy:
      name: "{{ object_name[1] }}"
      state: "{{ policy_state[1] }}"
    register: output2

  - name: Auto Scaling Policy Failure 3
    ec2_scaling_policy:
      name: "{{ object_name[2] }}"
      state: "{{ policy_state[2] }}"
    register: output3

  - name: Auto Scaling Policy Failure 4
    ec2_scaling_policy:
      name: "{{ invalid_input[0] }}"
      state: "{{ invalid_input[1] }}"
    register: output4

  - name: Auto Scaling Policy Failure 5
    ec2_scaling_policy:
      name: "{{ invalid_input[2] }}"
      state: "{{ policy_state[0] }}"
    register: output5
