
---
- name: Test Include Pathing Issue
  hosts: localhost
  become: yes

  vars:
    path: "{{ playbook_dir }}/files"

  tasks:
    - name: Create non-existent directory
      file:
        path: "{{ path }}"
        state: directory

    - name: Create empty file
      file:
        path: "{{ path }}/empty"
        state: touch
      when: skip is undefined

    - name: Include non-existent file
      include: "{{ path }}/non-existent.yml"
      when: skip is undefined

    - name: Include empty file
      include: |
        {{ path }}/empty
      when: skip is undefined
