
- hosts: all
  connection: "lxd"

  tasks:
    - name: Check Python version in Gentoo container
      command: python --version
      register: python_version

    - name: Use python2.7 installed in Gentoo container
      command: "/usr/bin/python2.7 {{ item }}"
      with_items:
        - "-V"
        - "-c 'print(\"Hello, World!\")'"
        - "-c 'import os; print(os.uname())'"
        - "-c 'import subprocess; subprocess.call([\"ls\", \"/etc/\"])'"
      when: "'Python 2.7' in python_version.stdout"

    - name: Use default Python version in Gentoo container
      command: python {{ item }}
      with_items:
        - "-V"
        - "-c 'print(\"Hello, World!\")'"
        - "-c 'import os; print(os.uname())'"
        - "-c 'import subprocess; subprocess.call([\"ls\", \"/etc/\"])'"
      when: "'Python 3.4' in python_version.stdout"
