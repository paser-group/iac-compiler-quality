
- name: Win_DSC PSCredential conversion error for DSC module xFailoverCluster xCluster resource
  hosts: localhost
  gather_facts: no

  vars:
    my_password: "myPassword@123"
    my_user: "myUser"
    
  tasks:
    - name: Invoke-DscResource with invalid authentication
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present
          Credential: "{{ my_user }}:incorrect_password"
      register: result



    - name: Invoke-DscResource with missing parameter
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present
      register: result



    - name: Invoke-DscResource with empty parameter value
      win_dsc:
          ResourceName: ''
          ModuleName: ''
          Ensure: present
      register: result



    - name: Invoke-DscResource with malformed specifier
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present>>>
      register: result



    - name: Invoke-DscResource with non-existent specifier
      win_dsc:
          ResourceName: xCluster
          ModuleName: xMyNonExistentModule
          Ensure: present
      register: result



    - name: Invoke-DscResource with unexpected data types for the parameters
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present
          Credential: "{{ my_user }}:{{ my_password }}"
          ClusterName: 12345
          StaticIPAddress: "WrongInputIp"
          NoAccessPorts: "29,Error"
          RestartTimeout: "1/2"
      register: result



    - name: Invoke-DscResource with additional parameters
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present
          AdditionalPara: "This should fail"
      register: result



    - name: Invoke-DscResource with extra spaces in parameters
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present
          Credential: "{{ my_user }}: {{my_password}} "
          ClusterName:  Abcd 
          StaticIPAddress: 1.2.3.4
      register: result



    - name: Invoke-DscResource with a complex parameter
      win_dsc:
          ResourceName: xCluster
          ModuleName: xFailoverCluster
          Ensure: present"
          ClusterName: "{{ join('=', list(range(5))) }}"
      register: result
