
- name: Test get_url module with password protected FTP site
  hosts: localhost
  
  tasks:
    - name: Download file from FTP site via get_url module
      get_url:
        url: "ftp://ftp.example.com/path/to/file.txt"
        dest: "{{ ansible_env.HOME }}/Downloads/file.txt"
        mode: 0440
        validate_certs: no
        ftp_user: "username"
        ftp_password: "password"
      register: download_file

    - debug:
        var: download_file

    - name: Download file from wrong server and directory
      get_url:
        url: "ftp://ftp.example2.com/path/to/file.txt"
        dest: "{{ ansible_env.HOME }}/Downloads/wrong_directory/file.txt"
        mode: 0666
        validate_certs: no
        ftp_user: "wrong_user"
        ftp_password: "wrong_password"
      ignore_errors: yes

    - name: Download file with wrong permissions
      get_url:
        url: "ftp://ftp.example.com/path/to/file.txt"
        dest: "{{ ansible_env.HOME }}/Downloads/wrong_file_permissions.txt"
        mode: 0500
        validate_certs: no
        ftp_user: "username"
        ftp_password: "password"
      ignore_errors: yes

    - name: Download file to non-existing directory
      get_url:
        url: "ftp://ftp.example.com/path/to/file.txt"
        dest: "{{ ansible_env.HOME }}/Downloads/non_existing_folder/file.txt"
        mode: 0644
        validate_certs: no
        ftp_user: "username"
        ftp_password: "password"
      ignore_errors: yes
