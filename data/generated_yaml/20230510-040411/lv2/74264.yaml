
# Generate a symmetric encryption key and store it in a file
- name: Generate encryption key
  command: openssl rand -base64 32 > encryption.key

# Create a new vault without a file name
- name: Create vault without file name
  ansible-vault:
    vault_password_file: "{{ vault_password_file }}"
    decrypt: no
    encrypt: yes
    content: |
      This is a secret.

# Attempt to create a vault with too few arguments
- name: Create vault with too few arguments
  ansible-vault:
    vault_password_file: "{{ vault_password_file }}"
    decrypt: no
    encrypt: yes
    content: |
      This is a secret.
  args:
    argv:
      - create

# Create a new vault with a file name
- name: Create vault with file name
  ansible-vault:
    vault_password_file: "{{ vault_password_file }}"
    decrypt: no
    encrypt: yes
    content: |
      This is a secret.
  args:
    argv:
      - create
      - vault.yml

# Create a new vault with an unconventional file extension
- name: Create vault with unconventional file extension
  ansible-vault:
    vault_password_file: "{{ vault_password_file }}"
    decrypt: no
    encrypt: yes
    content: |
      This is a secret.
  args:
    argv:
      - create
      - vault.dat

# Create a new vault with an unexpected input
- name: Create vault with unexpected input
  ansible-vault:
    vault_password_file: "{{ vault_password_file }}"
    decrypt: no
    encrypt: yes
    content: |
      {{ 2 + 2 }}
  args:
    argv:
      - create
      - vault.yml
