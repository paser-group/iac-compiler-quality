
- hosts: localhost
  vars:
    vm_name: "{{ ['vm1', 'vm2', null, false, {'name': 'vm3'}] | random }}"
  tasks:
  - name: Create virtual machine
    azure_rm_virtualmachine:
      resource_group: "{{ ['rg1', 'rg2', 'rg3', null, false, {'name': 'rg4'}] | random }}"
      name: "{{ vm_name }}"
      image:
        offer: "{{ ['offer1', 'offer2', {'name': 'offer3'}] | random }}"
        publisher: "{{ ['pub1', 'pub2', null, false, {'name': 'pub3'}] | random }}"
        sku: "{{ ['sku1', {'name': 'sku2'}] | random }}"
      admin_username: "{{ ['user1', 'user2', null, false, {'name': 'user3'}] | random }}"
      admin_password: "{{ ['pass1', 'pass2', null, false, {'name': 'pass3'}] | random }}"
      location: "{{ ['eastus', 'westus', 'northeurope', null, false, {'name': 'westeurope'}] | random }}"
      hardware_profile:
        vm_size: "{{ ['Standard_DS1_v2', 'Standard_F2s_v2', 'Standard_NC6', null, false, {'name': 'Standard_E32_v3'}] | random }}"
    delegate_to: localhost
    register: result

  - debug: var=result
