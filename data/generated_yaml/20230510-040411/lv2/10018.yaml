
---
# Playbook to test inventory group variable resolution issues
- name: Test inventory group variable resolution
  hosts: localhost

  # Define a fake inventory with group variables
  vars:
    mygroup_var: 'mygroupvalue'

  tasks:
    - name: Test inventory group variable resolution
      delegate_to: localhost
      template: "{{ 'template_' + (groups['mygroup'] | first | default('no_group')) }}"
      with_items:
        - "{{ groups['mygroup'] }}"
      vars:
        mygroup_var: "{{ 'overridden' }}"
        
    - name: Display the inventory group variable value in the template file
      debug:
        var: mygroup_var
