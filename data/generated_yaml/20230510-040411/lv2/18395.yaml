
- name: Test playbook for importing YAML file via include_vars
  hosts: localhost
  vars:
    test_var: "{{ lookup('file', 'test_var.yml') }}"
    
  tasks:
  - name: Include YAML file without filename
    include_vars:
      name: "{{ test_var }}"
      no_errors: true
      
  - name: Include YAML file with invalid filename
    include_vars: "{{ nonexistent_file }}"  # generates undefined variable error
      
  - name: Include YAML file with path traversal
    include_vars: "../../../../../../etc/passwd"
      
  - name: Include YAML file with invalid YAML syntax
    include_vars:
      name: "{{ lookup('file', 'invalid_yaml.yml') }}"
      
  - name: Include YAML file with malicious code
    include_vars:
      name: "{{ lookup('file', 'malicious_yaml.yml') }}"
