
- name: Test osx_defaults module
  hosts: localhost
  gather_facts: no
  
  vars:
    key: "{{ lookup('env', 'USER') }}"
  
  tasks:
    - name: Set macOS default (string)
      become: yes
      osx_defaults:
        domain: com.example
        key: "{{ key }}"
        value: "string_value"
  
    - name: Set macOS default (boolean)
      become: yes
      osx_defaults:
        domain: com.example
        key: "{{ key }}"
        value: yes
  
    - name: Set macOS default (integer)
      become: yes
      osx_defaults:
        domain: com.example
        key: "{{ key }}"
        value: 123456

    - name: Set macOS default (array)
      become: yes
      osx_defaults:
        domain: com.example
        key: "{{ key }}"
        value:
          - item1
          - item2
          - item3
   
    - name: Set macOS default with unconventional syntax
      become: yes
      osx_defaults:
        domain: !<!$#@$>!(@(*#&)$%^&{{ 'com.example' + '345' }}
        key: "{{ key }}"
        value: "{{ lookup('pipe', 'echo "complex value" | base64') }}"
  
    - name: Set macOS default with unexpected input
      become: yes
      osx_defaults:
        domain: com.example
        key: "{{ key }}"
        value: "{{ 1/0 }}"

