
- name: Test aws_secret lookup plugin with botocore version 2.8.3 from PPA
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Test with invalid secret id input
      debug:
        msg: "{{ lookup('aws_secret', 'aws_secret_access_key=MY_ACCESS_KEY aws_secret_id=INVALID_SECRET_ID', 'us-east-1') }}"
    - name: Test with invalid region input
      debug:
        msg: "{{ lookup('aws_secret', 'aws_secret_access_key=MY_ACCESS_KEY aws_secret_id=MY_SECRET_ID', 'invalid_region') }}"
    - name: Test with invalid botocore module version
      vars:
        botocore_version: '1.14.3'
      ansible_python_interpreter: "/usr/bin/python3.6"
      ansible_python_raw_interpreter: "/usr/bin/python3.6"
      shell: "pip install botocore=={{ botocore_version }}"
    - name: Test with valid input parameters
      debug:
        msg: "{{ lookup('aws_secret', 'aws_secret_access_key=MY_ACCESS_KEY aws_secret_id=MY_SECRET_ID') }}"
