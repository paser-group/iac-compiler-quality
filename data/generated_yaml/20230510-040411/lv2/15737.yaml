
- hosts: all
  become: yes
  gather_facts: no

  tasks:
    # Unconventional Syntax
    - name: Set Permissions
      win_acl:
        path: C:\Temp
        user: DOMAIN\USER
        rights:
          - 'execute_file:allow'
          - 'list_directory:allow'
        propagation: both
        child_dirs: true
        child_files: no

    # Edge Cases and Unexpected Inputs
    - name: Set Permissions Invalid Path
      win_acl:
        path: 'C:\Temp\\'
        user: DOMAIN\USER
        rights:
          - 'execute_file:allow'
          - 'list_directory:allow'
        propagation: both
        child_dirs: true
        child_files: no

    - name: Set Permissions Invalid User
      win_acl:
        path: C:\Temp
        user: 'DOMAIN\\USER\\'
        rights:
          - 'execute_file:allow'
          - 'list_directory:allow'
        propagation: both
        child_dirs: true
        child_files: no

    - name: Set Permissions Invalid Rights
      win_acl:
        path: C:\Temp
        user: DOMAIN\USER
        rights:
          - 'execute_file:invalid_right'
          - 'list_directory:allow'
        propagation: both
        child_dirs: true
        child_files: no

    - name: Set Permissions Invalid Propagation
      win_acl:
        path: C:\Temp
        user: DOMAIN\USER
        rights:
          - 'execute_file:allow'
          - 'list_directory:allow'
        propagation: 'invalid_propagation'
        child_dirs: true
        child_files: no

    - name: Set Permissions Invalid Child Directories
      win_acl:
        path: C:\Temp
        user: DOMAIN\USER
        rights:
          - 'execute_file:allow'
          - 'list_directory:allow'
        propagation: both
        child_dirs: 'invalid_child_directories'
        child_files: no

    - name: Set Permissions Invalid Child Files
      win_acl:
        path: C:\Temp
        user: DOMAIN\USER
        rights:
          - 'execute_file:allow'
          - 'list_directory:allow'
        propagation: both
        child_dirs: true
        child_files: 'invalid_child_files'
