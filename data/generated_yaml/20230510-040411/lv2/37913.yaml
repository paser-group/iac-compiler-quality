
- name: Test win_copy on different 'dest' paths
  hosts: localhost
  gather_facts: no

  vars:
    dest_paths:
      - "c:/"
      - "c:/temp"
      - "c:/temp/"

  tasks:
    - name: Create empty folder
      win_file:
        path: "c:/temp/testdir"
        state: directory
      register: result

    - name: Copy file to root dir
      win_copy:
        src: "testfile.txt"
        dest: "{{ dest_paths[0] }}"
      when: dest_paths[0] != "c:/"

    - name: Copy file to custom dir
      win_copy:
        src: "testfile.txt"
        dest: "{{ dest_paths[1] }}"
      when: dest_paths[1] != "c:/temp"

    - name: Copy file to custom dir with trailing slash
      win_copy:
        src: "testfile.txt"
        dest: "{{ dest_paths[2] }}"
      when: dest_paths[2] != "c:/temp/"
