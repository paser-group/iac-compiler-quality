
---
- name: Test s3_lifecycle module edge cases and unconventional syntaxes
  hosts: localhost
  tasks:
    - name: Configure s3_lifecycle with edge cases
      s3_lifecycle:
        bucket: test-bucket
        rules:
          - id: "test1"
            status: "Enabled"
            expiration:
              date: "{{ ansible_date_time.date }}"
              days: "30"
            filters:
              - prefix: ""
                tag: "testtag"
                and:
                  - prefix: "foo/bar/"
                    tag: "testtag2"
          - id: "test2"
            status: "Enabled"
            expiration:
              date: "{{ ansible_date_time.date }}"
              days: "30"
            non_existent_parameter: !jkm
