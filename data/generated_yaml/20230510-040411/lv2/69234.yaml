
- hosts: localhost
  become: yes
  vars:
    repo_name: "my-repo"
    pulp_directory: "/var/lib/pulp"
  tasks:

  # Add repo with add_export_distributor option set to true
  - name: Add repository with add_export_distributor set to true
    pulp_repo:
      name: "{{ repo_name }}"
      state: present
      add_export_distributor: true
      pulp_conf: "{{ pulp_directory }}/server.conf"

  # Query the repository created earlier
  - name: Query repository created earlier
    pulp_repo:
      name: "{{ repo_name }}"
      state: present
      pulp_conf: "{{ pulp_directory }}/server.conf"

  # Add repo with add_export_distributor option set to false
  - name: Add repository with add_export_distributor set to false
    pulp_repo:
      name: "{{ repo_name }}"
      state: present
      add_export_distributor: false
      pulp_conf: "{{ pulp_directory }}/server.conf"

  # Remove the repository using an unconventional format
  - name: Remove the repository using an unconventional format
    pulp_repo: "{{ 'state=' ~ 'absent' }}"
