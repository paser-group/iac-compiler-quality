
- name: Test playbook for win_command issue
  hosts: windows

  tasks:
    - name: Test win_command with spaces in args
      win_command: 'C:\Program Files (x86)\My Application\app.exe arg1 "arg 2"'

    - name: Test win_command with single quotes
      win_command: 'C:\Program Files (x86)\My Application\app.exe arg1 '\''arg2'\'''

    - name: Test win_command with double quotes
      win_command: "C:\Program Files (x86)\My Application\app.exe arg1 'arg2'"

    - name: Test win_command with no quotes
      win_command: C:\Program Files (x86)\My Application\app.exe arg1 arg2

    - name: Test win_command with special characters
      win_command: 'C:\Program Files (x86)\My Application\app.exe !@#$%^&*()+=-_\][{}|;:\'",.<>/?'

    - name: Test win_command with variables
      win_command: "{{ app_path }} arg1 'arg 2'"
      vars:
        app_path: "C:\Program Files (x86)\My Application\app.exe"
