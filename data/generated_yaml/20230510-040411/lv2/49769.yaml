
- name: Test aci_bd_subnet module
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Create BD with invalid subnet
      aci_bd_subnet:
        host: "{{ inventory_hostname }}"
        username: "{{ aci_username }}"
        password: "{{ aci_password }}"
        tenant: "{{ invalid_tenant }}"
        bd: "{{ valid_bd }}"
        cidr: "{{ invalid_cidr }}"
        mask: "{{ valid_mask }}"
        state: invalid
      register: result

    - name: Create BD with invalid state
      aci_bd_subnet:
        host: "{{ inventory_hostname }}"
        username: "{{ aci_username }}"
        password: "{{ aci_password }}"
        tenant: "{{ valid_tenant }}"
        bd: "{{ valid_bd }}"
        cidr: "{{ valid_cidr }}"
        mask: "{{ valid_mask }}"
        state: invalid_state
      ignore_errors: yes

    - name: Query BD subnet
      aci_bd_subnet:
        host: "{{ inventory_hostname }}"
        username: "{{ aci_username }}"
        password: "{{ aci_password }}"
        tenant: "{{ valid_tenant }}"
        bd: "{{ valid_bd }}"
        state: query
      register: result

    - name: Delete BD subnet
      aci_bd_subnet:
        host: "{{ inventory_hostname }}"
        username: "{{ aci_username }}"
        password: "{{ aci_password }}"
        tenant: "{{ valid_tenant }}"
        bd: "{{ valid_bd }}"
        cidr: "{{ valid_cidr }}"
        mask: "{{ valid_mask }}"
        state: absent
      register: result

    - name: Display result
      debug:
        var: result
