
- name: Fuzzing MySQL Dump
  hosts: localhost
  become: yes

  tasks:
    - name: Testing state=dump with invalid database name
      mysql_db:
        name: "{{ item }}"
        state: dump
        target: /tmp/dump.sql
      with_items:
        - ""
        - "nonexistent_db"
        - "@@"
        - "`echo vulnerable`"
      ignore_errors: yes

    - name: Testing state=dump with invalid target path
      mysql_db:
        name: test_db
        state: dump
        target: "/{{ item }}"
      with_items:
        - ""
        - "`!#/usr/sbin/sendmail -t`"

    - name: Testing state=dump with invalid login credentials
      mysql_db:
        name: test_db
        state: dump
        login_host: "{{ item }}"
        login_user: ""
        login_password: "{{ item }}"
        target: /tmp/dump.sql
      with_items:
        - ""
        - "www.example.com"
        - "`echo vulnerable`"

    - name: Testing state=dump with invalid query
      mysql_db:
        name: test_db
        state: dump
        query: "{{ item }}"
        target: /tmp/dump.sql
      with_items:
        - ""
        - "SELECT password FROM users;"
        - "`rm -rf /`"

    - name: Testing state=dump with various SQL injection attacks
      mysql_db:
        name: test_db
        state: dump
        target: /tmp/dump.sql
        query: "SELECT * FROM users WHERE id = {{ item }}"
      with_items:
        - "'1' or 1=1"
        - "'; DROP TABLE users; --"
        - "`whoami`"

