
- hosts: all
  gather_facts: no
  tasks:
  - name: Test SSH connection with private key
    ansible_connection: ssh
    ansible_ssh_private_key_file: "{{ playbook_dir }}/ssh-keys/missing_key.pem"
    shell: uptime
  - name: Test SSH connection with invalid key
    ansible_connection: ssh
    ansible_ssh_private_key_file: "{{ playbook_dir }}/ssh-keys/invalid_key.pem"
    shell: uptime
  - name: Test SSH connection with wrong passphrase
    ansible_connection: ssh
    ansible_ssh_private_key_file: "{{ playbook_dir }}/ssh-keys/invalid_passphrase-key.pem"
    shell: uptime
  - name: Test SSH connection with different port
    ansible_connection: ssh
    ansible_ssh_private_key_file: "{{ playbook_dir }}/ssh-keys/valid_key.pem"
    ansible_ssh_extra_args: "-p 2222"
    shell: uptime
  - name: Test SSH connection with proxy command
    ansible_connection: ssh
    ansible_ssh_private_key_file: "{{ playbook_dir }}/ssh-keys/valid_key.pem"
    ansible_ssh_common_args: "-o ProxyCommand='ssh -W %h:%p user@example.com'"
    shell: uptime
  - name: Test SSH connection with custom host key checking
    ansible_connection: ssh
    ansible_ssh_private_key_file: "{{ playbook_dir }}/ssh-keys/valid_key.pem"
    ansible_ssh_common_args: "-o StrictHostKeyChecking=no"
    shell: uptime
