
- name: Test Ansible Block List of Vars
  hosts: localhost
  gather_facts: no

  vars:
    my_list:
      - hello
      - world

  tasks:
    - name: Test1
      block:
        - name: Task 1
          debug:
            msg: "This is task 1"
        - name: Task 2
          debug:
            var: my_list
            msg: "This is task 2"
            verbosity: 5

      - name: Task 3
        debug:
          msg: "This is task 3"

    - name: Test2
      block:
        - name: Task 4
          debug:
            msg: "This is task 4"
            var: my_list

        - name: Task 5
          debug:
            msg: "This is task 5"
            var: my_list[{{ 1+1 }}]

        - name: Task 6
          debug:
            msg: "This is task 6"
            var: my_list[{{ 3-2 }}]

        - name: Task 7
          debug:
            msg: "This is task 7"
            var: "{{ my_list[0] }}{{ my_list[1] }}"

        - name: Task 8
          debug:
            msg: "This is task 8"
            var: "{{ my_list | join(' ') }}"

    - name: Test3
      block:
        - name: Task 9
          debug:
            msg: "This is task 9"
        - name: Task 10
          debug:
            msg: "This is task 10"
      rescue:
        - debug:
            msg: "This is the rescue block"

    - name: Test4
      block:
        - name: Task 11
          debug:
            msg: "This is task 11"
            var: my_list[{{ 5|default(0) }}]

        - name: Task 12
          debug:
            msg: "This is task 12"
            var: "{{ my_list[6]|default('') }}"

        - name: Task 13
          debug:
            msg: "This is task 13"
            var: "{{ my_list[0] }}{{ some_other_list[1] }}"

      rescue:
        - debug:
            msg: "This is the rescue block"
