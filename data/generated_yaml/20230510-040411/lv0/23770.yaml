
from netmiko import ConnectHandler
import time

# Define device parameters
device = {
    'device_type': 'cisco_ios',
    'ip': '192.168.1.1',
    'username': 'admin',
    'password': 'password',
}

# Establish the connection to the device
connection = ConnectHandler(**device)

# Wait for the prompt to appear
while True:
    output = connection.read_channel()
    if '>' in output or '#' in output:
        break
    time.sleep(1)

# If there is an error, still wait for the prompt
if 'Error' in output:
    while True:
        output = connection.read_channel()
        if '>' in output or '#' in output:
            break
        time.sleep(1)

# Do something with the connection here
