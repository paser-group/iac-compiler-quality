
- hosts: localhost
  gather_facts: false
  vars:
    project_id: "my-gcp-project"
    auth_kind: "serviceaccount"
    service_account_file: "/path/to/service/account.json"
  tasks:
    - name: Authenticate with GCP API
      gcp_auth:
        project_id: "{{ project_id }}"
        auth_kind: "{{ auth_kind }}"
        service_account_file: "{{ service_account_file }}"
    
    - name: Gather instance facts
      gcp_compute_instance_facts:
        project: "{{ project_id }}"
      register: instance_facts

    - name: Print instance facts
      debug:
        var: instance_facts
