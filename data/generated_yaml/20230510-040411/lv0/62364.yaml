
import ansible.module_utils.network.os.neutron.neutron as neutron

def main():
  module = AnsibleModule(
    argument_spec=dict(
      ip_address=dict(required=True),
    ),
    supports_check_mode=True
  )

  client = neutron.NeutronModule(module)

  filters = {'fixed_ips.ip_address': module.params['ip_address']}

  ports = client.list_ports(retrieve_all=True, **filters)

  module.exit_json(ports=ports)

if __name__ == '__main__':
    main()
