
- name: Install packages with apt or yum
  become: true
  vars:
    package_list:
      - apt: ['nginx', 'python3-pip']
      - yum: ['httpd', 'mysql']
  tasks:
    - name: Install required packages
      loop: "{{ package_list }}"
      loop_control:
        label: "{{ item.keys() | first }}"
      # using a prefix for each module in the loop
      when: item.values() | list
      apt:
        name: "{{ item.apt }}"
      yum:
        name: "{{ item.yum }}"
