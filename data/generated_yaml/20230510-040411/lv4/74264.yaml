
---
- name: Test ansible-vault create without file name
  hosts: localhost
  tasks:
    - name: Attempt to create a vault without a file name
      command: ansible-vault create
      args:
        creates: "{{ vault_file }}"
      register: result
      ignore_errors: true

    - fail:
        msg: "Unexpected error: {{ result.stderr }}"
      when: result.rc != 2
