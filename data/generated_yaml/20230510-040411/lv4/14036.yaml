
- hosts: all
  gather_facts: no
  tasks:
    - name: Find files in playbook directory
      find:
        paths: "{{ playbook_dir }}"
        file_type: any
      register: found_files

    - name: Use with_fileglob to iterate over files
      set_fact:
        file_list: "{{ query('fileglob', item) }}"
      with_fileglob:
        - "{{ playbook_dir }}/files/*"
        - "{{ playbook_dir }}/templates/*"

    - name: Print file list
      debug:
        var: file_list
