
- name: Test idempotency of nxos_igmp_interface module with default values
  hosts: switches
  gather_facts: no
  
  vars:
    igmp_version: ""
    ip_address: ""
  
  tasks:
  - name: Set default values
    set_fact:
      igmp_version: ""
      ip_address: ""

  - name: Apply nxos_igmp_interface module
    nxos_igmp_interface:
      igmp_version: "{{ igmp_version }}"
      interface: Ethernet1/1
      ip_address: "{{ ip_address }}"
      state: present

  - name: Reapply nxos_igmp_interface module
    nxos_igmp_interface:
      igmp_version: "{{ igmp_version }}"
      interface: Ethernet1/1
      ip_address: "{{ ip_address }}"
      state: present
    register: result

  - name: Check idempotency
    assert:
      that: result is not changed
