
- name: Gather IOS Device Facts
  hosts: ios_devices
  gather_facts: no 

  vars:
    ios_version_required: "15+"
    ios_model_required: "2800"

  tasks:
    - name: Gather Facts for IOS Devices
      ios_facts:
        gather_subset: "!all"
      register: ios_device_facts
      when: 
        - ios_device_facts.ansible_net_version | version_compare(ios_version_required, ">=")
        - ios_device_facts.ansible_net_model | match(ios_model_required)

    - name: Retrieve Tunnel MAC and IP Address 
      debug: 
        var:
          - ios_device_facts.ansible_net_gather_subset_tunnels_tunnel0_description
