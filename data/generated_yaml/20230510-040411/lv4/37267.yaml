
- name: Test ELB modules on EC2 instances
  hosts: ec2_instances
  gather_facts: no
  
  tasks:
  - name: Registering instance with the target group or application load balancer
    elb_target_group:
      name: "my-target-group"    # replace with the actual target group name
      protocol: "HTTP"
      port: "80"
      targets:
        - id: "{{ inventory_hostname }}"
          port: "80"
    when: inventory_hostname in groups['ec2_instances']
  
  - name: Checking if instance is in target group or application load balancer
    elb_application_lb_facts:
      name: "my-application-lb"  # replace with the actual application load balancer name
      region: "us-west-2"
    when: inventory_hostname in groups['ec2_instances']
