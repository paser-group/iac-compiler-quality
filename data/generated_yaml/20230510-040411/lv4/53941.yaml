
- name: Deploy Docker Swarm Service
  hosts: swarm-manager
  become: true

  tasks:
    - name: Login to Docker Registry
      docker_login:
        username: "{{ docker_registry_username }}"
        password: "{{ docker_registry_password }}"
        registry_url: "{{ docker_registry_url }}"

    - name: Deploy Service
      docker_swarm_service:
        name: "{{ service_name }}"
        image: "{{ image_name }}"
        auth_email: "{{ docker_registry_email }}"
        resolve_image: yes
        replicas: "{{ service_replicas }}"
        state: "{{ service_state }}"
        env:
          "{{ service_environment }}"
        networks:
          - "{{ service_network }}"
