
- hosts: all
  tasks:
    - name: Refresh inventory from Non-EC2 source
      meta: refresh_inventory

    - name: Debug Inventory
      debug:
        var: hostvars

    # Using EC2 dynamic inventory
    - name: Refresh EC2 dynamic inventory
      meta: refresh_inventory
      when: inventory_hostname == groups['all'][0]

    - name: Debug EC2 Inventory
      debug:
        var: hostvars
      when: inventory_hostname == groups['all'][0]
