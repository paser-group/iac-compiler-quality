
- name: Test shell and command modules
  hosts: all
  tasks:
    - name: Invalid shell command
      shell: this_is_an_invalid_command
      register: output
      ignore_errors: true

    - name: Validate shell output
      fail:
        msg: "Shell module failed to give correct error message"
      when: '"MODULE FAILURE" not in output.stderr'

    - name: Invalid command
      command: this_is_also_an_invalid_command
      register: output
      ignore_errors: true

    - name: Validate command output
      fail:
        msg: "Command module failed to give correct error message"
      when: '"MODULE FAILURE" not in output.stderr'
