yaml
---
- name: Test playbook for removes option
  hosts: server
  gather_facts: false
  tasks:
    - name: Create temporary file
      command: touch /tmp/tempfile

    - name: Remove temporary file
      command: rm /tmp/tempfile
      removes: /tmp/tempfile

    - name: Check if file exists
      command: test -e /tmp/tempfile
      register: result
      ignore_errors: yes
      failed_when: result.rc == 0
