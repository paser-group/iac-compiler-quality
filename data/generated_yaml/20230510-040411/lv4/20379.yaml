
- name: Test Playbook for json_query filter bug
  hosts: localhost
  gather_facts: no
  vars:
    # Inventory containing a nested dictionary with values of different data types
    inventory:
      name: ansible
      children:
        group1:
          hosts:
            host1:
              nested_key:
                nested_value1: 1
                nested_value2: "two"
                nested_value3: true
                nested_value4:
                  - 1
                  - "two"
                  - true
    # Using json_query filter to extract a value from the nested dictionary and setting it to an unexpected data type
    extracted_value: "{{ inventory.group1.host1.nested_key | json_query('nested_value2') | int }}"
  tasks:
    - name: Print the extracted value
      debug:
        var: extracted_value
