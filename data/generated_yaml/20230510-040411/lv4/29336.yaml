
---
- name: Test lxc_container snapshot clone container creation
  hosts: localhost
  tasks:
  - name: create lxc_container origin container
    lxc_container:
      name: origin_container
      state: started
  - name: create lxc_container snapshot
    lxc_container:
      name: snapshot_container
      clone: true
      snapshot: true
      original_name: origin_container
  - name: check lxc_container state
    command: lxc-ls -f | grep -w origin_container | awk '{print $3}'
    register: origin_container_state
  - name: check lxc_container state
    assert:
     that:
      - origin_container_state.stdout == 'STOPPED'
      - origin_container_state.rc == 0
