
---
- hosts: localhost
  vars:
    container_name: my-container
    container_image: nginx
    container_state: present
  tasks:
    - name: Create a new container
      docker_container:
        name: "{{ container_name }}"
        image: "{{ container_image }}"
        state: "{{ container_state }}"
    - name: Start container and expose port 80
      docker_container:
        name: "{{ container_name }}"
        state: running
        published_ports: "80:80"
    - name: Test environment variable
      docker_container:
        name: "{{ container_name }}"
        envvars:
          FOO: bar
    - name: Stop the container
      docker_container:
        name: "{{ container_name }}"
        state: stopped
    - name: Remove the container
      docker_container:
        name: "{{ container_name }}"
        state: absent
