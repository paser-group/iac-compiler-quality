
- name: Install .NET 3.5
  win_optional_feature:
    feature_name: NetFx3
    state: present
  register: netfx3_feature

- name: Verify .NET 3.5 installation
  win_shell: dism /online /get-featureinfo /featurename:NetFx3
  register: dism_output

- name: Fail if installation unsuccessful
  fail:
    msg: Installation unsuccessful
  when: "'State : Enabled' not in dism_output.stdout_lines"
