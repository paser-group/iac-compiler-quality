
---
- name: Ansible Playbook to address inventory_hostname resolution issue
  hosts: all
  tasks:
    - name: Install Azure CLI
      win_chocolatey:
        name: azure-cli
        state: present

    - name: Define inventory file
      copy:
        dest: /etc/ansible/hosts
        content: |
          [azure_dynamic]
          server1.example.com ansible_host=<ip_address_1>
          server2.example.com ansible_host=<ip_address_2>

    - name: Test inventory_hostname resolution
      debug:
        var: inventory_hostname

    - name: Verify Azure dynamic inventory authentication
      command: az ad signed-in-user show
