
- name: Test WinRM Connectionplugin
  hosts: windows
  gather_facts: no

  vars:
    invalid_var: "{{ var_does_not_exist }}" # This creates a templating error

  tasks:
  - name: Ping Windows machine
    win_ping:

  - name: Test WinRM Connectionplugin with invalid variable in hostvars
    win_shell: echo "Hello, World!"
    connection: winrm
    delegate_to: localhost
    vars:
      ansible_connection: winrm
      ansible_winrm_server_cert_validation: ignore
