yaml
- name: Playbook for testing nxos_vtp_password idempotence
  hosts: switches
  gather_facts: no

  tasks:
    - name: Set vtp password
      nxos_vtp_password:
        password: "{{ vtp_password }}"
        state: present

    - name: Remove vtp password using nxos_vtp_password module
      nxos_vtp_password:
        state: absent

    - name: Run the task again
      nxos_vtp_password:
        state: absent

    - name: Check the differences between the two outputs
      shell: diff /tmp/first-output /tmp/second-output
      register: output

    - name: Print the output
      debug:
        var: output.stdout
