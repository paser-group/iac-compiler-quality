
---
- hosts: localhost
  gather_facts: no
  
  tasks:
  - name: create VM from template with disk options
    vmware_guest:
      hostname: "{{ vcenter_ip }}"
      username: "{{ vcenter_user }}"
      password: "{{ vcenter_password }}"
      datacenter: "{{ datacenter_name }}"
      folder: "{{ folder_name }}"
      name: "{{ vm_name }}"
      template: "{{ template_name }}"
      disk:
      - size_gb: "{{ disk_size_gb }}"
        type: "{{ disk_type }}"
        datastore: "{{ datastore_name }}"
      hardware:
        memory_mb: "{{ memory_mb }}"
        num_cpus: "{{ num_cpus }}"
        scsi: paravirtual
        guest_id: "{{ guest_os }}"
    delegate_to: localhost
    register: vmware_output

  - debug:
      var: vmware_output
