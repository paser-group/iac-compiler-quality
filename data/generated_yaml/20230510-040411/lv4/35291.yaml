
---
- hosts: localhost
  become: yes

  tasks:

  - name: Create a non-existing user
    user:
      name: non_existing_user
      state: present
    register: user_created

  - name: Delete the non-existing user
    user:
      name: non_existing_user
      state: absent
    register: user_deleted

  - name: Modify the non-existing user
    user:
      name: non_existing_user
      uid: 1501
      shell: /bin/bash
    register: user_modified

  - name: Confirm user is not created
    debug:
      var: user_created.changed
    when: user_created is defined

  - name: Confirm user is deleted
    debug:
      var: user_deleted.changed
    when: user_deleted is defined

  - name: Confirm user is not modified
    debug:
      var: user_modified.changed
    when: user_modified is defined

