
- hosts: all
  gather_facts: no
  vars:
    ansible_failed_task: "{{ my_failed_task }}"
  tasks:
    - block:
        - name: Loop task 1
          debug:
            msg: "loop task 1"
        - name: Loop task 2
          debug:
            msg: "loop task 2"
        - name: Loop task 3
          debug:
            msg: "loop task 3"
      rescue:
        - name: Handle the error
          debug:
            msg: "Error handled"
  loop:
    - "{{ non_existing_var }}"
    - "{{ 1/0 }}"
