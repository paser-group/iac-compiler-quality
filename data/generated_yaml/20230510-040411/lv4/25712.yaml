
- hosts: localhost
  tasks:
    - name: Testing host_group_vars with CSV file
      hosts: all
      gather_facts: no
      vars:
        temp_file_path: "/tmp/test.csv"
      gather_facts: no
      copy:
        content: |
          this,is,a,test
          1,2,3
        dest: "{{temp_file_path}}"
      set_fact:
        group_vars: "{{ lookup('host_group_vars', temp_file_path) }}"
      assert:
        that:
          - "'1' in group_vars.keys()"
        fail_msg: "CSV file not parsed correctly"
        success_msg: "CSV file parsed successfully"
