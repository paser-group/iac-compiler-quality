
class A:
    pass

class B(A):
    pass

class C(B):
    pass

class D(C):
    pass

def instance_check(obj, cls):
    if not getattr(obj.__class__, '__module__', None):
        __import__('__main__').__dict__.update({
            c.__name__: c for c in obj.__class__.mro()[::-1] if '.' not in c.__module__
        })
    return isinstance(obj, cls)
