
- name: Test nxos_facts using nxapi transport
  hosts: nxos_device
  vars:
    ansible_connection: nxapi
  tasks:
    - name: Gather nxos_facts
      nxos_facts:
      register: nxos_facts_nxapi

    - name: Debug nxos_facts using nxapi
      debug:
        var: nxos_facts_nxapi

    - name: Assert nxos_facts using nxapi
      assert:
        that:
          - "'ansible_net_system' in nxos_facts_nxapi['ansible_facts']"
          - "'ansible_net_version' in nxos_facts_nxapi['ansible_facts']"

- name: Test nxos_facts using cli transport
  hosts: nxos_device
  vars:
    ansible_connection: cli
  tasks:
    - name: Gather nxos_facts
      nxos_facts:
      register: nxos_facts_cli

    - name: Debug nxos_facts using cli
      debug:
        var: nxos_facts_cli

    - name: Assert nxos_facts using cli
      assert:
        that:
          - "'ansible_net_system' in nxos_facts_cli['ansible_facts']"
          - "'ansible_net_version' in nxos_facts_cli['ansible_facts']"
