
- name: Test Ansible compiler for dictionary inconsistencies
  hosts: localhost
  tasks:
    - name: Module 1 with dict input
      module1:
        var_dict: {key1: value1, key2: value2}
      register: out1
    - name: Module 2 with dict input
      module2:
        var_dict: {key1: value1, key2: value2}
      register: out2
    - name: Module 3 with dict input
      module3:
        var_dict: {key1: value1, key2: value2}
      register: out3
    
    - name: Check for dictionary inconsistencies
      block:
        - fail:
            msg: "{{item.module}} returned an error message"
          when: item.stderr_lines is defined
        loop:
          - {module: 'Module 1', stderr_lines: out1.stderr_lines}
          - {module: 'Module 2', stderr_lines: out2.stderr_lines}
          - {module: 'Module 3', stderr_lines: out3.stderr_lines}
