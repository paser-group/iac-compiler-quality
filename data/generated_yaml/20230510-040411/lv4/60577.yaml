
- name: Gather GCE instance facts
  hosts: localhost
  gather_facts: false
  vars:
    gce_instance_filters:
      - name: "instance-name"
        op: "EQUALS"
        value: "my-instance"
  tasks:
    - name: Gather instance facts
      gcp_compute_instance_facts:
        project: my-project
        auth_kind: serviceaccount
        service_account_file: /path/to/service/account.json
        filters: "{{ gce_instance_filters }}"
      register: instance_facts

    - name: Debug if google-auth errors
      debug:
        var: instance_facts
      when: instance_facts is not defined
