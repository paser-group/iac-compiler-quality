
- hosts: localhost
  tasks:
    - name: Set Fact ansible_virtualization_type
      set_fact:
        virt_type: "{{ ansible_virtualization_type }}"
      register: virt_type_fact

    - name: Verify fact ansible_virtualization_type
      fail:
        msg: "ansible_virtualization_type '{{ virt_type_fact.ansible_facts.ansible_virtualization_type }}' incorrect for alpine container on GitHub runner 'ubuntu-latest'"
      when: "(virt_type_fact.ansible_facts.ansible_distro == 'Alpine') and (virt_type_fact.ansible_facts.ansible_virtualization_type != 'docker') and (ansible_runner_name == 'ubuntu-latest')"
