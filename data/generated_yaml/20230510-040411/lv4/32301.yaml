
- name: Test Python 3.6 compatibility with Ansible Galaxy
  hosts: localhost
  gather_facts: no
  vars:
    python_version: "3.6"

  tasks:
    - name: Install Python 3.6 and Ansible Galaxy
      become: true
      apt:
        name: ["python3.6", "python3.6-dev", "python3-pip"]
      environment: 
        PATH: "/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
      pip:
        name: "ansible-galaxy"

    - name: Test Ansible Galaxy with Python 3.6
      command: ansible-galaxy init test_galaxy
      register: output
      failed_when: false

    - name: Check for errors
      fail:
        msg: "Ansible Galaxy initialization failed with Python 3.6"
      when: "'ERROR' in output.stdout_lines"
