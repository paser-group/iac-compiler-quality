
- hosts: switches
  gather_facts: False
  
  tasks:
    - name: Test nxos_reboot module error handling for CLI
      nxos_reboot:
        provider: "{{ cli }}"
        reboot_timeout: 60
      register: result

    - name: Fail if the module returns with an unexpected status
      fail:
        msg: "{{ result }}"
      when: result.status != "expected_status_code"

    - name: Test nxos_reboot module error handling for NXAPI
      nxos_reboot:
        provider: "{{ nxapi }}"
        reboot_timeout: 60 
      register: result

    - name: Fail if the module returns with an unexpected status
      fail:
        msg: "{{ result }}"
      when: result.status != "expected_status_code"

    - name: Test data serialization
      nxos_reboot:
        provider: "{{ nxapi }}"
        data: "{{ large_malformed_payload }}"
      register: result

    - name: Fail if the module returns with an unexpected status
      fail:
        msg: "{{ result }}"
      when: result.status != "expected_status_code"
