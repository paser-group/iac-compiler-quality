
- name: Check service status
  hosts: <target_hosts>
  tasks:
    - name: Get service facts
      service_facts:
        gather_timeout: 10
      register: service_status

    - name: Query actual service status
      systemd:
        name: <service_name>
        state: "status"
      register: actual_status

    - name: Print service status
      debug:
        var: service_status["ansible_facts"]["services"]["<service_name>"]["state"]

    - name: Compare service status
      assert:
        that: service_status["ansible_facts"]["services"]["<service_name>"]["state"] == actual_status["status"]
        success_msg: "Service status matches"
        fail_msg: "Service status does not match"
