
---
- name: Playbook to test handling of curly braces in extra-vars JSON objects
  hosts: localhost
  gather_facts: no
  vars:
    sample_json: {"name":{"first":"Tom","last":"Jones"},"age":"32","contact":{"email":"tom.jones@example.com","phone":{"home":"111-111-1111","work":"222-222-2222"}},"address":{"street":"123 Main St.","city":"Anytown","zip":"12345"}}
    my_variable: "{{ sample_json['contact']['phone'] }}"
  tasks:
  - name: Test if json_query can properly validate JSON with nested curly braces
    debug:
      var: sample_json | json_query('contact.phone')
  - name: Test if variable with curly braces can be handled
    debug:
      var: my_variable
  - name: Test if set_fact can properly parse JSON with nested curly braces
    set_fact:
      my_fact: "{{ sample_json['contact']['phone'] }}"
  - name: Print the Ansible internal data structure for the JSON with nested curly braces
    debug:
      var: my_fact
