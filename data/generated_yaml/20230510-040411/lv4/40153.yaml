
---
- name: Remove Default VPC
  hosts: localhost
  vars:
    region: us-east-1
  tasks:
    - name: Gather VPC Facts
      ec2_vpc_net_facts:
        filters:
          "default-vpc": true
        region: "{{ region }}"
      register: vpc_fact

    - name: Remove Default VPC
      ec2_vpc_net:
        name: "{{ vpc_fact['vpc_networks'][0]['id'] }}"
        state: absent
        region: "{{ region }}"
        wait: true
