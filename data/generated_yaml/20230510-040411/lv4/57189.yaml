
- name: Install package
  yum:
    name: "{{ item }}"
    state: "{{ state }}"
    update_cache: "{{ update_cache }}"
  register: result
  ignore_errors: true
  with_items: "{{ packages }}"

- name: 'Print debug message'
  debug:
    msg: "Task Failed."

- name: 'Pause Execution'
  pause:
    seconds: 5
  when: loop.last

- name: 'Fail Task'
  fail:
    msg: "Task Failed."
  when: result is failed
