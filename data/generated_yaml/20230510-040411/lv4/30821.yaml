
---
- name: Unarchive Module Bug Test
  hosts: localhost
  tasks:
    - name: Download archive file from URL
      get_url:
        url: https://example.com/archive.tar.gz
        dest: /tmp/archive.tar.gz
    - name: Unarchive archive file using unarchive module
      unarchive:
        src: /tmp/archive.tar.gz
        dest: /tmp/unarchived/
    - name: Check if file exists in expected location
      stat:
        path: /tmp/unarchived/file-to-check.txt
      register: file_check
    - name: Fail task if file not found
      fail:
        msg: "File not found in expected location"
      when: file_check.stat.exists == false
