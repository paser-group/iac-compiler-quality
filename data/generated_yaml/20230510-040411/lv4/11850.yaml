
- name: Test Shell module error handling
  hosts: all
  tasks:
    - name: Execute command that should fail with exit code 1
      shell: /path/to/command --invalid-argument
      register: command_output
      ignore_errors: true
    - assert:
        that:
          - command_output.rc == 1
      vars:
        error_msg: "Command did not return the expected error code"
