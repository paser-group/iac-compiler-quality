
- name: Get default IPv6 address fact
  debug:
    msg: "{{ ansible_default_ipv6.address }}"

- name: Get actual IPv6 address
  shell: ip -6 addr show | grep 'scope global' | awk '{print $2}' | cut -d '/' -f1
  register: actual_ipv6_address

- name: Compare default and actual IPv6 addresses
  fail:
    msg: "Default IPv6 address fact is incorrect"
  when: ansible_default_ipv6.address != actual_ipv6_address.stdout
