
- name: Playbook to uncover potential bugs in the nxos nxapi default port setting
  hosts: nexus_switch

  vars:
    use_ssl: true
    nxapi_port: 8888

  tasks:
    - name: Ensure nxapi_port is set to 443 if use_ssl is set to true
      set_fact:
        nxapi_port: 443
      when: use_ssl == true

    - name: Configure nxapi with the updated port
      nxos_nxapi:
        host: "{{ inventory_hostname }}"
        port: "{{ nxapi_port }}"
        use_ssl: "{{ use_ssl }}"
