
- hosts: all
  vars:
    - dynamic_set:
        - name: module1
          param1: value1
          param2: value2
        - name: module2
          param1: value3
          param2: value4
  tasks:
    - name: render template
      template:
        src: dynamic_set_template.j2
        dest: /tmp/output.txt
      loop: "{{ dynamic_set }}"
    - name: execute modules
      include_tasks: "{{ item.name }}.yml"
      loop: "{{ dynamic_set }}"
