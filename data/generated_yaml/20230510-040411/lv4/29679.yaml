
- name: Update AWS IAM username
  hosts: localhost
  vars:
    iam_user_name: "new_user_name"
    
  tasks:
  - name: Update IAM user
    iam_user:
      aws_access_key: "{{ aws_access_key }}"
      aws_secret_key: "{{ aws_secret_key }}"
      region: "{{ region }}"
      iam_username: "{{ iam_user_name }}"
      state: "present"
    register: user_updated
    
  - name: Debugging messages
    debug:
      var: user_updated
      
  - name: Verify IAM user is updated
    assert:
      that:
        - user_updated is defined
        - user_updated.state == "present"
        
