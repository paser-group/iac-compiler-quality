
- name: Test lineinfile edits
  hosts: localhost
  tasks:
    - name: Add line to file
      lineinfile:
        path: /tmp/test_file
        line: 'test line'
        create: true
        state: present
      register: line_changed
    - name: Check if line added successfully
      debug:
        msg: "Line added successfully"
      when: line_changed.changed == True
    - name: Report failure if line not added
      meta: end_play
      when: line_changed.changed == False
