
- name: Test SCP module with special characters
  hosts: remotehost
  gather_facts: no

  vars:
    local_filename: "{{ 'test file.txt' }}"
    remote_path: "/home/user"
    ssh_key: "{{ '/path/to/sshkey' }}"
    
  tasks:
    - name: Transfer a file to the remote machine using SCP module
      become: yes
      become_user: root
      scp: src={{ local_filename }} dest={{ remote_path }} key_file={{ ssh_key }}
      with_items:
        - "{{ 'test%name=^!$.txt' }}"
        - "{{ 'test file with space.txt' }}"
        - "{{ 'testfile' }}"
      register: scp_output

    - name: Display the output from SCP module
      debug:
        msg: "{{ scp_output }}"
