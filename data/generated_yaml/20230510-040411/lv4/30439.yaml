
- name: Test idempotence of nxos_igmp_snooping module
  hosts: switches
  gather_facts: no
  vars:
    igmp_snooping_value: <non-default-value>

  tasks:
  - name: Set igmp_snooping_value
    nxos_igmp_snooping:
      state: present
      global_snooping: "{{ igmp_snooping_value }}"

  - name: Display igmp_snooping_value for first time
    debug:
      var: ansible_facts.nxos.ansible_nxos_fact.nxos_igmp_snooping.global_snooping

  - name: Set igmp_snooping_value again
    nxos_igmp_snooping:
      state: present
      global_snooping: "{{ igmp_snooping_value }}"

  - name: Display igmp_snooping_value for second time
    debug:
      var: ansible_facts.nxos.ansible_nxos_fact.nxos_igmp_snooping.global_snooping
