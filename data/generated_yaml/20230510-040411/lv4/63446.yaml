
- name: Execute command on remote host
  hosts: all
  tasks:
    - name: Test for command injection vulnerability
      command: echo {{ var }}
      vars:
        var: "hello; rm -rf /"
      register: result
      failed_when: "result.rc != 0 and 'rm -rf /' in result.stderr"

    - name: Test for race condition vulnerability
      command: touch /tmp/file && sleep 1 && echo "test" >> /tmp/file
