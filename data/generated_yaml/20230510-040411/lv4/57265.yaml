
- name: Detecting bugs in gcp_container_cluster module
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Test gcp_container_cluster with missing zone
      gcp_container_cluster:
        name: my-cluster
        state: present
      ignore_errors: yes
      register: result
    - name: Check for Key Error
      fail:
        msg: "Potential Ansible Compiler bug found related to the gcp_container_cluster module and the 'zone' key"
      when: "'zone' in result.msg and result.failed"
