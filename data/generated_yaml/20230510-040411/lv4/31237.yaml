
- name: Deploy Azure ARM Template
  hosts: localhost
  connection: local

  tasks:
  - name: Check if resource group exists
    azure_rm_resourcegroup_info:
      name: non-existent-resource-group
    register: resource_group

  - name: Deploy ARM template
    azure_rm_deployment:
      resource_group_name: my-resource-group
      template: path/to/arm-template.json
      parameters:
        param1: value1
      state: present
    when: resource_group.exists | default(false) == true
