
---
- name: Playbook for testing custom library module resolution order
  hosts: localhost
  gather_facts: no
  vars:
    custom_var: "my_custom_variable_value"
  tasks:
    - name: Ensure custom library directory is added to module path
      pip:
        name: my_custom_library
        state: present
    - name: Test custom module by referencing it with incorrect syntax
      custom_library_module:
        my_custom_library_module_function:
          custom_var: "{{ custom_var }}"
          invalid_key: "invalid_value"
      ignore_errors: yes
    - name: Test custom module by referencing it with correct syntax
      custom_library_module:
        function: my_custom_library_module_function
        args:
          custom_var: "{{ custom_var }}"
          valid_key: "valid_value"
