
---
- hosts: all
  become: true
  
  tasks:
  - name: Configure haproxy backend servers
    haproxy_backend:
      name: backend_servers
      state: present
      mode: http
      balance_algorithm: roundrobin
      server_list:
        - name: server1
          address: 192.168.0.1
          port: 80
        - name: server2
          address: 192.168.0.2
          port: 80
      drain: true
      drain_time: 15
      purge: true
