
- hosts: localhost
  tasks:
  - name: create encrypted file
    command: echo "my secret" > test_file.txt && ansible-vault encrypt test_file.txt --vault-password-file=../vault_pass.txt
    args:
      chdir: /home/user/test

  - name: try to decrypt with invalid password file
    shell: ansible-vault view /home/user/test/test_file.txt --vault-password-file=../invalid_pass_file.txt
    args:
      chdir: /home/user/test
    ignore_errors: yes
