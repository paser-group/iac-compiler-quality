
- name: Test Vault interaction
  hosts: localhost
  vars:
    secret_key: "secret_key"
    bad_vault_password: "bad_password"
    good_vault_password: "correct_password"
  tasks:
    - name: Attempt to access Vault resource with incorrect password
      ansible.builtin.include_vars: vault_password="{{ bad_vault_password }}"
      ansible.builtin.debug:
        msg: "{{ lookup('hashi_vault', 'secret=secret/data/' ~ secret_key) }}"

    - name: Attempt to access Vault resource with correct password
      ansible.builtin.include_vars: vault_password="{{ good_vault_password }}"
      ansible.builtin.debug:
        msg: "{{ lookup('hashi_vault', 'secret=secret/data/' ~ secret_key) }}"
