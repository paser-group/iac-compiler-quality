
- name: Test Ansible YAML Parsing
  hosts: localhost
  gather_facts: no

  vars:
    file1: 'somefile.yml'
    file2: 'anotherfile.yml'

  tasks:
  - name: Copy test files
    copy:
      src: "{{ item }}"
      dest: /tmp/
    with_items:
    - "{{ file1 }}"
    - "{{ file2 }}"

  - name: Attempt to execute malicious code
    shell: cat /tmp/somefile.yml
    ignore_errors: true

  - name: Attempt to execute malicious code in another file
    shell: cat /tmp/anotherfile.yml
    ignore_errors: true

  - name: Clean up test files
    file:
      state: absent
      path: "/tmp/{{ item }}"
    with_items:
    - "{{ file1 }}"
    - "{{ file2 }}"
