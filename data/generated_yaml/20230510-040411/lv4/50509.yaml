
---
- name: Test Ansible Raw Module for Bugs
  hosts: all
  gather_facts: no

  tasks:
    - name: Test with simple shell command
      raw: ls -l
      register: result_simple

    - name: Test with command using pipes and quotes
      raw: "ps aux | grep 'python'"
      register: result_pipes

    - name: Test with command using variables
      raw: "{{ my_command }}"
      vars:
        my_command: "cat /etc/passwd"
      register: result_vars

    - name: Check if any errors occurred
      assert:
        that:
          - result_simple.rc == 0
          - result_pipes.rc == 0
          - result_vars.rc == 0
