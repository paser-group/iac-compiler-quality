
- name: Test ios_config module
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Apply invalid ios_config command
    ios_config:
      lines:
        - 'invalid command'
    ignore_errors: yes
    register: result

  - name: Debug ios_config error
    debug:
      var: result

  - name: Check ios_config error message
    assert:
      that:
        - 'invalid command' in result.stderr
      fail_msg: 'ios_config did not report a failure'
