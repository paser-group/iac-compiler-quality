
- hosts: localhost
  tasks:
    - name: Set queue-max-priority policy with priority value 5
      rabbitmq_policy:
        vhost: "/"
        name: queue-max-priority
        pattern: "^myqueue$"
        priority: 5
        definition: '{"max-priority":10}'
        state: present

    - name: Set queue-max-priority policy with priority value 10
      shell: rabbitmqctl set_policy -p / queue-max-priority "^myqueue$" '{"max-priority":10}' --priority 10

    - name: Set queue-max-priority policy with priority value 100
      shell: rabbitmqctl set_policy -p / queue-max-priority "^myqueue$" '{"max-priority":10}' --priority 100
