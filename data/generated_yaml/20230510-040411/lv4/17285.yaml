
- name: Kerberos Module Test
  hosts: all
  gather_facts: no

  tasks:
  
  - name: Authenticate with Kerberos
    become: yes
    kerberos_auth:
      krb5_principal: "client_principal_name@REALM"
      krb5_ccname: "/path/to/krb5cc_cache"
      user: "{{ ansible_user }}"
      password: "{{ ansible_become_password }}"
    ignore_errors: true
    register: kerberos_auth_result
    
  - name: Handle Kerberos module error
    fail:
      msg: "{{ kerberos_auth_result | to_nice_json }}"
    when: kerberos_auth_result.failed == true
