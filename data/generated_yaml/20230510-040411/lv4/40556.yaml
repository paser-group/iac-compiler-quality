
- name: Testing osx_defaults array_add bug
  hosts: localhost
  gather_facts: no
  vars:
    new_key: testKey
    array_value:
      - value1
      - value2
  tasks:
    - name: Set array to new key
      osx_defaults:
        domain: com.test
        key: "{{new_key}}"
        array_add: True
        value: "{{array_value}}"
      become: yes

    - name: Debug the type of value stored
      debug:
        var: ansible_osx_defaults."{{new_key}}"
