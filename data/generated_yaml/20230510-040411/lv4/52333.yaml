
- name: Test error handling
  hosts: localhost
  vars:
    valid_vpc_id: "vpc-123456789"
    valid_peer_vpc_id: "vpc-987654321"
  tasks:
  - name: Test error handling in ec2_vpc_peer
    ec2_vpc_peer:
      state: "{{ item.state }}"
      vpc_id: "{{ item.vpc_id }}"
      peer_vpc_id: "{{ item.peer_vpc_id }}"
    register: result
    with_items:
    - { state: "present", vpc_id: valid_vpc_id, peer_vpc_id: valid_peer_vpc_id }
    - { state: "invalid", vpc_id: valid_vpc_id, peer_vpc_id: valid_peer_vpc_id }
    - { state: "present", vpc_id: "invalid-vpc-id", peer_vpc_id: valid_peer_vpc_id }
    - { state: "present", vpc_id: valid_vpc_id, peer_vpc_id: "invalid-peer-vpc-id" }
  - debug:
      msg: "{{ result }}"
