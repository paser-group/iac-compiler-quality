
---
- name: Test S3 multipart object download with destination folder
  hosts: localhost
  become: yes
  vars:
    bucket: your-bucket-name
    multipart_upload_key: s3/object.key
    dest: /path/to/destination/folder
  tasks:
    - name: Download S3 object (multipart) with destination folder
      s3:
        bucket: "{{bucket}}"
        object: "{{multipart_upload_key}}"
        dest: "{{dest}}"
        mode: get
        # Set below variables to trigger potential issues while downloading multipart objects
        retry_timeout: 0
        max_retry_delay: 0
        wait: no
      register: s3_result
    - name: Print error message
      failed_when: true
      debug:
        var: s3_result
