
- name: Test privilege escalation and password prompts
  hosts: servers

  tasks:
    - name: Test sudo command privilege escalation
      command: whoami
      become: yes
      become_method: sudo
      register: cmd_output_sudo

    - name: Test sudo command with invalid password prompt
      command: whoami
      become: yes
      become_method: sudo
      become_password: InvalidPassword
      ignore_errors: true
      register: cmd_output_invalid_password

    - name: Test become command privilege escalation
      command: whoami
      become: yes
      become_method: become
      become_exe: sudo
      register: cmd_output_become

    - name: Test become command with no password prompt
      command: whoami
      become: yes
      become_method: become
      become_exe: sudo
      become_flags: "-n"
      ignore_errors: true
      register: cmd_output_no_password
