
---
- name: Testing block/always/rescue bug with any_errors_fatal inside include_role
  hosts: all
  become: yes

  tasks:
    - name: Testing any_errors_fatal flag with include_role
      block:
        - name: Test include_role with any_errors_fatal flag
          include_role:
            name: myrole
          any_errors_fatal: true
          
        - name: Test always block executes even if the previous block fails
          always:
            - debug:
                msg: 'The included role failed, but this block must always execute.'
          
      rescue:
        - name: Test block fails and rescue block gets executed
          debug:
            msg: 'The block failed and this rescue block must execute.'
