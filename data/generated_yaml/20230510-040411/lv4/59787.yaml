
---
- name: Discover potential bugs in Ansible Compiler related to iam_password_policy ignoring group/aws
  hosts: localhost
  connection: local
  
  tasks:
  - name: Get default IAM Password Policy
    iam_password_policy:
      region: us-east-1
    register: default_policy
    
  - name: Display default IAM Password Policy
    debug: var=default_policy
    
  - name: Override group/aws variables
    set_fact:
      aws_password_policy: >
                           {
                              "MinimumPasswordLength": 8,
                              "RequireSymbols": true,
                              "RequireNumbers": true,
                              "RequireUppercaseCharacters": true,
                              "RequireLowercaseCharacters": true
                           }
  - name: Get IAM Password Policy with overridden variables
    iam_password_policy:
      region: us-east-1
      policy: "{{ aws_password_policy }}"
    register: policy_with_overridden_variables
    
  - name: Display IAM Password Policy with overridden variables
    debug: var=policy_with_overridden_variables
