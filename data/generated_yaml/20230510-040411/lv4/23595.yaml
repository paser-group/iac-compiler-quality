
- name: Retrieve EC2 metadata
  ec2_facts:
  register: ec2_instance

- name: Check metadata types
  assert:
    that:
      - ec2_instance!=None
      - ec2_instance["instance_id"] is string
      - ec2_instance["private_ip"] is string
      - ec2_instance["public_ip"] is string
      - ec2_instance["vpc_id"] is string
      - ec2_instance["ami_launch_index"] is int
      - ec2_instance["block_device_mapping"] is list
      - ec2_instance["ebs_optimized"] is boolean
      - ec2_instance["root_device_type"] is string
      - ec2_instance["root_device_name"] is string
      - ec2_instance["hypervisor"] is string
      - ec2_instance["virt_type"] is string
      - ec2_instance["architecture"] is string
      - ec2_instance["kernel_id"] is string
      - ec2_instance["ramdisk_id"] is string
  fail_msg: "The metadata types are not as expected :: {{ec2_instance}}"
