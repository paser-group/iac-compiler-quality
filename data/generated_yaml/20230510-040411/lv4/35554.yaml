
---
- name: Simulating VLAN Interface Assignment Bug
  hosts: switch

  vars:
    vlan_id: 100
    num_interfaces: 7

  tasks:
    - name: Create VLAN
      ios_vlan:
        vlan_id: "{{ vlan_id }}"
        name: "vlan_{{ vlan_id }}"

    - name: Add Interfaces to VLAN
      ios_interface:
        name: "GigabitEthernet1/{{ item }}"
        switchport_mode: access
        switchport_access_vlan: "{{ vlan_id }}"
      loop: "{{ range(num_interfaces) | list }}"
