
- name: Test delegate_to with OpenSSH ssh client
  hosts: target
  gather_facts: no
  tasks:
     - name: Run hostname command on target machine
       delegate_to: "{{ inventory_hostname }}"
       become: true
       become_user: test_user
       shell: hostname

- name: Test delegate_to with PuTTY ssh client
  hosts: target
  gather_facts: no
  tasks:
     - name: Run hostname command on target machine
       delegate_to: "{{ inventory_hostname }}"
       become: true
       become_user: test_user
       shell: hostname
       environment:
         ANSIBLE_SSH_ARGS: "-o 'ProxyCommand C:/ProgramData/chocolatey/bin/nc.exe %h %p'"
