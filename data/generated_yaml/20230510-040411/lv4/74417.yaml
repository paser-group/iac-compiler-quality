
---
- name: Test reboot functionality
  hosts: target
  gather_facts: no
  tasks:
  - name: Disable verbose connection
    remote_user: ubuntu
    connection: ssh
    become: true
    become_method: sudo
    become_user: root

  - name: Reboot target machine
    remote_user: ubuntu
    become: true
    become_method: sudo
    become_user: root
    reboot:

  - name: Wait for connection after reboot
    remote_user: ubuntu
    become: true
    become_method: sudo
    become_user: root
    wait_for_connection:

  - name: Validate reboot
    remote_user: ubuntu
    become: true
    become_method: sudo
    become_user: root
    command: echo "Reboot successful"
