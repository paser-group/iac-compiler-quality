
- name: Test any_errors_fatal
  hosts: all
  vars:
      my_var: true   # Define a custom variable for testing purposes
  tasks:
    - block:
        - name: This task will not fail
          shell: echo "Success"
          
        - name: This task will always fail
          shell: /bin/false
        any_errors_fatal: true   # Set any_errors_fatal to true at the block level

    - name: This task will always fail
      command: /bin/false
      when: my_var == true
      any_errors_fatal: true     # Set any_errors_fatal based on a condition

    - name: This task will not fail
      debug: msg="Success"
      when: inventory_hostname in groups['group1'] 
      any_errors_fatal: true     # Set any_errors_fatal based on host patterns
