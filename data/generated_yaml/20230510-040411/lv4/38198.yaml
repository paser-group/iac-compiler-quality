
- name: Create Azure Security Group
  hosts: localhost
  connection: local
  vars:
    resource_group: my_resource_group
    security_group_name: my_security_group
    rule_name: allow_ip
    rule_priority: 100
    ip_prefixes: "10.0.0.1/24,10.0.1.0/24"
  tasks:
  - name: Create Security Group
    azure_rm_securitygroup:
      resource_group: "{{ resource_group }}"
      name: "{{ security_group_name }}"
      tags:
        environment: development
      rules:
        - name: "{{ rule_name }}"
          protocol: Tcp
          destination_port_range: "22,23,24"
          access: Allow
          priority: "{{ rule_priority }}"
          direction: Inbound
          source_address_prefix: "{{ ip_prefixes }}"
