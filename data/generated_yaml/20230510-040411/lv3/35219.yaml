
---
- name: Execute fact file with incorrect shebang
  hosts: all
  tasks:
    - name: Create fact file with incorrect shebang
      copy:
        dest: "/etc/ansible/facts.d/malicious_fact.fact"
        content: "#!/bin/nosuchinterpreter\n{ 'key': 'value' }"

    - name: Execute fact file
      setup:
        filter: "ansible_local"
