
---
- name: Inventory configuration
  hosts: all
  gather_facts: yes
  tasks:
  - name: Create a new VM
    virt:
      name: kubevirt-vm1
      memory: 2048
      vcpus: 2
      disks:
        - file: /var/lib/libvirt/images/kubevirt-vm1.qcow2
          size: 10G
      network:
        - network: default
          model: virtio
      state: running

- name: Assigning Role
  hosts: kubevirt-vm1
  gather_facts: yes
  tasks:
  - name: Set up the virtualization environment
    set_fact:
      ansible_virtualization_role: guest
