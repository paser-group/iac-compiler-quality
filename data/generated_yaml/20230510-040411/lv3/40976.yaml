
- name: azure_rm_keyvaultsecret - incorrect authentication?
  hosts: localhost
  gather_facts: no

  vars:
    azure_client_id: "<INSERT YOUR CLIENT ID HERE>"
    azure_secret: "<INSERT YOUR CLIENT SECRET HERE>"
    azure_tenant: "<INSERT YOUR TENANT ID HERE>"
    key_vault_name: "<INSERT YOUR KEY VAULT NAME HERE>" 
    secret_name: "<INSERT YOUR SECRET NAME HERE>" 

  tasks:
    - name: Create Secret
      azure_rm_keyvaultsecret:
        secret_name: "{{ secret_name }}"
        key_vault_uri: "https://{{ key_vault_name }}.vault.azure.net/"
        value: "MySecret"
        state: present
        client_id: "{{ azure_client_id }}"  
        client_secret: "{{ azure_secret }}" 
        tenant: "{{ azure_tenant }}" 
      register: secret_creations

    - name: Check for errors
      debug:
        var: secret_creations

