
---
- hosts: localhost
  gather_facts: no

  tasks:
  - name: Attempting to execute IAM policy
    aws_iam_policy:
      name: example-policy #name of the policy
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
              {
                  "Effect": "Allow",
                  "Action": [
                      "s3:ListAllMyBuckets"
                  ],
                  "Resource": "arn:aws:s3:::*"
              }
          ]
        } #dummy policy code
      region: us-east-1 #region of the AWS environment
      access_key: "{{ aws_access_key }}"
      secret_key: "{{ aws_secret_key }}"
    register: result

  - debug:
      var: result

