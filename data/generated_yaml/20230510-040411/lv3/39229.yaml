
---
- name: Fix enable mode issue in nx-os device
  hosts: nxos_device
  connection: local

  tasks:

  - name: Configure enable mode
    nxos_command:
      command_string: configure terminal
    register: output
    ignore_errors: true

  - name: Enter enable mode
    nxos_command:
      command_string: enable
    register: output
    ignore_errors: true

  - name: Configure interface
    nxos_command:
      command_string: interface Ethernet 1/1
    register: output
    ignore_errors: true

  - name: Exit to privilege EXEC mode
    nxos_command:
      command_string: exit
    register: output
    ignore_errors: true

  - name: Exit to user EXEC mode
    nxos_command:
      command_string: exit
    register: output
    ignore_errors: true

  - name: Display configuration
    nxos_command:
      command_string: show running-config interface Ethernet 1/1
    register: output

  - name: Verify the configuration is correct
    debug:
      var: output.stdout_lines
