
- name: Unzip a corrupt file using win_unzip
  hosts: my-windows-server
  gather_facts: no

  tasks:
    - name: Copy a corrupt zip file 
      copy:
        src: path/to/corrupt/file.zip
        dest: C:\Temp\file.zip

    - name: Unzip the corrupt file and set a failure flag
      win_unzip:
        src: C:\Temp\file.zip
        dest: C:\Temp\
      register: result
      failed_when: "'Failed to unzip file' not in result.stderr_lines"
