
---
- name: Playbook to reproduce Ansible issue
  hosts: all
  become: true
  tasks:
    
    - name: Start Docker container with published ports
      docker_container:
        name: my_container
        image: nginx
        published_ports: 80:127.0.0.1:80/tcp
        network_mode: bridge
        detach: true
        state: started
        
    - name: Wait for the container to start
      wait_for_connection:
        timeout: 30
        
    - name: Check if Nginx is accessible via container IP
      shell: curl 127.0.0.1:80
