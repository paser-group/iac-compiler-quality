
- name: Test Scoped Blocks and Role Default Variables
  hosts: localhost
  vars:
    foo: "global"
  roles:
    - test_role
  tasks:
    - name: Set Scoped Variable
      set_fact:
        foo: "scoped"
      vars:
        _orig_foo: "{{ foo }}"
      when: "'global' in foo"
      tags:
        - scoped
    - name: Debug Scoped Variable
      debug:
        var: foo
      when: "'global' in foo"
      tags:
        - debug
