
---
- name: Test Playbook to recreate pkgng hangs and missing error messages
  hosts: all
  tasks:
    - name: Install pkgng package manager
      package:
        name: pkg
        state: present

    - name: Add a valid repo for pkgng
      shell: 'pkg update'
      register: pkg_update_output
      failed_when: "pkg_update_output.rc not in [0]"

    - name: Add an invalid repo for pkgng
      shell: 'pkg update -g'
      register: pkg_update_output_2
      failed_when: "pkg_update_output_2.rc not in [0]"

    - name: Uninstall pkgng package manager
      package:
        name: pkg
        state: absent
