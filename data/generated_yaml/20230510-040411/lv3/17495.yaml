
---
- name: Test playbook to reproduce Docker-py version check issue
  hosts: localhost
  gather_facts: no
 
  tasks:
  - name: Install Docker-py
    pip: 
      name: docker-py
      state: latest
 
  - name: Check for Docker-py Version
    command: docker --version
    register: docker_version
    ignore_errors: true
 
  - name: Fail if Docker-py version < 1.7
    fail:
      msg: "Docker-py version is outdated. Please update to version 1.7 or newer"
    when: docker_version.rc == 0 and docker_version.stdout.find('1.7') == -1
