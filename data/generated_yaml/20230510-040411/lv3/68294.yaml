
---
- name: EC2 inventory playbook
  hosts: ec2_hosts
  gather_facts: true
  connection: local
  vars_files:
    - secrets.yaml
  tasks:
    - name: Configure EC2 inventory plugin
      ec2_instance_facts:
        region: "{{ec2_region}}"
        filters:
          instance-state-name: running
      register: ec2
