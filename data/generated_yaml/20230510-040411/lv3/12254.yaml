
- hosts: localhost
  tasks:
    - name: Run long-running process with async
      async: 60
      poll: 0
      register: result
      command: sleep 300

    - name: Wait for long-running process to complete
      async_status: "{{ result.ansible_job_id }}"
      until: result.finished
      retries: 30
      delay: 10
      with_items:
        - item1
        - item2
        - item3
      ignore_errors: yes
