
- name: Test playbook for acl module
  hosts: localhost

  tasks:
  - name: Create a file named /tmp/testfile
    file:
      path: /tmp/testfile
      state: touch

  - name: Setting default ACL on /tmp/testfile
    acl:
      path: /tmp/testfile
      entity: everyone
      type: mask
      rights: read, write
      default: yes

  - name: Remove the entity's ACL on /tmp/testfile
    acl:
      path: /tmp/testfile
      entity: everyone
      state: absent
      default: yes

  - name: Verify whether the ACL module removes all default entries
    command: getfacl /tmp/testfile

  handlers:
  - name: Delete /tmp/testfile
    file:
      path: /tmp/testfile
      state: absent
