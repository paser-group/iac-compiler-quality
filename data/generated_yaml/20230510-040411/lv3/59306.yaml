
---
- name: Asynchronous Tasks Fuzzing
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Run async task 1
      async: 100
      poll: 1
      shell: "echo 'running async task 1'"

    - name: Run async task 2
      async: 100
      poll: 1
      shell: "echo 'running async task 2'"

    - name: Run async task 3
      async: 100
      poll: 1
      shell: "echo 'running async task 3'"

    - name: Wait for all tasks to complete
      async_status:
        jid: "{{ item.ansible_job_id }}"
      with_items:
        - "{{ ansible_jobs }}"

    - name: Done
      debug: 
        msg: "All tasks completed successfully."
