
- name: Create and run a shortcut
  hosts: windows
  gather_facts: no
  tasks:
    - name: Create a shortcut
      win_shortcut:
        src: C:\Program Files\Internet Explorer\iexplore.exe
        dest: C:\Users\Public\Desktop\Internet Explorer.lnk
        description: 'Internet Explorer'
    - name: Run the shortcut
      win_command: 'start /d "C:\Program Files\Internet Explorer" iexplore.exe'
    - name: Check if the shortcut exists
      win_stat:
        path: C:\Users\Public\Desktop\Internet Explorer.lnk
      register: shortcut
    - name: Recreate the shortcut if it is missing
      win_shortcut:
        src: C:\Program Files\Internet Explorer\iexplore.exe
        dest: C:\Users\Public\Desktop\Internet Explorer.lnk
        description: 'Internet Explorer'
      when: not shortcut.stat.exists
