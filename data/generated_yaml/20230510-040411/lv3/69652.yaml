
- name: Assign Fixed IP address to Openstack instance using os_server
  hosts: localhost
  tasks:
  - name: Create a new instance
    os_server:
      name: test-instance
      flavor: 2
      image: "{{ image_id }}"
      state: present

  - name: Assign a fixed IP address to the instance
    os_floating_ip:
      server: test-instance
      floating_ip_address: 10.0.0.2
      state: present
    register: floating_ip

  - name: Assign the private IP address to the instance
    os_server:
      server: test-instance
      fixed_ip: "{{ floating_ip.private_ip }}"
      state: present

  - name: Print the Fixed IP address of the instance
    debug:
      var: floating_ip.private_ip
