
- name: Check CPU facts on ARM
  hosts: arm_host
  gather_facts: true

  tasks:
  - name: Print number of CPUs
    debug:
      var: ansible_processor_count
  
  - name: Delete CPU facts cache
    shell: rm -rf /etc/ansible/facts.d/*
    become: true
    become_method: sudo

  - name: Re-gather CPU facts
    setup:
      gather_subset:
        - hardware
    become: true
    become_method: sudo
  
  - name: Print updated number of CPUs
    debug:
      var: ansible_processor_count
