
---
- name: LXC Module Internal Server Error Playbook
  hosts: all
  gather_facts: yes

  tasks:

  - name: Install Proxmox LXC Module
    apt:
      name: proxmox-ve
      update_cache: yes
  
  - name: Create LXC Container
    proxmox:
      api_user: root@pam
      api_password: "{{vault_proxmox_password}}"
      api_host: "{{inventory_hostname}}"
      vmid: 901
      node: node1
      password: "{{vault_proxmox_password}}"
      ostemplate: local:vztmpl/debian-9.0-standard_9.4-1_amd64.tar.gz
      clone: false
      name: Test-Container
      state: present

  - name: Delete LXC Container
    proxmox:
      api_user: root@pam
      api_password: "{{vault_proxmox_password}}"
      api_host: "{{inventory_hostname}}"
      vmid: 901
      node: node1
      password: "{{vault_proxmox_password}}"
      name: Test-Container
      state: absent
