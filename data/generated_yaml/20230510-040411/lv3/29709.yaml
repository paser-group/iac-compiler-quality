
---
- hosts: localhost
  gather_facts: no
  vars:
    azure_subscription_id: '<subscription_id>'
    azure_client_id: '<client_id>'
    azure_secret: '<secret>'
    azure_tenant: '<tenant_id>'
    vm_name: 'vm-test'
  tasks:
    - name: Create virtual machine with invalid subnet name
      azure_rm_virtualmachine:
        resource_group: 'test'
        name: '{{ vm_name }}'
        vm_size: 'Standard_D2_v2'
        admin_username: 'adminuser'
        admin_password: 'password'
        image:
          offer: 'CentOS'
          publisher: 'OpenLogic'
          sku: '7.5'
          version: 'latest'
        vnet_name: 'test-vnet'
        subnet_name: 'Invalid subnet' # The incorrect subnet value causing the error
        storage_account: 'teststorage'
        custom_data: ''
        tags:
          Environment: 'Test'
        network_interface_names:
          - 'nic-test'
        os_disk_name: 'test-os-disk'
        os_type: linux
        state: present
      register: vm_created
    - name: Show VM details
      debug:
        var: vm_created
