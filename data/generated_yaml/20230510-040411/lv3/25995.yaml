
---
- hosts: localhost
  connection: local
  gather_facts: no

  tasks:
  - name: Create S3 Bucket
    s3_bucket:
      name: my-bucket
      region: us-east-1
      state: present
    register: result

  - name: Retry S3 Bucket creation if it fails
    when: result|failed
    delay: 5
    s3_bucket:
      name: my-bucket
      region: us-east-1
      state: present
