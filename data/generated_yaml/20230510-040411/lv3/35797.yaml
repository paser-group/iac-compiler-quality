
---
- name: Configure Layer 2 Interface on NX-OS devices
  hosts: nxos_devices
  gather_facts: no
  
  vars:
    interface_name: Ethernet1/10
    switchport_mode: access
    vlan_id: 100

  tasks:
    - name: Create L2 Interface on NX-OS device
      nxos_l2_interface:
        name: "{{ interface_name }}"
        admin_state: up
        switchport_mode: "{{ switchport_mode }}"
        access_vlan: "{{ vlan_id }}"
      register: result

    - name: Print Module Result
      debug:
        var: result

    - name: Configure Same Interface with Different VLAN
      nxos_l2_interface:
        name: "{{ interface_name }}"
        switchport_mode: "{{ switchport_mode }}"
        access_vlan: 101
      when: vlan_id != 101
