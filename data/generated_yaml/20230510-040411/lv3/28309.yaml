
- name: Incorrect Context Detection on Arista Modular Switches (7500)
  hosts: arista_switches
  gather_facts: no

  tasks:
    - name: Configure Switches
      ios_config:
        lines:
          - "hostname {{ inventory_hostname }}"
          - "ip routing"
          - "interface Ethernet1"
          - "ip address 10.0.0.1/24"
          - "no shutdown"
      transport: cli

    - name: Configure VLAN
      ios_config:
        lines:
          - "vlan 100"
          - "name test"
      transport: cli

    - name: Add VLAN to Interfaces
      ios_config:
        lines:
          - "interface Ethernet1"
          - "switchport"
          - "switchport access vlan 100"
      transport: cli
