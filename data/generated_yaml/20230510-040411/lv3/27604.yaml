yaml
---
- name: Install OS on devices running NX-OS
  hosts: target_hosts
  gather_facts: no

  tasks:
    - name: Copy the OS file to the target_host
      nxos_file_copy:
        hostname: "{{ inventory_hostname }}"
        username: "{{ username }}"
        password: "{{ password }}"
        src_file: "{{ os_file_path }}"
        dst_file: "{{ install_path }}/{{ os_file_name }}"
        protocol: scp
        force: True

    - name: Install the OS on the target_host
      nxos_install_os:
        hostname: "{{ inventory_hostname }}"
        username: "{{ username }}"
        password: "{{ password }}"
        os_type: "{{ os_type }}"
        os_file: "{{ install_path }}/{{ os_file_name }}"
      register: install_status

    - name: Check if the installation was successful
      debug:
        msg: "{{ install_status }}"
