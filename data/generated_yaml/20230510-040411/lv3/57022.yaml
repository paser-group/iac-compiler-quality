
- name: ansible_connection evaluation issue
  hosts: all
  gather_facts: no
  become: yes

  vars:
    conn_list:
      - ssh
      - local

  tasks:
    - name: loop over connection options
      debug:
        msg: "Connection option: {{ item }}"
      with_items: "{{ conn_list }}"
      vars:
        ansible_connection: "{{ item }}"
