
- hosts: target
  become: yes
  vars:
    ansible_python_interpreter: /usr/bin/non-existent-python
  tasks:
    - name: Install Python on the target system
      raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
      register: output
      changed_when: output.stdout != ""
    
    - name: Copy file to the target system
      copy:
        src: /path/to/local/file
        dest: /path/to/remote/file
    
    - name: Restart Apache
      service:
        name: apache2
        state: restarted
