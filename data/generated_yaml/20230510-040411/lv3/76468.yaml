
---
- name: Test WinRM Connection Issue in Windows Server 2019
  hosts: windows_host
  gather_facts: no

  vars:
    ansible_user: administrator
    ansible_password: 'P@ssw0rd1'

  tasks:
  - name: Attempt to WinRM Connect to Windows Host
    win_ping:
        data: "hello!"
    delegate_to: localhost
    register: ping_response

  - name: Print Connection Failure if Ping Fails
    debug:
        msg: "WinRM connection failure: {{ ping_response.msg }}"
    when: ping_response.failed == true
