
- name: Set user permissions on a file
  hosts: windows
  gather_facts: no

  tasks:
    - name: Check the existence of the file
      win_stat:
        path: "C:/testfile.txt"
      register: file_status

    - name: Set permissions for the user
      win_acl:
        path: "C:/testfile.txt"
        user: "{{ ansible_user }}"
        type: allow
        rights: read
