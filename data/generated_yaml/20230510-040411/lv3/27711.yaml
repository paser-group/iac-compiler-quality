
- name: Configure SNMP Community on NXOS devices
  hosts: switches
  connection: network_cli
  gather_facts: no

  tasks:
  - name: Set SNMP string
    nxos_snmp_community:
      name: "{{ inventory_hostname }}"
      community: "public"
      state: present
    register: result

  - debug:
      var: result

- name: Configure SNMP Community on NXAPI connection
  hosts: switches
  connection: httpapi
  gather_facts: no

  tasks:
  - name: Set SNMP string
    nxos_snmp_community:
      name: "{{ inventory_hostname }}"
      community: "public_api"
      state: present
    register: result

  - debug:
      var: result
