
- name: Test playbook to recreate SSH debugging issue
  hosts: all
  gather_facts: no

  vars:
    ssh_user: testuser
    ssh_pass: testpassword
    ssh_host: 192.0.2.1
    ssh_port: 22

  tasks:
  # Test SSH Connection Debug
  - name: Attempt SSH Connection
    become: false
    debug:
      msg: "Attempting SSH Connection to {{ ssh_host }} {{ ssh_port }} as {{ ssh_user }}"

  # Connection Broken
  - name: Break SSH Connection Debug
    become: false
    shell: echo "Connection Broken"
    register: result

  # Debug Connection Broken
  - name: Debug SSH Connection Broken
    become: false
    debug:
      msg: "{{ result.stdout }}"
