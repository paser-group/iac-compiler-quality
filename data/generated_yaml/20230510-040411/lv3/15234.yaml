
- hosts: all
  gather_facts: yes

  tasks:
    - name: Update all packages
      yum:
        name: '*'
        state: latest
      register: yum_output
      ignore_errors: yes

    - name: Print yum output
      debug:
        var: yum_output

    - name: Raise an error if out of memory situation occurs
      assert:
        that:
          - "yum_output is not defined or 'out of memory' not in yum_output.stderr_lines|string()"


