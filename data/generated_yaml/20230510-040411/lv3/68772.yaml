
---
- name: Test osx_defaults Integer Type Check Bug
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Set a key with integer value using osx_defaults
    command: /usr/bin/defaults write com.example.test setting -integer 5
    register: result
    ignore_errors: yes

  - debug:
      msg: "The result is {{ result.stdout }}"

  - name: Verify integer value is set
    command: /usr/bin/defaults read com.example.test setting
    register: verify_result

  - assert:
      that:
        - '"5" in verify_result.stdout'
