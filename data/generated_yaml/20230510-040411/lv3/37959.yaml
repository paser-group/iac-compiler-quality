
---
- name: S3_sync module bug reproduction playbook
  hosts: localhost
  gather_facts: false

  vars:
    s3_bucket: "my-s3-bucket"
    local_dir: "/path/to/local/directory"

  tasks:
    - name: Sync files to S3
      s3_sync:
        bucket: "{{ s3_bucket }}"
        upload_dir: "{{ local_dir }}"
        mode: push
        acl: public-read
        purge: yes
      register: s3_sync_output

    - name: Print Sync output
      debug:
        var: s3_sync_output
