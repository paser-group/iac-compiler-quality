
---
- name: Create EC2 ENI
  hosts: localhost
  connection: local
  gather_facts: no

  vars:
    region: "{{ lookup('env', 'AWS_REGION') }}"
    access_key: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
    secret_key: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"

  tasks:
    - name: Create ENI
      ec2_eni:
        aws_access_key: "{{ access_key }}"
        aws_secret_key: "{{ secret_key }}"
        region: "{{ region }}"
        subnet_id: "subnet-xxxxxx"
        security_groups: "{{ security_groups | default(omit) }}"
        state: present
      register: eni

    - debug:
        var: eni
