
- name: Create a virtual machine from a template with disk option
  vmware_guest:
    hostname: "{{ vcenter_hostname }}"
    username: "{{ vcenter_username }}"
    password: "{{ vcenter_password }}"
    datacenter: "{{ datacenter_name }}"
    template: "{{ template_name }}"
    name: "{{ vm_name }}"
    disk:
      - size_gb: 10
        type: thin
    hardware:
      memory_mb: 4096
      num_cpus: 2
      scsi: paravirtual
    networks:
      - name: "{{ network_name }}"
        ip: "{{ ip_address }}"
        netmask: "{{ netmask }}"
  register: vm

- name: Verify the virtual machine was created
  vmware_guest:
    hostname: "{{ vcenter_hostname }}"
    username: "{{ vcenter_username }}"
    password: "{{ vcenter_password }}"
    validate_certs: no
    datacenter: "{{ datacenter_name }}"
    name: "{{ vm_name }}"
  register: vm_info

- name: Print VM's information
  debug:
    var: vm_info
