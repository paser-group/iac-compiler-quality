
---
- hosts: all
  vars:
    custom_inventory_script: "/path/to/custom/inventory/script"
  tasks:
  - name: Run inventory script with error message
    command: "{{ custom_inventory_script }}"
    register: inventory_output
    ignore_errors: true
    
  - name: Check for error message in stdout
    debug: 
      var: inventory_output.stdout
    failed_when: "'error message' not in inventory_output.stdout"

  - name: Check for error message in stderr
    debug:
      var: inventory_output.stderr
    failed_when: "'error message' not in inventory_output.stderr"
