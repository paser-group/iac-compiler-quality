
---
- name: Test Playbook
  hosts: target_machine
  become: true

  vars:
    target_ip: "10.10.10.10"
    target_username: "testuser"
    target_password: "testpass"
    target_url: "http://example.com"

  tasks:
    - name: Access URL with authentication
      uri:
        url: "{{ target_url }}"
        user: "{{ target_username }}"
        password: "{{ target_password }}"
        force_basic_auth: true
      register: result

    - name: Error Handling
      fail:
        msg: "Error: Failed to access URL with basic authentication"
      when: result.status == 401

    - name: Debug Message
      debug:
        msg: "Playbook completed!"
