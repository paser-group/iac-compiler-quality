yaml
- hosts: localhost
  gather_facts: no

  vars:
    project_id: "my_project"
    zone: "us-central1-a"
    instance_name: "my_instance"
  
  tasks:
    - name: Create Compute Engine Image
      gcp_compute_image:
        name: my-gcp-image
        source_disk: "{{ instance_name }}"
        project: "{{ project_id }}"
        zone: "{{ zone }}"
      register: image

    - name: Patch Compute Engine Image for currently used disk
      gcp_compute_image:
        name: my-gcp-image
        project: "{{ project_id }}"
        image: "{{ image }}"
        force: yes
      register: patch_result

    - name: Print patch result
      debug:
        var: patch_result
