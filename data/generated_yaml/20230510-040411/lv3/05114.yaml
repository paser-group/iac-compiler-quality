
- name: Handling more error types in a template
  hosts: all
  vars:
    error_type: 'permission denied'
  tasks:
  - name: Generate configuration file
    template:
      src: my_template.j2
      dest: /etc/my_config_file.conf
    register: template_result
  - name: Fail if error encountered
    fail:
      msg: "Error encountered while generating configuration file"
    when: "'failed' in template_result.stderr and error_type in template_result.stderr"
