
---
- name: Ansible 2.0 hostgroup vars issues
  hosts: my_hostgroup

  vars:
    my_var1: "hostgroup_level"

  tasks:
    - name: Define hostsubset
      add_host:
        name: "{{ item }}"
        groups: my_hostsubset
      with_items:
        - host1
        - host2

  # Override hostgroup variable at hostsubset level
    - name: Override hostgroup variable
      set_fact:
        my_var1: "hostsubset_level"
      when: inventory_hostname in groups['my_hostsubset']

    - name: Debug vars
      debug:
        var: my_var1
