
---
- name: Test nxos_acl module for error handling
  hosts: switch
  gather_facts: no

  tasks:
    - name: Create access list no 1
      nxos_acl:
        access_list: access-list 101
        type: ipv4-acl
        rule:
        - permit ip any any
      register: acl_status

    - name: Create access list no 2
      nxos_acl:
        access_list: access-list 102
        type: ipv4-acl
        rule:
        - permit ip any any
      register: acl_status

    - name: Create access list no 3
      nxos_acl:
        access_list: access-list 103
        type: ipv4-acl
        rule:
        - permit ip any any
      register: acl_status

    - name: Remove access list no 2
      nxos_acl:
        access_list: access-list 102
        type: ipv4-acl
        state: absent
      register: acl_status

    - name: Remove access list no 1
      nxos_acl:
        access_list: access-list 101
        type: ipv4-acl
        state: absent
      register: acl_status

    - name: Remove access list no 3
      nxos_acl:
        access_list: access-list 103
        type: ipv4-acl
        state: absent
      register: acl_status
