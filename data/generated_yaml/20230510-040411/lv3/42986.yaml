
---
- hosts: localhost
  gather_facts: no
  
  vars:
    my_param_name: "my-test-param"
    my_param_value: "my-test-param-value"
    my_param_description: "my-test-description"
  
  tasks:
    - name: Create AWS SSM parameter
      aws_ssm_parameter_store:
        name: "{{ my_param_name }}"
        value: "{{ my_param_value }}"
        description: "{{ my_param_description }}"
      
    - name: Read the 'Description' key in the parameter
      debug:
        var: aws_ssm.parameters[my_param_name].Description
      
    - name: Ensure the key error occurs
      fail:
        msg: "Error - 'Description' key doesn't exist in the parameter"
      when: "aws_ssm.parameters[my_param_name].Description is not defined"
