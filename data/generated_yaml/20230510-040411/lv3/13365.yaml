
---
- hosts: "{{ target_host }}"
  remote_user: ansible
  become: true
  gather_facts: false
  vars:
    test_file: /tmp/test_file
  tasks:
    - name: Check Deployed Server
      block:
        - name: Set up test file on target
          copy:
            src: /dev/null
            dest: "{{ test_file }}"
            # the next line will cause ssh error
            remote_src: true
          delegate_to: "{{ target_host }}"
        - name: Print message
          debug:
            msg: "Test file created successfully!"
      rescue:
        - name: Print fail message
          debug:
            msg: "Test file creation failed"
            var: ansible_failed_result
