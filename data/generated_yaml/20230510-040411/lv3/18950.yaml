
---
- name: Execute command and log error message
  hosts: localhost
  tasks:
    - name: Run command with non-zero return code and catch failure
      shell: unreliable-command
      register: shell_result
      ignore_errors: yes

    - name: Fail the playbook if shell command has failed
      fail:
        msg: "Error executing shell command - {{ shell_result }}"

    - name: Print error message if shell command fails
      debug:
        msg: "Error Message: {{ shell_result }}.stderr"

    - name: Continue playbook if shell command succeeds
      debug:
        msg: "Command Result: {{ shell_result }}"
