
- name: Test WinRM Connection
  hosts: windows
  gather_facts: no
  vars:
    winrm_transport: ntlm
    winrm_port: 5985
  tasks:
  - name: Copy file to Windows host
    win_copy:
      src: /path/to/file
      dest: C:\temp\file.txt
      username: "{{ inventory_hostname }}"
      password: "{{ winrm_password }}"
    register: copy_result
  - debug: var=copy_result
