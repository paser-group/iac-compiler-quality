
---
- name: Testing Ansible ec2_vpc module to expose potential vulnerabilities and weaknesses
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Create an EC2 VPC with explicit credentials
    ec2_vpc:
      aws_access_key: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
      aws_secret_key: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"
      region: us-west-2
      name: ansible-test-2007
      cidr_block: 10.0.0.0/24
      profile: non_existent_profile
    register: ec2_vpc_result

  - name: Debug ec2_vpc result
    debug:
      var: ec2_vpc_result
