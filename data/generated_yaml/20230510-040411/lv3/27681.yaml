
---
- name: Test DNS Resolution and iptables Configuration
  hosts: all
  gather_facts: false
  tasks:
    - name: Check DNS Resolution
      debug:
        msg: "The resolved DNS name for the host is {{ lookup('dns', 'localhost') }}"
    
    - name: Add iptables rule
      iptables:
        chain: INPUT
        protocol: tcp
        destination_port: 80
        jump: DROP
    
    - name: Check iptables rule
      command: "iptables --list"
      register: command_output
    
    - name: Display iptables rule
      debug:
        var: command_output.stdout_lines
