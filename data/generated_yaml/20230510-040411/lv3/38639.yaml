
---
- name: nxos_facts - ansible_connection=network_cli Playbook
  hosts: "{{ target_device_ip }}"
  gather_facts: no
  connection: ssh
  become: yes
  vars:
    ansible_network_os: nxos
    ansible_user: "{{ target_device_username }}"
    ansible_ssh_pass: "{{ target_device_password }}"
    ansible_port: "{{ target_device_ssh_port }}"
    ansible_connection: network_cli
    
  tasks:
  - name: "Execute show version"
    nxos_command:
      commands: show version
    register: command_output

  - name: "Debug show version output"
    debug:
      msg: "{{ command_output.stdout_lines }}"

  - name: "Gather nxos facts"
    nxos_facts:
      gather_subset : all
    register: fact_output

  - name: "Debug nxos fact output"
    debug:
      msg: "{{ fact_output }}"

