
- name: Archive Cyrillic Filenames
  hosts: localhost
  gather_facts: no
  
  tasks:
  - name: Create a directory for the archive
    file:
      path: "/tmp/archive_test"
      state: directory

  - name: Create test files
    file:
      path: "/tmp/archive_test/тест_Тест.txt"
      state: touch

  - name: Create an archive with Cyrillic filenames
    archive:
      path: "/tmp/archive_test"
      dest: "/tmp/archive_test.tar"
      format: tar

  - name: Extract the archive with Cyrillic filenames
    command: "tar -xvf '/tmp/archive_test.tar'"
    args:
      chdir: "/tmp"

  - name: Remove test files and archive
    file:
      path: "/tmp/archive_test"
      state: absent
    file:
      path: "/tmp/archive_test.tar"
      state: absent
