
- hosts: client
  tasks:
    - name: Establishing connection with the server
      wait_for_connection:
        timeout: 300

    - name: Sending large file to the server
      command: cat /path/to/large/file | ssh server "cat > /tmp/largefile.out"
      ignore_errors: True
      register: result

    - name: Checking for broken pipe
      debug:
        var: result.stderr_lines
