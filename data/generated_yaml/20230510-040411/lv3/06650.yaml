
---
- hosts: localhost
  vars:
    stack_name: "existing-stack"
    template_file: "stack-template.json"
  tasks:
    - name: Create or update CloudFormation stack
      cloudformation: 
        stack_name: "{{ stack_name }}"
        state: present
        region: us-west-2
        template: "{{ lookup('file', template_file) }}"
        tags: 
          Name: "Ansible Stack"
      register: stack_output
         
    - name: Check stack events for any errors
      debug: var=stack_output.events
