yaml
- name: Aborting playbook execution using max_fail_percentage
  hosts: localhost
  gather_facts: no
  vars:
    max_fail_percentage: 30

  tasks:
    - name: Task 1 (will pass)
      command: /bin/echo "Task 1 passed"

    - name: Task 2 (will fail)
      command: /usr/bin/false

    - name: Task 3 (will fail)
      command: /usr/bin/false

    - name: Task 4 (will pass)
      command: /bin/echo "Task 4 passed"

  max_fail_percentage:
    active: true
    value: "{{ max_fail_percentage }}"
