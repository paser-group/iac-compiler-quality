
- name: Change Ansible Semaphore Path
  hosts: localhost
  tasks:
    - name: Create new semaphore path directory
      file:
        path: /tmp/new_semaphore_path
        state: directory
        mode: '0755'
    - name: Modify semaphore_path configuration
      lineinfile:
          path: /etc/ansible/ansible.cfg
          regexp: '^[[:space:]]*semaphore_path[[:space:]]*=[[:space:]]*'
          line: 'semaphore_path = /tmp/new_semaphore_path'
    - name: Check semaphore
      command: ansible-semaphore stats
