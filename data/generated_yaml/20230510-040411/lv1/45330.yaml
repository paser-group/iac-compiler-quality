
---
- name: Azure RM Container Registry Playbook
  hosts: localhost
  gather_facts: false
  tasks:

  - name: Check if Container Registry exists
    azure_rm_containerregistry_info:
      resource_group: myResourceGroup
      name: myContainerRegistry
    register: registry_info

  - name: Create Container Registry
    azure_rm_containerregistry:
      resource_group: myResourceGroup
      name: myContainerRegistry
      sku: Basic
      admin_user_enabled: true
      location: eastus
    when: registry_info is not defined

  - name: Update Container Registry with Latest Configurations
    azure_rm_containerregistry:
      resource_group: myResourceGroup
      name: myContainerRegistry
      sku: Basic
      admin_user_enabled: true
      location: eastus
    when: registry_info is defined and registry_info.state != 'present'
