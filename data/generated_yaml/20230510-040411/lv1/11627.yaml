yaml
---
- name: Playbook to fix "devel bug - profile_tasks.py requires CALLBACK_ constants or the display param is not passed" issue
  hosts: your_server
  gather_facts: false

  tasks:
  - name: Update Ansible configuration file
    lineinfile:
      dest: /etc/ansible/ansible.cfg
      regexp: "^#callback_whitelist"
      line: "callback_whitelist = profile_tasks"
      state: present
  - name: Ensure the necessary callback constants are present
    copy:
      dest: /usr/share/ansible_plugins/callback/profile_tasks.py
      src: /path/to/profile_tasks.py
      owner: root
      group: root
      mode: '0644'
  - name: Run your playbooks to see profiling output
    command: ansible-playbook your_playbook.yml
    register: playbook_output
