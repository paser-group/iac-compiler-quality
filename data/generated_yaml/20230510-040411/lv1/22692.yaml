
- hosts: localhost
  gather_facts: false
  become: true
  vars:
    instance_type: "t2.micro"
    ami_id: "ami-0c55b159cbfafe1f0"
  tasks:
    - name: Create Spot Request
      ec2_spot_instance:
        wait: no
        spot_type: one-time
        wait_timeout: 600
        instance_type: "{{ instance_type }}"
        image: "{{ ami_id }}"
      register: ec2_spot

    - name: Debug
      debug:
        var: ec2_spot
