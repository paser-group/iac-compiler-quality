
- name: Upload OS image
  hosts: all
  vars:
    os_image_url: "http://www.example.com/os_image.img"
    os_image_timeout: 120
  tasks:
    - name: Download OS image
      get_url:
        url: "{{ os_image_url }}"
        dest: "/home/user/os_image.img"
    - name: Upload OS image
      gluster.volume:
        state: present
        volume: "my_volume"
        server: "{{ inventory_hostname }}"
        transport: "tcp"
        bricks: "/gluster/my_volume"
        brick_stransport: "tcp"
        options: "server.tcp-user-timeout={{ os_image_timeout }}"
