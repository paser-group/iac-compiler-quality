
---
- name: Install Ansible dependencies
  hosts: localhost
  gather_facts: no
  
  tasks:
  - name: Install pip
    become: yes
    apt: name=python-pip state=present
      
  - name: Install Ansible
    become: yes
    pip: name=ansible state=present
      
  - name: Install missing dependency
    become: yes
    pip: name=ansible boto boto3 botocore state=present
  
  - name: Display EC2 Instances
    hosts: localhost
    gather_facts: no
    connection: local
    vars:
      region: "us-east-1"
    tasks:
    - name: Get EC2 Facts
      ec2_facts:
        region: "{{ region }}"
      register: ec2_facts
  
    - debug:
        var: ec2_facts.instances
