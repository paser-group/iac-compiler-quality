yaml
- name: Gather Facts from Nexus Switch
  hosts: my_nexus_switch
  gather_facts: no

  tasks:
    - name: Run Module
      nxos_facts:
        filter: "fan"
        legacy: yes
      register: nexus_facts

    - name: Check for errors
      fail:
        msg: "Failed to gather fan facts: {{ nexus_facts.msg }}"
      when: nexus_facts.failed == true
