yaml
---
- name: Check if container exists
  hosts: docker_host
  gather_facts: no
  
  vars:
    container_name: example_container
  
  tasks:
    - name: Check if container exists with non-zero error code
      command: docker inspect {{ container_name }}
      register: container_exists
      ignore_errors: yes

    - name: Stop and remove the container
      docker_container:
        name: "{{ container_name }}"
        state: stopped
        remove: yes
      when: container_exists|failed
