yaml
---
- hosts: all
  become: yes
  tasks:
    - name: stop and remove the container
      docker_container:
        name: test-container
        state: absent

    - name: start the container with custom network settings
      docker_container:
        name: test-container
        image: test-image
        published_ports:
          - "127.0.0.1:{{ EXTERNAL_PORT }}:{{ INTERNAL_PORT }}/tcp"
        network_mode: "{{ CUSTOM_NETWORK }}"
        daemon_json: "{{ CUSTOM_DAEMON_JSON }}"
