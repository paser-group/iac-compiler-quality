
- name: Add APT key from HTTPS URL with custom certificate
  hosts: all
  become: yes

  tasks:
    - name: Download custom certificate from URL
      get_url:
        url: https://example.com/path/to/cert.pem
        dest: /tmp/cert.pem
      
    - name: Add APT key from HTTPS URL with custom certificate
      apt_key:
        url: https://example.com/path/to/key.gpg
        state: present
        validate_certs: True
        keyring: /etc/apt/trusted.gpg.d/custom.gpg
        keyserver_options: https-proxy=https://proxy.example.com:8080
        cert_file: /tmp/cert.pem
