yaml
- hosts: all
  gather_facts: no
  vars:
    inventory_dir: "{{ inventory_dir }}"
    file_to_fetch: "{{ file_to_fetch }}"
  tasks:
    - name: Fetch file
      slurp:
        src: "{{ inventory_dir }}/{{ file_to_fetch }}"
      register: file_contents

    - name: Write file
      copy:
        content: "{{ file_contents.content | b64decode }}"
        dest: "/path/to/destination/file"
      when: file_contents.rc == 0
