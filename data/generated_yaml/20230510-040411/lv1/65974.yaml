
- hosts: servers
  gather_facts: false

  tasks:
    - name: Check for duplicate keys in a dictionary
      assert:
        that:
          - "{{ my_dict | dictsort() | join('|') }}" == "{{ my_dict | dictsort | unique | join('|') }}"
        fail_msg: "The dictionary has duplicate keys."
        success_msg: "The dictionary has no duplicate keys."
      vars:
        my_dict:
          key1: value1
          key2: value2
          key1: value3
