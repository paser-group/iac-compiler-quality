yaml
---
- name: Install and configure Elasticache
  hosts: all
  become: true

  vars:
    aws_profile: my-profile

  tasks:
  - name: Install Elasticache
    yum:
      name: aws-elasticache-cluster-client
      state: present

  - name: Configure Elasticache
    become_user: ec2-user
    shell: |
      /opt/aws/bin/cfn-init -v \
        --stack {{ stack_name }} \
        --resource {{ resource_name }} \
        --region {{ region }} \
        --configsets {{ configset_name }} \
        --profile {{ aws_profile }}
    args:
      executable: /bin/bash
