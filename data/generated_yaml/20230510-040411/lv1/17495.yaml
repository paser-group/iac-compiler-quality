
---
- hosts: all
  become: true
  tasks:
    - name: Check Docker-Py Version
      shell: pip show docker-py | grep Version | awk '{print $2}'
      register: docker_py_version

    - name: Validate Docker-Py Version
      fail:
        msg: "Docker-Py version {{ docker_py_version.stdout }} is invalid. Please upgrade to a supported version."
      when: docker_py_version.stdout not regex '^([1].[1-3].|2.0.)*$'
