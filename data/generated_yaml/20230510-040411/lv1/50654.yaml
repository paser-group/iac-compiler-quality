yaml
---
- name: Update Docker Swarm Service
  hosts: docker_swarm_nodes
  become: true

  tasks:
    - name: Stop Services
      docker_swarm_service:
        state: absent
        name: "{{ item }}"
      with_items:
        - "service_1"
        - "service_2"
        - "service_3"

    - name: Start Services
      docker_swarm_service:
        state: present
        name: "{{ item }}"
        image: my_image:latest
        replicas: 2
      with_items:
        - "service_1"
        - "service_2"
        - "service_3"

  vars:
    docker_swarm_nodes: docker-swarm-node-1, docker-swarm-node-2
