yaml
---
- name: Deploy Service to Docker Swarm
  hosts: swarm
  tasks:
    - name: Auth with Private Docker Registry
      docker_login:
        registry: private-registry.com
        username: myusername
        password: "{{ lookup('env', 'DOCKER_REGISTRY_PASSWORD') }}"
    
    - name: Pull Image from Private Registry
      docker_image:
        name: myimage
        tag: latest
        pull: yes
    
    - name: Deploy Service
      docker_swarm_service:
        name: myservice
        global_mode: true
        image: private-registry.com/myimage:latest
