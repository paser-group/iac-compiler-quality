yaml
---
- name: Configure Ansible Connection and Network OS
  hosts: all
  gather_facts: false
  become: true
  vars:
    ansible_connection: network_cli
    ansible_network_os: ios
  tasks:
  - name: Check SSH connectivity
    ping:
  - name: Run command on router
    ios_command:
      commands:
        - show version
      provider:
        host: "{{ inventory_hostname }}"
  - name: Save running configuration
    ios_command:
      commands:
        - write mem
      provider:
        host: "{{ inventory_hostname }}"
