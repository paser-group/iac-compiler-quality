
- name: osx_defaults array_add into new key sets value to a string rather than array
  hosts: localhost
  gather_facts: no
  vars:
    key: example_key
    value:
      - value1
      - value2
  tasks:
    - name: Add values to array
      shell: defaults write com.example.app {{ key }} -array-add '{{ item }}'
      with_items: "{{ value }}"
      args:
        executable: /usr/libexec/PlistBuddy -c
