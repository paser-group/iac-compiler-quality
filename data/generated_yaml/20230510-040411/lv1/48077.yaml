yaml
- name: Fix KeyError bug in cloudwatchlogs_log_group
  hosts: your_hosts
  gather_facts: yes

  tasks:
    - name: Install AWS CLI
      become: yes
      command: >
        curl https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip -o awscliv2.zip &&
        unzip awscliv2.zip &&
        sudo ./aws/install

    - name: Update cloudwatch logs retention policy
      become: yes
      shell: >
        aws logs describe-log-groups |
        jq -r '.logGroups | .[] | select(.logGroupName == "your_log_group_name") | .arn' |
        xargs -I {} aws logs put-retention-policy --log-group-arn {} --retention-in-days 7
