yaml
---
- name: Ensure SSH connection to all hosts
  hosts: all
  gather_facts: no
  become: yes

  tasks:
    - name: Check connectivity
      ping:

    - name: Fix authentication errors
      gather_facts: yes
      user: root
      vars_prompt:
        - name: "ssh_password"
          prompt: "Enter SSH password for root: "
          private: yes
      vars:
        ansible_ssh_pass: "{{ ssh_password }}"
      ignore_errors: yes
      shell: echo "success"

    - name: Verify connectivity
      ping:

    - name: other tasks
      # add your tasks here, e.g:
      # or use include_tasks module to include a separate playbook
      # include_tasks: tasks/relevant-tasks.yml
