
---
- name: Update dynamic inventory hosts
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Generate dynamic inventory
    add_host:
      name: "{{ item }}"
      groups: internal_hosts
    with_items: ['internal_host_1.domain.com', 'internal_host_2.domain.com', 'internal_host_3.domain.com']

  - name: Remove incorrectly listed hosts
    shell: sed -i '/<incorrect_hosts>/d' /path/to/inventory
