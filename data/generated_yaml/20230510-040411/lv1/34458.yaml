
- name: Get VPN Gateway facts
  hosts: localhost
  gather_facts: no
  vars:
    region: "us-east-1"
  tasks:
    - name: Fetch VPN Gateway data
      ec2_vpc_vgw_facts:
        region: "{{ region }}"
      register: vpn_facts
      ignore_errors: yes

    - name: Handle VPN Gateway errors
      fail:
        msg: "VPN Gateway not found or has no tags."
      when: vpn_facts.failed or vpn_facts.vgws[0].tags is undefined
