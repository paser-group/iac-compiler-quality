
---
- name: Playbook to fix Jinja2 Scoped Blocks issue with role default variables
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Install Jinja2
      become: true
      yum:
        name: python-jinja2
        state: latest

    - name: Fixing Jinja2 issue in the Ansible role
      blockinfile:
        path: /etc/ansible/roles/role_name/maintasks.yml
        block: |
          {% extends 'ansible-roles/role_name/tasks/maintasks.yml.j2' %}
          {% set scoped_var = scoped_value %}
        marker: "# Fixing scoped variable issue"

      vars:
        scoped_value: "{{ default_variable_value }}" 
