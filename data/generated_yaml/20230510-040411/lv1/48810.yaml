yaml
---
- name: Update the retention setting for a Cloudwatch Log Group
  hosts: localhost
  gather_facts: no

  vars:
    group_name: "my-log-group"
    retention_period: 90

  tasks:
    - name: Get the Cloudwatch Log Group ARN
      command: aws logs describe-log-groups --log-group-name-prefix "{{ group_name }}" --query "logGroups[0].arn" --output text
      register: log_group_result

    - name: Update the retention setting for the Log Group
      command: aws logs put-retention-policy --log-group-name {{ log_group_result.stdout }} --retention-in-days {{ retention_period }}
      ignore_errors: yes
