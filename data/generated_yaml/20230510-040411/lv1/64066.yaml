
---
- hosts: all
  gather_facts: true
  tasks:
   - name: Fix syntax error in the task
     block:
       - name: Shell command with syntax error
         command: echo 'This command has a syntax error'
         args:
           chdir: /tmp
         register: invalid_syntax
       - name: Fail module if there's an error
         fail:
           msg: "Error in syntax detected in task"
         when: invalid_syntax.rc != 0
     rescue:
       - name: Print error message in case of syntax error
         debug:
           msg: "Syntax error detected, but exit code is 0."
