
- name: Remove default VPC
  hosts: localhost
  gather_facts: false
  vars:
    region: <region_name>
  tasks:
    - name: Get Default VPC ID
      ec2_vpc_net_facts:
        region: "{{ region }}"
        filters:
          - name: "isDefault"
            values: ["true"]
      register: default_vpc
    
    - name: Remove Default VPC
      ec2_vpc_net:
        state: absent
        region: "{{ region }}"
        vpc_id: "{{ default_vpc.vpcs[0].id }}"
      when: default_vpc.vpcs|length>0
