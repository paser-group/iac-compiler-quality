yaml
---
- name: Extract archive file
  hosts: localhost
  become: yes
  tasks:
    - name: Unarchive file
      unarchive:
        src: /path/to/archive/file.tar.gz
        dest: /path/to/extract/directory/
      register: archive_result

    - name: Check if archive extraction is successful
      debug:
        msg: "Archive successfully extracted"
      when: archive_result.changed == true

    - name: Check if file exists in extracted directory
      stat:
        path: /path/to/extract/directory/file.expected
      register: file_result

    - name: Fail the playbook if file is not found
      fail:
        msg: "Unable to find file in extracted directory"
      when: not file_result.stat.exists
