
---
- name: Configure ACLs on NX-OS switches
  hosts: switches-nxos
  gather_facts: no

  tasks:
  - name: Gather access lists
    nxos_acl:
      state: gather
    register: acl_output

  - name: Configure access lists
    nxos_acl:
      name: "{{ item.name }}"
      type: "{{ item.type }}"
      config: "{{ item.config }}"
      state: "{{ item.state }}"
    loop: "{{ acl_output.access_lists }}"
    when: item.access_list_entries | length > 1
