yaml
---
- hosts: all
  tasks:
    - name: Copy files with nested includes
      copy:
        src: "{{ item.src }}"
        dest: "{{ item.dest }}"
      with_items: "{{ lookup('template', item.filelist) }}"
      loop_control:
        loop_var: item
      vars:
        filelist:
          - src: "/path/to/source/file1.txt"
            dest: "/path/to/destination/folder1/"
            filelist: "filelist1.txt.j2"
          - src: "/path/to/source/file2.txt"
            dest: "/path/to/destination/folder2/"
            filelist: "filelist2.txt.j2"
