
---
- name: Download multipart S3 objects
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Download S3 object
      s3:
        bucket: "{{ s3_bucket }}"
        object: "{{ s3_object }}"
        dest: "{{ s3_dest }}"
        mode: get
      register: s3_object_download
      when: "'multipart/' in s3_object"
    - name: Display error message
      fail:
        msg: "Error while downloading S3 object {{ s3_object }} to destination {{ s3_dest }}"
      when: s3_object_download is failed
