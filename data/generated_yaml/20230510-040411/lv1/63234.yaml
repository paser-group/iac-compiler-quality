
---
- name: Fix gcp_storage_bucket_access_control module bucket parameter bug
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Grant access to a Google Cloud Storage Bucket
    gcp_storage_bucket_access_control:
      bucket: "{{ bucket_name }}"
      entity: "{{ service_account_email }}"
      role: "{{ role }}"
    register: bucket_access

  - name: Check if grant access action succeeded
    fail:
      msg: "{{ bucket_access.stderr }}"
    when: bucket_access.failed
