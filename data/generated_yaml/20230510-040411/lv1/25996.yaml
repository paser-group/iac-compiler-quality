
---
- name: Fixing bucket naming conventions
  hosts: localhost
  gather_facts: false

  vars:
    s3_bucket_name: "{{ issue_title }}"

  tasks:
    - name: Check for uppercase letters or dots in bucket name
      fail:
        msg: "S3 bucket name cannot contain dots or uppercase letters"
      when: s3_bucket_name is not match('^[a-z0-9]*$')

    - name: Create S3 bucket
      s3_bucket:
        name: "{{ s3_bucket_name }}"
        state: present
