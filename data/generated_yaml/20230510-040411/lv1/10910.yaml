yaml
---
- name: Fix unbound error variable in ec2.py
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Download ec2.py from Github
      get_url:
        url: https://raw.githubusercontent.com/ansible/ansible/stable-1.9/contrib/inventory/ec2.py
        dest: /home/user/ec2.py

    - name: Update ec2.py to fix unbound error variable
      replace:
        path: /home/user/ec2.py
        regexp: error_not_found\(
        replace: "error_not_found(message"

    - name: Set executable permissions on ec2.py
      file:
        path: /home/user/ec2.py
        mode: 'u+x'

    - name: Test ec2.py inventory plugin
      command: /home/user/ec2.py --list
