yaml
---
- name: Create Vault with filename
  hosts: localhost
  gather_facts: no
                  
  vars:
    vault_file: my_vault.yml
                  
  tasks:
    - name: Generate vault password
      ansible.builtin.set_fact: vault_password="{{ lookup('password', '/dev/null', length=42, special=True) }}"

    - name: Create Vault
      ansible.builtin.command:
        cmd: ansible-vault create "{{ vault_file }}"
        creates: "{{ vault_file }}"
      vars:
        ansible_become_password: "{{ vault_password }}"
