yaml
- name: Upgrade Docker engine on remote hosts
  hosts: all
  become: true
  tasks:
    - name: Check Docker version
      command: docker version --format '{{json .Client}} {{json .Server}}'
      register: docker_version
    - name: Upgrade Docker engine
      shell: curl -fsSL https://get.docker.com | sh && systemctl restart docker
      when: "'1.12' not in docker_version.stdout or '1.10' in docker_version.stdout"
