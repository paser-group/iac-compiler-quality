yaml
- name: Create virtual network peering
  hosts: localhost
  gather_facts: false

  vars:
    resource_group_name: myResourceGroup
    virtual_network_name: myVirtualNetwork
    remote_virtual_network_id: /subscriptions/SUBSCRIPTION_ID/resourceGroups/remoteResourceGroup/providers/Microsoft.Network/virtualNetworks/remoteVirtualNetwork

  tasks:
  - name: Create virtual network peering
    azure_rm_virtualnetworkpeering:
      resource_group: "{{ resource_group_name }}"
      virtual_network_name: "{{ virtual_network_name }}"
      name: myVirtualNetworkPeering
      remote_virtual_network_id: "{{ remote_virtual_network_id }}"
      allow_virtual_network_access: true
      allow_forwarded_traffic: false
      allow_gateway_transit: false
      use_remote_gateways: false
