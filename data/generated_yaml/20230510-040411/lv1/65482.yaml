yaml
---
- hosts: <your hosts>
  gather_facts: no
  connection: network_cli
  tasks:
    - name: Running show version
      ios_command:
        commands:
          - show version
      register: shver

    - name: Configuring interfaces
      ios_config:
        lines:
          - "interface gigabitethernet 1/0/1"
          - "ip address 192.168.1.1 255.255.255.0"
          - "no shutdown"
      when: "'element does not exist' not in shver.stdout_lines[0]"
