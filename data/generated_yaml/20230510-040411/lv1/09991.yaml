
---
- hosts: all
  become: yes
  gather_facts: no

  tasks:
  - name: Update .bashrc file to initialize env directory variables
    lineinfile:
      dest: ~/.bashrc
      line: 'export ANSIBLE_DEVEL_CODEBASE={{ ansible_env.PWD }}'
      state: present
      regexp: '^export ANSIBLE_DEVEL_CODEBASE='

  - name: Update env-setup file to export correct variables
    lineinfile:
      dest: ~/ansible/hacking/env-setup
      line: 'export ANSIBLE_TEST_REQUIREMENTS=1'
      state: present
      regexp: '^export ANSIBLE_TEST_REQUIREMENTS='

  - name: Source env-setup script
    command: source ~/ansible/hacking/env-setup
    args:
      executable: /bin/bash

