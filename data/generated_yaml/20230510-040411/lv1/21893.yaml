
---
- name: Gather facts and get CPU facts
  hosts: all
  gather_facts: true
  tasks:
    - name: Get CPU facts
      block:
        - name: Gather CPU Facts
          ansible.builtin.set_fact:
             cpu_facts: "{{ ansible_facts['processor'][-1] }}"
        rescue:
          - name: Handle divide by zero error
            ansible.builtin.set_fact:
              cpu_facts: "Unknown"
            when: "ansible_failed_result | search('zero division')"

    - name: Debug output of CPU Facts
      ansible.builtin.debug:
        msg: "CPU Facts: {{cpu_facts}}"

