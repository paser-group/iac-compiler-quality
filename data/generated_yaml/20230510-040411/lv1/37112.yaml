
---

- hosts: all
  become: yes

  vars:
    cs_instance_name: 'user_data'

  tasks:
    - name: Ensure that python3 is installed
      apt:
        name: python3
        state: present

    - name: Ensure that python3-pip is installed
      apt:
        name: python3-pip
        state: present

    - name: Install the cs module for python3
      pip:
        name: cs
        state: latest
        executable: /usr/bin/python3
        extra_args: --ignore-installed

    - name: Execute cs_instance with python3
      shell: >
        cd /path/to/cs_instance/directory;
        python3 cs_instance.py --name "{{ cs_instance_name }}"
