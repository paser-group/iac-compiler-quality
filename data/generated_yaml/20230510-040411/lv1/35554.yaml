
---
- name: Update VLAN interfaces
  hosts: switches
  gather_facts: no
  tasks:
    - name: Get current VLAN interfaces
      ios_command:
        commands:
          - show interfaces switchport | include Access Mode VLAN
      register: vlan_interfaces

    - name: Check for index errors
      fail:
        msg: Index error thrown when more than 6 interfaces are assigned to a VLAN
      when: vlan_interfaces.stdout_lines|length > 6
