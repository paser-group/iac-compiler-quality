yaml
---
- hosts: servers
  tasks:
    - name: Run shell command and register the result
      shell: <your-relevant-shell-command-here>
      register: shell_command_result
      ignore_errors: yes
     
    - name: Fail with proper error message
      fail:
        msg: "Shell command returned incorrect error code {{ shell_command_result.rc }}. Check the command output and try again."
      when: shell_command_result.rc != 0
