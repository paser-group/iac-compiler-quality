yaml
- hosts: localhost
  become: true
  vars:
    image: alpine
    container_name: my_container
    build_path: /path/to/Dockerfile
  tasks:
  - name: Install buildah
    yum:
      name: buildah
      state: present
  - name: Create a new container
    buildah:
      name: "{{ container_name }}"
      image: "{{ image }}"
      pull: true
      state: present
  - name: Build image from Dockerfile
    buildah:
      name: "{{ container_name }}"
      buildargs:
        HTTP_PROXY: http://proxy.example.com:8080
        HTTPS_PROXY: http://proxy.example.com:8080
      build_opts:
        networkmode: host
        format: docker
      path: "{{ build_path }}"
      state: present
