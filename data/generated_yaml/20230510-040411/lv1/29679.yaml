yaml
---
- name: Update IAM username in AWS
  hosts: localhost
  gather_facts: false
  vars:
    username: <new_iam_username>
  tasks:
    - name: Update IAM username
      aws_iam_user:
        user_name: <current_iam_username>
        new_user_name: "{{ username }}"
        aws_access_key: <AWS_access_key>
        aws_secret_key: <AWS_secret_key>
      register: result
    - name: Display result
      debug:
        var: result
    - name: Check for errors
      fail:
        msg: "An error occurred while updating the IAM username"
      when: result.failed
