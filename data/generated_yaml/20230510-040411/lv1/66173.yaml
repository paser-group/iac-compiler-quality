
---
- name: Ansible Tower Authentication Error
  hosts: localhost
  gather_facts: no
  become: yes
  
  tasks:
    - name: Check Tower Authorization
      uri:
        url: "{{ansible_tower_url}}/api/v2/me/"
        method: GET
        headers:
          Authorization: "Bearer {{ansible_tower_token}}"
        return_content: yes
        status_code:
          - 200
        timeout: 15
      register: auth_result

    - name: Debug Authorization Result
      debug:
        var: auth_result

    - name: Fail if Authentication Fails
      fail:
        msg: "Ansible Tower Authentication Failed"
      when: auth_result.status != 200
...
