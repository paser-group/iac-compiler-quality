yaml
---
- name: Configure suppress_arp and assoc_vrf on nxos_vxlan_vtep_vni
  hosts: nxos_switch
  gather_facts: no

  tasks:
    - name: Configure suppress_arp on nxos_vxlan_vtep_vni
      nxos_vxlan_vtep_vni:
        vrf: "{{ item.vrf_name }}"
        vni: "{{ item.vni_id }}"
        suppress_arp: yes
      loop: "{{ vtep_vni_list }}"

    - name: Configure assoc_vrf on nxos_vxlan_vtep_vni
      nxos_vxlan_vtep_vni:
        vrf: "{{ item.vrf_name }}"
        vni: "{{ item.vni_id }}"
        assoc_vrf: yes
        vrf_ip_addr: "{{ item.assoc_vrf_ip }}"
      loop: "{{ vtep_vni_list }}"

  vars:
    vtep_vni_list:
      - vrf_name: "VRF1"
        vni_id: "5001"
        assoc_vrf_ip: "10.0.0.1"
      - vrf_name: "VRF2"
        vni_id: "5002"
        assoc_vrf_ip: "10.0.0.2"
