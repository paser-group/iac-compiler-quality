
- name: Test ovirt_nic errors
  hosts: localhost

  vars:
    nic_name: nic1
    datacenter_name: BUA
    network_name: infra-prod

  tasks:
  - name: Gather NIC information
    ovirt_nic_info:
      auth: "{{ ovirt_auth }}"
      vm: "{{ vm_name }}"
      nic: "{{ nic_name }}"
    register: nic_info

  - name: Validate Network & Data Center
    fail:
      msg: "NIC {{ nic_name }} has invalid network or datacenter configuration."
    when: (nic_info.interfaces[0].network.name != network_name) or (nic_info.interfaces[0].network.data_center.name != datacenter_name)
