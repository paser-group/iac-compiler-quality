
- name: Reboot Windows Host
  win_reboot:
    reboot_timeout_sec: 900
  register: reboot_result

- name: Wait for Host to come back online
  wait_for:
    host: "{{ inventory_hostname }}"
    port: 22
    state: started
    timeout: 180
  when: reboot_result is changed
