
# Define environment variables
- name: Define AWS_PROFILE and AWS_DEFAULT_REGION environment variables
  become: true
  become_user: root
  shell: |
    echo 'export AWS_PROFILE=<profile-name>' >> ~/.bashrc
    echo 'export AWS_DEFAULT_REGION=<region>' >> ~/.bashrc
    source ~/.bashrc

# Use debug module to gather more information about the runtime error
- name: Debugging S3 Module
  vars:
    s3_bucket_name: "<your-bucket-name>"
  become: true
  become_user: root
  debug:
    var: s3_bucket_name

# Use S3 module with correct syntax
- name: Uploading file to S3 bucket
  vars:
    file_name: "myfile.txt"
  become: true
  become_user: root
  aws_s3:
    bucket: "{{ s3_bucket_name }}"
    object: "{{ file_name }}"
    src: "/path/to/local/file"
    mode: put
