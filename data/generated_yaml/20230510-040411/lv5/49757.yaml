
---
- name: Test temporary files in Ansible compiler
  hosts: localhost
  tasks:
    - name: Create temporary file with syntax error
      tempfile:
        state: file
        suffix: .py
        register: tempfile
      delegate_to: localhost
      run_once: true
      become: yes
      command: echo "print 'Hello world'" >> {{ tempfile.path }}
    - name: Execute temporary file
      script: "{{ tempfile.path }}"
