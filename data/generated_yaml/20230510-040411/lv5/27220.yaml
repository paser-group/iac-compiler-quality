yaml
- name: Test NetApp authentication error handling
  hosts: localhost
  gather_facts: false
  vars:
    netapp_host: netapp.example.com
    netapp_user: admin
    netapp_pass: invalid
  tasks:
    - name: Attempt to connect to NetApp with invalid credentials
      na_ontap_login:
        hostname: "{{ netapp_host }}"
        username: "{{ netapp_user }}"
        password: "{{ netapp_pass }}"
      register: result
      ignore_errors: true
    - name: Verify that an error was raised
      assert:
        that:
          - " 'Failed to authenticate' in result.msg "
