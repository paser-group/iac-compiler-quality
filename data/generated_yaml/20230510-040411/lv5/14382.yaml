
- name: Check command output
  hosts: all
  tasks:
  - name: Execute problematic command and check output
    command: some_command
    args:
      chdir: "/path/to/command"
      echo: yes
      stdin: "some random data"
    register: cmd_output
    failed_when: "'error' in cmd_output.stdout"
