
- name: Test variable precedence
  hosts: all

  vars:
    variable1: "default_value"

  tasks:
    - name: Debug variable
      debug:
        var: variable1

    - name: Override variable1 with command-line argument
      debug:
        var: variable1
      vars:
        variable1: "{{ lookup('env','VAR1')|default('default_value') }}"

    - name: Override variable1 with Playbook variable
      debug:
        var: variable1
      vars:
        variable1: "variable1_value"

    - name: Override variable1 with inventory variable
      debug:
        var: variable1

  environment:
    VAR1: "{{ lookup('env','VAR1') }}"
