
- name: Create resource group in Azure subscription
  hosts: localhost
  gather_facts: false
  vars:
    subscription_id: "<Subscription ID>"
    resource_group_name: "<Resource Group Name>"
  tasks:
    - name: Set the default subscription
      azure_rm_subscription:
        subscription_id: "{{ subscription_id }}"
        state: present
        is_default: yes
      register: set_subscription

    - name: Create resource group
      azure_rm_resourcegroup:
        name: "{{ resource_group_name }}"
        location: eastus
      register: create_resourcegroup

    - name: Check resource group creation
      fail:
        msg: "Resource group creation failed."
      when: create_resourcegroup is failed
