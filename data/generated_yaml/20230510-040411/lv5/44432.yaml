
---
- name: Create router with os_router module
  hosts: controllers

  tasks:
  - name: Setup OpenStack and network resources
    # ...

  - name: Create router
    os_router:
      name: test_router
      external_gateway_info:
        network: invalid_network_id
    register: router_create_result
    ignore_errors: true

  - name: Check for PolicyNotAuthorized error
    debug:
      msg: "{{ router_create_result }}"
    when: "'PolicyNotAuthorized' in router_create_result.stderr"
