
- name: Check YAML syntax errors in the inventory file
  hosts: localhost
  gather_facts: no
  tasks:
  - name: Check syntax
    fail:
      msg: "Error parsing YAML inventory file: {{ item }}"
    when: inventory_valid.returncode != 0 and item is defined
    loop: "{{ inventory_output.stdout_lines }}"
