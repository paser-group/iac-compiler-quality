
---
- name: Test playbook
  hosts: localhost

  tasks:
    # Install the role
    - name: Install role
      ansible.builtin.command:
        cmd: "ansible-galaxy install role_name -p <path_to_roles>"

    # Check that the role was installed successfully and in the specified path
    - name: Check installation path
      ansible.builtin.stat:
        path: "<path_to_roles>/role_name"
      register: role_installer

    # Fail if the role was not installed in the expected directory
    - name: Verify role installation location
      ansible.builtin.fail:
        msg: "Role installed at unexpected location."
      when: not role_installer.stat.exists or not role_installer.stat.isdir
