
---
- name: Test playbook for group_by module
  hosts: localhost
  gather_facts: false
  vars:
    items:
       - name: item1
         value1: 10
         value2: 20
       - name: item2
         value1: 20
         value2: 30
       - name: item3
         value1: 10
         value2: 40
    attributes:
       - value1
  tasks:
    - name: Group items by attributes
      group_by:
        key: "{{ item.attributes }}"
      loop: "{{ items }}"
      loop_control:
        index_var: index
      register: result

    - name: Display groups
      debug:
        msg: "{{ result.groups }}"
