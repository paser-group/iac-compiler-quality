
---
- name: Test netscaler module functionality
  hosts: localhost
  gather_facts: false

  vars:
    ns_address: "10.0.0.10"
    ns_username: "admin"
    ns_password: "password"

  tasks:
  - name: Test netscaler module read operation
    netscaler_service_lb_vserver:
      nsip: "{{ ns_address }}"
      nitro_user: "{{ ns_username }}"
      nitro_pass: "{{ ns_password }}"
      lbvservername: "lb-vserver-1"
      operation: "READ"
    register: result

  - debug:
     var: result

  - name: Test netscaler module create operation
    netscaler_service_lb_vserver:
      nsip: "{{ ns_address }}"
      nitro_user: "{{ ns_username }}"
      nitro_pass: "{{ ns_password }}"
      name: "lb-vserver-1"
      servicetype: "HTTP"
      ipv46: "{{ ns_address }}"
      port: "80"
      weight: "10"
      trafficdomain: "0"
      operation: "ADD"
    register: result

  - debug:
     var: result
