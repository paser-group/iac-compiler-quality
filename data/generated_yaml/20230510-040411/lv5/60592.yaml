yaml
- name: Retrieve Arista EOS facts
  hosts: eos_devices
  gather_facts: no
  tasks:
    - name: Gather EOS facts
      eos_facts:
        transport: eapi
        host: "{{ inventory_hostname }}"
        username: "{{ eos_username }}"
        password: "{{ eos_password }}"
        port: "{{ eos_port }}"
      register: eos_facts_output
    
    - name: Confirm EOS facts are valid
      assert:
        that:
          - eos_facts_output.ansible_facts.eos_neighbours is defined
          - eos_facts_output.ansible_facts.eos_facts.system_state.system_uptime is defined
      fail_msg: "EOS facts are not valid, check eos_facts module or EOS device configuration."
