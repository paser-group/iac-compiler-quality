
- name: Test for misleading "Max Retries Exceeded" error
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Copy file to S3 bucket
      aws_s3:
        bucket: my-s3-bucket
        object: "{{ user_home }}/file.txt"
        dest: "/Invalid/Path/file.txt"
      register: s3_copy

    - fail:
        msg: "An error should have been raised when a non-existing file path is specified"
      when: 's3_copy.status != 0'
