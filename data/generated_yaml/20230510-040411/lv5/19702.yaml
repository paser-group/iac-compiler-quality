
- name: Verify hostname before executing playbook
  hosts: all
  tasks:
    - name: Check if hostname is valid
      fail:
        msg: "Invalid hostname format"
      when: inventory_hostname | regex_match("^\\w+(\\.\\w+)*$") == false

- name: The main playbook
  hosts: dynamic_inventory
  tasks:
    # Ansible tasks go here
