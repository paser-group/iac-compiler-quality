
- name: Test Azure RM VirtualMachine Facts module
  hosts: localhost
  gather_facts: False

  tasks:
  - name: Get Azure VM Facts
    azure_rm_virtualmachine_facts:
      resource_group: "{{ resource_group }}"
      name: "{{ vm_name }}"
    register: vm_facts

  - name: Print Azure VM Facts
    debug:
      var: vm_facts

  - name: Get Azure VM Facts without name
    azure_rm_virtualmachine_facts:
      resource_group: "{{ resource_group }}"
    register: vm_facts_without_name
    ignore_errors: True

  - name: Print Azure VM Facts without name
    debug:
      var: vm_facts_without_name

  - name: Get Azure VM Facts without resource group
    azure_rm_virtualmachine_facts:
      name: "{{ vm_name }}"
    register: vm_facts_without_rg
    ignore_errors: True

  - name: Print Azure VM Facts without resource group
    debug:
      var: vm_facts_without_rg

  - name: Get Azure VM Facts with invalid state
    azure_rm_virtualmachine_facts:
      resource_group: "{{ resource_group }}"
      name: "{{ vm_name }}"
      state: invalid
    register: vm_facts_with_invalid_state
    ignore_errors: True

  - name: Print Azure VM Facts with invalid state
    debug:
      var: vm_facts_with_invalid_state
