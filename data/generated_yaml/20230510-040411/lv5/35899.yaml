
- name: Ensure WinRM is enabled on the Windows host
  win_command: powershell.exe Set-ExecutionPolicy Unrestricted -Force; Enable-PSRemoting -Force

- name: Set up authentication for the Windows host
  winrm_authenticate: 
    username: <user_name>
    password: <password>
    kerberos_delegation: yes

- name: Copy file to Windows host
  win_copy:
   src: /path/to/local/file
   dest: /path/to/remote/file
   remote_src: yes

- name: Check if the file is on the Windows host
  win_stat:
    path: /path/to/remote/file

- name: Remove file from Windows host
  win_file:
    path: /path/to/remote/file
    state: absent
