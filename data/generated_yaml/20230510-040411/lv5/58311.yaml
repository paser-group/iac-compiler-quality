
- name: Test authentication with wrong password
  snow_record:
    username: "{{ snow_username }}"
    password: "{{ 'wrong_password' }}"
    instance: "{{ snow_instance }}"
    table: "{{ snow_table }}"
    data: "{{ snow_data }}"
  register: result
  failed_when: result.json.error is not defined

- name: Test authentication with invalid token
  snow_record:
    username: "{{ snow_username }}"
    password: "{{ snow_password }}"
    instance: "{{ snow_instance }}"
    table: "{{ snow_table }}"
    data: "{{ snow_data }}"
    token: "{{ 'invalid_token' }}"
  register: result
  failed_when: result.json.error is not defined

- name: Test authentication with SSO/ADFS
  snow_record:
    username: "{{ snow_username }}"
    password: "{{ snow_password }}"
    instance: "{{ snow_instance }}"
    table: "{{ snow_table }}"
    data: "{{ snow_data }}"
    auth: "oauth"
    token: "{{ snow_token }}"
    oauth:
      client_id: "{{ client_id }}"
      client_secret: "{{ client_secret }}"
