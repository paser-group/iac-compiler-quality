
- name: Test ec2_vpc with valid profile
  ec2_vpc:
    state: present
    profile: myprofile
    region: us-west-2
    cidr_block: 172.31.0.0/16
    resource_tags:
      environment: testing
  register: vpc_test_result
  
- name: Ensure ec2_vpc is created with correct profile
  assert:
    that:
      - "'mycredentials' in vpc_test_result.aws_access_key and 'mysecretkey' in vpc_test_result.aws_secret_key"
    success_msg: "The 'ec2_vpc' module successfully utilized the specified profile to generate AWS credentials."
