
- name: Check if Python is installed
  hosts: remote_host
  become: true

  tasks:
  - name: Check if Python is installed
    shell: "which python"
    register: python_path
    ignore_errors: yes

  - name: Raise an error if Python is not installed
    fail:
      msg: "Python is not installed on the target system"
    when: python_path.rc != 0
   
- name: Try establishing and SSH connection
  hosts: remote_host
  become: true

  vars:
    ansible_connection: ssh
    ansible_ssh_user: remote_user
    ansible_ssh_pass: SSH_PASSWORD

  block:
  - name: SSH Connectivity Check
    ping:

  rescue:
  - name: Raise an error if SSH connectivity fails
    fail:
      msg: "Failed to SSH into the remote system because Python is not installed"
