
- name: Test ec2_win_password with Unicode data in key_data argument
  hosts: localhost
  gather_facts: no

  vars:
    ec2_instance_id: "i-0123456789abcdef0"
    unicode_password: "{{ lookup('pipe', 'echo -n テスト') }}"

  tasks:
    - name: Set Windows password for EC2 instance
      ec2_win_password:
        instance_id: "{{ ec2_instance_id }}"
        password: "{{ unicode_password }}"
        key_data: "{{ lookup('file', '~/path/to/private_key.pem') }}"
      register: ec2_win_password_result

    - name: Show generated password hash
      debug:
        var: ec2_win_password_result.password_hash
