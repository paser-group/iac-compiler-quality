
- name: Test os_keypair module with force flag
  hosts: localhost
  tasks:
  - name: Create keypair with force flag
    os_keypair:
      name: my_key
      public_key_file: /path/to/public/key
      private_key_file: /path/to/private/key
      state: present
      force: true
  
  - name: Create keypair without force flag
    os_keypair:
      name: my_key
      public_key_file: /path/to/public/key
      private_key_file: /path/to/private/key
      state: present
    register: output
  
  - name: Verify keypair was not overwritten
    fail:
      msg: Key pair overwrite issue detected
    when: output.msg is defined
