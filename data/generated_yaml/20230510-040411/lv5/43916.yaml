
- name: Create a BIG-IP pool member
  bigip_pool_member:
    ip: "{{ member_ip }}"
    partition: "{{ partition }}"
    pool: "{{ pool }}"
    provider:
      password: "{{ provider_pass }}"
      server: "{{ provider_server }}"
      user: "{{ provider_user }}"
      validate_certs: "{{ provider_validate_certs }}"
    state: "present"
    port: "{{ member_port }}"
  register: pool_member

- name: Verify that the BIG-IP pool member object is created
  assert:
    that:
      - "'pool_member' in result"
      - "'pool_member_ip' in result"
      - "'partition' in result"
      - "'pool_name' in result"
      - "'port' in result"
    success_msg: "BIG-IP pool member object created successfully"
    fail_msg: "BIG-IP pool member object creation failed"
  vars:
    pool_member_ip: "{{ member_ip }}"
    pool_name: "{{ pool }}"
    partition: "{{ partition }}"
    port: "{{ member_port }}"
    result: "{{ pool_member }}"
