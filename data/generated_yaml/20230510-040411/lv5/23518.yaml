
---
- name: Test Azure RM Securitygroup facts module with proxy connection
  hosts: localhost
  gather_facts: no

  vars:
    proxy_host: "proxy.example.com"
    proxy_port: "8080"
    proxy_user: "username"
    proxy_pass: "password"

  tasks:
    - name: Set Proxy Environment Variables
      ansible.builtin.set_fact:
        https_proxy: "http://{{ proxy_user }}:{{ proxy_pass }}@{{ proxy_host }}:{{ proxy_port }}"
        http_proxy: "http://{{ proxy_user }}:{{ proxy_pass }}@{{ proxy_host }}:{{ proxy_port }}"

    - name: Test Azure RM Securitygroup facts module with malformed requests
      azure_rm_securitygroup_facts:
        resource_group: "example"
        client_id: "example"
        secret: "example"
        tenant: "example"
      register: result

      - debug:
          var: result

