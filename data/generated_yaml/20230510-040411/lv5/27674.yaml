
- name: Test playbook to identify bugs in the nxos_reboot module
  hosts: cisco
  gather_facts: no
  vars:
    cli_flag: true
    nxapi_flag: true
  tasks:
    - name: Ensure connectivity to the device
      wait_for_connection:
        timeout: 30
    - name: Provide device credentials
      include_vars:
        file: "{{ inventory_dir }}/group_vars/all/secrets.yaml"
    - name: Gather information about the device and its current state
      ios_facts:
    - name: Test cli flag
      nxos_reboot:
        cli: "{{ cli_flag }}"
      register: cli_output
    - debug:
        var: cli_output
    - name: Test nxapi flag
      nxos_reboot:
        nxapi: "{{ nxapi_flag }}"
      register: nxapi_output
    - debug:
        var: nxapi_output
