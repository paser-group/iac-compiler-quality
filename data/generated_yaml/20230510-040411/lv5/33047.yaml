yaml
- name: establish persistent SSH connection
  hosts: servers
  gather_facts: no
  vars:
    ansible_ssh_common_args: '-o ControlMaster=auto -o ControlPersist=10m -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'
  tasks:
    - name: transfer files using persistent connection
      ansible.builtin.copy:
        src: /tmp/file.txt
        dest: /tmp/file.txt
      register: transfer
      until: transfer is succeeded
      retries: 5
