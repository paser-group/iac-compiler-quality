
# Check if registry key exists and delete it if it should not exist
- name: Remove invalid registry key
  win_regedit:
    path: HKLM:\Software\MyApp
    name: MyValue
    state: absent

# Check if registry value exists and set it to the right value
- name: Set registry key value
  win_regedit:
    path: HKCU:\Software\MyApp
    name: MyValue
    data: "MyData"

# Set registry key value to a random value each time the playbook runs
- name: Randomize registry key value
  set_fact:
    random_data: "{{ range(1, 10)|random }}"
  win_regedit:
    path: HKLM:\Software\MyApp
    name: MyValue
    data: "{{ random_data }}"
    type: dword
