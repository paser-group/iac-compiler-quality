
---
- name: Test docker_container retries on error 500 from image source
  hosts: localhost
  tasks:
    - name: Start faulty container
      docker_container:
        name: faulty_container
        image: faulty_image
        state: started
        retries: 3
      ignore_errors: yes
      
    - name: Check if the container is running
      command: docker ps | grep faulty_container
      register: ps
      until: ps.stdout != "" or ps is failed
