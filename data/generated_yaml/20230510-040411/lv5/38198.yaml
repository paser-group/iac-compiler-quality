
- hosts: localhost
  vars:
    resource_group_name: "testResourceGroup"
    security_group_name: "testSecurityGroup"
    address_prefixes:
      - "192.168.0.0/16, 10.0.0.0/8"
  tasks:
  - name: "Create security group with rule that includes comma-separated IP prefixes"
    azure_rm_securitygroup:
      resource_group: "{{ resource_group_name }}"
      name: "{{ security_group_name }}"
    azure_rm_securitygroup_rule:
      resource_group: "{{ resource_group_name }}"
      security_group: "{{ security_group_name }}"
      rulename: "testRule"
      protocol: "*"
      destination_port_range: "*"
      access: "Allow"
      direction: "Inbound"
      priority: 100
      source_address_prefixes: "{{ address_prefixes }}"
