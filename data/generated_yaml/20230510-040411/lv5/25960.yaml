
---
- name: Test Ansible handling of MySQL configuration files
  hosts: target_system

  tasks:
    - name: Install MySQL Community Edition
      package:
        name: mysql-community-server
        state: present

    - name: Create MySQL configuration file
      template:
        src: mysql.cnf.j2
        dest: /etc/mysql/my.cnf

    - name: Restart MySQL Service
      service:
        name: mysql
        state: restarted

    - name: Create MySQL User
      mysql_user:
        name: db_user
        login_user: root
        login_password: "{{ lookup('env', 'MYSQL_ROOT_PASSWORD') }}"
        password: "{{ lookup('env', 'MYSQL_PASSWORD') }}"
        state: present
