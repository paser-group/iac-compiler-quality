
- name: Test gcp_container_node_pool module with location field
  hosts: localhost
  gather_facts: no

  vars:
    cluster_name: example-cluster
    node_pool_name: example-pool
    location: us-central1-a

  tasks:
    - name: Create GKE cluster
      gcp_container_cluster:
        name: "{{ cluster_name }}"
        zone: "{{ location }}"
        initial_node_count: 1

    - name: Create node pool
      gcp_container_node_pool:
        name: "{{ node_pool_name }}"
        location: "{{ location }}"
        cluster_name: "{{ cluster_name }}"
        node_count: 1

    - name: Verify node pool location
      assert:
        that:
          - gcp_container_node_pool.json.nodeConfig.zone == location
