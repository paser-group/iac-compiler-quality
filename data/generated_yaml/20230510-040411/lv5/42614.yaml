
---
- name: Test VM instantiation with IPv6
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Create a new virtual machine with IPv6 address
    vmware_guest:
      hostname: "{{ vcenter_hostname }}"
      username: "{{ vcenter_username }}"
      password: "{{ vcenter_password }}"
      datacenter: "{{ datacenter }}"
      folder: "/{{ folder }}"
      name: "{{ vm_name }}"
      state: poweredon
      guest_id: "{{ guest_id }}"
      hardware:
        memory_mb: "{{ memory_size }}"
        num_cpus: "{{ num_cpus }}"
      networks:
      - label: "{{ network_label }}"
        ip: "{{ ipv6_address }}"
        netmask: "{{ ipv6_netmask }}"
        connected: true
      disks:
      - size_gb: "{{ disk_size }}"
        type: "{{ disk_type }}"
        datastore: "{{ datastore }}"
        scsi: paravirtual
