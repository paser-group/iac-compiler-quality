
- name: Test net_cli error handling
  hosts: all
  connection: net_cli
  vars:
    command: "command that triggers an error"
  tasks:
    - name: send command that triggers an error
      raw: "{{ command }}"
      register: command_output
      ignore_errors: yes

    - name: pause until prompt is received
      pause:
        seconds: 60
        prompt: "Enter something when prompt is received"
      when: "'prompt' in command_output.stdout_lines[-1]"
