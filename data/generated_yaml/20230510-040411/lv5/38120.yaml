
- name: Test API token authentication with URI module
  hosts: localhost
  become: no

  vars:
    api_endpoint: "https://example.com/api"
    api_tokens:
      - correct_token: "xxxxxxxxxxxx"
      - missing_token: ""
      - wrong_token: "yyyyyyyyyyyy"
      - expired_token: "zzzzzzzzzzzz"
      
  tasks:
    - name: Test GET Request with correct api token
      uri:
        url: "{{ api_endpoint }}"
        headers:
          Authorization: "Token {{ api_tokens.correct_token }}"
        method: GET
      register: correct_token_response

    - name: Debug correct token response
      debug:
        var: correct_token_response

    - name: Test GET Request with missing api token
      uri:
        url: "{{ api_endpoint }}"
        method: GET
      register: missing_token_response

    - name: Debug missing token response
      debug:
        var: missing_token_response

    - name: Test GET Request with wrong api token
      uri:
        url: "{{ api_endpoint }}"
        headers:
          Authorization: "Token {{ api_tokens.wrong_token }}"
        method: GET
      register: wrong_token_response

    - name: Debug wrong token response
      debug:
        var: wrong_token_response

    - name: Test GET Request with expired api token
      uri:
        url: "{{ api_endpoint }}"
        headers:
          Authorization: "Token {{ api_tokens.expired_token }}"
        method: GET
      register: expired_token_response

    - name: Debug expired token response
      debug:
        var: expired_token_response
