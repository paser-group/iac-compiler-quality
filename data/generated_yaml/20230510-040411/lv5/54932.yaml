
- name: Create a Redis cache in Azure and block by default on provisioning operations
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Create the Redis cache
      azure_rm_rediscache:
        resource_group: test-resource-group
        name: test-cache
        location: eastus
        sku:
          name: Basic
          family: C
          capacity: 1
        redis_configuration:
          maxmemory-policy: allkeys-lru
          notify-keyspace-events: Egx
          save: "60 1000 5"
        block_provisioning_operations: yes
      register: redis_cache

    - name: Print output of the Redis cache creation task
      debug:
        var: redis_cache
