
- name: Test Task Failure
  hosts: eos-routers
  gather_facts: no
  connection: eosapi

  tasks:
  - name: Check for task failure due to incorrect configuration settings
    eos_command:
      commands:
        - show invalid-command
    register: command_result
    ignore_errors: true

  - name: Verify task failure
    fail:
      msg: "Task did not fail as expected"
    when: command_result|failed
