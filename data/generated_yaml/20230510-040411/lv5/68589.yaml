
---
- name: Gather custom facts for Windows targets
  hosts: windows_target
  gather_facts: true

  tasks:
    - name: Gather facts using setup module
      setup:

    - name: Check for exception errors
      fail:
        msg: "Exception error occurred"
      when: ansible_setup_module_exception is defined

    - name: Evaluate compatibility
      assert:
        that:
          - ansible_os_family == "Windows"
