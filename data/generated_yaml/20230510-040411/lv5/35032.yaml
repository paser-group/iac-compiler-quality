
---
- name: Testing Ansible module for subnets
  hosts: localhost
  gather_facts: no
  vars:
    subnet_id: subnet-0123456789abcdef
  tasks:
    - name: Facts for subnet id
      aws_subnet_facts:
        subnet_ids: "{{ subnet_id }}"
        region: us-west-2
      register: subnet_facts
    - meta: flush_handlers
    - name: Fail when a RequestLimitExceeded error occurs
      fail:
        msg: "RequestLimitExceeded error occurred"
      when: "'RequestLimitExceeded' in subnet_facts.stderr"
