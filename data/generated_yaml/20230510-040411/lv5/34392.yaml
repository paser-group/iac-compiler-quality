
- name: Test win_firewall_rule module for default values
  hosts: all
  become: yes

  tasks:
    - name: Test leave existing option
      win_firewall_rule:
        name: Allow HTTP Traffic
        localport: 80
        action: allow
        enabled: yes
        profile: private
        direction: inbound
        description: This rule allows HTTP traffic
        state: present
        allow_legacy_dcom: yes
        interfacetype: any
        leave_existing: yes

    - name: Test without leave existing option
      win_firewall_rule:
        name: Allow HTTP Traffic
        localport: 80
        action: allow
        enabled: yes
        profile: private
        direction: inbound
        description: This rule allows HTTP traffic
        state: present
        allow_legacy_dcom: yes
        interfacetype: any
        leave_existing: no
