
- name: configure IGMP snooping settings on interfaces
  nxos_igmp_interface:
    interface: "{{ item }}"
    snooping: enable
  with_items:
    - "eth 1/1"
    - "eth 1/2"
  register: igmp_snooping_output
  
- name: display debug information
  debug:
    var: igmp_snooping_output
    
- name: verify cli errors
  debug:
    msg: "The IGMP interface was not configured successfully"
  when: "'default' in item.stderr"
  with_items: "{{ igmp_snooping_output | json_query('results[*]') }}"
