
- name: Create MySQL user
  hosts: database
  become: true
  vars:
    mysql_user_db: my_database
    mysql_user_name: my_user
    mysql_user_pass: my_password
    mysql_user_priv: "my_database.*:ALL"
    ansible_python_interpreter: /usr/bin/python3

  tasks:
    - name: Ensure the MySQL client is installed
      apt:
        name: mysql-client
        update_cache: yes

    - name: Add the MySQL user
      mysql_user:
        name: "{{ mysql_user_name }}"
        password: "{{ mysql_user_pass }}"
        priv: "{{ mysql_user_priv }}"
        append_privs: yes
        host: localhost
        state: present
        login_user: root
        login_password: root_password

