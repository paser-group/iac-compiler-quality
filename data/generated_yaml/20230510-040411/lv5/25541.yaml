
---

- name: Test playbook for nxos_vxlan_vtep_vni with nxapi transport
  hosts: "{{ target_hosts }}"
  gather_facts: no

  vars:
    nxos_api_hostname: "{{ inventory_hostname }}"
    nxos_api_username: "{{ nxos_username }}"
    nxos_api_password: "{{ nxos_password }}"

  tasks:
    - name: Enable feature vtep
      nxos_feature:
        feature: vtep
        state: enabled
      register: result
      ignore_errors: yes

    - name: Configure VXLAN VTEP
      nxos_vxlan_vtep_vni:
        host: "{{ nxos_api_hostname }}"
        username: "{{ nxos_api_username }}"
        password: "{{ nxos_api_password }}"
        vxlan_vtep_ip: "10.0.0.1"
        vxlan_multicast_group: "239.1.1.1"
        nxapi_transport: "nxapi"
        state: present
      register: result
      ignore_errors: yes
      
    # Additional tasks to test nxos_vxlan_vtep_vni module with different input parameters

    - name: Print module output
      debug:
        var: result.stdout_lines
      
