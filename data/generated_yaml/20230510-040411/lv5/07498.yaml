
---
- name: Test Ansible Compiler for issues with process_common_errors()
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Generate errors using process_common_errors()
      block:
        - set_fact:
            invalid_variable: "{{ invalidVariable }}"
        - set_fact:
            invalid_value: "{{ 1/0 }}"
        - set_fact:
            invalid_argument: "{{ ['test']|regex_replace('(a))', '\\2\\1') }}"
        - set_fact:
            invalid_file: "{{ lookup('file', 'invalid_file.txt') }}"
      rescue:
        - debug: msg="Caught an exception in process_common_errors(): {{ ansible_failed_result | to_nice_json }} "
