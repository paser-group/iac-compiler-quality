
---
- hosts: swarm_nodes
  tasks:
    - name: Deploy Docker Swarm Service
      docker_swarm_service:
        name: my_swarm_service
        image: nginx:latest
        state: present
        networks:
          - name: my_swarm_network
    - name: Check Swarm Service Status
      shell: docker service ls | grep my_swarm_service
      register: swarm_service_status
    - debug:
        var: swarm_service_status
    # stop the service after checking
    - name: Stop Swarm Service
      shell: docker service rm my_swarm_service
