
- name: Provision Windows Server 2016 EC2 instance
  ec2:
    aws_access_key: "{{ aws_access_key }}"
    aws_secret_key: "{{ aws_secret_key }}"
    instance_type: t2.micro
    image: ami-0d8f6eb4f641ef691
    key_name: mykeypair
    wait: true
    region: us-east-1
    count: 1
    group: my-security-group
    vpc_subnet_id: subnet-abc12345
    assign_public_ip: yes
  register: ec2

- name: Install IIS on Windows Server 2016
  win_feature:
    name: 'Web-Server'
    state: present

- name: Verify IIS installation
  assert:
    that:
      - "'Web Server (IIS)' in inventory_hostname_stdout"
