
- name: Ensure a service is started or stopped on FreeBSD
  become: true
  service:
    name: "{{ service_name }}"
    state: "{{ service_state }}"
  vars:
    service_name: "nginx"
    service_state: "stopped"

- name: Check for service in rc.conf
  become: true
  shell: grep "^{{ service_name }}_enable" /etc/rc.conf | awk -F "=" '{print $2}'
  register: rc_conf_result

- name: Display rc.conf line for the service
  debug:
    msg: "Service is enabled: {{ rc_conf_result.stdout }}"

