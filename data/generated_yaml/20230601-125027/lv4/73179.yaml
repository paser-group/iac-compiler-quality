
- name: Check disk space of remote hosts
  hosts: all
  gather_facts: true
  tasks:
  - name: Check disk space utilization
    shell: df -h
    register: disk_usage
  - name: Check if disk utilization exceeds threshold
    debug:
      msg: "Disk usage of host {{ inventory_hostname }} is at {{ item.5 }}."
    when: item.4|float > 90
    with_items: '{{ disk_usage.stdout_lines[1:] }}'
