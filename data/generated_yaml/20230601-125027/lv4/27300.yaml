
- hosts: all
  gather_facts: yes
  tasks:
  - name: Print ansible_pkg_mgr variable
    debug:
      msg: "Package manager for {{ inventory_hostname }}: {{ ansible_pkg_mgr }}"
      verbosity: 1
    register: pkg_mgr
  - name: Check package manager name
    assert:
      that:
        - pkg_mgr.msg is search('Package manager for {{ inventory_hostname }}: apt')
        - pkg_mgr.msg is search('Package manager for {{ inventory_hostname }}: dnf')
        - pkg_mgr.msg is search('Package manager for {{ inventory_hostname }}: yum')
      success_msg: 'Package manager for {{ inventory_hostname }} is valid'
      fail_msg: 'Package manager for {{ inventory_hostname }} is invalid'
