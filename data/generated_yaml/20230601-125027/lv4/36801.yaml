
---
- name: "Configure SVI Interfaces for Cisco Nexus switches"
  hosts: switches
  gather_facts: no

  vars:
    switch_interfaces:
      - name: "Vlan1"
        address: "10.0.1.10"
        mask: "255.255.255.0"

  tasks:
    - name: "Configure {{ item.name }} interface"
      nxos_config:
        lines:
          - "interface {{ item.name }}"
          - "ip address {{ item.address }}/{{ mask }}"
          - "no shutdown"
      register: output
      with_items: "{{ switch_interfaces }}"

    - name: "Show interfaces"
      nxos_command:
        commands: "show interface {{ item.name }}"
      with_items: "{{ switch_interfaces }}"
