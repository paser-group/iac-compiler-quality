
---
- name: Mount NFS storage
  hosts: all
  vars:
    nfs_share: "{{ ansible_default_ipv4.address }}:/mnt/nfs_share"
    nfs_mount1: /mnt/share1
    nfs_mount2: /mnt/share2
  tasks:
    - name: Create mount points
      file:
        path: "{{ item }}"
        state: directory
      with_items:
        - "{{ nfs_mount1 }}"
        - "{{ nfs_mount2 }}"
      become: true

    - name: Mount NFS share
      mount:
        src: "{{ nfs_share }}"
        path: "{{ item }}"
        fstype: nfs
        opts: defaults
        state: mounted
      with_items:
        - "{{ nfs_mount1 }}"
        - "{{ nfs_mount2 }}"
      become: true
