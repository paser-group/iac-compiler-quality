
- name: Ensure IOS XR L3 configuration is idempotent
  hosts: iosxr
  gather_facts: no
  tasks:
    - name: Configure IOS XR L3 routing
      iosxr_config:
        lines:
          - "router l3vpn"
          - "address-family ipv4 unicast"
          - "route-target export 12345:67890"
          - "route-target import 12345:67890"
        parents: "interface {{ interface }}"
        provider:
          username: "{{ ansible_user }}"
          password: "{{ lookup('file', '/path/to/iosxr_password.txt') }}"
      loop:
        - { interface: "TenGigE0/0/0/0" }
        - { interface: "TenGigE0/0/0/1" }
