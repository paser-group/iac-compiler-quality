
- name: Run service action on FreeBSD
  hosts: freebsd
  become: yes

  tasks:
  - name: Add service to rc.conf
    blockinfile:
      block: |
        {{ service_name }}_flags=""
        {{ service_name }}_enable="YES"
      insertafter: 'last_match'
      path: /etc/rc.conf
    vars:
      service_name: "map_server"

  - name: Restart the service
    service:
      name: "{{ service_name }}"
      state: restarted
