
- name: Mount NFS Storage
  hosts: all
  gather_facts: false
  become: true
  vars:
    nfs_mountpoint: /mnt/nfs
    nfs_server: nfsserver.example.com
    nfs_share: /exported/files
  tasks:
    - name: Install NFS Client
      package:
        name: nfs-utils
        state: installed
      register: nfs_installed
    
    - name: Mount NFS Share
      mount:
        path: "{{ nfs_mountpoint }}"
        src: "{{ nfs_server }}:{{ nfs_share }}"
        state: mounted
        fstype: nfs
      when: nfs_installed.changed == true
