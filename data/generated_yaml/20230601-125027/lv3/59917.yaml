
- hosts: localhost
  gather_facts: no
  vars:
    vmware_portgroup:
      name: "{{ portgroup_name }}"
      switch_name: "{{ switch_name }}"
      vlan_id: "{{ vlan_id }}"
      state: present
  tasks:
    - name: Create a new VMware port group
      vmware_portgroup:
        hostname: "{{ vcenter_ip }}"
        username: "{{ vcenter_username }}"
        password: "{{ vcenter_password }}"
        datacenter: "{{ datacenter_name }}"
        cluster: "{{ cluster_name }}"
        validate_certs: no
        portgroup: "{{ vmware_portgroup }}"
      register: output
    - debug:
        var: output.changed
