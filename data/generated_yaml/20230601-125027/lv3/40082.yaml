
- hosts: localhost
  connection: local
  tasks:
    - name: Dynamically update the inventory file
      shell: echo "test ansible_host=10.1.1.5 ansible_connection=docker ansible_user=root ansible_python_interpreter=/usr/bin/python3" >> inventory
      changed_when: false

- hosts: all
  gather_facts: false
  tasks:
    - name: Use dynamically updated inventory before playbook start
      ping:
        hosts: test
