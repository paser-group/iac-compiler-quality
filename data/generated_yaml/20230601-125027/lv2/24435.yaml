yaml
- hosts: all
  vars:
    vm_name: "{{ 'test-vm-' ~ ansible_date_time.epoch }}"
    template: "centos_template"
    datastore: "datastore1"
    disk_size_gb: 50
    num_cpus: 2
    memory_mb: 2048
    network_name: "VM Network"
  tasks:
    - name: Create VM from template with disk option
      vmware_guest:
        hostname: "{{ inventory_hostname }}"
        username: "root"
        password: "s3cr3t"
        validate_certs: no
        datacenter: "DC1"
        template: "{{ template }}"
        name: "{{ vm_name }}"
        datastore: "{{ datastore }}"
        disk:
          - size_gb: "{{ disk_size_gb }}"
            type: thin
        hardware:
          memory_mb: "{{ memory_mb }}"
          num_cpus: "{{ num_cpus }}"
          scsi: paravirtual
        networks:
          - name: "{{ network_name }}"
            ip: 10.1.1.5
      ignore_errors: true
