
---
- name: Test Playbook
  hosts: all
  remote_user: root

  tasks:

  - name: Verify default configuration
    command: cat /etc/ansible/ansible.cfg
    register: default_conf

  - name: Test default configurations
    assert:
      that:
        - "'nocows' in default_conf.stdout_lines[4]"
        - "'host_key_checking' in default_conf.stdout_lines[10]"

  - name: Verify overridden configuration
    command: cat /etc/ansible/hosts
    register: overridden_conf

  - name: Test overridden configurations
    assert:
      that:
        - "'ubuntu1' in overridden_conf.stdout_lines[1]"
        - "'alpine1' in overridden_conf.stdout_lines[2]"
        - "'centos1' in overridden_conf.stdout_lines[3]"
        - "'redhat1' in overridden_conf.stdout_lines[4]"

  - name: Display Ansible default configurations
    debug:
      var: ansible_facts.ansible_default_ipv4

  - name: Display Ansible overridden configurations
    debug:
      var: ansible_facts.ansible_all_ipv4_addresses
