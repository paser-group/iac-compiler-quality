
- name: Test ansible_service_mgr fact
  hosts: all
  gather_facts: no
  tasks:
    - name: Display service manager info
      debug:
        var: ansible_service_mgr
      vars:
        sysvinit_binary: "{{ item }}{{ lookup('pipe', 'whoami') }}"
      with_items:
        - '/bin/'
        - '/usr/bin/'
        - '/usr/local/bin/'
        - '{{ sysvinit_binary }}'
    - name: Test invalid service manager
      debug:
        msg: "Service manager '{{ ansible_service_mgr }}' is not a valid option."
      when: ansible_service_mgr not in ['sysvinit', 'systemd']
