
- name: Jinja2 default filter usage causing when condition failure
  hosts: all
  gather_facts: no

  tasks:
  - name: Set variable to undefined
    set_fact:
      my_var: ''

  - name: Test failing when condition with default filter
    debug:
      msg: "My variable is undefined"
    when: my_var|default('undefined') == 'undefined'
