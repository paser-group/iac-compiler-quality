
- name: Retrieve Azure Key Vault secret
  hosts: all
  vars:
    azure_tenant_id: "YOUR-AD-TENANT-ID"
    azure_client_id: "YOUR-AD-CLIENT-ID"
    azure_secret: "YOUR-AD-CLIENT-SECRET"
    subscription_id: "YOUR-SUBSCRIPTION-ID"
    resource_group: "YOUR-RESOURCE-GROUP"
    key_vault: "YOUR-KEY-VAULT-NAME"
    secret_name: "YOUR-SECRET-NAME"
  tasks:
    - name: Fetch the Azure Key Vault secret
      azure_rm_keyvaultsecret:
        subscription_id: "{{ subscription_id }}"
        resource_group: "{{ resource_group }}"
        key_vault: "{{ key_vault }}"
        secret_name: "{{ secret_name }}"
        tenant: "{{ azure_tenant_id }}"
        client_id: "{{ azure_client_id }}"
        secret: "{{ azure_secret }}"
      register: secret_result
    - name: Display the secret value
      debug:
        var: secret_result
