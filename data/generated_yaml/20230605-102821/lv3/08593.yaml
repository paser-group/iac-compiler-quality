
- name: Test ansible authorized_key and with_items modules with empty input
  hosts: all
  gather_facts: false

  tasks:
  - name: Create an empty list
    set_fact:
      key_list: []

  - name: Try to add empty key to authorized_keys
    authorized_key:
      key: "{{ item }}"
      user: "{{ ansible_user }}"
    with_items: "{{ key_list }}"

  - name: Try to loop over empty list
    shell: echo "{{ item }}"
    with_items: "{{ key_list }}"
