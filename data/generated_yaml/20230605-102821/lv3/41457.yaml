
- hosts: nxos_switch
  gather_facts: no
  tasks:
  - name: Get nxos facts in legacy mode with fan information subset
    nxos_facts:
      provider:
        host: "{{ inventory_hostname }}"
        username: "{{ username }}"
        password: "{{ password }}"
        transport: cli
        use_legacy: yes
      subset: fan
    register: facts

  - name: Print fan information
    debug:
      var: facts.ansible_facts.nxos_facts_fan
