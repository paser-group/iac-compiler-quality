
- name: Execute recursion loop
  hosts: all
  tasks:
    - name: Recursive task
      block:
        - name: Check recursion depth
          debug: msg="{{ansible_facts.recursion_depth}}"
        - name: Execute recursive task
          include_tasks: "{{ playbook_dir }}/recursive_task.yml"
      when: ansible_facts.recursion_depth < 1000
