
- name: Deploy Azure Resource Group
  hosts: localhost
  connection: local
  gather_facts: no
  vars:
    rg_location: eastus
    rg_name: "{{ playbook_name }}"
  tasks:
  - name: Create resource group
    azure_rm_resourcegroup:
      name: "{{ rg_name }}"
      location: "{{ rg_location }}"
    register: rg
  - name: Azure RM Deployment
    azure_rm_deployment:
      location: "{{ rg_location }}"
      resource_group_name: "{{ rg_name }}"
      template: "{{ template }}"
      parameters:
        par1: "{{ par1 }}"
        par2: "{{ par2 }}"
      mode: incremental
    register: deployment_result
  - name: Display Deployment Result
    debug:
      var: deployment_result
