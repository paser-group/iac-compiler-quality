
- name: Create a GCE instance with a service account
  gcp_compute_instance:
    name: test-instance
    machine_type: n1-standard-1
    disks:
      - auto_delete: true
        boot: true
        initialize_params:
          image: projects/debian-cloud/global/images/family/debian-9
    zone: us-central1-a
    project_id: my-project
    auth_kind: serviceaccount
    service_account_file: /path/to/service_account.json
    service_account_contents:
      client_email: "email@example.com"
      private_key_id: "keyid"
      private_key: |
        -----BEGIN PRIVATE KEY-----
        keydata
        -----END PRIVATE KEY-----
