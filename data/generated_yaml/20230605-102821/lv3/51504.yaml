
- name: Ensure the `ansible_processor_vcpus` fact is calculated correctly
  hosts: all
  gather_facts: yes

  tasks:
  - name: Generate debug message for `ansible_processor_vcpus`
    debug:
      var: ansible_processor_vcpus
  
  - name: Run container and get `ansible_processor_vcpus` fact
    docker_container:
      name: sample_container
      image: ubuntu:latest
      command: /bin/bash
      detach: yes
    register: container_info

  - name: Print `ansible_processor_vcpus` fact for container
    debug:
      var: container_info.ansible_facts.ansible_processor_vcpus
