yaml
- name: Install a package with DNF and report errors
  hosts: all
  tasks:
    - name: Install the package
      dnf:
        name: "{{ package }}"
        state: latest
      ignore_errors: yes
      register: result

    - name: Fail if there are RPM scriptlet errors
      fail:
        msg: "RPM scriptlet errors occurred during package installation"
      when: "'scriptlet failure' in result.msg"
