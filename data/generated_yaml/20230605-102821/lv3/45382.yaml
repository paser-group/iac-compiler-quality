
- name: Play to test aggregated inventory
  hosts: all
  gather_facts: false

  tasks:
    - name: Add inventory plugin for multiple inventories
      add_host:
        name: "{{ item }}"
        ansible_host: "{{ hostvars[item]['ansible_host'] }}"
        ansible_user: "{{ hostvars[item]['ansible_user'] }}"
        ansible_ssh_private_key_file: /var/tmp/key_I.pem
        ansible_become_pass_file: /path/to/become_pass_file
        ansible_connection: ssh
      with_items:
        - ubuntu1
        - alpine1
        - centos1
        - redhat1
      ignore_errors: true
