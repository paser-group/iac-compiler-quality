
- name: Cache facts on Redis server
  hosts: all
  gather_facts: true
  become: yes
  become_method: sudo
  vars:
    ansible_cache_plugin: redis
    redis_host: localhost
    redis_port: 6379
    redis_socket_timeout: 0.1
    redis_db: 0
    redis_password: ""
  tasks:
    - name: Cache facts
      setup:
        fact_caching: yes
        fact_caching_connection: "{{redis_host}}:{{redis_port}}"
        fact_caching_timeout: "{{redis_socket_timeout}}"
        fact_caching_prefix: "{{ansible_user}}"
