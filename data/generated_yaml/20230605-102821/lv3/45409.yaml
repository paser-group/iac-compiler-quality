
- name: Resize disk and restore VM with multiple SCSI controllers
  hosts: localhost
  gather_facts: no
  vars:
    vm_name: "{{ inventory_hostname }}"
    vmware_guest_disk:
      - size_gb: 100
        state: absent
        device_type: scsi
        controller_type: pvscsi
        unit_number: 0
      - size_gb: 100
        state: present
        device_type: scsi
        controller_type: lsilogic
        unit_number: 1
  tasks:
  - name: "Resize disk with multiple SCSI controllers"
    vmware_guest_disk:
      validate_certs: no
      hostname: "{{ vcenter_hostname }}"
      username: "{{ vcenter_username }}"
      password: "{{ vcenter_password }}"
      datacenter: "{{ datacenter_name }}"
      name: "{{ vm_name }}"
      disks: "{{ vmware_guest_disk }}"
    delegate_to: localhost
