
---
- hosts: localhost
  gather_facts: no
  tasks:
    - name: Azure RM Virtual Machine Facts using tags
      azure_rm_virtualmachine_facts:
        resource_group: "resource-group"
        tag_name: "tag-name-1"
        tag_value: "tag-value-1"
        api_profile: latest

      register: vm_facts

    - name: Display virtual machine facts using tags
      debug:
        msg: "{{ vm_facts.virtual_machines }}"
