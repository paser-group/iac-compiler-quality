
- name: Create a database and a user
  hosts: all
  gather_facts: no
  vars:
    db_name: mydb
    db_user: myuser
    db_password: mypassword
  tasks:
  - name: Create MySQL database
    mysql_db:
      name: "{{ db_name }}"
      state: present
      login_user: root
      login_password: "{{ lookup('env', 'MYSQL_ROOT_PASSWORD') }}"
      login_unix_socket: /run/mysqld/mysqld.sock
      target: "{{ inventory_hostname }}"
      mysql_user: "{{ db_user }}"
      mysql_password: "{{ db_password }}"
      mysql_priv: "{{ db_name }}.*:ALL"
