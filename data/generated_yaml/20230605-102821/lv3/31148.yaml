
- name: Clear Redis Facts Cache
  hosts: all
  gather_facts: yes
  tasks:
    - name: Set Redis as fact cache
      set_fact:
        ansible_cache_plugin: redis
        ansible_cache_plugin_connection: /tmp/redis.sock
        
    - name: Test Fact Caching
      set_fact:
        my_fact: "{{ ansible_date_time.epoch }}"
      
    # Flush Redis cache
    - name: Flush Redis Cache
      redis:
        flush_all: yes
      become: yes
      
    # Verify Fact Caching
    - name: Test Fact Caching Again
      set_fact:
        my_fact: "{{ ansible_date_time.epoch }}"
      
    - name: Display Cached Fact Value
      debug: var=my_fact
