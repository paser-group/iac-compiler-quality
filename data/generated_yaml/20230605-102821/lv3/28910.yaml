
---
- name: Validate Password Policy
  hosts: all
  become: yes

  vars:
    password: weak

  tasks:
  - name: Change Password for User
    user:
      name: ansibleuser
      update_password: always
      password: "{{password}}"
      
  - name: Test Login With New Password
    command: id
    register: login_output
    ignore_errors: true
    
  - name: Validate Password Error
    assert:
      that:
        - "'password is too simple' in login_output.stderr"
