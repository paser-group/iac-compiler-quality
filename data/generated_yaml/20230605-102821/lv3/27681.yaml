
- name: Test DNS resolution failure
  hosts: all
  tasks:
    - name: Ping example.com
      ping:
        data: example.com
      register: ping_result
    - name: Add IP to iptables
      iptables:
        chain: INPUT
        protocol: all
        destination: "{{ ping_result.x }}"
        jump: DROP
      when: ping_result.failed == true
