
- name: Create a VM with IPv6 address
  hosts: localhost
  connection: local
  gather_facts: no
  tasks:
  - name: Create VM using vmware_guest
    vmware_guest:
      hostname: "{{ vcenter_hostname }}"
      username: "{{ vcenter_username }}"
      password: "{{ vcenter_password }}"
      validate_certs: no
      name: "{{ vm_name }}"
      state: poweredon
      hardware:
        memory_mb: 2048
        num_cpus: 2
      guest_id: "{{ guest_id }}"
      disk:
        - size_gb: 20
          type: thin
      networks:
        - name: "{{ network_label }}"
          start_connected: yes
          adapter_type: vmxnet3
          ipv6:
            address: "{{ ipv6_address }}"
            prefix_length: "{{ prefix_length }}"
