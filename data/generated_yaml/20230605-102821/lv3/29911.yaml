
- name: Launch Elasticache
  hosts: localhost
  gather_facts: false
  vars:
    aws_profile: non-existent-profile

  tasks:
    - name: Provision Elasticache instance
      ec2_instance:
        aws_access_key: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"
        profile: "{{ aws_profile }}"
        instance_type: cache.t2.small
        image: ami-07df274a488ca919d
        region: us-east-1
        count: 1
        key_name: mykey
        security_group: elasticache-security-group
      register: ec2_instance

    - name: Print EC2 instance
      debug:
        var: ec2_instance
