
- name: Check AIX WPARs
  hosts: aix_hosts
  gather_facts: no
  tasks:
    - name: Execute lswpar command
      shell: chroot /WPAR /usr/bin/lswpar
      register: lswpar_output
      ignore_errors: yes
    - name: Check for errors
      fail:
        msg: "lswpar command exited with a non-zero status code"
      when: lswpar_output.rc != 0
