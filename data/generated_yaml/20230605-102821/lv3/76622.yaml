
- name: Test OpenStack Inventory
  hosts: localhost
  connection: local

  tasks:
    - name: Set up OpenStack Inventory
      set_fact:
        inventory: "plugins/inventory/openstack_inventory.py"
        auth_url: "https://openstack.example.com:5000/v2.0/"
        username: "<username>"
        password: "<password>"
        project_name: "<project_name>"
        project_domain_name: "<project_domain_name>"
        user_domain_name: "<user_domain_name>"
      tags: 
        - openstack

    - name: Test OpenStack connecitivity
      os_server_facts:
        auth_url: "{{auth_url}}"
        username: "{{username}}"
        password: "{{password}}"
        project_name: "{{project_name}}"
        project_domain_name: "{{project_domain_name}}"
        user_domain_name: "{{user_domain_name}}"
        timeout: 30
      tags:
        - openstack

    - debug:
        var: ansible_facts.openstack_servers
      tags:
        - openstack
