
- name: Create an Azure VM
  hosts: localhost
  connection: local
  gather_facts: False
  vars:
    resource_group: "{{ rg_name }}"
    location: "{{ location_name }}"
    admin_username: "{{ admin_username }}"
    admin_password: "{{ admin_password }}"
    image:
      offer: "{{ image_offer }}"
      publisher: "{{ image_publisher }}"
      sku: "{{ image_sku }}"
      version: "{{ image_version }}"
    vm_size: "{{ invalid_vm_size }}"
  tasks:
    - name: Create a VM
      azure_rm_virtualmachine:
        resource_group: "{{ resource_group }}"
        name: "{{ vm_name }}"
        vm_size: "{{ vm_size }}"
        admin_username: "{{ admin_username }}"
        admin_password: "{{ admin_password }}"
        image: "{{ image }}"
        location: "{{ location }}"
      register: vm

    - debug:
        var: vm
