
- name: Create VLANs
  hosts: all
  gather_facts: false

  tasks:
    - name: create vlan
      net_vlan:
        vlan_id: "{{ item.vlan_id }}"
        name: "{{ item.name }}"
      with_items:
        - { vlan_id: 500, name: "vlan500" }
        - { vlan_id: 600, name: "vlan600" }
      register: result

    - name: aggregate info
      debug:
        var: result.results | json_query('[].[stdout, stderr]')
      vars:
        ansible_python_interpreter: /usr/bin/python
