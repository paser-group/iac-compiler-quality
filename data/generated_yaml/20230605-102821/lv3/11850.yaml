
- hosts: all
  tasks:
    - name: Test shell module error code
      shell: ls | not_a_valid_command
      register: shell_output
      ignore_errors: true

    - debug:
        var: shell_output.rc
