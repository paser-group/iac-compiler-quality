
- hosts: all
  tasks:
  - name: Create a disk from a snapshot
    gce_pd: 
      name: test-disk-{{ ansible_date_time.epoch }}
      zone: us-central1-c
      source_snapshot: sample-snap
      project_id: "my-gcp-project"
    register: disk

  - name: Format and Mount the Disk
    mount:
      path: /mnt/disks/test
      src: "/dev/disk/by-id/google-{{ disk.name }}-part1"
      fstype: ext4
      state: mounted
      opts: "defaults,noatime"
