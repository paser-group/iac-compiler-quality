
- name: Kubernetes Module Test
  hosts: localhost
  gather_facts: no
  vars:
    kubeconfig: /path/to/kubeconfig
    body: "<some_request_body>"
  tasks:
    - name: Apply Kubernetes Object
      k8s:
        kubeconfig: "{{ kubeconfig }}"
        state: present
        definition: "{{ body }}"
      register: result
      retries: 3
      delay: 5
      until: result.status == 422
