
- name: Configure ios device
  ios_config:
    provider:
      host: "{{ inventory_hostname }}"
      username: "admin"
      password: "{{ lookup('file', 'path/to/password_file') }}"
    commands:
      - command: "command 1"
      - command: "command 2"
      - command: "command 3"
      - command: "command 4"
  register: result

- name: Check for errors
  fail:
    msg: "ios_config failed with error code {{ result.rc }}"
  when: result.rc is defined and result.rc != 0
