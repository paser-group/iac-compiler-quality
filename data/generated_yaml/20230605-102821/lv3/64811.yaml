
- name: Test sudo with become:false
  hosts: all
  tasks:
  - name: Run command without elevated privileges
    command: echo "Hello World"
    become: false
    ignore_errors: yes
    register: result_without_become
  - name: Run command with elevated privileges
    command: echo "Hello World"
    become: true
    become_method: sudo
    become_user: root
    ignore_errors: yes
    register: result_with_become
  - name: Fail if sudo prompt is detected
    assert:
      that: "'incorrect password attempt' not in result_with_become.stderr"
