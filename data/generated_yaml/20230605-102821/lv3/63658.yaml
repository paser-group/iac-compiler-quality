
---
- name: Gather facts for all nodes
  hosts: all
  gather_facts: false
  tasks:
    - name: Install Python if not installed
      raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
    - name: Gather pre-requisite facts
      setup:
        filter: "ansible_python_version"
    - name: Gather facts for remote nodes with delegate_facts
      delegate_facts: true
