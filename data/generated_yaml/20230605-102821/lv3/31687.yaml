
- name: Remove authorized keys
  hosts: all
  tasks:
    - name: Remove a key from authorized_keys
      authorized_key:
        user: "{{ ansible_user }}"
        state: present
        key: "{{ lookup('file', '/path/to/public_key') }}"
      register: auth_key
    - name: Remove a non-existent key from authorized_keys
      authorized_key:
        user: "{{ ansible_user }}"
        state: present
        key:
          - "{{ lookup('file', '/path/to/non-existent-key1.pub') }}"
          - "{{ lookup('file', '/path/to/non-existent-key2.pub') }}"
      until: auth_key is success
