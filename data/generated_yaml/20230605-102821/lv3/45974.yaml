yaml
- name: Playbook to reproduce error when using with_items and when condition with body filter
  hosts: all
  become: true
  gather_facts: false

  tasks:
    - name: Echo debug message
      debug: 
        msg: "{{ item }} has a color of {{ item.color }}"
      with_items:
        - { color: "red" }
        - { color: "blue" }
        - { color: "green" }
      
      when:
        - item.color == "red"
        - "{{ item.color | lower }}" == "red"
