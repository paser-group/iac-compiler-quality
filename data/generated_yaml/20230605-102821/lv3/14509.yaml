
- name: Attempt OpenStack connection
  hosts: openstack
  gather_facts: no
  vars:
    ansible_ssh_common_args: '-o ProxyCommand=\"/usr/bin/ncat --proxy 10.1.1.1:8080 %h %p\"'
    insecure: true
  tasks:
    - name: Ping OpenStack server
      os_server:
        auth:
          auth_url: https://<OS_AUTH_URL>
          username: <OS_USERNAME>
          password: <OS_PASSWORD>
          project_name: <OS_TENANT>
          project_domain_name: <OS_PROJECT_DOMAIN_NAME>
          user_domain_name: <OS_USER_DOMAIN_NAME>
        state: present
        name: openstack-server
        metadata: {"foo": "bar"}
