
- hosts: all
  gather_facts: no
  tasks:
  - name: Run async tasks
    command: echo 'Task {{ item }}' && sleep 3
    loop: "{{ range(5) | list }}"
    async: 25
    poll: 0
    register: async_test
  - name: Wait for async results
    async_status:
      jid: "{{ item.ansible_job_id }}"
    loop: "{{ async_test.results }}"
    poll: 0
    delay: 1
    register: async_result
    delegate_to: localhost
  - name: Print async results
    debug:
      var: item.stdout_lines
    loop: "{{ async_result.results }}"
