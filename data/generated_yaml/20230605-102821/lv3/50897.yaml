
- name: Include a role and stop the playbook if there is an error
  include_role:
    name: my_role
  register: my_role_result
  ignore_errors: yes

- name: Fail the playbook if the previous task had an error
  fail:
    msg: "The role 'my_role' failed"
  when: my_role_result.failed
