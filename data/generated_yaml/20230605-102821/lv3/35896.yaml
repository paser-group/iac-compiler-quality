
- name: Allocate memory
  shell: "dd if=/dev/zero of=/dev/null bs={{memory_size}} count=1"
  ignore_errors: true

- name: Handle memory allocation error
  fail:
    msg: "Unexpected Exception, this is probably a bug: [Errno 12] Cannot allocate memory"
  when: "'Cannot allocate memory' in allocate_result.stderr"
