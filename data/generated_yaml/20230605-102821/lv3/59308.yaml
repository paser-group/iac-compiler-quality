
- name: Test 'become' on Windows
  hosts: windows
  gather_facts: false
  tasks:
    - name: Check disk space
      win_shell: Get-PSDrive C |
        Select-Object `
          @{'Name'='FreeSpace'; 'Expression'={$_.Free}} |
        ForEach-Object {$_.FreeSpace}

  vars:
    ansible_become: 'yes'
    ansible_become_method: 'runas'

  become: true
  become_method: runas
