
- name: Update RabbitMQ user password 
  hosts: localhost
  become: true
  vars:
    rabbitmq_user: admin
    rabbitmq_password: strong_password
    updated_password: new_password
  tasks:
    - name: Create RabbitMQ user with Admin Tag and Password
      rabbitmq_user:
        user: "{{ rabbitmq_user }}"
        password: "{{ rabbitmq_password }}"
        vhost: "/"
        configure_priv: ".*"
        read_priv: ".*"
        write_priv: ".*"
        tags: "administrator"

    - name: Update RabbitMQ user password
      rabbitmq_user:
        user: "{{ rabbitmq_user }}"
        password: "{{ updated_password }}"
        vhost: "/"
        configure_priv: ".*"
        read_priv: ".*"
        write_priv: ".*"
        tags: "administrator"
      register: result

    - name: Display result
      debug:
        var: result
