
- hosts: localhost
  connection: local

  gather_facts: false

  vars:
    instance_id: "i-1234567890abcdef0"
    ami_name: "my-ec2-ami"
    region: "us-east-1"

  tasks:
    - name: "Create EC2 AMI with long wait time"
      ec2_ami:
        instance_id: "{{ instance_id }}"
        wait: "yes"
        region: "{{ region }}"
        name: "{{ ami_name }}"
        description: "My AMI"
        block_device_mappings:
          - device_name: "/dev/sdc"
            no_device: ""

      register: ec2_ami

    - name: "Debug EC2 AMI output"
      debug:
        var: ec2_ami
