
- name: Upload OS image with timeout
  hosts: ubuntu1
  vars:
    os_img_path: "/path/to/os/image.iso"
    remote_path: "/remote/path/to/uploaded/os/image.iso"
  tasks:
    - name: Copy OS image to remote node
      copy:
        src: "{{ os_img_path }}"
        dest: "{{ remote_path }}"
        remote_src: True
      register: file_copied
    - name: Check if OS image is uploaded
      stat:
        path: "{{ remote_path }}"
      register: stat_result
      until: stat_result.stat.exists
      retries: 3
      delay: 10
