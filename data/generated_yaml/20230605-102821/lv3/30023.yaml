
- name: Create VPC using ec2_vpc
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Create a VPC
      ec2_vpc_net:
        region: "{{ region }}"
        cidr_block: "{{ cidr_block }}"
        profile: "{{ profile_name }}"
        subnets:
          - cidr: "{{ subnet_cidr }}"
            az: "{{ aws_az }}"
            resource_tags: "{{ tags }}"
        internet_gateway: yes
        route_tables:
          - subnets:
             - "{{ subnet_id }}"
      register: vpc_result
