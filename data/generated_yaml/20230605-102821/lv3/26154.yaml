
- name: Test network_group_modules setting in Ansible
  hosts: all
  gather_facts: no

  tasks:
  - name: Create ansible.cfg file with incorrect network modules
    copy:
      dest: /etc/ansible/ansible.cfg
      content: |
        [defaults]
        inventory = /etc/ansible/hosts
        transport = ssh
        network_group_modules = dummy_plugin

  - name: Load the inventory using ansible-inventory command
    shell: ansible-inventory -i /etc/ansible/hosts --list
    register: inventory_output

  - name: Debug the inventory status
    debug: var=inventory_output.stderr_lines
