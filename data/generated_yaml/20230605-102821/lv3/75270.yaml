
- name: Get service facts for systemd-modules-load.service
  service_facts:
    - name: systemd-modules-load.service

- name: Check if systemd-modules-load.service is running on CentOS7
  debug:
    var: ansible_facts.services["systemd-modules-load.service"]["state"]

- name: Check if status of systemd-modules-load.service is active
  debug:
    var: ansible_facts.services["systemd-modules-load.service"]["status"]["ActiveState"]
  when: ansible_facts.services["systemd-modules-load.service"]["state"] == "running"
  register: service_status

- name: Report status of systemd-modules-load.service
  debug:
    msg: "systemd-modules-load.service status is {{ service_status['ansible_facts']['services']['systemd-modules-load.service']['status']['ActiveState'] }}"
