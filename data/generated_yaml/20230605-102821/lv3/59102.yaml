
- name: Set IAM password policy
  iam_policy:
    policy_name: "password-policy"
    policy_document:
      Version: "2012-10-17"
      Statement:
        - Sid: "PasswordRequirements"
          Effect: "Deny"
          Action: "iam:ChangePassword"
          Resource: "*"
          Condition:
            Bool:
              aws:MultiFactorAuthPresent: "false"
              NumericLessThan:
                "iam:PasswordExpirationTimestamp":
                  "Fn::Join": [ "", ["arn:aws:iam::", "{{ account_id }}", ":password-policy/", "{{ policy_name }}" ]]
