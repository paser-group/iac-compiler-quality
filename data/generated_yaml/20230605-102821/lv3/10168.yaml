
- name: Example Playbook
  hosts: all
  become: true

  roles:
    - role: my-role
      vars:
        my_var: "{{ inventory_hostname }}"
      when: "'{{ inventory_hostname }}' in groups['group_with_var']"
 
  tasks:
    - name: Check if my-var is defined
      fail:
        msg: "my-var is not defined"
      when: "my_var is not defined"
