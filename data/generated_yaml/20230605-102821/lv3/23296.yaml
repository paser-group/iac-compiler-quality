
- name: Create mssql database
  hosts: ubuntu1
  become: true
  vars:
    mssql_db_name: "test_db"
    mssql_db_collation: "SQL_Latin1_General_CP1_CI_AS"
  tasks:
  - name: Install MSSQL-Python connector
    apt:
      name: python3-pymssql
      state: present
    register: apt_output

  - name: Verify installation output
    debug:
      msg: "{{apt_output.stdout_lines}}"
    when: apt_output is defined and apt_output.stdout_lines is defined

  - name: Create mssql database
    mssql_db:
      name: "{{ mssql_db_name }}"
      collation: "{{ mssql_db_collation }}"
