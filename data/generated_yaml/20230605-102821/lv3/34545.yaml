
- name: Remove vim from nodes
  hosts: all
  become: true
  tasks:
    - name: remove vim package
      apt:
        name: vim
        state: absent
      ignore_errors: yes
      
- name: Test missing vim package with vault
  hosts: all
  become: true
  tasks:
    - name: Create a vault file
      command: vault create secret/test value=testing123
      register: create_vault
      ignore_errors: yes
    - name: Check if the command runs successfully
      assert:
        that: "'vim: command not found' in create_vault.stderr"
