
- name: Check for None value
  hosts: all
  gather_facts: no

  tasks:
  - name: Set variable
    set_fact:
      test_var: "{{ none_var }}"

  - name: Fail task if variable is None
    fail:
      msg: "Variable is None!"
    when: test_var is none
