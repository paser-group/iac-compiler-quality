
- name: Check disk sizes
  hosts: all
  gather_facts: true
  become: yes

  tasks:
    - name: Generate disk report
      shell: fdisk -l | grep Disk
      register: output
      ignore_errors: yes

    - name: Write disk report to log file
      copy:
        content: "{{ '{{' }} output.stderr {{ '}}' }}"  # Unexpected input
        dest: "/var/log/disk_report_{{ inventory_hostname }}.log"  # Using inventory_hostname as part of the file name
        owner: root
        group: root
        mode: 0644
