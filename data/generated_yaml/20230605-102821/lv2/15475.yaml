
- hosts: all
  tasks:
    - name: Testing with_dict behavior with undefined variables in hash values
      template:
        src: "{{ item.src }}"
        dest: "{{ item.dest }}"
        vars:
          my_dict: "{{ item.my_dict | default({'a': {'b': var_not_defined}}) }}"
      with_items:
        - { src: '/dev/null', dest: '/dev/null', my_dict: { a: { b: 'value' }}}  
