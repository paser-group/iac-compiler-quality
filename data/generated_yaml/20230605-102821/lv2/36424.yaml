
- hosts: all
  gather_facts: false
  tasks:
    - name: Synchronize files using local_action
      local_action:
        module: synchronize
        src: "{{ item }}"
        dest: "/test/{{ item }}"
        compress: "{{ item|basename }}.tgz"
        checksum: no
        delete: "{{ item|random }}"
      with_fileglob:
        - "/tmp/*"
  become: yes
