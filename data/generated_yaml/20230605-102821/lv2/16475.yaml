
- name: Test any_errors_fatal error
  hosts: all
  gather_facts: false
  tasks:
  - name: Ping all hosts
    ansible.builtin.ping

  - name: Attempt SSH connection to an unreachable host (incorrect IP)
    ansible.builtin.shell: ssh -o StrictHostKeyChecking=no -i /var/tmp/key_I.pem ansible@10.1.1.9
    ignore_errors: yes

  - name: Execute an invalid command
    ansible.builtin.command: cmd122
    register: output
    failed_when: false
    ignore_errors: true
    delegate_to: ubuntu1

  any_errors_fatal: true
