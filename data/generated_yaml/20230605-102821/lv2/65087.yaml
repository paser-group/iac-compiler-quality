
- name: Test Ansible Compiler for Byte/Str Encoding
  hosts: all
  gather_facts: no
  become: yes
  tasks:
  - name: Convert string to bytes
    set_fact:
      result: "{{ 'default' | to_bytes(encoding='UTF-8') }}"

  - name: Verify encoding
    shell: |
      if [ '{{ result }}' != "b'default'" ]; then exit 1; fi
    register: cmd_output
    changed_when: false

  - name: Display output
    debug:
      var: cmd_output.stdout_lines
