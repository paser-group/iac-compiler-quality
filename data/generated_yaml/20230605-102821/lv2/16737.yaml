
---
- name: Ansible Compiler Stress Test Playbook
  hosts: all
  gather_facts: no

  tasks:
    - name: Install Python 2.7 on Gentoo Container
      raw: |
        emerge -q =dev-lang/python-2.7*
      delegate_to: "{{ inventory_hostname }}"
      when: ansible_distribution == 'Gentoo' and '2.7' not in ansible_python_version

    - name: Test ansible_connection LXD on Gentoo Container with Python 3.4
      shell: echo "Hello, World!"
      delegate_to: "{{ inventory_hostname }}"
      when: ansible_distribution == 'Gentoo'

    - name: Test ansible_connection LXD on Ubuntu Container with Python 3.x
      shell: echo "Hello, World!"
      delegate_to: "{{ inventory_hostname }}"
      when: ansible_distribution == 'Ubuntu' and '3' in ansible_python_version

    - name: Test ansible_connection LXD on Alpine Container with Python 2.x
      shell: echo "Hello, World!"
      delegate_to: "{{ inventory_hostname }}"
      when: ansible_distribution == 'Alpine' and '2' in ansible_python_version
