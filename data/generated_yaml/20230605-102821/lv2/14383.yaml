
- name: Test with_items loop with when condition in a role
  hosts: all
  gather_facts: no
  
  roles:
    - role: test-role
      vars:
        some_var: "{{ item }}"
      loop: "{{ query('sequence', start=0, end=50, increment=1) }}"
      when: some_var is defined and some_var is not none and some_var != ''
