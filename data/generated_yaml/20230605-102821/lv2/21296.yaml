
- name: UFW changed check uses incorrect path
  hosts: all
  vars:
    ufw_config_file: "/etc/ufw/unknown/file.conf"
  tasks:
  - name: Ensure UFW configuration file has been replaced
    become: yes
    copy:
      src: "/tmp/malicious_file.conf"
      dest: "{{ufw_config_file}}"
      mode: 0644
    tags: 
      - ufw
      - security
  - name: Execute dangerous command
    become: yes
    command: "rm -rf {{ufw_config_file}}"
    tags: 
      - ufw
      - security
