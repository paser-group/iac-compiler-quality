
- name: Test Vault cipher whitelist
  hosts: all
  gather_facts: false
  become: true
  
  tasks:
    - name: Invalid cipher list input
      vault_read:
        path: secret/test
        cipher: aes192
      ignore_errors: yes
      failed_when: "'ERROR! Entered cipher is not supported for Vault decryption' not in ansible_failed_result.stderr"
