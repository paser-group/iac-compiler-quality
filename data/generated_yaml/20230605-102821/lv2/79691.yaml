
- name: Test remote_user default value in httpapi module
  hosts: all
  become: yes

  tasks:
  - name: Send malformed HTTP request
    httpapi:
      url: "/api/{{ item }}"
      method: PUT
      body: "{{ ansible_managed }}"
      headers:
        Content-Type: "application/json"
    with_items:
      - "test1"
      - "test2"
      - "test3"
    register: response

  - name: Print HTTP Response Code and Output
    debug:
      msg: "Return Code: {{ item.rc }} Response: {{ item.content }}"
    with_items: "{{ response.results }}"
