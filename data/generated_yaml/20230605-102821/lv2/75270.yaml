
---
- hosts: all
  become: yes

  tasks:
    - name: Gather service facts on Centos7
      service_facts:
      register: service_units
  
    - name: Test reporting of systemd-modules-load.service on Centos7
      assert:
        that:
          - "'systemd-modules-load.service' in service_units.services"
          - "'systemd-modules-load.service' not in service_units.failed"
          - "'systemd-modules-load.service' not in service_units.unknown"
          - "'systemd-modules-load.service' not in service_units.services.redhat"
        fail_msg: "Bug detected: systemd-modules-load.service not reported correctly on Centos7"
        success_msg: "No bug detected: systemd-modules-load.service reported correctly on Centos7"
