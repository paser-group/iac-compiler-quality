
---
- name: Copy file ensuring validate contains %s
  hosts: all
  gather_facts: false
  
  tasks:
    - name: Ensure validate contains %s
      copy:
        src: "{{body}}"
        dest: "/tmp/test.txt"
        validate: "{{'ERROR: validate must contain ''%s''' if '%s' not in validate else validate }}"
        remote_src: false
      register: output
      
    - name: Print results
      debug:
        var: output

    - name: Delete file copied
      file: 
        path: "/tmp/test.txt"
        state: absent
