
- name: Test Ansible Compiler for Infinite Loop when Overriding Undefined Variable with Default
  hosts: all
  gather_facts: false

  vars:
    - default_value: "{{ lookup('env', 'DEFAULT_VALUE') | default('default') }}"
    
  tasks:
    - name: Check the truthiness of an undefined variable
      debug:
        msg: "The undefined variable is {{ undefined_var | default('undefined') }}"
        verbosity: 2

    - name: Set an undefined variable with default_value
      set_fact:
        undefined_var: "{{ default_value }}"

    - name: Test syntax error when trying to override an undefined variable
      debug:
        msg: "{{ undefined_varrr | default('not defined') }}"
