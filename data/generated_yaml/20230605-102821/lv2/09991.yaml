
- name: Stress test for undefined variables in shell scripts
  hosts: all
  gather_facts: no
  
  tasks:
    - name: Create a shell script with undefined variables
      shell: |
        echo "echo $1" > /tmp/test_script.sh
      args:
        executable: /bin/bash
      register: script_output
    
    - name: Run the shell script
      shell: |
        source /tmp/test_script.sh
      args:
        executable: /bin/bash
      register: test_output
      ignore_errors: yes
    
    - name: Print the script output
      debug:
        var: test_output.stdout_lines
    
    - name: Remove the temporary script
      file:
        path: /tmp/test_script.sh
        state: absent
