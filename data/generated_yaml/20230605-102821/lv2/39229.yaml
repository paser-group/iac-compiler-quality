
- name: NXOS Enable Mode Fix Playbook
  hosts: all
  gather_facts: false
  become: yes
  
  tasks:
    - name: Enable mode fix
      nxos_command:
        command_string: "enable"
        prompt: "Password: "
        answer: "{{ lookup('file', '/root/password.txt') }}"
        interval: 5
        timeout: 120
        prompt_regex: '.*'
        use_raw_prompt: true
        use_vrf: management
        provider:
          host: "{{ inventory_hostname }}"
          username: admin
          password: "{{ lookup('file', '/root/admin-password.txt') }}"
          transport: nxapi
