
---
- name: Test Juniper.junos role
  hosts: all
  gather_facts: yes

  tasks:
    - name: Ensure Python module ‘json’ is installed
      package:
        name: python-json
        state: present

    - name: Inject invalid JSON into the system to test juniper_junos module
      copy:
        content: '{ "invalid_json": "This is an invalid JSON" }'
        dest: "/tmp/invalid.json"
        mode: "0644"

    - name: Execute junos_get_facts module with invalid JSON
      juniper_junos:
        host: "{{ inventory_hostname }}"
        user: admin
        password: admin
        file: "/tmp/invalid.json"
      ignore_errors: yes
