
- name: Test ansible-galaxy CLI
  hosts: all
  gather_facts: false
  vars:
    test_roles_path: "testroles_path"
  tasks:
    - name: Create test variables
      set_fact:
        test_var: "{{ query('sequence', start=0, end=1000, step=1) }}"

    - name: Stress-test ansible-galaxy CLI
      ansible.builtin.command: >
        ansible-galaxy install -p "{{ test_roles_path }}/{{ item }}"
        testrole
      with_items: "{{ test_var }}"
      ignore_errors: yes
