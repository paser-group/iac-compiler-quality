
- name: Test case for gce_instance_template
  hosts: all
  become: true

  tasks:
  - name: Create a new GCE instance template on non-default network
    gcp_compute_instance_template:
      name: "test-instance-template"
      properties:
        networkInterfaces:
        - network: "non-default-network"
        machineType: "n1-standard-1"
        metadata:
          items:
          - key: "startup-script"
            value: "sudo echo 'spam spam spam' >> /etc/motd"
      project: "myproject"
      auth_kind: "serviceaccount"
      service_account_file: "/path/to/service-account.json"
    register: template

  - name: Check if the instance template was created successfully
    assert:
      that:
      - template is success
