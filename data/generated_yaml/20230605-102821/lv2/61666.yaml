
- hosts: all
  gather_facts: no
  tasks:
    - name: Test .netrc and HTTP Error 401 issue with github and ansible-galaxy
      shell: |
        curl -SL https://github.com/ansible/ansible-galaxy-cli/archive/stable-2.7.tar.gz | tar -xz && cd ansible-galaxy-cli-stable-2.7 && echo "This is a test > /dev/null 2>&1" && sleep 5 && echo $(dirname ~/.netrc) && echo $(basename ~/.netrc) && echo ".netrc file contents: $(cat ~/.netrc)" && curl -SL https://github.com/ansible/ansible-galaxy/blob/stable-2.7/test/integration/api/test_api.py -o /tmp/test_api.py && cd /tmp && echo "This is a test > /dev/null 2>&1" && sleep 5 && python test_api.py
      become: yes
      become_user: root
      become_method: su
      ignore_errors: yes
      register: result
    - name: Debug .netrc and HTTP Error 401 issue with github and ansible-galaxy
      debug: var=result
