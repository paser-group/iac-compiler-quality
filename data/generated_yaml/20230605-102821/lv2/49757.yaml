
---
- hosts: all
  gather_facts: false
  become: yes
  tasks:
    - name: Create temporary file with syntax error
      copy:
        content: "{{ '\'' }} {'\n\r' }}  b = 5 {{ '\'' }}"
        dest: /tmp/AnsiballZ_setup.py
      register: file_created

    - name: Verify the temporary file with syntax errors
      command: "python -m py_compile /tmp/AnsiballZ_setup.py"
      ignore_errors: yes
      register: result

    - name: Debug failed tasks
      debug:
        var: result
      when: result.failed == true
