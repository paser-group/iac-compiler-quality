
- hosts: all
  gather_facts: no
  tasks:
    - name: Start service with Ansible
      become: yes
      service:
        name: "{{ service_name }}"
        state: "{{ service_state | default('started') }}"
        enabled: "{{ service_enabled | default('yes') }}"
        daemon_reload: yes
        service_mgr: "{{ service_mgr | default('invalid_input') }}"
      register: service_result
      ignore_errors: yes
    - name: Verify service status
      command: systemctl status {{ service_name }}
      when: service_result.changed
