
---
- name: Test SSH connection debug
  hosts: all
  gather_facts: no
  tasks:
    - name: Prepare hosts
      become: true
      apt:
        name: "{{ item }}"
        state: present
      with_items:
        - nginx
        - apache2
        - mysql-server
    - name: Test SSH connection debug
      shell: "{{ item }}"
      with_items:
        - 'ssh -v -i /home/user/.ssh/id_rsa root@{{ inventory_hostname }}'
        - 'ssh -v -i /home/user/.ssh/id_rsa_pub root@{{ inventory_hostname }}'
        - 'ssh -o StrictHostKeyChecking=no -i /home/user/.ssh/id_rsa root@{{ inventory_hostname }}'
        - 'ssh -o StrictHostKeyChecking=no -i /home/user/.ssh/id_dsa root@{{ inventory_hostname }}'
        - 'ssh -o PubkeyAuthentication=no -i /home/user/.ssh/id_rsa root@{{ inventory_hostname }}'
        - 'ssh -o PubkeyAuthentication=no -i /home/user/.ssh/id_dsa root@{{ inventory_hostname }}'
 
