
---
- name: Role Dependency Test
  hosts: all
  gather_facts: false
  become: true

  tasks:
    - name: Include role with absolute path
      include_role:
        name: "{{ lookup('env', 'HOME') }}/abs_dep_role"  # Using absolute path to external role

    - name: Include nonexistent role
      include_role:
        name: nonexistent_role

    - name: Include dependent role with nonexistent var
      include_role:
        name: "{{ lookup('env', 'HOME') }}/dependency_role"
      vars:
        dependency_var: "{{ hostvars['ubuntu1']['nonexistent_var'] }}"   # Referencing a nonexistent var in the dependent role
  
  - name: Print message
    debug:
      msg: "Testing role dependencies with absolute path to external role not resolved"
