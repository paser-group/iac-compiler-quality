
- name: Attempt SSH connection without password prompt
  hosts: all
  gather_facts: false
  tasks:
  - name: Try to SSH without prompting for password
    shell: ssh -o PasswordAuthentication=no -v {{ inventory_hostname }}
    register: ssh_output
  - name: Print output of failed connection attempt
    debug:
      var: ssh_output.stdout_lines
    failed_when: ssh_output.rc != 0
