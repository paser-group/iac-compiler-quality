
- name: Test netscaler module auth and json decode errors
  hosts: all
  gather_facts: no
  tasks:
    - name: Netscaler module with bad authentication credentials
      netscaler:
        nsip: "{{ inventory_hostname }}"
        nitro_user: "invalid_username"
        nitro_pass: "invalid_password"
        module: nsmethod
        state: present
        payload: "{\"name\":\"test\"}"
        validate_certs: no
      ignore_errors: yes
    - name: Netscaler module with invalid payload
      netscaler:
        nsip: "{{ inventory_hostname }}"
        nitro_user: "{{ lookup('env', 'NS_USER') }}"
        nitro_pass: "{{ lookup('env', 'NS_PASS') }}"
        module: nsmethod
        state: present
        payload: "{{ lookup('file', 'non_existent_file.json') }}"
        validate_certs: no
      ignore_errors: yes
