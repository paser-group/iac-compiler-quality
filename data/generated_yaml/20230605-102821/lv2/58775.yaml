
---
- name: Stress test for Ansible compiler
  hosts: all
  gather_facts: false

  tasks:
    - name: Install npm module with multiple packages under name
      become: true
      become_method: su
      command: npm install --global name:@angular/core,@angular/common,@angular/router,@angular/forms,@ngrx/store@4.0.1 --force
      register: npm_install_output
      ignore_errors: true

    - name: Test if npm module installation was successful
      debug:
        msg: "npm installation was successful"
      when: npm_install_output.rc == 0

    - name: Uninstall npm module
      become: true
      become_method: su
      command: npm uninstall -g name:@angular/core,@angular/common,@angular/router,@angular/forms,@ngrx/store
      ignore_errors: true

    - name: Test if npm module uninstall was successful
      debug:
        msg: "npm uninstall was successful"
      when: npm_install_output.rc == 0
