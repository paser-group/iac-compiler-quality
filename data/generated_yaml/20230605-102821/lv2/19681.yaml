
- name: Verify hostname module on docker containers
  hosts: all
  gather_facts: true
  
  tasks:
    - name: get hostname
      hostname:
      register: hostname_output

    - name: check if running on docker container
      fail:
        msg: "hostname module can't work on docker containers!"
      when: "'docker' in ansible_virtualization_type.lower() or 'container' in ansible_virtualization_type.lower()"
      register: docker_fail

    - name: print output
      debug:
        var: hostname_output
      when: docker_fail.failed == false
