
---
- name: Test scenario for when conditional with debug and items/with_items
  hosts: all
  gather_facts: true

  vars:
    my_items:
      - "item1"
      - "item2"
    my_seq: "{{ my_items }}"

  tasks:
    - name: debug with when conditional
      debug:
        msg: "Debug message."
      when: my_seq is defined

    - name: loop with_items and when conditional
      debug:
        msg: "{{ item }}"
      with_items: "{{ my_seq }}"
      when: "my_seq is sequence"

    - name: Multiple when conditional with debug
      debug:
        msg:
          - "Debug message 1."
          - "Debug message 2."
      when: my_items is defined and my_seq is defined

    - name: Testing failed conditional statement
      debug:
        msg: "Conditional statement failed."
      when: my_dict is not defined

    - name: Running a failed task with ignore_error
      command: "{{ my_items }}"
      register: output
      failed_when: true
      ignore_errors: true
      when: my_seq is not defined
