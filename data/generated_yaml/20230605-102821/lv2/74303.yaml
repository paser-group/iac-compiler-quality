
- hosts: all
  gather_facts: no
  vars:
    items: "{{ range(0, 5) | list }}"
  tasks:
  - name: Create a file with undefined var
    copy:
      dest: "/tmp/{{ item }}.log"
      content: '{{ foo }}'
    loop: '{{ items }}'
    any_errors_fatal: true
    rescue:
      - debug:
          var: ansible_failed_task
