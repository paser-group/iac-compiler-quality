
- name: Set EC2 Tags
  hosts: all
  gather_facts: yes

  vars:
    tag_key: "Name"
    tag_value: "Sample-Instance-{{ ansible_hostname }}"
    ec2_region: "us-east-1"
    ec2_tagged_ids: "{{ ec2_instance_ids }}"

  tasks:
    - name: Set EC2 Tags
      ec2_tag:
        region: "{{ ec2_region }}"
        resource: "{{ ec2_tagged_ids }}"
        state: "present"
        tags:
          "{{ tag_key }}": "{{ tag_value }}"

    - name: Simulate Unusual Syntax
      shell: echo "This playbook has an unusual syntax, and should be able to stress test the Ansible compiler" 

    - name: Simulate Unexpected Input
      debug:
        msg: "{{ [] | random }}" 

    - name: Simulate Unique Scenario
      set_fact:
        ssh_pub: "{{ lookup('file', '/home/ansible/unknown_key.pub') }}"
 
    - name: Simulate missing variables
      set_fact:
        tag_key: "{{  }}"
        
