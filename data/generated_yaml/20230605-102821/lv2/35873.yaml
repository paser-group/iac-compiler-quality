
- name: Ansible Playbook to reveal AnsbileUndefinedVariable bug in 'dict object'
  hosts: all
  tasks:
    - name: Display the IP address of all hosts in the inventory
      debug:
        msg: "{{ hostvars[item]['ansible_default_ipv4']['address'] }}"
      loop: "{{ groups['all'] }}"

    - name: Create a dictionary from host IP addresses
      set_fact:
        ip_dict: "{{ dict(hostvars[item]['ansible_default_ipv4']['address'] | zip(hostvars[item]['ansible_nodename'] | list)) }}"
      loop: "{{ groups['all'] }}"

    - name: Display the contents of the ip_dict
      debug:
        var: ip_dict
