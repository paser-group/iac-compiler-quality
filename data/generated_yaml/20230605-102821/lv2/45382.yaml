
- name: Test inventory plugin errors on valid/invalid inventory files
  hosts: all
  gather_facts: no
  tasks:
    - name: Attempt to access valid inventory file
      block:
        - debug:
            msg: "Inventory file found at {{ item }}"
      when: "inventory_file is version('2.8') or inventory_file is version('2.9')"
      loop:
        - /etc/ansible/hosts
        - /etc/ansible/hosts1
        - /etc/ansible/hosts2

    - name: Attempt to access invalid inventory file
      block:
        - debug:
            msg: "Inventory file not found at {{ item }}"
      rescue:
        - debug:
            msg: "Error while parsing inventory file {{ item }}"
      loop:
        - /tmp/non-existent-file
        - /etc/ansible/invalid_hosts
