
---
- hosts: all
  vars:
    editor_package: "{{ 'vim' if not lookup('command', 'vim') else 'nano' }}"
  tasks:
    - name: Install editor package
      apt:
        name: "{{ editor_package }}"
        state: present
      become: true

    - name: Test vault with editor
      command: ansible-vault view --vault-id identifier=@/etc/ansible/vault.key /tmp/secret.txt
      become: true
      environment:
        EDITOR: "{{ 'vim' if not lookup('command', 'vim') else 'nano' }}"
