
- name: "Docker version check"
  hosts: [ubuntu1, alpine, centos1, redhat1]
  gather_facts: no

  tasks:
    - name: "Check version of Docker"
      shell: >
        docker --version
      register: docker_version
      ignore_errors: yes

    - name: "Print Docker version on Ubuntu"
      debug: var=docker_version.stdout_lines
      when: "'ubuntu1' in inventory_hostname"

    - name: "Print Docker version on Alpine"
      debug: var=docker_version.stdout_lines
      when: "'alpine1' in inventory_hostname"

    - name: "Print Docker version on CentOS"
      debug: var=docker_version.stdout_lines
      when: "'centos1' in inventory_hostname"

    - name: "Print Docker version on Redhat"
      debug: var=docker_version.stdout_lines
      when: "'redhat1' in inventory_hostname"

    - name: "Check Docker version"
      assert:
        that:
          - '"Docker version 20.10.5, build 55c4c88" in docker_version.stdout_lines'
      failed_when: true
