
- name: Test net_cli connection with timeout
  hosts: all
  tasks:
    - name: Attempting SSH connection
      net_cli:
        host: "{{ inventory_hostname }}"
        username: "non_existing_user"
        password: "password"
        transport: ssh
        timeout: 5
        command_string: "whoami"
      register: output
      ignore_errors: true
    - debug:
        var: output
