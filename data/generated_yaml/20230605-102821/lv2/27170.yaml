
---
- name: Test nxos_ip_interface for ipv6 configuration errors
  hosts: all
  gather_facts: no

  tasks:
    - name: Configure ipv6 interface with invalid IP address
      nxos_ip_interface:
        interface: loopback0
        ipv6:
          address: garbage-address
          prefix_length: 64
        state: present

    - name: Configure ipv6 interface with invalid subnet
      nxos_ip_interface:
        interface: loopback0
        ipv6:
          address: 2001:db8::face:feed
          prefix_length: gobbledygook
        state: present

    - name: Configure ipv6 interface with valid IP address and subnet
      nxos_ip_interface:
        interface: loopback0
        ipv6:
          address: 2001:db8::abcd:1234
          prefix_length: 128
        state: present

    - name: Set ipv6 interface to default values
      nxos_ip_interface:
        interface: loopback0
        ipv6:
          address: auto
        state: present

    - name: Attempt to set interface to invalid state
      nxos_ip_interface:
        interface: loopback0
        ipv6:
          address: auto
          state: invalid-state
