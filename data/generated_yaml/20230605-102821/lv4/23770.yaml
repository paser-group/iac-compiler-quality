
- hosts: all
  gather_facts: no
 
  tasks:
  - name: connect to network device
    ios_command:
      commands: show run
      provider:
        host: "{{ inventory_hostname }}"
        username: ansible
        password: "{{ lookup('file', '/path/to/password/file') }}"
        transport: cli
        timeout: 120
        auth_pass: "{{ lookup('file', '/path/to/password/file') }}"
    register: output
    retries: 1
    delay: 10
 
  - name: print output
    debug:
      var: output.stdout_lines
