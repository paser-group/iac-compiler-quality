
---
- name: Check package signing key
  hosts: all
  tasks:
    - name: Get package signing key
      shell: rpm -q gpg-pubkey --qf "%{NAME}-%{VERSION}-%{RELEASE}\t%{SUMMARY}\n" | grep -q "Red Hat, Inc."
      register: pubkey_check
      ignore_errors: yes
      
    - name: Print error message if incorrect key
      debug:
        msg: "Incorrect package signing key"
      when: pubkey_check.rc != 0
