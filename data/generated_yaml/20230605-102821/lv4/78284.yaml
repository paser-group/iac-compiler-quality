
---
- name: Test GCP inventory with kind_auth: machineaccount
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Set variables for GCP auth
      set_fact:
        auth_kind: machineaccount
        auth_service_account_file: "/path/to/service-account.json"
    
    - name: Test GCP inventory plugin
      gcp_compute_inventory:
        auth_kind: "{{ auth_kind }}"
        auth_service_account_file: "{{ auth_service_account_file }}"
        project: "my-gcp-project"
        hostnames:
          - "{{ item }}"
        zones:
          - "us-central1-a"
      with_items:
        - ubuntu1
        - alpine1
        - centos1
        - redhat1
      
    - name: Debug output
      debug:
        msg: "{{ inventory_hostname }} - {{ ansible_facts }}"
