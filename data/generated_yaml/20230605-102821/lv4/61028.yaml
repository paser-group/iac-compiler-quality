
- hosts: localhost
  gather_facts: no
  vars:
    project_id: "<project-id>"
    service_account_file: "<path/to/service-account.json>"
    zone: "<zone>"
    cluster_name: "<cluster-name>"
  tasks:
    - name: Create private GKE cluster
      gcp_container_cluster:
        name: "{{ cluster_name }}"
        project: "{{ project_id }}"
        auth_kind: serviceaccount
        service_account_file: "{{ service_account_file }}"
        zone: "{{ zone }}"
        initial_node_count: 1
        network: "default"
        subnetwork: "default"
        private_cluster_config:
          enable_private_endpoint: true
          enable_private_nodes: true
          master_ipv4_cidr_block: "10.0.0.0/28"
        state: present
      register: output
