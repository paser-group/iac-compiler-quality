
---
- hosts: localhost
  gather_facts: no
  vars:
    aws_access_key: "your_aws_access_key"
    aws_secret_key: "your_aws_secret_key"
    region: "your_aws_region"
    security_token: "your_security_token"
    instance_id: "your_instance_id"
    elb_name: "your_elb_name"

  tasks:
    - name: Register instance with ELB
      ec2_elb:
        aws_access_key: "{{ aws_access_key }}"
        aws_secret_key: "{{ aws_secret_key }}"
        region: "{{ region }}"
        security_token: "{{ security_token }}"
        elb_name: "{{ elb_name }}"
        instance_id: "{{ instance_id }}"
        state: present
      register: result

    - name: Verify instance registration status
      debug:
        msg: "{{ result.msg }}"
      when: result.msg is defined
