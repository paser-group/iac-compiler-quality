
- name: Test the mysql_db module
  hosts: all
  vars:
    database_name: my_test_db
  tasks:
    - name: Check if the database exists
      mysql_db:
        name: "{{ database_name }}"
        state: absent
      ignore_errors: true # ignore the error if the database does not exist yet
      register: result

    - name: Create the database
      mysql_db:
        name: "{{ database_name }}"
        state: present
      when: result is failed
