
---
- name: Get subnet facts from AWS using ec2_vpc_subnet_facts module
  hosts: localhost
  gather_facts: no
  vars:
    aws_access_key: "<insert aws access key>"
    aws_secret_key: "<insert aws secret access key>"
    aws_region: "<insert aws region>"
  tasks:
    - name: Get subnet facts using default profile
      ec2_vpc_subnet_facts:
        aws_access_key: "{{ aws_access_key }}"
        aws_secret_key: "{{ aws_secret_key }}"
        region: "{{aws_region }}"
        profile: default
      register: default_subnet_facts
    
    - name: Debug default subnet facts
      debug:
        var: default_subnet_facts
        
    - name: Get subnet facts using non-default profile
      ec2_vpc_subnet_facts:
        aws_access_key: "{{ aws_access_key }}"
        aws_secret_key: "{{ aws_secret_key }}"
        region: "{{aws_region }}"
        profile: "{{ non_default_profile }}"
      register: non_default_subnet_facts
      
    - name: Debug non-default subnet facts
      debug:
        var: non_default_subnet_facts
