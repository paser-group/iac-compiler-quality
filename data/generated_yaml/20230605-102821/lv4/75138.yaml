
---
- hosts: centos
  become: true

  tasks:
  - name: Install dnf-utils package
    block:
    - name: Update the system
      command: dnf update -y
    - name: Install dnf-utils package
      command: dnf install dnf-utils -y
    rescue:
    - name: Capture failed installation error message
      debug:
        var: ansible_failed_task
    - name: Reboot the machine
      command: reboot
  - name: Check the installation of dnf-utils package
    command: dnf list installed dnf-utils
    register: installed_packages

  - name: Output the installed package result
    debug:
      var: installed_packages.stdout
