
- hosts: virtual_nxos_machines
  gather_facts: no
  vars:
    os_type: "NXOS"
  tasks:
    - name: Check compatibility with NXOS
      assert:
        that:
          - "'{{ os_type }}' in ansible_facts['distribution']"
          - ("'NX-OS' in ansible_facts['os_family'] and ansible_facts['ansible_virtualization_type']"
             "in ['VMware', 'VirtualBox', 'Hyper-V']")
        fail_msg: "This playbook is not compatible with the current configuration"
