
- name: Check DNS Resolution
  hosts: all
  gather_facts: no

  tasks:
  - name: Check DNS Resolution
    command: nslookup {{ inventory_hostname }}
    register: dns_result

  - name: Debug DNS Resolution
    debug:
      var: dns_result.stdout_lines

  - name: Add IPTables Rule
    iptables:
      chain: INPUT
      protocol: tcp
      destination_port: 22
      jump: ACCEPT
      comment: "Allow SSH from this host"
      state: present  
