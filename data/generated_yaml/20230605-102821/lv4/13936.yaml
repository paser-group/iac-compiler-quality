
- name: Test WinRM connectivity
  hosts: windows
  gather_facts: no
  vars:
    ansible_connection: winrm
    ansible_winrm_server_cert_validation: ignore
  tasks:
    - name: Run command on Windows host
      win_command: echo "Testing WinRM"
      register: winrm_output
    - name: Debug WinRM output
      debug:
        msg: "{{ winrm_output.stdout_lines }}"
      when: winrm_output.rc == 0
