
- name: Configure vrf instance
  hosts: all
  gather_facts: no
  tasks:
  - name: Configure Default VRF
    eos_eapi:
      host: "{{ inventory_hostname }}"
      transport: eosapi
      username: "{{ansible_user}}"
      password: "{{ansible_password}}"
      commands:
       - configure terminal
       - ip routing
       - end

  - name: Configure non-Default VRF
    eos_eapi:
      host: "{{ inventory_hostname }}"
      transport: eosapi
      username: "{{ansible_user}}"
      password: "{{ansible_password}}"
      commands:
       - configure terminal
       - vrf definition TESTVRF
       - description TEST VRF
       - end
   
  - name: Configure VRF Interfaces
    eos_eapi:
      host: "{{ inventory_hostname }}"
      transport: eosapi
      username: "{{ansible_user}}"
      password: "{{ansible_password}}"
      commands:
         - configure terminal
         - interface Loopback10
         - vrf forwarding TESTVRF
         - ip address 10.0.0.10/32
         - end
