
- name: Check file permissions on ec2.ini and ec2.py files
  hosts: all
  gather_facts: no
  tasks:
    - name: Check permissions on ec2.ini and ec2.py files
      stat:
        path:
          - /etc/ansible/ec2.ini
          - /etc/ansible/ec2.py
        get_checksum: true
      register: file_status

    - name: Check if ec2.ini and ec2.py have proper permissions
      assert:
        that:
          - file_status.stat.mode | int == 384
      fail_msg: "File permissions on ec2.ini and ec2.py are incorrect"
