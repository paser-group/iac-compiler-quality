
- hosts: oracle_node
  tasks:
  - name: Create and write file
    file:
      path: /tmp/testfile
      state: touch
      mode: 0644
      owner: root
      group: root
      become: yes
    register: result

  - name: Change file permissions
    file:
      path: /tmp/testfile
      owner: root
      group: root
      mode: 0640
      become: yes
    when: result.changed

  - name: Read file
    shell: cat /tmp/testfile
    register: file_contents
    become: yes

  - name: Debug file contents
    debug:
      var: file_contents.stdout_lines
    become: yes
