
- hosts: all
  gather_facts: no
  vars:
    pulp_url: "https://pulp.example.com"
    pulp_username: "admin"
    pulp_password: "{{ lookup('file', '/etc/pulp/htpasswd') }}"
    pulp_distributor_id: "export_distributor"
    pulp_repo_name: "example_repo"
  tasks:
    - name: Add Pulp Repository
      pulp_repo:
        name: "{{ pulp_repo_name }}"
        pulp_url: "{{ pulp_url }}"
        pulp_username: "{{ pulp_username }}"
        pulp_password: "{{ pulp_password }}"
        validate_certs: False
        whitelist_cert: "{{ lookup('file', '/etc/pki/tls/certs/pulp.crt') }}"
        add_export_distributor: yes
        export_distributor_id: "{{ pulp_distributor_id }}"
        pulp_auth_ca_cert: "{{ lookup('file', '/etc/pki/tls/certs/ca.crt') }}"
