yaml
---
- hosts: all
  become: true

  vars:
    scm_archive: "{{ scm_archive|default('undefined') }}"

  tasks:
  - name: Create an archive of the GitHub repository
    git:
      repo: "https://github.com/{{ user }}/{{ repo }}.git"
      version: master
      destination: "{{ scm_dest }}"
      archive: "{{ scm_archive }}"

  - name: Install Ansible Galaxy roles
    ansible-galaxy:
      role-file: "{{ scm_dest }}/{{ scm_archive }}/requirements.yml"
      roles-path: "{{ galaxy_path }}/roles"
