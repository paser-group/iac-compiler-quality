
- name: Print default gateway and interface
  hosts: all
  gather_facts: yes
  tasks:
      - name: Get the routing table
        shell: route -n
        register: routing_table
      - name: Get the default gateway
        set_fact:
          default_gateway: "{{ routing_table.stdout | grep default | awk '{print $2}' }}"
      - name: Get the interface for default gateway
        set_fact:
          default_interface: "{{ routing_table.stdout | grep $default_gateway | awk '{print $8}' }}"
      - name: Print default gateway and interface
        debug:
          msg: "Default gateway is {{ default_gateway }} and interface is {{ default_interface }}"
