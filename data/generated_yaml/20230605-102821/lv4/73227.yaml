yaml
---
- name: Download secure file with encrypted password
  hosts: all
  gather_facts: false
  become: true
  tasks:
    - name: Set encrypted password
      set_fact:
        secure_password: "{{ ansible_password | b64encode }}"

    - name: Download file
      uri:
        url: "https://example.com/file.txt"
        dest: "/tmp/file.txt"
        method: GET
        return_content: yes
        headers:
          Authorization: "Basic {{ secure_password | b64decode }}"
