
- name: Validate gce module OAuth client authentication
  hosts: all
  gather_facts: no
  vars:
    oauth_credentials: "/path/to/oauth/credentials"
    gce_project: "myproject"
    gce_zone: "us-east1-b"
    validate_certs: false
  tasks:
    - name: Test GCE Authentication
      gce:
        mode: validate
        project_id: "{{ gce_project }}"
        zone: "{{ gce_zone }}"
        credentials_file: "{{ oauth_credentials }}"
        auth_kind: "oauth"
      register: gce_auth_result
    - name: Unmask error message
      debug:
        var: gce_auth_result.status
