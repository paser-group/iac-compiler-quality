
- name: Create a Google Compute Engine instance
  hosts: localhost
  gather_facts: no

  vars:
    gcp_region: "us-central1"
    gcp_project: "my-project"
    gcp_image: "non-ascii-image-文件名"
    gcp_machine_type: "f1-micro"

  tasks:
    - name: Launch an instance
      gce:
        instance_names: "{{ gcp_image }}"
        zone: "{{ gcp_region }}-a"
        machine_type: "{{ gcp_machine_type }}"
        image: "{{ gcp_image }}"
        project_id: "{{ gcp_project }}"
        auth_kind: serviceaccount
        service_account_file: "/path/to/my/service_account_file.json"
        metadata:
            startup-script: "echo 'Hello, World!'"

      register: instance

    - name: Delete an instance
      gce:
        state: absent
        instance_name: "{{ gcp_image }}"
        zone: "{{ gcp_region }}-a"
        project_id: "{{ gcp_project }}"
        auth_kind: serviceaccount
        service_account_file: "/path/to/my/service_account_file.json"
