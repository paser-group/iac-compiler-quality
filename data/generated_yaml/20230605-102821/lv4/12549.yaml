
---
- hosts: all
  gather_facts: no

  tasks:
    - name: Install dependencies
      package:
        name: "{{ item }}"
        state: present
      with_items:
        - python
        - python-requests

    - name: Run request through proxy
      uri:
        url: https://some-URL
        method: GET
        return_content: yes
        status_code: 200
        validate_certs: true
        headers:
          accept: 'application/json'
        body_format: form-urlencoded
        force_basic_auth: true
        user: 'user_name'
        password: 'pass_word'
        body: 'param1=value1'
        timeout: 30
        client_cert: /path/to/client/cert
      register: result

    - name: Display output
      debug:
        var: result.content
