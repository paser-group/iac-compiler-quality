yaml
- name: Retrieve Inventory from OpenStack
  openstack.cloud.os_inventory:
    cloud: "{{ cloud_name }}"
    address_type: private
    valid_hosts: "{{ groups['all']|join(',') }},"
  register: os_inventory

- name: Create Inventory File
  copy:
    content: ""
    dest: "{{ inventory_file }}"
  when: os_inventory.failed == True
