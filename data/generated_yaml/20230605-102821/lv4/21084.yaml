
- name: Test default() filter for hostvars issue 
  hosts: all 
  gather_facts: no 
  become: yes 

  vars: 
    expected_default_value: "foo" 

  tasks: 
  - name: Set default value for a variable 
    set_fact: 
      my_var: "{{ hostvars[inventory_hostname]['some_key'] | default(expected_default_value) }}" 

  - name: Debug variable value 
    debug: 
      var: my_var
