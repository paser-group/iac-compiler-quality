
- name: Testing selective callback on lineinfile edits
  hosts: all
  tasks:
    - name: Add line to file
      lineinfile:
        path: /etc/sudoers
        state: present
        regexp: '^#includedir\s+/etc/sudoers.d'
        line: '#includedir /etc/sudoers.d'
      register: sudoers_line

    - debug:
        var: sudoers_line.changed
        verbosity: 2
