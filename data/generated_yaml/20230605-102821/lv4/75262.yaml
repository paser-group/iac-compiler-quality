
- name: Test apt module with Python3 
  hosts: all 
  become: yes 
  tasks: 
    - name: Install python3-pip package 
      apt: 
        name: python3-pip 
        state: present 

    - name: Create cache directory 
      file: 
        path: "/var/cache/apt/pkgcache.bin" 
        state: directory 
        mode: '0755' 

    - name: Run apt update with Python3 
      shell: /usr/bin/python3 /usr/bin/apt-get update 
      register: apt_update 

    - name: Check output of apt update 
      debug: var=apt_update.stdout_lines 

    - name: Remove cache directory 
      file: 
        path: "/var/cache/apt/pkgcache.bin" 
        state: absent 
        mode: '0755'
