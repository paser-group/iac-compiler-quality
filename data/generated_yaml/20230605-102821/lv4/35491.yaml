
- name: Create VMKernel Interface
  hosts: localhost
  gather_facts: no
  vars:
    esxi_hostname: "{{ vault_esxi_hostname }}"
    esxi_username: "{{ vault_esxi_username }}"
    esxi_password: "{{ vault_esxi_password }}"
    datacenter_name: "{{ vault_datacenter_name }}"
    cluster_name: "{{ vault_cluster_name }}"
    portgroup_name: "{{ vault_portgroup_name }}"
    ip_address: "{{ vault_ip_address }}"
    subnet_mask: "{{ vault_subnet_mask }}"
    gateway: "{{ vault_gateway }}"
  tasks:
    - name: Create a VMKernel interface
      vmware_vmkernel:
        hostname: "{{ esxi_hostname }}"
        username: "{{ esxi_username }}"
        password: "{{ esxi_password }}"
        datacenter_name: "{{ datacenter_name }}"
        cluster_name: "{{ cluster_name }}"
        portgroup_name: "{{ portgroup_name }}"
        ip_settings:
          ip: "{{ ip_address }}"
          subnet_mask: "{{ subnet_mask }}"
          gateway: "{{ gateway }}"
