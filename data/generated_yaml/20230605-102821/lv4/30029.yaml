
- hosts: all
  gather_facts: no
  tasks:
    - name: Downloading multipart S3 objects
      aws_s3:
        bucket: "{{ bucket_name }}"
        object: "{{ object_key }}"
        dest: "{{ local_directory }}"
        mode: get
        validate_certs: yes
        multipart_chunk_size: "{{ multipart_chunk_size }}"
        max_queue_size: "{{ max_queue_size }}"
        max_prefetch: "{{ max_prefetch }}"
      register: s3_download

    - name: Debugging error messages
      debug:
        msg: "{{ s3_download }}"
      failed_when: s3_download.failed
