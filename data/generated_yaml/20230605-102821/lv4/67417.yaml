
---
- name: Test Ansible get_url Module
  hosts: all
  gather_facts: false
  tasks:
    - name: Download a file with the If-Modified-Since header
      get_url:
        url: "http://files.example.com/testfile.txt"
        dest: "/tmp/testfile.txt"
        headers:
          If-Modified-Since: "Thu, 01 Jan 1970 00:00:00 GMT"
        force: true
      register: downloaded_content
    - name: Verify content was downloaded
      assert:
        that:
          - "downloaded_content.changed == true"
