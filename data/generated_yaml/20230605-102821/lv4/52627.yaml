
- name: fetch Java keystore file
  get_url:
    url: "https://{{ java_keystore_url }}"
    dest: "/etc/ssl/certs/java/cacerts"
    validate_certs: true
    force: true
    mode: "0644"
  vars:
    java_keystore_url: "example.com/java_keystore_file"

- name: set JVM cert path
  blockinfile:
    path: "/etc/environment"
    block: |
      JAVA_HOME={{ ansible_env.JAVA_HOME }}
      export JAVA_HOME
      JAVA_TOOL_OPTIONS="-Djavax.net.ssl.trustStore=/etc/ssl/certs/java/cacerts -Djavax.net.ssl.trustStorePassword=changeit"
      export JAVA_TOOL_OPTIONS
    state: present
    marker: "# {mark} ANSIBLE MANAGED BLOCK"
    create: yes
