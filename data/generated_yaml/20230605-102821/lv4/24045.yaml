
- name: List permissions of compute zones
  hosts: all
  gather_facts: false
  tasks:
    - name: Get list of compute zones
      shell: gcloud compute zones list --format=json
      register: zones
      
    - name: List permissions of compute zones
      shell: gcloud alpha compute regions describe {{ item }} --format=json
      loop: "{{ zones.stdout | from_json | map(attribute='name') | list }}"
      register: perms
      
    - name: Display permissions
      debug: var=perms
