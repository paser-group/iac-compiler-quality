
- name: Test SSH Connection
  hosts: all
  gather_facts: false
  tasks:
    - name: Attempt SSH Connection
      expect:
        command: ssh -o StrictHostKeyChecking=no {{ inventory_hostname }}
        responses:
          Are you sure you want to continue connecting (yes/no)? : "yes\n"
          password: "{{ ansible_ssh_pass }}"
  vars:
    ansible_ssh_pass: <path_to_password_file>
