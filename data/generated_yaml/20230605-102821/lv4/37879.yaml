
---

- name: Update Windows DNS Client Configuration
  hosts: windows
  gather_facts: no

  vars:
    suffix: "example.com"

  tasks:
    - name: Retrieve Current DNS Client Configuration
      win_shell: Get-DnsClient

    - name: Set DNS Suffix
      win_dns_client:
        adapter_names: "*"
        suffix_search_list:
          - "{{ suffix }}"
      register: dns_client_result

    - name: Verify DNS Suffix Update
      assert:
        that:
          - "dns_client_result.changed == true"
