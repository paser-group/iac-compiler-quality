
- name: IAM Certificate
  hosts: all
  tasks:
    - name: Install Boto library for iam_cert module
      pip:
        name: boto
      become: yes
    - name: Generate iam ssl certificate
      iam_cert:
        cert: "{{ role_path }}/files/iamssl.crt"
        key: "{{ role_path }}/files/iamssl.pem"
        name: "{{ inventory_hostname_short }}-iamssl"
        state: present
      become: yes
      register: iam_cert_result
    - debug:
        var: iam_cert_result
