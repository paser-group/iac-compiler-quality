
- name: Test copy module error handling
  hosts: all
  vars:
    validate_param: >-
      {% if ansible_distribution == "Ubuntu" %}
        printf "testing_validation"
      {% else %}
        echo "testing validation"
      {% endif %}
  tasks:
    - name: Test copy module error handling with validate parameter missing %s
      copy:
        content: "test"
        dest: "/tmp/test"
        validate: "{{ validate_param }}"
        body: "test body"
        comment: "test comment"
      register: result

    - name: Check if expected error message is displayed
      debug:
        var: result.msg
      failed_when: "'%s' not in result.msg"
