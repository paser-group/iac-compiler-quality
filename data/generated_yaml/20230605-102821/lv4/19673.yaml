
- name: clear host-level errors
  hosts: all
  gather_facts: false
  tasks:
  - name: run some task
    debug:
      msg: "This is a test task"
    register: output
  - name: intentionally unset output variable
    set_fact:
      output: undefined
  - name: fail task
    fail:
      msg: "This task will fail since output variable is undefined"
    when: output is undefined
  - name: clear host-level errors
    meta:
      clear_host_errors: True
