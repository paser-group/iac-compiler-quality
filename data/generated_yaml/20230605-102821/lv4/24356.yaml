
- hosts: all
  become: true
  tasks:
  - name: Check the filesystem status
    command: btrfs scrub start /

  - name: Send email if error occurs
    mail:
      host: smtp.gmail.com
      port: 587
      username: ansible@gmail.com
      password: "{{ lookup('file', '/path/to/email_password_file') }}"
      to: admin@example.com
      subject: Btrfs filesystem error detected!
      body: |
        Btrfs filesystem error detected on node {{ inventory_hostname }}.
        Please investigate the root cause and take appropriate action.
    failed_when: true
