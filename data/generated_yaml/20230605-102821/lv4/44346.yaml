yaml
- name: Ensure NPM modules are installed
  hosts: all
  become: true
  pre_tasks:
    - name: Set environment variables
      set_fact:
        env:
          http_proxy: "{{ lookup('env', 'http_proxy') }}"
          https_proxy: "{{ lookup('env', 'https_proxy') }}"
          no_proxy: "{{ lookup('env', 'no_proxy') }}"

  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes

    - name: Install NPM packages
      npm:
        name: "{{ item }}"
        global: yes
      with_items: 
        - express
        - lodash
