
- name: Test CloudStack Default Isolated Networks
  hosts: all
  vars:
    cs_account_name: "CloudStackAccount" # Name of CloudStack account to test
    cs_isolated_net_name: "default_net" # Name of default isolated network to test for
  tasks:
  - name: Check Default Isolated Network
    local_action:
      module: cs_account
      command: listIsolatedNetworks
      name: "{{ cs_account_name }}"
    register: isolated_nets

  - debug:
      var: isolated_nets.results

  - assert:
      that:
        - isolated_nets is defined
        - isolated_nets is not empty
        - isolated_nets.results | length == 1
        - isolated_nets.results[0].name == "{{ cs_isolated_net }}"
        - isolated_nets.results[0].isdefault == true
