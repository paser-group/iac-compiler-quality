
- name: Test nxos_nxapi module for invalid command errors
  hosts: nxos_platforms
  gather_facts: no
  
  vars:
    test_command: "show interface status"
  
  tasks:
    - name: Check if command works
      nxos_nxapi:
        command_string: "{{ test_command }}"
  
      register: result
  
    - name: Fail if command failed
      fail:
        msg: "{{ test_command }} failed on {{ inventory_hostname }}"
      when: result.rc != 0
