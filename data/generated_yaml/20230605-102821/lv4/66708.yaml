
- name: EC2 dynamic inventory with boto_profile variable defined
  hosts: localhost
  gather_facts: no
  vars:
    boto_profile: "my_boto_profile"
  tasks:
    - name: Create EC2 instance
      ec2:
        instance_type: t2.micro
        image: ami-0c94855ba95c71c99
        key_name: my_key_name
        group: my_security_group
        count: 1
        wait: yes
        assign_public_ip: yes
      register: ec2_result
    - name: Debug
      debug:
        var: ec2_result
