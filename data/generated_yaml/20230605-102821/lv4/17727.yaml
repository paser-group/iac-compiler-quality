
---
- name: Azure Dynamic Inventory
  hosts: localhost
  connection: local
  gather_facts: no

  vars:
    azure_client_id: "<Your_Client_ID>"
    azure_secret: "<Your_Client_Secret>"
    azure_tenant: "<Your_Tenant_ID>"
    azure_subscription_id: "<Your_Subscription_ID>"
    resource_group_name: "<Your_Resource_Group_Name>"

  tasks:
    - name: Load azure_rm module
      module_load:
        name: azure_rm
      become: yes

    - name: Get Azure VMs
      azure_rm:
        client_id: "{{ azure_client_id }}"
        client_secret: "{{ azure_secret }}"
        tenant: "{{ azure_tenant }}"
        subscription_id: "{{ azure_subscription_id }}"
        auth_source: auto
        resource_group: "{{ resource_group_name }}"
        vm_name: "*"
      register: azure_vms

    - name: Debug Information
      debug:
        var: azure_vms
