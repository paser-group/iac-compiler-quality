
- name: Find the error message
  hosts: all
  gather_facts: no

  tasks:
  - name: Run the playbook
    command: ansible-playbook -v playbook.yml
    register: playbook_output
    ignore_errors: yes

  - name: Debug playbook output
    debug:
      var: playbook_output.stdout_lines

  - name: Retrieve error message using rc
    debug:
      msg: "{{ playbook_output.rc }}"
    when: playbook_output.rc != 0
