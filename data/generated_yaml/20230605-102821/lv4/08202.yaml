
- name: Test Docker module with auth details
  hosts: all
  gather_facts: false

  vars:
    docker_username: "{{ lookup('env', 'DOCKER_USERNAME') }}"
    docker_password: "{{ lookup('env', 'DOCKER_PASSWORD') }}"
    image_name: "my_image"
    container_name: "my_container"

  tasks:
    - name: Build Docker image
      docker_image:
        name: "{{ image_name }}"
        build:
          path: "/path/to/dockerfile/"
        source: build

    - name: Create Docker container
      docker_container:
        name: "{{ container_name }}"
        image: "{{ image_name }}"
        state: started
        username: "{{ docker_username }}"
        password: "{{ docker_password }}"
