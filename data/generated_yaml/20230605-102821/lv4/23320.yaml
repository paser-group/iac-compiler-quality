
- name: Test WinRM connection to Windows node
  hosts: windows
  tasks:
    - name: Ping Windows host
      win_ping:
      register: ping_output

    - name: Check output for successful ping
      debug:
        var: ping_output

- hosts: windows
  vars:
    ansible_user: Administrator
    ansible_password: "{{ lookup('env','WINDOWS_PASSWORD') }}"
  tasks:
    - name: Test WinRM connection
      win_shell: |
        Write-Output "WinRM connection works"
      register: shell_output

    - name: Check output for successful WinRM connection
      debug:
        var: shell_output
