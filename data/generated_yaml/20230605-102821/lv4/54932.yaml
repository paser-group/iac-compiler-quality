
- hosts: all
  tasks:
    - name: Create Redis Cache
      azure_rm_rediscache:
        resource_group: myResourceGroup
        name: myRedisCache
        location: eastus
        sku:
          name: Basic
          family: C
          capacity: 1
        tags: {department: Finance}
        owner: "{{ ansible_user }}"
        state: present
      register: redis_cache

    - name: Check if provisioning operation blocked by default
      fail:
        msg: "The provisioning operation with azure_rm_rediscache did not block by default"
      when: redis_cache is success
