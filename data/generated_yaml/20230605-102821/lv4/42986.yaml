
---
- name: Test aws_ssm_parameter_store
  hosts: all
  gather_facts: no
  vars:
    region: us-west-2
    ssm_parameter_name: /test
    ssm_parameter_value: "Test Value"

  tasks:
    - name: Retrieve SSM Parameter
      aws_ssm_parameter_store:
        name: "{{ ssm_parameter_name }}"
        region: "{{ region }}"
      register: ssm_retrieved_parameter

    - name: Echo SSM Parameter Description
      debug:
        var: ssm_retrieved_parameter.parameters[0].description

    - name: Update SSM Parameter Description
      aws_ssm_parameter_store:
        name: "{{ ssm_parameter_name }}"
        region: "{{ region }}"
        description: "Updated description {{ ansible_date_time.date }}"
        value: "{{ ssm_parameter_value }}"
        overwrite: yes
