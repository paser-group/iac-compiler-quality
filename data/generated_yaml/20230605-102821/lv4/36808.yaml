
- hosts: all
  tasks:
    - name: Read CSV file
      set_fact:
        csv_data: "{{ lookup('csvfile', 'file=sample.csv delimiter=,') }}"
        # Using a string instead of an iterator object as the first argument to the lookup function.
      when: inventory_hostname == 'ubuntu1'
    - name: Print CSV data
      debug:
        var: csv_data
      when: inventory_hostname == 'ubuntu1'
