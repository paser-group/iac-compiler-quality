
- name: Look up an AWS secret using the aws_secret plugin
  hosts: ubuntu1  # Assumes the ubuntu1 hosts is within the inventory file
  gather_facts: false  # Disables facts gathering to simplify and speed up playbook execution
  vars:
    secret_name: "my_secret_name"
  tasks:
    - name: Retrieve the secret
      debug:
        var: lookup('aws_secret', secret_name)

  # Customize ssh connection parameters as needed
  vars_files:
    - "/var/tmp/key_I.pem"
  become: true
  become_method: sudo
  become_password_file: "<path_to_password_file>"

  # Define a group of Ubuntu hosts within the inventory file
  [ubuntu]
  ubuntu1 ansible_host=10.1.1.1 ansible_user=root
