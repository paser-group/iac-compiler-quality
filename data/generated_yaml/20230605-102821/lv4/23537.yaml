
- hosts: all
  gather_facts: no
  tasks:
  - name: Verify inventory file
    shell: ansible-inventory -i inventory --list
    register: inventory_output
    ignore_errors: yes
  - name: Print inventory file contents
    debug:
      var: inventory_output.stdout_lines
      verbosity: 2
  - name: Unmask any errors in the inventory file
    fail:
      msg: "Errors were detected in the inventory file"
    when: inventory_output.rc != 0
