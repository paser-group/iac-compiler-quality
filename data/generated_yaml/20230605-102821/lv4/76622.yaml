
- name: Ensure OpenStack inventory file exists
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Fetch OpenStack inventory plugin
      get_url:
        url: "https://raw.githubusercontent.com/ansible-collections/openstack/stable-{{ openstack_version }}/plugins/inventory/openstack_inventory.py"
        dest: "{{ inventory_dir }}/openstack_inventory.py"
        mode: '0755'
      vars:
        openstack_version: "{{ ansible_facts['distribution_major_version'] }}"
        inventory_dir: "/etc/ansible/inventory"
