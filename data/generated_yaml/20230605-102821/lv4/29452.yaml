
- name: Test group_by bug in Ansible 2.2.0.0
  hosts: all
  gather_facts: false
  vars:
    group_var:
      - group_key: value1
        data: data1
      - group_key: value2
        data: data2
      - group_key: value3
        data: data3
      - group_key: value4
        data: data4
  tasks:
    - group_by:
        key: "{{ item.group_key }}"
      loop: "{{ group_var }}"
    - debug:
        msg: "{{ groups[item.group_key] }}"
      loop: "{{ group_var }}"
