
- name: Adding PostgreSQL user and database
  hosts: all
  become: yes

  tasks:
  - name: Create a PostgreSQL user
    postgresql_user:
      db: mydb
      name: myuser
      password: mypassword
      state: present

  - name: Create a new PostgreSQL database
    postgresql_db:
      name: mydb
      owner: myuser
      state: present

  - name: Grant privileges to a PostgreSQL user
    postgresql_privs:
      db: mydb
      priv: "ALL"
      type: database
      role: wronguser
      state: present
