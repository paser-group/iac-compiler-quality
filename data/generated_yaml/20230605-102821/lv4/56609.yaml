
- hosts: all
  gather_facts: no
  tasks:
  - name: Execute task from outside roles path
    shell: "echo 'Task executed from outside roles path'"
    delegate_to: "{{ inventory_hostname }}"
    when: ansible_env.ANSIBLE_ROLES_PATH is not defined or '/opt/ansible/roles' not in ansible_env.ANSIBLE_ROLES_PATH.split(':')"
