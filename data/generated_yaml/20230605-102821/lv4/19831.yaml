
- hosts: all
  tasks:
    - name: Get EFS Facts
      efs_facts:
        name: "{{ efs_name }}"
      register: efs_result

    - name: Check Permissions Error
      fail:
        msg: "EFS facts failed to report mount permissions error"
      when: "'The mount source is not properly configured' not in efs_result.stdout"

    - name: Check Runtime Error
      fail:
        msg: "EFS facts failed with unhandled exception"
      when: "'unhandled NoneType argument' in efs_result.stdout"
