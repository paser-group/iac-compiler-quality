
- name: Configure Docker network with ICC option
  hosts: localhost
  tasks:
    - name: Create network with ICC off
      docker_network:
        name: node-net
        state: present
        driver: bridge
        internal: yes
        enable_icc: no
        
    - name: Create container ubuntu1 with ICC off
      docker_container:
        name: ubuntu1_container
        image: ubuntu:latest
        state: started
        network_mode: node-net
        command: sleep infinity
        
    - name: Create container alpine1 with ICC on
      docker_container:
        name: alpine1_container
        image: alpine:latest
        state: started
        network_mode: node-net
        command: sleep infinity
        restart: yes
        enable_icc: yes
