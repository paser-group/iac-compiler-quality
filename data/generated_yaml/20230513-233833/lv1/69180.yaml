yaml
- hosts: your_aci_host
  connection: local

  tasks:
    - name: Upgrade SSL DH Keys to 2048-bit (Cisco ACI)
      aci_rest:
        hostvars: "{{ inventory_hostname }}"
        username: "{{ aci_username }}"
        password: "{{ aci_password }}"
        method: post
        path: "/api/node/mo/uni/fabrickeyring/securityentity-[uni/userext/keyring-{aci_ssl_keyring-name}]-bgpkey/conf-{{ aci_ssl_keyring-name }}_bgp_key"
        data: |
          {
            "bgpEthCktEpList": [
              {
                "bgpAsP": "{{ aci_bgp_as_number }}",
                "bgpKeyChainP": "{{ aci_ssl_keyring-name }}_bgp_key",
                "dn": "uni/tn-{{ aci_tenant }}/lDevVip-{{ aci_gateway }}-{{ aci_bridge-domain }}/ctx-{{ aci_vrf }}/adj-{{ aci_bgp_peer-ip }}-eth-[eth1/101]",
                "ifInstT": "sub-interface",
                "lcOwn": "local",
                "monPolDn": "",
                "name": "{{ aci_vrf }}-{{ aci_bgp_peer-ip }}-eth1/101",
                "neighAddr": "{{ aci_bgp_peer-ip }}",
                "operSt": "down",
                "podId": "{{ aci_pod_id }}",
                "skeyId": "{{ aci_ssl_keyring-name }}",
                "stateQual": "none",
                "status": "",
                "type": "internal",
                "ctrl": "md",
                "mtu": "{{ aci_vrf_mtu }}",
                "secMode": "none",
                "encap": "{{ aci_vlan_encap }}",
                "ip": "{{ aci_gateway }}/{{ aci_subnet_nm }}",
                "pcTag": "",
                "vlanId": "{{ aci_vlan }}",
                "fabEncap": "vlan-{{ aci_vlan }}"
              }
            ],
            "bgpKeyChainPList": [
              {
                "descr": "",
                "dn": "uni/tn-{{ aci_tenant }}/userext/keyring-{{ aci_ssl_keyring-name }}_bgp_key",
                "lcOwn": "local",
                "name": "{{ aci_ssl_keyring-name }}_bgp_key",
                "status": "",
                "ctrl": "md",
                "actrl": "",
                "locale": "global",
                "skeySize": "2048"
              }
            ]
          }
