
- name: Update network configs on GCP compute instance
  hosts: my-instance
  gather_facts: no
  vars:
    network_interface: eth0
    network_config:
      - name: "default"
        access_configs:
          - name: "external-nat"
            type: "ONE_TO_ONE_NAT"
  tasks:
  - name: Update network configs
    gcp_compute_instance:
      name: my-instance
      zone: us-east1-b
      network_interface: "{{ network_interface }}"
      auto_create_subnetworks: false
      network: "{{ network_config }}"
      state: present
