yaml
---
- name: Reboot NXOS switches
  hosts: switches
  gather_facts: no

  tasks:
  - name: Reboot switches
    nxos_reboot:
      confirm: yes
      use_cli: yes
      use_nxapi: yes
    register: reboot_result

  - name: Report success or failure
    debug:
      msg: "Switches rebooted successfully"
    when: reboot_result.changed

  - name: Report error message
    fail:
      msg: "Error occurred during switch reboot: {{ reboot_result.stderr }}"
    when: not reboot_result.changed
