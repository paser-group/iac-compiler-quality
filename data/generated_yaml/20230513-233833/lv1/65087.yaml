
---
- name: Update Config to convert bytes to strings
  hosts: all
  become: true

  vars:
    config_file: "/path/to/config/file"

  tasks:
    - name: Read the config file
      slurp:
        path: "{{ config_file }}"
      register: config_content

    - name: Convert bytes to strings
      set_fact:
        config_str: "{{ config_content['content']|b64decode|decode('utf-8') }}"

    - name: Write the updated content back to the config file
      copy:
        content: "{{ config_str }}"
        dest: "{{ config_file }}"

    - name: Restart the service
      service:
        name: <service_name>
        state: restarted
