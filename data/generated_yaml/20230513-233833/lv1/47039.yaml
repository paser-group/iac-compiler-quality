
---
- name: Configure InfluxDB users
  hosts: all
  become: yes
  vars:
    influxdb_username: default
    influxdb_password: "{{ lookup('env','INFLUXDB_PASSWORD') }}"
      only_once: true
  tasks:
    - name: Create InfluxDB user with password
      influxdb_user:
        username: "{{ influxdb_username }}"
        password: "{{ influxdb_password }}"
        state: present
      when: influxdb_password is defined
