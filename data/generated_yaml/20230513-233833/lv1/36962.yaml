
---
- hosts: all
  become: true
  tasks:
    - name: Fix string/binary encoding issue in pull.py
      find:
        paths: /path/to/pull.py
        patterns: "*.py"
      register: py_files
    - name: Update pull.py encoding
      lineinfile:
        path: "{{ item }}"
        regexp: '^#.*coding[:=]\s*([-\w.]+)'
        line: '# -*- coding: utf-8 -*-'
      with_items:
        - "{{ py_files.files }}"
