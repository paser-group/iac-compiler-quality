
---
- name: Check service state
  hosts: your_host
  become: yes

  tasks:
  - name: Start a service and check state
    service:
      name: your_service
      state: started
      enabled: yes
    register: service_state

  - name: Print state message
    debug:
      var: service_state

  - name: Fail if state not changed
    fail:
      msg: "{{service_state.stdout}} state not changed"
    when: service_state.changed == False
