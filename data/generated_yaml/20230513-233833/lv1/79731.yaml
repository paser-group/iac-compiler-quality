
---
- name: Install Ansible Galaxy collection
  hosts: localhost
  tasks:
    - name: Clone Ansible Galaxy repository
      git:
        repo: https://github.com/ansible/galaxy.git
        dest: /tmp/galaxy
    - name: Install the required dependencies
      package:
        name: python3-pip
        state: present
    - name: Create a virtual environment for Galaxy
      pip:
        name: virtualenv
        state: present
    - name: Activate the virtual environment
      command:
        chdir: /tmp/galaxy
        cmd: virtualenv venv && source venv/bin/activate
      args:
        executable: /bin/bash
    - name: Install Galaxy requirements
      pip:
        requirements: /tmp/galaxy/requirements.txt
        virtualenv: /tmp/galaxy/venv
    - name: Build and install Galaxy
      command:
        chdir: /tmp/galaxy
        cmd: pip install .
