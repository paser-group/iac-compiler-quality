
---
- name: Create Windows shortcut
  hosts: windows
  gather_facts: no

  tasks:
  - name: Create shortcut
    win_shortcut:
      src: C:\Program Files\Microsoft\Edge\Application\msedge.exe
      dest: C:\Users\Public\Desktop\Microsoft Edge.lnk
      description: Microsoft Edge
    register: shortcut_result

  - name: Update shortcut if it already exists
    win_shell: |
      if(Test-Path "C:\Users\Public\Desktop\Microsoft Edge.lnk") {
        del "C:\Users\Public\Desktop\Microsoft Edge.lnk"
        New-Item -ItemType SymbolicLink -Path "C:\Users\Public\Desktop\Microsoft Edge.lnk" -Target "C:\Program Files\Microsoft\Edge\Application\msedge.exe" -Description "Microsoft Edge"
      }
    when: not shortcut_result.changed
