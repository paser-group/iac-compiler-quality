
- name: Run aci_maintenance_group_node module
  hosts: localhost
  gather_facts: no
  vars:
    aci_maintenance_group_node_params:
      host: "{{ inventory_hostname }}"
      username: "{{ ansible_user }}"
      password: "{{ ansible_password }}"
      fabric:
        host: "fabric"
      group:
        name: "test-group"
      node:
        pod_id: "1"
        node_id: "101"
      attributes:
        "policy-name": "default"
        "maintenance-grp-name": "default"
        "admin-state": "enabled"
        "descr": "Example Description"
  tasks:
    - name: Run aci_maintenance_group_node module
      aci_maintenance_group_node:
        host: "{{ aci_maintenance_group_node_params.host }}"
        username: "{{ aci_maintenance_group_node_params.username }}"
        password: "{{ aci_maintenance_group_node_params.password }}"
        validate_certs: no
        fabric: "{{ aci_maintenance_group_node_params.fabric }}"
        group: "{{ aci_maintenance_group_node_params.group }}"
        node: "{{ aci_maintenance_group_node_params.node }}"
        attributes: "{{ aci_maintenance_group_node_params.attributes }}"
      register: result

    - name: Fail the playbook if any tasks failed
      fail:
        msg: "module execution failed"
      when: result is failed
