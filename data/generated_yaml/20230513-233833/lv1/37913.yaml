yaml
---
- name: copy file to windows directory
  hosts: windows
  vars:
    src_file: "{{ playbook_dir }}/files/test.txt"
    dest_dir: "C:\\Temp\\test"
  tasks:
    - name: check if destination folder exists
      win_command: "Test-Path {{ dest_dir }}"
      register: result
      ignore_errors: yes
    - name: create destination folder
      win_command: "New-Item -ItemType Directory -Force -Path {{ dest_dir }}"
      when: result.rc != 0
    - name: copy file
      win_copy:
        src: "{{ src_file }}"
        dest: "{{ dest_dir }}"
