
---
- name: Troubleshoot SSH connection issue
  hosts: <your_hosts>
  gather_facts: false

  tasks:
    - name: Test SSH Connection
      shell: ssh -o BatchMode=yes <your_user>@<your_host> "echo success"
      ignore_errors: true
      register: ssh_output

    - name: Display SSH Connection status
      debug:
        msg: "{{ ssh_output.stdout_lines }}"

    - name: Run Ansible ping module
      ping:
      register: ansible_ping_output
      when: ssh_output.rc == 0

    - name: Display Ansible Ping status
      debug:
        msg: "{{ ansible_ping_output.msg }}"
