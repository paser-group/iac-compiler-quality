
- name: Filter VMware hosts
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Load VMware inventory
    vmware_inventory:
      hostname: your_vcenter_server
      username: your_username
      password: your_password
      validate_certs: False
      folder: 'your_folder_name'

  - name: Filter host
    set_fact:
      filtered_hosts: "{{ groups['vmware_hosts'] | select('match', 'filter_text') | list }}"

  - name: Display filtered hosts
    debug:
      var: filtered_hosts
