
---
- name: Fix selective callback reporting issue
  hosts: all
  become: true

  tasks:
    - name: Edit a line in a file
      lineinfile:
        path: /path/to/file
        regexp: '^old text'
        line: 'new text'
      register: result

    - name: Report result if failed
      debug:
        msg: "Failed to edit line in file"
      when: result is failed
