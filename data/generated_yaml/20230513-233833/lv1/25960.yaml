
---
- name: Fix mysql_user segmentation fault
  hosts: all
  become: true

  tasks:
  - name: Install MYSQL client package
    package:
      name: mysql
      state: present

  - name: Remove .my.cnf file
    file:
      path: ~/.my.cnf
      state: absent

  - name: Create .my.cnf file
    copy:
      content: |
        [client]
        user=root
        password=yourpassword
      dest: ~/.my.cnf
      mode: 0600

  - name: Restart MySQL service
    service:
      name: mysql
      state: restarted
