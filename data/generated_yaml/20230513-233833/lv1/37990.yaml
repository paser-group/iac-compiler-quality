
---
- hosts: junos_device
  gather_facts: no
  vars:
    junos_connection_type: ssh # correct connection type
  tasks:
    - name: Verify junos connection type
      junos_ping:
      register: ping_result

    - name: Print connection type
      debug:
        var: ping_result["ansible_netmiko_device"]["device_type"]

    - name: Run junos module with wrong connection type
      junos_facts:
        user: "{{ ansible_user }}"
        password: "{{ ansible_password }}"
        gather_subset: "!hardware"
        host: "{{ ansible_host }}"
        connection: telnet # wrong connection type
      register: junos_facts_result
      ignore_errors: yes

    - name: Print junos module error message
      debug:
        var: junos_facts_result.msg
