
- hosts: all
  become: yes
  
  gather_facts: no
  
  tasks:
  
  - name: Check system memory
    shell: free -m | awk 'NR==2{printf "%.2f%%", $3*100/$2}'
    register: mem
    
  - name: Display memory usage
    debug:
      var: mem.stdout_lines
      
  - name: Update the system to increase memory limit
    sysctl:
      name: vm.overcommit_memory
      value: 1
      state: present
