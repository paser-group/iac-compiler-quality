yaml
---
- name: Configure JSONFILE cache plugin prefix
  hosts: all
  become: yes

  tasks:
    - name: Configure JSONFILE cache plugin
      blockinfile:
        path: /etc/ansible/ansible.cfg
        block: |
          [defaults]
          fact_caching= jsonfile
          fact_caching_connection=/tmp/facts_cache
          fact_caching_prefix=my_custom_prefix
      when: "'jsonfile' in ansible_fact_manager"

    - name: Create cache directory
      file:
        state: directory
        path: /tmp/facts_cache
