
---
- hosts: localhost
  gather_facts: false

  tasks:
  - name: Gather inventory from GCP Compute
    gcp_compute_inventory:
      filters:
        - name: status
          values:
            - RUNNING
        - name: label-key
          values:
            - my-app-label
      auth_kind: serviceaccount
      service_account_file: /path/to/service_account.json
      project: my-gcp-project
      auth_kind: serviceaccount
      hostnames:
        - private
      keyed_groups:
      - key: labels.my-app-label
        prefix: my-app
      - key: zone
        prefix: zone
    register: gcp_compute_inventory_output

  - debug:
      var: gcp_compute_inventory_output
