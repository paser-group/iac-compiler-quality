
- name: Install Python Winrm Module
  hosts: all
  become: true
  
  tasks:
  - name: Install Python Winrm Module
    pip:
      name: pywinrm
      state: latest
  
- name: Configure WinRM Settings
  hosts: all
  vars:
    ansible_winrm_read_timeout_sec: 180
  tasks:
  - name: Configure WinRM Settings
    winrm_config:
      listener_type: http
      max_shell_memory: 2147483647
      allow_unencrypted: true
      ssl: true
      cert_thumbprint: "{{ lookup('env', 'thumbprint') }}"
    become: true
