yaml
---
- hosts: database_servers
  vars:
    mysql_database: mydatabase
    mysql_user: myuser
    mysql_password: mypassword
  tasks:
  - name: Dump MySQL database
    mysql_db:
      state: dump
      name: "{{ mysql_database }}"
      login_user: "{{ mysql_user }}"
      login_password: "{{ mysql_password }}"
    register: mysql_db_dump
  - name: Verify MySQL dump result
    debug:
      msg: "MySQL dump failed with error message: {{ mysql_db_dump.msg }}"
    failed_when: mysql_db_dump.failed and "'Access denied' not in mysql_db_dump.msg"
