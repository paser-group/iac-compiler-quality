
---
- hosts: ios_switches

  tasks:
    - name: Run IOS command and save output
      ios_command:
        commands:
          - show interfaces status
      register: ios_command_output

    - name: Display IOS command output
      debug:
        var: ios_command_output.stdout

    - name: Fail the playbook if IOS command output includes an error
      fail:
        msg: "matched error in IOS command response"
      when: "'error' in ios_command_output.stdout"
