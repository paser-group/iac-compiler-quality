yaml
---

- name: Install VMware tools asynchronously
  hosts: all
  become: yes
  tasks:
    - name: Install open-vm-tools package
      yum:
        name: open-vm-tools
        state: present

    - name: Install dependencies
      yum:
        name:
          - gcc
          - make
          - kernel-headers
          - kernel-devel
        state: present

    - name: Install perl package
      yum:
        name: perl
        state: present

    - name: Install VMware tools using open-vm-tools-deploypkg
      async: 1000
      poll: 0
      shell: 'vmware-install.pl --default EULA_AGREED=yes'
