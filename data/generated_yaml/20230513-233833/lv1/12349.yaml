yaml
---
- name: Upgrade Python to 2.7 on hosts
  hosts: all
  become: yes # Set 'become' flag to access root privileges

  tasks:
  - name: Update package manager
    package:
      update_cache: yes
    delegate_to: localhost # Update the package manager on the controlling machine
    
  - name: Upgrade Python to 2.7 on hosts
    package:
      name: python2.7 # Install Python 2.7 package
    become: yes # Need root privileges to install package
      
  - name: Install pip for Python 2.7
    get_url:
      url: https://bootstrap.pypa.io/get-pip.py
      dest: /tmp/get-pip.py # Download get-pip.py script
    become: yes # Need root privileges to download script
      
  - name: Install pip
    command: "/usr/bin/python2.7 /tmp/get-pip.py" # Run script to install pip
    become: yes # Need root privileges to install pip
      
  - name: Upgrade pip setuptools
    command: "/usr/bin/pip install --upgrade pip setuptools"
    become: yes # Need root privileges to upgrade pip and setuptools
      
  - name: Install ansible
    command: "/usr/bin/pip install ansible" # Install ansible
    become: yes # Need root privileges to install ansible
