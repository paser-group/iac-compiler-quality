
- name: Troubleshoot Lookup module failure
  hosts: all
  become: true
  
  tasks:
  
    - name: Ensure the password lookup directory exists
      file:
        path: "/path/to/password/lookup/directory"
        state: directory
          
    - name: Gather facts about the system
      setup:
        
    - name: Perform the lookup
      vars:
        lookup_path: "/path/to/password/lookup/directory"
        some_var: "{{ lookup('password', 'file=lookupfile.txt path=' + lookup_path + 'chars=ascii_letters,digits') }}"
          
    - name: Print the value returned from lookup
      debug:
        var: some_var
