yaml
- name: Gather NXOS facts (with fan information)
  hosts: switch
  gather_facts: no
  vars:
    nxos_command_string: "show inventory;show environment fan"
  tasks:

    - name: Gather device facts
      nxos_facts:
        command_string: "{{ nxos_command_string }}"
        legacy: yes
        subset:
          - hardware
          - interfaces
          - vlans
          - default_vrf
          - running_config
    - name: Gather fan information
      nxos_command:
        commands:
          - show environment fan
      register: fan_info

    - name: Display fan information
      debug:
        var: fan_info.stdout_lines
