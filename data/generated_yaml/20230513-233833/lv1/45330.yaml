
- name: Ensure the existence of Azure Container Registry
  hosts: all
  become: true
  vars:
    containerregistry_name: mycontainerregistry
    containerregistry_group: mycontainerregistrygroup
  tasks:
    - name: Create Azure Container Registry
      azure_rm_containerregistry:
        name: "{{ containerregistry_name }}"
        resource_group: "{{ containerregistry_group }}"
        sku: basic
      register: result
    - name: Ensure idempotency
      debug:
        msg: "Azure Container Registry already exists"
      when: result is skipped
