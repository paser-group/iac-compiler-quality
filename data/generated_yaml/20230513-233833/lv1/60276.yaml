
- name: Fix issues with custom module and aci module
  hosts: all
  gather_facts: false

  tasks:

  - name: Install needed python modules
    pip:
      name: "{{ item }}"
    with_items:
      - acitoolkit
      - requests

  - name: Copy custom module to remote host
    copy:
      src: /path/to/custom/module.py
      dest: /tmp/module.py
      mode: 0644

  - name: Run custom module with aci module as dependency
    shell: python /tmp/module.py
    environment:
      PYTHONPATH: /usr/local/lib/python2.7/site-packages/aci_toolkit-{{ acitoolkit_version }}-py2.7.egg/aci_toolkit
