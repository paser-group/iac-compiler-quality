
---
- name: Inventory files parsing correction playbook
  hosts: localhost
  connection: local
  gather_facts: no
  
  tasks:
  - name: Check inventory file
    stat:
      path: inventory.txt
    register: inventory_file

  - name: Parse inventory file
    ini_file: 
      path: inventory.txt
      section: "{{ item.key }}"
      option: "{{ item.value }}"
    with_dict: "{{ inventory_sections }}"
    when: inventory_file.stat.exists == true

  - debug:
      var: ansible_inventory
