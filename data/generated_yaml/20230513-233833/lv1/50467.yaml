
---
- name: Restart the Docker Swarm service
  hosts: all
  become: true

  tasks:
    - name: Stop the Docker Swarm service
      systemd:
        name: docker.service
        state: stopped

    - name: Update Docker Swarm service configuration
      lineinfile:
        path: /etc/systemd/system/docker.service.d/docker-override.conf
        line: ExecStart=
      become: true

    - name: Reload the systemd daemon
      systemd:
        daemon_reload: yes

    - name: Start the Docker Swarm service
      systemd:
        name: docker.service
        state: started
