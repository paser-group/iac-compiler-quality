
- name: Adding an XML fragment on Windows using ansible
  hosts: windows
  tasks:
    - name: Install win_shell module
      win_pip:
        name: pypiwin32
        state: present
      register: win_shell_check

    - name: Check dependencies
      block:
        - fail:
            msg: "Error: Install pypiwin32 library to use the xml module in Ansible"
          when: win_shell_check.failed

        - name: "Add an XML fragment"
          xml:
            path: "path/to/file.xml"
            fragment: "<node>Added by Ansible playbook</node>"
            state: present
