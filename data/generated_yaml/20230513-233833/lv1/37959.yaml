yaml
- hosts: all
  vars:
    s3_bucket: 'my-s3-bucket'
    s3_profile: 'my-profile'
    src_dir: '/path/to/local/source/directory'
    dest_dir: 's3://{{ s3_bucket }}/my-s3-destination'
  tasks:
    - name: Install boto3 and botocore
      pip:
        name: "{{ item }}"
      with_items:
        - boto3
        - botocore
      become: true
      become_user: root
    - name: Sync local directory to S3 bucket
      s3_sync:
        bucket: "{{ s3_bucket }}"
        profile: "{{ s3_profile }}"
        region: 'us-east-1'
        src: "{{ src_dir }}"
        dest: "{{ dest_dir }}"
      become: true
      become_user: root
