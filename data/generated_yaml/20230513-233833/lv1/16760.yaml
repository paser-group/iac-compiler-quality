
- name: Debug ansible-galaxy info Attribute Errors
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Install requirements
    pip:
      name: requirements.txt

  - name: Gather ansible-galaxy info
    shell: ansible-galaxy info
    register: galaxy_info_output

  - name: Check ansible-galaxy output
    debug:
      var: galaxy_info_output

  - name: Fix attribute error
    replace:
      path: /usr/lib/python2.7/site-packages/ansible/galaxy/__main__.py
      regexp: 'values.offline'
      replace: 'values.__getattr__("offline")'
