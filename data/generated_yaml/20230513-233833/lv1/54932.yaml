
---

- name: Provision and configure Redis Cache in Azure
  hosts: localhost
  connection: local
  gather_facts: no
  
  vars:
    resource_group: my_resource_group
    location: westus
    redis_cache_name: my_redis_cache
    sku: Basic
    vm_size: C0
    maxclients: 10000
  
  tasks:
  
  - name: Ensure Redis Cache is blocked by default on provisioning ops
    azure_rm_rediscache:
      resource_group: "{{ resource_group }}"
      name: "{{ redis_cache_name }}"
      location: "{{ location }}"
      sku: "{{ sku }}"
      vm_size: "{{ vm_size }}"
      maxclients: "{{ maxclients }}"
      blocked: yes
    register: redis_cache
    
  - name: Display Redis Cache properties
    debug:
      var: redis_cache
