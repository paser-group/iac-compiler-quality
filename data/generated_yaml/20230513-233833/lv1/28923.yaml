
---
- hosts: your_host
  gather_facts: false
  become: true
  vars:
    ansible_python_interpreter: /usr/bin/python3

  tasks:
    - name: Install required dependencies
      apt:
        name:
          - python3-digitalocean
          - python3-pip
          - python3-setuptools
          - python3-dev
        state: present

    - name: Update pip
      pip:
        name: pip
        state: latest

    - name: Install DigitalOcean API
      pip:
        name: python-digitalocean
        state: latest

    - name: Display DigitalOcean droplets
      digital_ocean:
        state: list
        oauth_token: {your_token}
      register: output

    - name: Print output value
      debug:
        var: output
