
---
- hosts: your_server
  become: yes

  tasks:
  - name: Install Certbot and dependencies
    yum:
      name: certbot
      state: present

  - name: Ensure Firewall is open for HTTP and HTTPS traffic
    firewalld:
      service: http
      permanent: yes
      state: enabled
      immediate: yes
    firewalld:
      service: https
      permanent: yes
      state: enabled
      immediate: yes

  - name: Request Let's Encrypt SSL Certificate
    shell: certbot certonly --agree-tos --email your_email --no-eff-email --expand -d your_domain -d www.your_domain --webroot --webroot-path /var/www/html/
    args:
      chdir: /etc/letsencrypt/
