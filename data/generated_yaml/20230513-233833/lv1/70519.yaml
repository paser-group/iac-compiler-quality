yaml
- name: Install GCP modules
  hosts: localhost
  become: true
  tasks:
    - name: Install GCP modules
      pip:
        name:
          - google-auth
          - google-auth-oauthlib
          - google-auth-httplib2
          - google-api-python-client

- name: My GCP Playbook
  hosts: all
  gather_facts: true

  vars:
    project_id: "my-project-id"
    machine_name: "my-machine-name"
    zone: "us-central1-a"
    service_account_contents: "{{ lookup('file', 'path/to/service_account_contents.json') }}"

  tasks:
  - name: Create GCE instance
    gcp_compute_instance:
      name: "{{ machine_name }}"
      machine_type: "n1-standard-1"
      disks:
      - auto_delete: true
        boot: true
        initialize_params:
          image: "debian-cloud/debian-10"
      network_interfaces:
      - network: "global/networks/default"
      zone: "{{ zone }}"
      project: "{{ project_id }}"
      service_account_contents: "{{ service_account_contents }}"
