
---
- name: Install beadm module and fix python error
  hosts: all
  become: true
  gather_facts: false

  tasks:
    - name: Install beadm module
      ansible.builtin.pip:
        name: beadm
        state: present

    - name: Fix python error
      ansible.builtin.lineinfile:
        path: /usr/local/lib/python3.6/site-packages/beadm/__init__.py
        regexp: '^(.*def split_boot_env.*):'
        line: '\1 return () if chunks == [""] else chunks'
        backup: yes
