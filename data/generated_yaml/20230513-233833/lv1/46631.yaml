yaml
---
- name: Fix ansible errors in undercloud deployment
  hosts: undercloud
  tasks:
    - name: Ensure required packages are installed
      package:
        name:
          - python3-tripleoclient
          - python3-heatclient
        state: present

    - name: Verify the overcloud images
      command: openstack overcloud image upload --image-path /usr/share/rhosp-director-images/
      register: upload_result
      ignore_errors: yes

    - name: Re-run the undercloud installation
      command: openstack undercloud install
