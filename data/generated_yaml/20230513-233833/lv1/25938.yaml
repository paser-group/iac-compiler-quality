
- hosts: localhost

  tasks:
  - name: create ec2 security group
    ec2_group:
      name: my_security_group
      description: my security group
      vpc_id: my_vpc_id
      region: my_region
      rules:
        - proto: tcp
          ports: 80
          cidr_ip: 0.0.0.0/0
        - proto: tcp
          ports: 443
          cidr_ip: 0.0.0.0/0

  - name: Remove empty security group
    ec2_group:
      name: my_security_group
      description: my security group
      vpc_id: my_vpc_id
      region: my_region
      state: absent
