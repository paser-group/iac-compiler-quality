
- name: Configure S3 using Fakes3 protocol
  hosts: all
  tasks:
    - name: Install boto3 and botocore Python modules
      pip:
        name:
          - 'boto3'
          - 'botocore'

    - name: Create S3 Bucket using Fakes3 Protocol
      s3_bucket:
        name: 'my-bucket.fake.s3.amazonaws.com'
        region: 'us-east-1'
        profile: 'default'
        state: 'present'

    - name: Enable versioning on S3 bucket
      s3_bucket_versioning:
        name: 'my-bucket.fake.s3.amazonaws.com'
        state: 'enabled'
        profile: 'default'
