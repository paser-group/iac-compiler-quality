
- name: Upload Cisco IOS image
  hosts: cisco
  gather_facts: no

  vars:
    ios_file: <path_to_IOS_image>

  tasks:
    - name: Copy Cisco IOS image to remote device
      net_put:
        src: "{{ ios_file }}"
        dest: "/bootflash/{{ ios_file }}"
      register: result

    - name: Verify upload of Cisco IOS image
      ios_command:
        commands:
          - show bootflash: | include "{{ ios_file }}"
      register: result

    - name: Reboot device
      ios_command:
        commands:
          - reload
        wait_for_reboot: yes
