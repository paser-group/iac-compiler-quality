yaml
- hosts: your_target_machines
  become: true
  gather_facts: true

  # Define your tasks here
  tasks:

  - name: Perform the main task
    shell: your_shell_command_here

    # Register the variable and indicate it is conditional
    register: result
    changed_when: false
    failed_when: result.rc != 0

  - name: Handle the result based on the conditional register variable
    debug:
      msg: "The operation succeeded!"
    when: result is succeeded

    # Handle the result if it failed
  - name: Handle the result if it failed
    debug:
      msg: "The operation failed!"
    when: result is failed
