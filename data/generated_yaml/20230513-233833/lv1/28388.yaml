yaml
---
- hosts: all
  gather_facts: yes
  tasks:
    - name: Create user with no password
      eos_user:
        name: "{{ user_name }}"
        nopassword: yes
      register: result
      failed_when: result is not defined

    - name: Create user with password
      eos_user:
        name: "{{ user_name }}"
        password: "{{ user_password }}"
        state: present
      register: result
      failed_when: result is not defined
