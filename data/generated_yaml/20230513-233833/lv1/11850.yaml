
---
- name: Run shell command and capture exit code
  hosts: localhost
  gather_facts: false
  
  tasks:
    - name: Execute shell command and capture exit code
      shell: "[your command here]"
      register: command_exit_code
      # Example command:
      # shell: "ls /path/to/nonexistent/file"
      
    - name: Check exit code and take action
      fail:
        msg: "Command failed with exit code {{ command_exit_code.rc }}"
      when: command_exit_code.rc != 0
