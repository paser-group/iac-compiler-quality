
---
- name: Debug cloudwatchevent_rule error
  hosts: all
  gather_facts: true

  tasks:
    - name: Check CloudWatch Event Rule status
      aws_eventbridge_event_select:
        region: "{{ region }}"
        event_rule_name: "{{ event_rule_name }}"
      register: eventbridge_rule_status

    - name: Fix error
      command: "{{ command_to_fix_error }}"
      when: eventbridge_rule_status.failed == true
