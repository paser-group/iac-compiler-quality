
- name: Configure IOS
  hosts: network_device
  gather_facts: no
  vars:
    src: "{{ playbook_dir }}/config.cfg"
  tasks:
    - name: Apply IOS configuration
      ios_config:
        src: "{{ src }}"
      register: ios_result
      failed_when: "'invalid src option' in ios_result.stderr"
