yaml
---
- name: Configure eos_eapi for non-default vrfs
  hosts: your_target_hosts
  gather_facts: false

  tasks:
    - name: Check default VRF configuration status
      eos_command:
        commands:
          - show ip vrf
      register: default_vrf

    - name: Configure non-default vrfs
      eos_eapi:
        host: your_eos_host
        username: your_username
        password: your_password
        enable_vrfs: True
        state: present
      when: default_vrf.stdout.find('default') != -1
