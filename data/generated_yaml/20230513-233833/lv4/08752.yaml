
- name: Decrypt file using Ansible Vault
  vars:
    original_file: /path/to/original_file
    encrypted_file: /path/to/encrypted_file
    decrypted_file: /path/to/decrypted_file
  command: ansible-vault decrypt {{encrypted_file}} --output {{decrypted_file}} --vault-password-file /path/to/vault_password
  register: decrypt_output
  
- name: Ensure that decrypt output is correct
  assert:
    that:
      - lookup('file', '{{original_file}}') == lookup('file', '{{decrypted_file}}')
  when: decrypt_output.changed
