
- name: Set SSH Configuration
  hosts: all
  gather_facts: false
  vars:
    ssh_key_file: "/path/to/ssh/key"
    ssh_user: "ansible"
    ssh_connection_timeout: 30
  tasks:
  - name: delegate_to with ssh settings
    delegate_to: 10.1.1.1
    gather_facts: false
    vars:
      ansible_ssh_private_key_file: "{{ ssh_key_file }}"
      ansible_user: "{{ ssh_user }}"
      ansible_ssh_common_args: "-o StrictHostKeyChecking=no -o ControlMaster=auto -o ControlPersist=60s -o ServerAliveInterval=30 -o ServerAliveCountMax=3"
      ansible_connection_options:
        ssh_args: "-o ControlMaster=auto -o ControlPersist=60s -o ServerAliveInterval=30 -o ServerAliveCountMax=3 -o ControlPath=/tmp/ansible-%r@%h:%p"
      ansible_ssh_extra_args: "-o ControlMaster=auto -o ControlPersist=60s"
    become: true
    become_method: sudo
    ignore_errors: true
