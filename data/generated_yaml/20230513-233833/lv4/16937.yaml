
- hosts: all
  gather_facts: no
  tasks:
    - name: Run once task that generates an error
      command: /bin/false
      run_once: true
      ignore_errors: true
    - name: Log error to file in rescue block
      rescue:
        - copy:
            content: "{{ ansible_failed_result.msg }}"
            dest: "/var/log/test_playbook/rescue.log"
    - name: Log message to file in always block
      always:
        - copy:
            content: "This message runs always"
            dest: "/var/log/test_playbook/always.log"
