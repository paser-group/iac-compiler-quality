
- name: Test SSH connectivity - nodes
  hosts: all
  vars_prompt:
    - name: "ssh_user"
      prompt: "Enter SSH username: "
      private: no
    - name: "ssh_pass"
      prompt: "Enter SSH password: "
      private: yes
  tasks:
    - name: Test SSH connectivity
      shell: echo "Connected to '{{ inventory_hostname }}'" 
      register: ssh_connection
      failed_when: "ssh_connection.rc != 0"
      delegate_to: localhost
      run_once: true
