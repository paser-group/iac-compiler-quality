
- name: Create an instance and add it to two default groups
  hosts: localhost
  connection: local
  gather_facts: false

  vars:
    instance_type: t2.micro
    image: ami-0c55b159cbfafe1f0
    keypair: my_key
    region: us-east-1
    count: 1
    group_names: default,default

  tasks:
    - name: Provision and launch new instance
      ec2:
        key_name: "{{ keypair }}"
        region: "{{ region }}"
        image: "{{ image }}"
        instance_type: "{{ instance_type }}"
        count: "{{ count }}"
        group: "{{ group_names }}"
      register: ec2

    - name: Debugging EC2 instances
      debug:
        var: ec2
