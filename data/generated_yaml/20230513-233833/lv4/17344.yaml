
---
- name: Test ServerList using Openstack dynamic inventory
  hosts: all
  gather_facts: False

  tasks:
    - name: Test ServerList with invalid Openstack credentials
      os_server_list:
        auth:
          auth_url: "http://{{ hostvars['controller']['ansible_host'] }}:5000/v3"
          username: "invalid_user"
          password: "invalid_password"
          project_name: "invalid_project"
          project_domain_name: "invalid_domain"
        validate_certs: False
      delegate_to: localhost
      ignore_errors: True

    - name: Test ServerList with invalid server group name
      os_server_list:
        auth:
          auth_url: "http://{{ hostvars['controller']['ansible_host'] }}:5000/v3"
          username: "{{ openstack_username }}"
          password: "{{ openstack_password }}"
          project_name: "{{ openstack_project_name }}"
          project_domain_name: "{{ openstack_project_domain_name }}"
        server_group_name: "invalid_server_group"
        validate_certs: False
      delegate_to: localhost
      ignore_errors: True
