
- name: Create Launch Configuration
  ec2_lc:
    name: "{{ asg_name }}-{{ item.name }}"
    image_id: "{{ ami_id }}"
    instance_type: "{{ item.instance_type }}"
    region: "{{ region }}"
  with_items: "{{ launch_configurations }}"
  
- name: Create Auto Scaling Group
  ec2_asg:
    name: "{{ asg_name }}"
    launch_config_name: "{{ asg_name }}-{{ primary_lc_name }}"
    min_size: "{{ min_size }}"
    max_size: "{{ max_size }}"
    desired_capacity: "{{ desired_capacity }}"
    region: "{{ region }}"

- name: Modify Auto Scaling Group settings (wait_for_instances = none)
  ec2_asg:
    name: "{{ asg_name }}"
    wait_for_instances: none
    region: "{{ region }}"

- name: Modify Auto Scaling Group settings (wait_for_instances = minimum)
  ec2_asg:
    name: "{{ asg_name }}"
    wait_for_instances: minimum
    region: "{{ region }}"

- name: Modify Auto Scaling Group settings (wait_for_instances = exact)
  ec2_asg:
    name: "{{ asg_name }}"
    wait_for_instances: exact
    region: "{{ region }}"

- name: Modify Auto Scaling Group settings (wait_for_instances = maximum)
  ec2_asg:
    name: "{{ asg_name }}"
    wait_for_instances: maximum
    region: "{{ region }}"
