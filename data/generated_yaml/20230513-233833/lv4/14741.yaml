
- name: Deploy haproxy configuration
  hosts: localhost
  tasks:
    - name: Invoke haproxy module and delegate to remote host
      haproxy:
        state: present
        config_file: /etc/haproxy/haproxy.cfg
        delegate_to: 10.1.1.1
      register: haproxy_result
      
    - name: Compare actual result with expected result
      assert:
        that:
          - haproxy_result.changed == true
          - haproxy_result.failures == 0
