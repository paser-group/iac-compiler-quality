
---
- name: Fuzzing ios_command module
  hosts: ios_devices
  gather_facts: no
  tasks:
    - name: Fuzz ios_command module
      ios_command:
        provider: "{{ provider }}"
        commands: "{{ item }}"
        wait_for_connection: no
      loop:
        - "show version"
        - "show interface"
        - "show configuration"
        - "debug"
        - "ping google.com"
        - "{{ random_string(50) }}"
      register: output
    - name: Validate output
      debug:
        var: output
