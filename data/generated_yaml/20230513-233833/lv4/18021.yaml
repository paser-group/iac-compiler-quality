
- name: Test playbook with any_errors_fatal
  hosts: all
  gather_facts: false

  vars:
    my_var: "test"

  tasks:
    - name: Task 1
      command: "echo 'This is the first task'"
      register: result

    - name: Task 2
      command: "unknown-command"
      register: result
      ignore_errors: yes

    - name: Task 3
      command: "echo 'This is the third task'"
      register: result

  any_errors_fatal: yes
