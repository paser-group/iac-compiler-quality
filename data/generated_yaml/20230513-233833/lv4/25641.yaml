
- name: Add Hosts to CloudStack
  hosts: all
  vars:
    cloudstack_url: "http://yourcloudstackurl.com"
    cloudstack_user: "your_user"
    cloudstack_password: "your_password"
  tasks:
  - name: Add Hosts
    community.cloud.cloudstack.cs_host:
      api_url: "{{ cloudstack_url }}"
      api_key: "{{ cloudstack_user }}"
      api_secret: "{{ cloudstack_password }}"
      name: "Test Host 1"
      url: "{{ cloudstack_url }}"
      state: present
      tags:
        - cloudstack
      register: output
    failed_when: "'failed' in output.stdout"
  - name: Show Debug Output
    debug:
      var: output
