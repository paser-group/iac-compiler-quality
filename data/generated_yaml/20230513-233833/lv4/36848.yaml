
- hosts: all
  gather_facts: no
  tasks:
    - name: Test AnsibleParserError
      shell: "ansible-playbook --syntax-check -i inventory test.yml"
      register: result
      
    - name: Print Result
      debug:
        var: result.stdout_lines
      
    - name: Check for Duplicate Errors
      assert:
        that: "' {{ item }} ' in result.stdout"
      with_items:
        - 'AnsibleParserError: Ansible failed to parse'
        - ' Ansible failed to parse '
