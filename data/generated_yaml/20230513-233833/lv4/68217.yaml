
---
- name: Manage security groups in VPCs from different regions or subnets
  hosts: localhost
  gather_facts: false

  vars:
    vpc_groups:
      - group_id: sg-1234567 # ID of the source VPC security group
        dest_vpc:
          region: us-east-2 # Region of the destination VPC
          id: vpc-456789 # ID of the destination VPC
          subnet: subnet-101010 # Subnet of the destination VPC

  tasks:
    - name: Create security group in destination VPC
      ec2_group:
        name: "{{ vpc_group.name }}"
        description: "{{ vpc_group.description }}"
        vpc_id: "{{ vpc_group.dest_vpc.id }}"
        rules: "{{ vpc_group.rules }}"
        region: "{{ vpc_group.dest_vpc.region }}"
        subnet: "{{ vpc_group.dest_vpc.subnet }}"
      loop: "{{ vpc_groups }}"
