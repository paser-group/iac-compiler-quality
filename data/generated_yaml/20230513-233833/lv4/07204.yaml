
---
- name: Test playbook for hanging issue
  hosts: all
  tasks:
    - name: Try to copy files without sudo
      become: false
      copy:
        src: /tmp/test.txt
        dest: /home/user/test.txt
      register: copy_output
      failed_when: >
        ('sudo: sorry, you must have a tty to run sudo' not in copy_output.stdout) and
        ('Operation not permitted' not in copy_output.stderr)
