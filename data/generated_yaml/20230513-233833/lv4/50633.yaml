
---
- name: Test IOS connection
  hosts: ios
  gather_facts: no
  connection: ansible.netcommon.ssh_config

  tasks:
  - name: Ping IOS device
    ios_command:
      commands: ping 10.1.1.1 source loopback 0
    register: result

  - name: Check ping output for IOS device
    debug:
      var: result.stdout_lines

  - name: Retrieve IOS device hostname
    ios_command:
      commands: show run | i hostname
    register: hostname

  - name: Check IOS device hostname
    debug:
      var: hostname.stdout_lines
