
- name: Check connection type
  junos_command:
    commands:
      - show configuration system login | display set | match type
  register: junos_login_type

- name: Throw error for wrong connection type
  fail:
    msg: "Invalid connection type: {{ junos_login_type.stdout_lines[0] }}. Please use one of the following connection types: {{ acceptable_connection_types }}"
  when: junos_login_type.stdout_lines[0] not in acceptable_connection_types
