
---
- name: Correct Virtualization Role for DigitalOcean Droplets
  hosts: digital_ocean
  remote_user: root
  
  tasks:
  - name: Set Virtualization Role to Guest for Droplets
    set_fact:
      ansible_virtualization_role: guest
    when: inventory_hostname in groups['digital_ocean']
  
  - name: Validate Virtualization Role
    shell: cat /proc/cpuinfo | grep -o vmware || echo "not found"
    register: output
    when: inventory_hostname in groups['digital_ocean']
  
  - name: Print Output
    debug:
      var: output.stdout_lines
    when: inventory_hostname in groups['digital_ocean']
