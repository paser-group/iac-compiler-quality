
- name: Install VMware tool
  async: 120 # set a timeout of 120 seconds
  shell: '/usr/bin/vmware-install.pl --default' # install VMware tool
  poll: 0 # Don't poll for the result of this task
  register: install_vmware # Register the output in a variable

- name: Check output file for errors
  assert:
    that:
      - "'No errors' in file_content"
    fail_msg: "Install output contains errors"
    success_msg: "Install output is error-free"
  vars:
    file_content: "{{ lookup('file', '/tmp/install_output.log') }}" # read the output file
