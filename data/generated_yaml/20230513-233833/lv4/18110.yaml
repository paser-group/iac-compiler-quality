
- hosts: all
  gather_facts: no

  tasks:
  - name: Execute task with async and check_mode
    debug:
      msg: "{{ item }}"
    async: 10
    poll: 0
    loop:
      - 1
      - 2
      - 3
    when: "'*scheduler*' not in ansible_hostname"
    check_mode: true
    register: result

  - pause:
      prompt: "Do you want to proceed with the execution?"
    when: "'*control*' in ansible_hostname"
    check_mode: true

  - name: Execute paused task with async and check_mode
    debug:
      msg: "{{ item }}"
    async: 10
    poll: 0
    loop:
      - 1
      - 2
      - 3
    when: "'*scheduler*' not in ansible_hostname"
    check_mode: true
    register: result2
