
---
- name: Test removes option for command module
  hosts: all
  tasks:
    - name: Install Apache server
      package:
        name: apache2
        state: latest
    - name: Create index.html file
      copy:
        content: "Hello, world!"
        dest: /var/www/html/index.html
    - name: Remove index.html file with removes option
      command: rm /var/www/html/index.html
        removes: /var/www/html/index.html
    - name: Check file absence with removes=false option
      stat:
        path: /var/www/html/index.html
      register: index_html_file
    - name: Fail if index.html file exists
      fail:
        msg: "Index.html file still exists"
      when: index_html_file.stat.exists == True
