
- name: Test nxos_facts module for both transports
  hosts: nxos_switch
  gather_facts: no
  vars:
    ansible_network_os: nexus
  tasks:
    - name: Collect nxos facts using nxapi transport
      nxos_facts:
        transport: nxapi
      register: nxapi_facts

    - name: Collect nxos facts using cli transport
      nxos_facts:
        transport: cli
      register: cli_facts

    - name: Compare the collected facts
      debug:
        msg: "{{ 'The output of nxapi_facts and cli_facts is different' if nxapi_facts != cli_facts else 'The output of nxapi_facts and cli_facts is identical' }}"
