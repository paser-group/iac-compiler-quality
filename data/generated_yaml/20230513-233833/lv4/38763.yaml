
---
- hosts: all
  roles:
    - role1
    - role2

- name: Role1
  hosts: all
  gather_facts: no
  roles:
    - role1

- name: Role2
  hosts: all
  gather_facts: no
  roles:
    - role2

---

# Role 1
- name: Variable with global scope
  set_fact:
    my_var_global: "This variable has global scope"
  delegate_to: localhost

- name: Variable with role scope
  set_fact:
    my_var_role: "This variable has role scope"

- name: Use variables in role
  debug:
    msg: "{{ my_var_global }}, {{ my_var_role }}"

# Role 2
- name: Include role1 tasks
  include_role:
    name: role1

- name: Variable with task scope
  set_fact:
    my_var_task: "This variable has task scope"
  delegate_to: localhost
