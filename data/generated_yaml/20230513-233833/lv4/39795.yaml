
- name: Run docker service tests
  hosts: all
  vars:
    docker_service_name: "test_svc"
  tasks:
    - name: Create a new docker service
      docker_service:
        name: "{{ docker_service_name }}"
        state: started
        service_logs: true
      register: new_service

    - name: Stop docker service
      docker_service:
        name: "{{ docker_service_name }}"
        state: stopped

    - name: Start docker service
      docker_service:
        name: "{{ docker_service_name }}"
        state: started

    - name: Restart docker service
      docker_service:
        name: "{{ docker_service_name }}"
        state: restarted

    - name: Check service health
      docker_service:
        name: "{{ docker_service_name }}"
        state: health

    - name: Create a docker container
      docker_container:
        name: "test_container"
        image: "alpine:latest"
        command: "/bin/sleep 30"
        state: started

    - name: Remove docker container
      docker_container:
        name: "test_container"
        state: absent
