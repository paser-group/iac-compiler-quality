yaml
- hosts: windows
  gather_facts: no
  tasks:
    - name: Create Windows shortcut
      win_shortcut:
        src: C:\Program Files\App\app.exe
        dest: C:\Users\Admin\Desktop\App.lnk
        arguments: /debug /verbose
        icon_path: C:\Program Files\App\app.ico
        icon_index: 0
      register: shortcut

    - name: Verify shortcut existence
      win_ping:
        path: C:\Users\Admin\Desktop\App.lnk
      when: shortcut.changed == true

    - name: Delete Windows shortcut
      win_shell: Remove-Item "C:\Users\Admin\Desktop\App.lnk"

