
---
- name: Playbook to capture command output
  hosts: all
  tasks:
  - name: Execute command and capture output
    shell: <command>
    register: cmd_output
    ignore_errors: true
  - name: Process output based on status
    debug:
      msg: "{{ cmd_output.stdout_lines }}"
    failed_when: cmd_output.rc != 0
  - name: Handle error output
    debug:
      msg: "{{ cmd_output.stderr_lines }}"
    when: cmd_output.failed
