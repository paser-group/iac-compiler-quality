
- name: Test SSL connection with multiple SSL versions
  hosts: all
  gather_facts: no
  vars:
    target_port: 443
  tasks:
    - name: "Test with SSL v2"
      openssl_certificate:
        host: "{{ inventory_hostname }}"
        port: "{{ target_port }}"
        version: "SSLv2"
        cafile: "/etc/ssl/certs/ca-certificates.crt"
      register: result_ssl2

    - name: "Test with SSL v3"
      openssl_certificate:
        host: "{{ inventory_hostname }}"
        port: "{{ target_port }}"
        version: "SSLv3"
        cafile: "/etc/ssl/certs/ca-certificates.crt"
      register: result_ssl3

    - name: "Test with TLS v1.0"
      openssl_certificate:
        host: "{{ inventory_hostname }}"
        port: "{{ target_port }}"
        version: "TLSv1_0"
        cafile: "/etc/ssl/certs/ca-certificates.crt"
      register: result_tls10

    - name: "Test with TLS v1.1"
      openssl_certificate:
        host: "{{ inventory_hostname }}"
        port: "{{ target_port }}"
        version: "TLSv1_1"
        cafile: "/etc/ssl/certs/ca-certificates.crt"
      register: result_tls11

    - name: "Test with TLS v1.2"
      openssl_certificate:
        host: "{{ inventory_hostname }}"
        port: "{{ target_port }}"
        version: "TLSv1_2"
        cafile: "/etc/ssl/certs/ca-certificates.crt"
      register: result_tls12

    - name: Print SSL/TLS test results
      debug:
        var: item.changed
      loop:
        - "{{ result_ssl2 }}"
        - "{{ result_ssl3 }}"
        - "{{ result_tls10 }}"
        - "{{ result_tls11 }}"
        - "{{ result_tls12 }}"
