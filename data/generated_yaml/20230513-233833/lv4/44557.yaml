
---
- name: Test s3_lifecycle module
  hosts: all
  vars:
    aws_access_key: <YOUR_AWS_ACCESS_KEY>
    aws_secret_key: <YOUR_AWS_SECRET_ACCESS_KEY>
    region: <YOUR_AWS_REGION>
    bucket_name: <YOUR_BUCKET_NAME>
    lifecycle_config:
      - rule_id: "test_rule_1"
        status: "Enabled"
        expiration:
          days: 30
  tasks:
    - name: Test s3_lifecycle module without prefix
      s3_lifecycle:
        bucket: "{{ bucket_name }}"
        config: "{{ lifecycle_config }}"
        aws_access_key: "{{ aws_access_key }}"
        aws_secret_key: "{{ aws_secret_key }}"
        region: "{{ region }}"
