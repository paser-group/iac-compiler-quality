
- name: Convert byte strings to Unicode strings
  hosts: all
  become: true
  tasks:
    - name: Converting byte string to utf-8 encoded string
      lineinfile:
        path: /etc/ansible/hosts
        regexp: '=(.*)'
        backrefs: true
        state: present
        dest: file.txt
        content: "{{ line | b64decode }}"

    - name: All in one use case for converting byte string to utf-8 string
      shell: 'echo {{ input_line }} | base64 -d'
      register: decoded_str

    - name: Replace byte string with Unicode string
      lineinfile:
        path: /etc/ansible/group_vars/all
        regexp: '^(.*)ansible_ssh_pass(.*)=(.*)$'
        line: '\1ansible_ssh_pass\2={{ ssh_pass_string }}'
