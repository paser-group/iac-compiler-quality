
---
- name: Test efs_facts module for permission errors
  hosts: all
  become: true
  vars:
    efs_name: my-efs
    efs_mount: /mnt/efs
  tasks:
    - name: Create EFS filesystem
      efs:
        name: "{{ efs_name }}"
        state: present
        region: us-east-1
  
    - name: Set incorrect permissions on EFS filesystem
      file:
        path: "{{ efs_mount }}"
        mode: "0000"
  
    - name: Retrieve EFS attributes
      efs_facts:
        filesystem: "{{ efs_name }}"
