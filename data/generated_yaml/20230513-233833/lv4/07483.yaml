
- name: Copy file and validate
  hosts: all
  tasks:
  - name: Copy file to nodes
    copy:
      src: /path/to/file
      dest: /path/on/nodes/file
      validate: "cat {{path}} | grep 'ERROR'"
    register: result
  - fail:
      msg: "Error copying file: {{ result.msg }}"
    when: result.failed
  - debug: var=result.msg
