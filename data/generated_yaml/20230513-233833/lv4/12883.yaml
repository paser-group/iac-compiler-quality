
- name: Playbook to test ec2_vpc module
  hosts: localhost
  gather_facts: false
  
  vars:
    profile_name: my-profile
    credentials_file: /path/to/incorrect/credentials/file

  tasks:
    - name: Create VPC
      ec2_vpc:
        region: us-east-1
        state: present
        cidr_block: 10.0.0.0/16
        resource_tags:
          Name: MyVPC
        profile: "{{ profile_name }}"
        aws_access_key: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"
        security_groups: ['sg-12345678']
        subnets:
          - cidr: 10.0.1.0/24
            az: us-east-1a
            resource_tags:
              Name: MySubnet1
          - cidr: 10.0.2.0/24
            az: us-east-1b
            resource_tags:
              Name: MySubnet2
      register: vpc_result
      
    - debug:
        var: vpc_result
