
- name: Add Host Key to known_hosts file
  hosts: all
  become: yes
  gather_facts: no
  tasks:
  - name: Add Host Key to known_hosts file
    command: ssh-keyscan -H {{ inventory_hostname }} >> ~/.ssh/known_hosts

- name: Use SSH password authentication
  hosts: all
  become: yes
  tasks:
  - name: Set Remote User's Password
    ansible.builtin.user:
      name: "{{ remote_user }}"
      password: "{{ remote_user_password | password_hash('sha512') }}"
  - name: Log in to Remote System using SSH password authentication
    ansible.builtin.shell: sshpass -p {{ remote_user_password }} ssh {{ remote_user }}@{{ inventory_hostname }}
