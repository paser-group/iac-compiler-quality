
- name: Retrieve EC2 instance facts
  hosts: ec2-instances
  gather_facts: no
  vars:
    ansible_ssh_private_key_file: "/path/to/private/key.pem"
  tasks:
  - name: gather EC2 facts
    ec2_remote_facts:
      region: "us-west-2"
      filters:
        "instance-state-name": "running"
    register: ec2_facts
  - name: display EC2 facts
    debug:
      var: ec2_facts
