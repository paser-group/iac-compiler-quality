yaml
- name: Test iam password policy module
  hosts: all
  gather_facts: no
  
  tasks:
    - name: Test module with minimum parameters
      iam_password_policy:
        lowercase_characters: 1
        uppercase_characters: 1
        max_password_age: 90
        minimum_password_length: 6
        password_reuse_prevention: 3
        require_numbers: yes
        require_symbols: yes
        require_uppercase_characters: yes
        require_lowercase_characters: yes
      ignore_errors: yes
      
    - name: fuzz module with invalid values
      iam_password_policy:
        lowercase_characters: "{{ item.lowercase }}"
        uppercase_characters: "{{ item.uppercase }}"
        max_password_age: "{{ item.max_age }}"
        password_reuse_prevention: "{{ item.reuse_prevention }}"
        minimum_password_length: "{{ item.pass_length }}"
        require_numbers: "{{ item.require_numbers }}"
        require_symbols: "{{ item.require_symbols }}"
        require_uppercase_characters: "{{ item.require_uppercase }}"
        require_lowercase_characters: "{{ item.require_lowercase }}"
      loop:
      - { lowercase: "invalid", uppercase: "1", max_age: "90", reuse_prevention: "3", pass_length: "6", require_numbers: "yes", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "invalid", max_age: "90", reuse_prevention: "3", pass_length: "6", require_numbers: "yes", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "invalid", reuse_prevention: "3", pass_length: "6", require_numbers: "yes", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "90", reuse_prevention: "invalid", pass_length: "6", require_numbers: "yes", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "90", reuse_prevention: "3", pass_length: "invalid", require_numbers: "yes", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "90", reuse_prevention: "3", pass_length: "6", require_numbers: "invalid", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "90", reuse_prevention: "3", pass_length: "6", require_numbers: "yes", require_symbols: "invalid", require_uppercase: "yes", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "90", reuse_prevention: "3", pass_length: "6", require_numbers: "yes", require_symbols: "yes", require_uppercase: "invalid", require_lowercase: "yes" }
      - { lowercase: "2", uppercase: "1", max_age: "90", reuse_prevention: "3", pass_length: "6", require_numbers: "yes", require_symbols: "yes", require_uppercase: "yes", require_lowercase: "invalid" }
      ignore_errors: yes
