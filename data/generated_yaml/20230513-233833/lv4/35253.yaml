
- hosts: all
  tasks:
    - name: Install role in default location
      ansible.builtin.command: ansible-galaxy role install some_role
      
    - name: Check that role is installed in default location
      ansible.builtin.command: ls {{ ansible_env.HOME }}/.ansible/roles/some_role
      ignore_errors: true
      
    - name: Install role with specified roles path
      ansible.builtin.command: ansible-galaxy role install some_role -p /path/to/roles
      
    - name: Check that role is installed in specified roles path
      ansible.builtin.command: ls /path/to/roles/some_role
      ignore_errors: true
      
    - name: Verify that the role installed in the specified path takes precedence
      ansible.builtin.assert:
        that:
          - "'/path/to/roles/some_role' in stdout"
        fail_msg: "The specified roles path doesn't take precedence"
