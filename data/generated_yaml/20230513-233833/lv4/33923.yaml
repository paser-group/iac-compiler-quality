
---
- name: Test GCE non-ASCII character handling
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Create template with non-ASCII characters
      template:
        src: templates/non_ascii_char.yml.j2
        dest: /tmp/non_ascii_char.yml

    - name: Display output of non-ASCII character template
      debug:
        var: non_ascii_template

    - name: Create instance with non-ASCII character disk image
      gce:
        name: test-instance-non-ascii
        zone: us-central1-a
        machine_type: n1-standard-1
        image: projects/gce-ansible-test-global/images/{{ non_ascii_disk_image }}
        service_account_email: "{{ gce_email }}"
        credentials_file: "{{ credentials_file }}"
        project_id: "{{ gce_project_id }}"
      register: instance

    - name: Display instance status
      debug:
        var: instance
