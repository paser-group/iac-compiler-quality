
- name: when condition fuzzing
  hosts: all
  gather_facts: no
  tasks:
    - name: test when with undefined variable
      debug:
        msg: "Variable is undefined"
      when: "{{ undefined_var is defined }}"
    - name: test when with logical expression
      debug:
        msg: "'When' condition with logical expression triggered"
      when: "{{ (false_var and true_var) or (undefined_var is defined) }}"
