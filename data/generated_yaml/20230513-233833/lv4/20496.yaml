
- name: Directory permission check
  hosts: all
  tasks:
  - name: Create a directory with complex name
    file:
      path: "/tmp/!@#$%^&*( )_-={}[]\;/.,<>?`~'"
      state: directory
  - name: Change the directory permissions
    file:
      path: "/tmp/!@#$%^&*( )_-={}[]\;/.,<>?`~'"
      mode: "0777"
  - name: Check directory permissions
    stat:
      path: "/tmp/!@#$%^&*( )_-={}[]\;/.,<>?`~'"
      get_permissions: yes
    register: directory_permissions
  - name: Validate directory permissions
    assert:
      that:
        - directory_permissions.stat.mode == "0777"
      fail_msg: "Error! File parsing issue detected."
