
---
- name: Test set_fact bug with array templates
  hosts: all
  vars:
    array: "{{ ['first', 'second', 'third', 'fourth'][:item] }}"
  tasks:
  - name: Generate template configuration
    template:
      src: "template.j2"
      dest: "/etc/config_{{ item }}"
    loop: "{{ range(1, 5) }}"
  - name: Verify generated configurations
    command: "diff /etc/config_{{ item }} /etc/config_{{ item - 1 }}"
    loop: "{{ range(1, 4) }}"
