
- name: Test Playbook
  hosts: all
  become: yes
  
  tasks:
  - name: Creating a database with specified tablespace
    postgresql_db:
      name: test_db
      state: present
      owner: test_usr
      tablespace: lowercase_tablespace

  # set tablespace with uppercase
  - name: Set tablespace uppercase
    postgresql_set:
      db: test_db
      option: default_tablespace
      value: UPPERCASE_TABLESPACE

  - name: Get value of tablespace
    register: tablespace
    postgresql_get:
      db: test_db
      option: default_tablespace

  # check tablespace is in lowercase
  - name: Check tablespace in lowercase
    assert:
      that: "'lowercase_tablespace' in tablespace.stdout"
