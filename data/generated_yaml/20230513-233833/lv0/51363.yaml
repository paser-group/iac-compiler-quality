
from nornir import InitNornir
from nornir_netmiko import netmiko_send_command
from nornir_netmiko import netmiko_send_config
from nornir.plugins.tasks.networking import napalm_get

nr = InitNornir(config_file="config.yaml")

def configure_exos_devices(task):
    try:
        task.run(task=netmiko_send_config,
                 name="Configure device",
                 config_commands=["terminal datadump",
                                  "configure terminal",
                                  "set cli pagination off",
                                  "exit"])
    except ValueError as e:
        if "unable to set terminal parameters" in str(e):
            task.run(task=netmiko_send_config,
                     name="Alternative configure device",
                     config_commands=["set cli pagination off"])
        else:
            raise e

results = nr.run(task=configure_exos_devices)
