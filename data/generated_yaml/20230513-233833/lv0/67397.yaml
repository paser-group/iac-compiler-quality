
- name: Running playbook on virtual NXOS
  hosts: virtual_nxos
  gather_facts: no
  vars:
    ansible_network_os: nxos
  tasks:
    - name: Gathering Facts
      nxos_command:
        commands: show version
        provider:
          host: "{{ inventory_hostname }}"
          username: "{{ ansible_user }}"
          password: "{{ ansible_password }}"
          protocol: ssh
          platform: eapi
      register: nxos_fact

    - name: Display Facts
      debug:
        var: nxos_fact

    - name: Configure Interface
      nxos_interface:
        name: Ethernet1/1
        state: up
        provider:
          host: "{{ inventory_hostname }}"
          username: "{{ ansible_user }}"
          password: "{{ ansible_password }}"
          protocol: ssh
          platform: eapi
