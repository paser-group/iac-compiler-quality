
import winreg

def change_dns_order(primary, secondary):
    key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, 'SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters')
    dns_servers = winreg.QueryValueEx(key, 'DNSResolvers')[0].split(',')
    if primary not in dns_servers:
        print(f'Adding {primary} as primary DNS resolver')
        dns_servers.insert(0, primary)
        winreg.SetValueEx(key, 'DNSResolvers', 0, winreg.REG_EXPAND_SZ, ','.join(dns_servers))
    if secondary not in dns_servers:
        print(f'Adding {secondary} as secondary DNS resolver')
        dns_servers.insert(1, secondary)
        winreg.SetValueEx(key, 'DNSResolvers', 0, winreg.REG_EXPAND_SZ, ','.join(dns_servers))
