
- name: Create VPC
  hosts: localhost
  connection: local
  gather_facts: no
  vars:
    region: us-east-1
    vpc_cidr_block: 10.0.0.0/16
  tasks:
    - name: Create VPC
      ec2_vpc:
        state: present
        region: "{{ region }}"
        cidr_block: "{{ vpc_cidr_block }}"
        internet_gateway: yes
        aws_access_key: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"
        aws_profile: myprofile
      register: vpc_info
