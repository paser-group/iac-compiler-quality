python
from ansible.module_utils.basic import AnsibleModule

module = AnsibleModule(
    argument_spec=dict(
        file=dict(type='path', required=True),
        block=dict(type='str', required=True)
    )
)

filename = module.params['file']
block = module.params['block'].encode('utf-8')

with open(filename, 'r+') as f:
    contents = f.read()
    if block not in contents:
        f.write('\n' + block)

module.exit_json(changed=True)
