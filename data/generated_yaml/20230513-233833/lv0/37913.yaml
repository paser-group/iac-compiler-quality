
function win_copy ($source, $dest) {
    $destParent = Split-Path -Path $dest -Parent
    if (-not (Test-Path -Path $destParent)) {
        Write-Verbose "Creating parent directory $destParent"
        New-Item -Path $destParent -ItemType Directory | Out-Null
    }

    if (Test-Path -Path $dest) {
        Write-Verbose "Deleting existing file $dest"
        Remove-Item -Path $dest -Force | Out-Null
    }

    Write-Verbose "Copying file $source to $dest"
    Copy-Item -Path $source -Destination $dest -Force
}
