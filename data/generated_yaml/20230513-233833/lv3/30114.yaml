
---
- name: Create IAM policy that denies instance launching
  hosts: localhost
  gather_facts: no
  vars:
    action: "ec2:RunInstances"
  tasks:
  - name: Create IAM policy
    iam_policy:
      action: "{{ action }}"
      name: "deny-ec2-run-instances"
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": "{{ action }}",
              "Effect": "Deny",
              "Resource": "*"
            }
          ]
        }
