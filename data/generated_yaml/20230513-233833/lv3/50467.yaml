yaml
- hosts: swarm_nodes
  vars:
    service_name: "bad_default_service"
  tasks:
  - name: Create swarm service with bad default setting
    docker_swarm_service:
      name: "{{ service_name }}"
      image: "nginx"
      replicas: 1
      endpoint_mode: vip
      networks:
        - { name: "node-net" }
      endpoint_spec:
        mode: vip
      task_spec:
        container_spec:
          image: "nginx"
          restart_policy: 
            condition: on-failure
            delay: 5s
            max_attempts: 2
  - name: Update swarm service with a valid default setting
    docker_swarm_service:
      name: "{{ service_name }}"
      image: "nginx"
      replicas: 1
      endpoint_mode: vip
      networks:
        - { name: "node-net" }
      endpoint_spec:
        mode: vip
      task_spec:
        container_spec:
          image: "nginx"
          restart_policy: 
            condition: on-failure
            delay: 5s
            max_attempts: 3
