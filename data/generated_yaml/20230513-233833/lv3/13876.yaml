
---
- name: Recreate Intermittent error 'failed to resolve remote temporary directory from' issue
  hosts: all
  become: true

  tasks:
  - name: Create temporary directory on all the remote hosts
    file:
      path: /tmp/temp_dir
      state: directory
    register: dir_created
    delegate_to: localhost

  - name: Copy file to temporary directory
    copy:
      src: myfile.txt
      dest: /tmp/temp_dir/myfile.txt
    delegate_to: localhost

  - name: Use sleep command to increase delay in file transfer
    command: sleep 0

  - name: Execute command to move the file from temporary directory
    command: mv /tmp/temp_dir/myfile.txt /new/remote/directory
    
  - name: Printing contents of Remote Directory
    command: ls /new/remote/directory
    
