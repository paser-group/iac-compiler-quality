
---
- name: Deserialization error with azure_rm_virtualmachine
  hosts: node1
  gather_facts: no

  tasks:
  - name: create VM
    azure_rm_virtualmachine:
      name: "{{ 'vm-' ~ ansible_random | random(10000) }}"
      resource_group: test
      vm_size: Standard_B1s
      admin_username: testadmin
      admin_password: "{{ 'password-' ~ ansible_random | random(10000) }}"
      network_interfaces: "{{ nic }}"
      os_disk_name: "{{ 'osdisk-' ~ ansible_random | random(10000) }}"
      os_type: Linux
      image:
        offer: UbuntuServer
        publisher: Canonical
        sku: "18.04-LTS"
        version: latest
    register: vm

  - name: display VM details
    debug: var=vm
