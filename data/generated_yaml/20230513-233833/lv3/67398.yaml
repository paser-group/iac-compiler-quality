
- name: Test vmware_export_ovf module
  hosts: all
  gather_facts: false
  
  vars:
    vm_name: TestVM
    ovf_path: /tmp/Test.ovf

  tasks:
    - name: Export virtual machine as OVF
      vmware_export_ovf:
        hostname: "{{ inventory_hostname }}"
        username: "{{ ansible_user }}"
        password: "{{ ansible_password }}"
        validate_certs: no
        name: "{{ vm_name }}"
        ovf_path: "{{ ovf_path }}"
        disk_type: thin
        power_state: poweredoff
        wait_for_ip_address: no
        force: yes
        timeout: 300
        datastore: datastore1
        folder: TestFolder
        enable_leases: no
        overwrite_ovf: yes
        path_format: /TestVM/Test.ovf
        compress: gzip
        preallocated_disk: no
        # pass string instead of bytes-like object as the value for 'path_format'
        path_format: 'TestVM/Test.ovf'

        delegate_to: localhost
      register: result

    - name: Display Result
      debug:
        var: result
