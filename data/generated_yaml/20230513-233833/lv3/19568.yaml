
---
- name: Upload file to Google Cloud Storage
  hosts: node1
  gather_facts: false

  tasks:
   - name: Install gcs_oauth2_boto_plugin
     pip: name=gcs_oauth2_boto_plugin

   - name: Upload file to Bucket
     gcp_storage:
      bucket: "{{ bucket_name }}"
      object: "{{ object_name }}"
      src: "{{ file_path }}"
      mode: insert
      auth_kind: serviceaccount
      service_account_file: "{{ gcp_cred_file }}"

  vars:
    bucket_name: "my_bucket"
    object_name: "new_file.txt"
    file_path: "/tmp/new_file.txt"
    gcp_cred_file: "/path/to/service_account.json"
