
---
- name: Create GCE instance
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Launch GCE instance with gce module
      gce:
        instance_names: test-instance
        zone: us-east1-b
        machine_type: f1-micro
        image: ubuntu-1804-bionic-v20220214
        service_account_email: incorrect-email@wrong-project.iam.gserviceaccount.com
        project_id: myproject
        auth_kind: serviceaccount
        service_account_file: /path/to/credentials.json
        wait_for_ip_address: yes
      register: gce_create_instance_result

    - name: Check if instance is created
      debug:
        var: gce_create_instance_result
