
- name: Dynamic set of module variable failure playbook
  hosts: all
  vars:
    dynamic_var: "{{ lookup('env','VAR') }}"
  tasks:
  - name: set dynamic var for debug message
    debug:
      msg: "Dynamic var created"
  - name: set dynamic var for module execution
    set_fact:
      module_var: "{{ dynamic_var }}"
  - name: conditional execution
    template:
      src: "{{ module_var }}"
      dest: "/tmp/file"
       when:
         - module_var is defined
