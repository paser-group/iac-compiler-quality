
- name: Creating a VMware Portgroup
  hosts: all
  vars:
    datacenter: "DC1"
    cluster: "Cluster1"
    datastore: "Datastore1"
    esxi_hostname: "esxi1.example.com"
    portgroup_name: "example-portgroup"
    vlan_id: 20
    security_policy:
      allow_promiscuous: false
      mac_changes: false
      forged_transmits: false
  tasks:
  - name: Create new port group
    vmware_portgroup:
      datacenter: "{{ datacenter }}"
      cluster: "{{ cluster }}"
      datastore: "{{ datastore }}"
      hostname: "{{ esxi_hostname }}"
      security_policy: "{{ security_policy }}"
      portgroup_name: "{{ portgroup_name }}"
      vlan_id: "{{ vlan_id }}"
      state: present
