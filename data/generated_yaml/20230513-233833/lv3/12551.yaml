
---
- name: Ambiguous output redirect Ansible Fuzz Testing
  hosts: all
  gather_facts: true
  
  tasks:
  - name: Verify required files present
    stat:
      path: "/home/ubuntu/file.log" #Change Path
    register: log_file_stat
  
  - name: Setup task with ambiguous output redirection
    command: "ls >> /home/ubuntu/file.log 2>&1" #change command to reflect desired ambiguity
    become: true
    become_user: root
    args:
      warn: false
    ignore_errors: yes #Remove ignore_errors if command should not throw errors
    register: setup_task_output
  
  - name: Print setup task output
    debug:
      var: setup_task_output.stdout_lines
