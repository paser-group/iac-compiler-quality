
- hosts: all
  gather_facts: no
  tasks:
    - name: Deploy a new virtual machine
      vmware_guest:
        hostname: 'vc.example.com'
        username: 'administrator@vsphere.local'
        password: 'password123'
        datacenter: 'Datacenter'
        folder: '/{{ inventory_hostname }}/vm'
        name: 'TestVM'
        state: poweredon
        guest_id: ubuntu64Guest
        hardware:
          memory_mb: 2048
          num_cpus: 2
        cdrom:
          type: none
        disks:
          - size_gb: 10
            type: thin
            datastore: datastore1
        networks:
          - name: VM Network
            type: static
            ip: 192.0.2.10
            netmask: 255.255.255.0
            gateway: 192.0.2.1
            dns_servers:
              - 8.8.8.8
            device_type: vmxnet3
  vars:
    ansible_python_interpreter: /usr/bin/python3
