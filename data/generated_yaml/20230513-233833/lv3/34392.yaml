
---
- name: Test the win_firewall_rule module defaults
  hosts: windows
  gather_facts: false

  tasks:
    - name: Create a firewall rule with an existing name and different configuration parameters
      win_firewall_rule:
        name: "Test_Rule"
        profile: "private"
        direction: "in"
        action: "allow"
        remoteip: "192.0.2.0/24"
        description: "Test rule with modified configuration"
        state: present

    - name: Attempt to modify the same firewall rule with the 'leave existing' configuration option
      win_firewall_rule:
        name: "Test_Rule"
        profile: "private"
        direction: "in"
        action: "allow"
        description: "Test rule with unchanged configuration"
        state: present

    - name: Attempt to remove the firewall rule with the 'state=absent' option
      win_firewall_rule:
        name: "Test_Rule"
        state: absent
