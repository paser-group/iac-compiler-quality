
- name: Test Playbook
  hosts: cisco
  gather_facts: no
  tasks:
    - name: Test Connection
      ios_command:
        provider:
          host: "{{ inventory_hostname }}"
          username: non-existent-user
          password: "{{ lookup('env','IOS_PASSWORD') }}"
          authorize: yes
          auth_pass: "{{ lookup('env','IOS_AUTH_PASSWORD') }}"
          transport: ssh
          ssh_keyfile: "{{ lookup('env','IOS_KEYFILE') }}"
        commands:
          - show version
