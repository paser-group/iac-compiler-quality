
---
- name: Reboot Devices
  hosts: all
  gather_facts: false
  vars:
    reboot_reason: "Ansible Triggered Reboot"

  tasks:
    - name: Reboot devices using nxos_reboot module with cli
      nxos_reboot:
        providers:
          cli:
            host: "{{ inventory_hostname }}"
            username: "{{ ansible_user }}"
            password: "{{ ansible_password }}"
            transport: cli
        reboot_reason: "{{ reboot_reason }}"
      register: cli_reboot_result
      ignore_errors: yes
    
    - name: Reboot devices using nxos_reboot module with nxapi
      nxos_reboot:
        providers:
          nxapi:
            host: "{{ inventory_hostname }}"
            username: "{{ ansible_user }}"
            password: "{{ ansible_password }}"
        reboot_reason: "{{ reboot_reason }}"
      register: nxapi_reboot_result
      ignore_errors: yes

    - name: Show debug information
      debug:
        var: "{{ item }}"
      with_items:
        - cli_reboot_result
        - nxapi_reboot_result

