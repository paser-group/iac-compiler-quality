
---
- name: Test custom modules with pipelining
  hosts: all
  gather_facts: false

  tasks:
  - name: Install custom module dependencies
    pip: name={{ item }} state=present
    with_items:
      - module1-dependency1
      - module1-dependency2

  - name: Execute custom module with pipelining
    shell: echo "Hello World" | custom_module_2
    register: result

  - name: Output resulting variable
    debug:
      var: result
