
---
- name: Testing Ansible nxos_igmp_interface using CLI
  hosts: nexus
  gather_facts: no
  tasks:
    
    - name: Setting up the IGMP interface
      nxos_igmp_interface:
        # Setting up IGMP snooping on the interface
        interface: Ethernet1//1
        snooping: enable
        state: present
        username: "{{ cli_username }}"
        password: "{{ cli_password }}"
        protocol: cli
      
    - name: Verify the IGMP Snooping status for the interface
      nxos_command:
        commands:
          - show ip igmp snooping
        username: "{{ cli_username }}"
        password: "{{ cli_password }}"
        protocol: cli
      register: igmp_snoop_status

    - name: Print the output of the show IGMP Snooping command
      debug:
        var: igmp_snoop_status.stdout_lines
      
