
---
- name: "Port scan network"
  hosts: all
  gather_facts: no

  tasks:
    - name: Scan open ports
      wait_for:
        port: "{{ item }}"
        state: "started"
      loop: "{{ range(1, 1025)|list }}"
      ignore_errors: yes

    - name: Serialize modules
      pickle:
        data: "{{ modules }}"
        path: "/tmp/my_pickle"
