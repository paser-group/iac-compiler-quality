
---
- hosts: all
  gather_facts: no
  vars:
    key_vault_name: <Azure_Key_Vault_Name>
    secret_name: <Azure_Secret_Name>
    client_id: <Azure_Client_ID>
    client_secret: <Azure_Client_Secret>
    subscription_id: <Azure_Subscription_ID>
    tenant_id: <Azure_Tenant_ID>
  tasks:
  - name: Retrieve the Azure Key Vault Secret
    azure_rm_keyvaultsecret:
      vault_url: "https://{{ key_vault_name }}.vault.azure.net/"
      secret_name: "{{ secret_name }}"
      client_id: "{{ client_id }}"
      client_secret: "{{ client_secret }}"
      subscription_id: "{{ subscription_id }}"
      tenant: "{{ tenant_id }}"
    register: result
    ignore_errors: yes
  - name: Debug Secret Value
    debug:
      var: result
