
---
- name: Testing dependency variable resolution
  hosts: node1
  become: true 
  vars:
    dep_var1: "{{ foo }}"
    dep_var2: "{{ bar }}"
  tasks:
    - name: Displaying the dependency variables
      debug:
        msg:
          - "{{ dep_var1 }}"
          - "{{ dep_var2 }}"

    - name: Assigning default values to the dependency variables
      set_fact:
        dep_var1: "default_foo"
        dep_var2: "default_bar"
      when:
        - dep_var1 is not defined or dep_var2 is not defined

    - name: Checking the dependency resolution
      assert:
        that:
          - dep_var1 is defined
          - dep_var2 is defined
