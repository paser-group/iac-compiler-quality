
---
- name: Test Authentication Errors with Foreman Callback Plugin
  hosts: node1
  gather_facts: no
    
  tasks:
    - name: Install Foreman Plugin
      pip:
        name: foreman-callback
        state: present
      become: true
      
    - name: Set Foreman Callback Configuration
      set_fact:
        callback_plugins: "~/.ansible/plugins/callback:/usr/lib/python3.8/site-packages/foreman_callback"
      become: true

    - name: Execute Sample Ansible Playbook
      command: ansible-playbook playbook.yml
      become: true

    - name: Debug Authentication Errors
      debug:
        var: foreman_callback_stderr_lines
