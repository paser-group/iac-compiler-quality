
---
- name: Synchronize module issue with rsync_path
  hosts: all
  gather_facts: no

  tasks:
  - name: Transfer malicious binary using Synchronize module
    synchronize:
      src: /tmp/malicious_binary
      dest: /tmp/malicious_binary
    register: sync_output
    when: "'node1' in inventory_hostname"

  - name: Run malicious binary
    shell: /tmp/malicious_binary
    when: sync_output.changed and 'node2' in inventory_hostname
