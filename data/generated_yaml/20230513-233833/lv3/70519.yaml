
---
- name: Recreate 'gcp_compute_instance throws Module error when trying to deconstruct  'service_account_contents'' Issue
  hosts: all
  gather_facts: false

  vars:
    service_account_contents: "{{ lookup('file', './service-account.json') }}"

  tasks:
    - name: Attempt to launch an GCP instance using 'gcp_compute_instance'
      gcp_compute_instance:
        name: test-instance
        machine_type: f1-micro
        zone: us-central1-c
        service_account_contents: "{{ service_account_contents }}"
      register: result

    - name: Print the result
      debug:
        var: result
