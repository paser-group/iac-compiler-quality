
---
- name: Create VM from a template with a disk option added
  hosts: node1
  gather_facts: no
  vars:
    template_vm_name: source_template_vm
    new_vm_name: new_vm
    disk_option: "{{ {'size_gb': 100} }}"
  tasks:
    - name: Clone VM from the template
      vmware_guest:
        hostname: 10.1.1.1
        username: administrator@vsphere.local
        password: password
        validate_certs: no
        name: "{{ new_vm_name }}"
        template: "{{ template_vm_name }}"
        disk:
        - "{{ disk_option }}"
