
---
- name: Test Ansible Galaxy List Command
  hosts: node1
  gather_facts: no

  tasks:
    - name: Remove Galaxy Search Directories
      become: yes
      shell: rm -rf /etc/ansible/roles/*

    - name: Attempt Galaxy List Command
      ansible.builtin.shell:
        cmd: ansible-galaxy list
      register: output
      ignore_errors: yes

    - name: Print Output of Galaxy List Command
      debug:
        var: output.stdout_lines
      when: output.failed == true
