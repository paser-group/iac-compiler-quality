
# Inventory file
[node]
10.1.1.1

# Playbook
- hosts: node
  gather_facts: false
  tasks:
  - name: Configure SSH key
    shell: |
      echo 'ssh-rsa [insert incorrect public key] ansible-generated on $(date)' >> /home/user/.ssh/authorized_keys
  - name: Test SSH connection
    shell: |
      ssh -v -i /home/user/.ssh/id_rsa -o StrictHostKeyChecking=no user@{{ inventory_hostname }}
    register: ssh_output
    ignore_errors: yes
  - name: Debug error message
    debug:
      var: ssh_output.stderr_lines
