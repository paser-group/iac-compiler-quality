
---
- name: Testing Ansible custom module on Windows
  hosts: windows
  tasks:
    - name: Copy custom module
      copy:
        src: /path/to/mod.py
        dest: C:/Program Files/custom_mod.py
        mode: '0777'
        force: yes
      register: mod_copy

    - name: Ensure custom module was copied
      assert:
        that: mod_copy.changed == true

    - name: Execute custom module
      custom_mod:
        arg1: 'value1'
        arg2: 'value2'
      register: result

    - name: Handle results
      debug:
        var: result
