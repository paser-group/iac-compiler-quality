
---
- name: Test Ansible 404 handling
  hosts: all
  gather_facts: no
  tasks:
    - name: Attempt to access non-existent URL
      uri:
        url: "http://example.com/non-existent-page"
        status_code: 404
        method: GET
      register: page_response

    - name: Debug page response
      debug:
        msg: "{{ page_response }}"

    - name: Fail task if response is not 404
      fail:
        msg: "Unexpected response status code: {{ page_response.status }}"
      when: page_response.status != 404
