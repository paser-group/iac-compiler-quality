
---
- name: Connect to remote host and execute command as root user
  hosts: all
  gather_facts: no
  become: yes
  tasks:
  - name: Copy an authorized key to the remote host
    authorized_key:
      user: root
      key: "{{ lookup('file', '/path/to/public_key/id_rsa.pub') }}"
  - name: Execute command as root user
    shell: "whoami"
  - name: Remove the authorized key from the remote host
    authorized_key:
      user: root
      state: absent
      key: "{{ lookup('file', '/path/to/public_key/id_rsa.pub') }}"
