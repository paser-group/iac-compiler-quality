
- name: Test GCP Inventory plugin
  hosts: localhost
  gather_facts: no

  tasks:
    - name: Install GCE python client
      pip:
        name: google-auth google-auth-oauthlib google-auth-httplib2 google-cloud
      become: yes

    - name: Inventory GCP resources
      google.gcp_compute:
        service_account_email: ""
        project_id: <project_id>
        auth_kind: "serviceaccount"
        zone: <zone>
        name: test-instance
        state: "present"
      register: gce_server

    - name: Display GCP Inventory error
      debug:
        var: gce_server
