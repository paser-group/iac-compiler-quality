yaml
- name: Configure Cisco Nexus devices
  hosts: cisco_nexus_devices 
  gather_facts: no
  tasks:
    - name: Configure port channel
      nxos_portchannel:
        aggregate_interface: port-channel1
        members: ["Ethernet1/1", "Ethernet1/2"]
      register: config_changes

    - name: Configure feature
      nxos_feature:
        feature: vpc
        state: present
      register: config_changes

    - name: Check for idempotency
      debug:
        msg: "Configuration changes: {{ config_changes.changed }}"
