
- name: Attempt login with incorrect credentials
  hosts: all
  become: true

  vars:
    username: "incorrect_username"
    password: "incorrect_password"

  tasks:
    - name: Send login request
      uri:
        url: https://{{ inventory_hostname }}/api/v2/authtoken/
        method: POST
        body_format: json
        body:
          username: "{{ username }}"
          password: "{{ password }}"

      register: response

    - name: Check response status
      assert:
        that:
          - response.status == 401
