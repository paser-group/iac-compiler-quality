yaml
---
- name: Testing WinRM connection with Ansible
  hosts: win1
  gather_facts: no
  tasks:
    - name: Execute a PowerShell command on the remote Windows host
      winrm_elevated:
        cmd: 'Get-Service -Name NonExistingService'
      register: ps_output
    - debug:
        msg: "{{ ps_output.stdout }}"
  vars:
    ansible_connection: winrm
    ansible_winrm_transport: basic
    ansible_winrm_server_cert_validation: ignore
    ansible_user: administrator
    ansible_password: Passw0rd
  pre_tasks:
    - win_ping:
