
---
- name: Ansible Playbook to expose known_hosts/path vulnerabilities
  hosts: all
  remote_user: root
  gather_facts: false

  tasks:
    - name: Create an incorrect SSH Key path
      shell: "mkdir /root/test/ssh && touch /root/test/ssh/known_hosts"
      ignore_errors: true

    - name: Add sample host's SSH fingerprint to known_hosts
      known_hosts:
        path: /root/test/ssh/known_hosts
        name: 10.1.1.2
        key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDG5yPQKxGiJ5A+93SxlWn4xGHPwJyVIC/uuT1jEPdPFEIjX4B+lDPjg/btT4g/mO2OjFyCk1cQNT55My3wbV9AHnq/DlgYv9mWW1ci5SvBl8iHkprlYQSt7P0+scQiDiX42nKulMxp1L4nT8KnH9w0Nq/wlZPSQQRk2YdEZb/GU2iXRBDJHlZJdNyFd5uv0dbZlqXUnGT4/ZaWkDkZ6Zgtbpt1g6Z+4ovfNlNATxwP4ud7PDDr/uB4YrJY14+H/dQ1ZuCtjL5Q9K3lV8BUKbhqS4riv2KmusWgB6S4spvTpXf3zjXOEMNx960UZ5Lbtwb8V+R7vVjCzEJ4+s0H ansible-generated on node1

    - name: Check connectivity to the sample host
      ping:
