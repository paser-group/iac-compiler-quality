
---
- name: Testing issue in Ansible
  hosts: all
  gather_facts: no
  tasks:
    - name: Executing command with ERROR log message
      shell: "ls /invalid_directory 2>&1 > /dev/null"
      register: shell_output

    - name: Checking if ERROR message is parsed in stderr output
      assert:
        that:
          - '"ERROR" in shell_output.stderr_lines'
      changed_when: false
