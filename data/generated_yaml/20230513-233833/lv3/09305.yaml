
---
- hosts: all
  gather_facts: no
  become: true
  tasks:
    - name: Check if ssh is installed
      stat:
        path: /usr/bin/ssh
      register: ssh_check
      changed_when: false
    - name: Ensure ssh is installed
      apt:
        name: ssh
        state: present
      when: ssh_check.stat.exists == false
    - name: Check if rsync is installed
      stat:
        path: /usr/bin/rsync
      register: rsync_check
      changed_when: false
    - name: Ensure rsync is installed
      apt:
        name: rsync
        state: present
      when: rsync_check.stat.exists == false
    - name: Create a file using the copy module
      copy:
        content: "This is a test file"
        dest: "/tmp/test_file"
      ignore_errors: true
