
---
- name: Play 1
  hosts: node1
  become: true
  tasks:
    - name: Template 1
      template:
        src: templates/file1.j2
        dest: /tmp/output1.txt
      vars:
        my_dict:
          key1: value1
          key2: {{undefined_var}}
        with_dict: "{{my_dict}}"
    - name: Debug 1
      debug:
        var: my_dict

- name: Play 2
  hosts: node2
  become: true
  tasks:
    - name: Template 2
      template:
        src: templates/file2.j2
        dest: /tmp/output2.txt
      vars:
        my_dict:
          key1: value1
          key2: {{undefined_var}}
        with_dict: "{{my_dict}}"
    - name: Debug 2
      debug:
        var: my_dict
