
- name: Hostname Mismatch Test Playbook
  hosts: all
  gather_facts: no
  become: yes
  become_method: sudo
  vars:
    expected_hostname: "node1"
  tasks:
  - block:
      - name: Get Current Hostname
        shell: hostname
        register: current_hostname
      - name: Check if Hostname Matches
        fail:
          msg: "Incorrect hostname {{current_hostname.stdout}}. Expected {{expected_hostname}}"
        when: current_hostname.stdout != expected_hostname
      when: inventory_hostname == "node1"
