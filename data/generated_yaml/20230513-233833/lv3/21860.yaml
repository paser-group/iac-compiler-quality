
- name: Create EC2 Instances
  hosts: localhost
  gather_facts: false
  tasks:
    - name: Launch EC2 Instances
      ec2:
        instance_type: t2.micro
        image: ami-0c55b159cbfafe1f0
        wait: yes
        state: running
        group_id: invalid_group_id # introducing invalid group id to simulate hostname resolution failure
        count: 3
      register: ec2_instances

- name: Configure EC2 Instances
  hosts: ec2
  become: true
  become_user: ubuntu
  gather_facts: true
  tasks:
    - name: Retrieve EC2 Instance Details
      command: python /path/to/ec2.py --list
      register: ec2_details
