
---
- name: Wait for Prompt on Error
  hosts: all
  gather_facts: no
  vars:
    ansible_user: root
    ansible_ssh_private_key_file: /path/key
    ansible_connection: net_cli
    ansible_ssh_port: 22
  tasks:
    - name: Run a Command with Incorrect Syntax
      command: 'ls /does/not/exist'
      register: result
    - name: Print Debug Information
      debug:
        var: result
    - name: Wait for Prompt
      wait_for:
        port: 22
        state: started
