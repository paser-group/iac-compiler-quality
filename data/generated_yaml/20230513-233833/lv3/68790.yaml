
---
- name: Recreate ec2_elb_lb error
  hosts: localhost
  gather_facts: false

  tasks:
  - name: Set variables
    set_fact:
      lb_name: "{{ 123 }}"
      lb_ports: "80,443"
      subnet_id_list: ["subnet-123", "subnet-456"]
      sg_ids: ["sg-123"]
      lb_scheme: "internet-facing"

  - name: Create ELB
    ec2_elb_lb:
      state: present
      region: us-east-1
      name: "{{ lb_name }}"
      listeners:
        - protocol: http
          load_balancer_port: "{{ lb_ports.split(',')[0] }}"
          instance_protocol: http
          instance_port: "{{ lb_ports.split(',')[0] }}"
      subnets: "{{ subnet_id_list }}"
      security_groups: "{{ sg_ids }}"
      scheme: "{{ lb_scheme }}"
    register: ec2_elb_lb_result
