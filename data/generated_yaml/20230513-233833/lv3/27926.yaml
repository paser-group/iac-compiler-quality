
- name: Create vxlan and vtep
  nxos_vxlan_vtep_vni:
    nve_vni: 5000
    nve_vni_suppress_arp: true
    peers:
        - 10.1.1.2
        - 10.1.1.3
    vrf: ansible_vrf
    vni: 5000
    bfd: true
    src_intf: Ethernet1/1
    host: "{{ inventory_hostname }}"
  register: create_vxlan_vtep

- name: Validate vxlan and vtep are created
  assert:
    that:
      - create_vxlan_vtep.changed == true

- name: Remove vxlan and vtep
  nxos_vxlan_vtep_vni:
    nve_vni: 5000
    state: absent
    bfd: true
    src_intf: Ethernet1/1
    host: "{{ inventory_hostname }}"
  register: remove_vxlan_vtep

- name: Validate vxlan and vtep are removed
  assert:
    that:
      - remove_vxlan_vtep.changed == true
