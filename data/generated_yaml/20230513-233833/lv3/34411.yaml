
- name: Windows Firewall not working error replication playbook
  hosts: windows
  gather_facts: no
  vars:
    port: 9999
    name: "{{port}}_block"
  tasks:
  - name: Adding Firewall Rule
    win_firewall_rule:
      name: "{{name}}"
      direction: in
      enabled: yes
      action: allow
      protocol: tcp
      local_port: "{{port}}"
      remote_ip: any
      state: present
    register: result

  - name: verify firewall rule
    assert:
      that: result is failed
      success_msg: "Firewall is working fine"
      fail_msg: "Windows Firewall is not working"

