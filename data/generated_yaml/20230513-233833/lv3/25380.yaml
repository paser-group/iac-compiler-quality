
---
- name: Test RabbitMQ User Module
  hosts: node1
  become: yes
  vars:
    rabbitmq_user: testuser
    rabbitmq_password: testpass
    rabbitmq_vhost: /
    rabbitmq_tags: administrator
    rabbitmq_auth_mechanism: plain
    rabbitmq_node: ""
  tasks:
    - name: add rabbitmq user
      rabbitmq_user:
        user: "{{rabbitmq_user}}"
        password: "{{rabbitmq_password}}"
        vhost: "{{rabbitmq_vhost}}"
        configure_privileges: "^$"
        tags: "{{rabbitmq_tags}}"
        auth_mechanism: "{{rabbitmq_auth_mechanism}}"
        node: "{{rabbitmq_node}}"
        state: present
