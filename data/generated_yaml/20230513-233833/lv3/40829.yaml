
---
- name: Gather Facts from IOS Devices
  hosts: ios_devices
  gather_facts: no
  tasks:
    - name: Gather IOS Facts
      ios_facts:
        gather_subset: interfaces
        provider:
          username: "{{ username }}"
          password: "{{ password }}"
          host: "{{ inventory_hostname }}"
          authorize: yes
          auth_pass: "{{ enable_password }}"
      register: ios_facts

    - name: Debug IOS Facts
      debug:
        msg: "Interface {{ item.key }} has MAC address {{ item.value.macaddress }} and IP address {{ item.value.ipv4 }}"
      loop: "{{ ios_facts['ansible_facts']['interfaces'] | dict2items }}"
      when: "'tunnel' in item.key"
