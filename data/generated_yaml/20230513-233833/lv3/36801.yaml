
---
- name: Configure Interface VLAN
  hosts: nxos
  gather_facts: no

  vars:
    vlan_id: 100
    vlan_name: test

  tasks:
    - name: Configure VLAN {{ vlan_id }}
      nxos_config:
        lines:
          - interface vlan {{ vlan_id }}
          - name {{ vlan_name }}
        parents: interface {{ vlan_id }}
      register: vlan_config

    - name: Check for idempotence
      assert:
        that:
          - vlan_config.changed == false
          - vlan_config.failed == false
