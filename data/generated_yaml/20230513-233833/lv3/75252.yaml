
- name: Vulnerable Playbook
  hosts: all
  become: yes
  become_method: sudo
  gather_facts: no
  tasks:
  
  #Task 1- Create a user with sudo access on all nodes
  - name: Create privileged user - vulnerability recreation
    user:
      name: hacker
      shell: /bin/bash
      group: sudo
      password: "{{ 'password' | password_hash('sha512') }}"
      generate_ssh_key: yes
      
  #Task 2- Run a command with privilege escalation enabled by sudo
  - name: Execute Privileged command - vulnerability recreation
    shell: |
      sudo ls /root
    register: output

  #Task 3- Print the output of the command
  - name: Print the command output - vulnerability recreation
    debug:
      var: output
