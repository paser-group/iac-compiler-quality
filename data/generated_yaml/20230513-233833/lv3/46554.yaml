
- hosts: all
  gather_facts: no

  tasks:
    - name: Attempting to SSH into each node through ping module
      ping:
  # If SSH connection fails, jump to the handler
      register: ssh_rescue
      ignore_errors: true

  handlers:
  # Output a custom error message when the ssh connection fails
    - name: SSH connection failed
      debug:
        msg: "SSH error: {{ ssh_rescue.msg }}"
      failed_when: false
