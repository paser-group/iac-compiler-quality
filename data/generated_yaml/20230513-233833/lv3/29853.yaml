yaml
---
- name: IAM Policy Module Test
  hosts: all
  gather_facts: no
  become: true
  tasks:
    - name: Install boto3 and botocore library
      pip:
        name: "{{ item }}"
        state: present
      with_items:
        - boto3
        - botocore
      register: result

    - name: Print installed libraries
      debug:
        var: result

    - name: Test IAM policy module with policy_json field
      iam_policy:
        iam_type: user
        iam_name: ansible-test-user
        policy_name: test-policy
        policy_json:
          Version: "2012-10-17"
          Statement:
            Effect: Allow
            Action:
              - "ec2:*"
            Resource: "*"
      register: policy_result

    - name: Debug IAM policy module with policy_json field
      debug:
        var: policy_result
