
---
- name: Test remote target clear error reporting
  gather_facts: no
  hosts: node1
  tasks:

  - name: Attempt to execute invalid command on remote target
    shell: |
      invalid_cmd
    ignore_errors: yes
    register: result

  - name: Debug the execution result
    debug:
      var: result

  - name: Fail the playbook if the result contained an error message
    fail:
      msg: "The remote execution failed with the following error message: {{ result.stderr }}"
    when: result.rc != 0
