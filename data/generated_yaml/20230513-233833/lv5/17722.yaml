
---
- name: Test ansible_user variable resolution in a loop
  hosts: all
  vars:
    hosts_with_users:
      - host: "node1"
        ansible_user: "user1"
      - host: "node2"
        ansible_user: "user2"
      - host: "node3"
        ansible_user: "user3"
  tasks:
    - name: Print ansible_user variable values
      debug:
        msg: "{{ item.host }} has ansible_user = {{ item.ansible_user }}"
      with_items: "{{ hosts_with_users }}"
