
- hosts: all
  tasks:
    - name: Set variables with nested defined variables containing errors
      set_fact:
        var1: "{{ nested_error.undefined | default('default_value') }}"
        var2: "{{ nested_error.undefined | mandatory }}"
        var3: "{{ nested_error.undefined | required }}"
        var4: "{{ nested_error.undefined | bool | list }}"
    
    - name: Ensure the variables generate errors upon compilation
      include_vars:
        file: "{{ item }}"
        name: "{{ item }}"
      with_items:
        - '{{ var1 }}'
        - '{{ var2 }}'
        - '{{ var3 }}'
        - '{{ var4 }}'
      delegate_to: localhost
      run_once: true
