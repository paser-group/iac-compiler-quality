
- name: Add or update registry value
  win_reg_stat:
    path: HKLM:\Software\Example
    name: ExampleValue
  register: reg_stat

- name: Add or update registry value if not present
  win_regedit:
    path: HKLM:\Software\Example
    name: ExampleValue
    value: "NewValue"
  when: reg_stat.exists == False
  changed_when: True

- name: Delete and re-add registry value if present
  win_regedit:
    path: HKLM:\Software\Example
    name: ExampleValue
    operation: delete
  when: reg_stat.exists == True
  changed_when: True

- name: Add or update registry value
  win_regedit:
    path: HKLM:\Software\Example
    name: ExampleValue
    value: "NewValue"
  when: reg_stat.exists == True
  changed_when: True
