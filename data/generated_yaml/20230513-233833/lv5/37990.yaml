
- name: Test junos module for wrong connection type error
  hosts: junos_device
  gather_facts: no
  vars:
    connection_type: ssh  # this should be telnet
  tasks:
    - name: Connect to the device
      junos:
        host={{ ansible_host }}
        user={{ ansible_user }}
        password={{ ansible_password }}
        connection: "{{ connection_type }}"
      register: junos_result
      ignore_errors: yes
    - name: Check for error message
      assert:
        that:
          - '"wrong connection type specified" in junos_result.msg'
      when: "'wrong connection type specified' not in junos_result.msg"
