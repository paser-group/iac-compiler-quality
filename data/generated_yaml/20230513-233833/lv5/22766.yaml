
- name: Collect system facts
  hosts: all
  gather_facts: yes

- name: Set fact for LVM volumes
  set_fact:
    lvm_facts: "{{ ansible_lvm.facts }}"

- name: Print LVM Facts and ansible_cmdline
  vars:
    ansible_cmdline_var: "{{ ansible_cmdline }}"
  debug:
    msg:
      - "ansible_cmdline is {{ ansible_cmdline_var }}"
      - "lvm_facts are {{ lvm_facts }}"
      
- name: Verify Ansible cmdline and LVM facts
  assert:
    that: "ansible_cmdline_var | search('rd.lvm.lv') is defined"
    success_msg: "Ansible cmdline has the correct value"
