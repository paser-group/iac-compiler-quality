
- name: Attach previously-created Amazon EBS volume to instance
  hosts: ec2_instances
  gather_facts: False

  vars:
    snapshot_id: "snap-xxxxxxxx"
    zone: "us-west-2"
    instance_id: "i-xxxxxxxx"
    device_name: "/dev/sdf"

  tasks:
    - name: Attach an Amazon EBS volume from snapshot with invalid arguments
      ec2_vol:
        snapshot: "{{ snapshot_id }}"
        zone: "{{ zone }}"
        device_name: "{{ device_name }}"
        instance: "{{ instance_id }}"
        # Using invalid parameters to trigger a failure
        nonsense_param: "invalid"
      register: snap_attach_invalid

    - assert:
        that: snap_attach_invalid is failed

