
---
- name: Test for bug in Ansible compiler when --ask-sudo-pass is not provided
  hosts: centos_nodes
  tasks:
    - name: Test sudo command without --ask-sudo-pass
      command: "sudo whoami"
      ignore_errors: true
      register: command_output
    - name: Check if ask-sudo-pass message appears
      fail:
        msg: "'--ask-sudo-pass' option not provided, but password requested"
      when: "command_output.stdout.find('password') != -1"
