
---
- hosts: localhost
  gather_facts: no
  vars:
    AZURE_SUBSCRIPTION_ID: "<insert_subscriptionID_here>"
    AZURE_CLIENT_ID: "<insert_clientID_here>"
    AZURE_SECRET: "<insert_secret_here>"
    AZURE_TENANT: "<insert_tenant_here>"
    RG_NAME: "<insert_resource_group_name_here>"
    LOCATION: "<insert_location_here>"
  tasks:
  - name: Test creation and deletion of Azure Storage account using azure_rm_storageaccount module
    azure_rm_storageaccount:
      name: "testaccount"
      resource_group: "{{ RG_NAME }}"
      account_type: "Standard_LRS"
      location: "{{ LOCATION }}"
      state: present
      login_host: "localhost"
      login_port: 6000
      client_id: "{{ AZURE_CLIENT_ID }}"
      secret: "{{ AZURE_SECRET }}"
      subscription_id: "{{ AZURE_SUBSCRIPTION_ID }}"
      tenant: "{{ AZURE_TENANT }}"
    vars:
      rg: "{{ RG_NAME }}"
    with_items:
    - testaccount
  - name: Test deletion of Azure Storage Account using azure_rm_storageaccount module
    azure_rm_storageaccount:
      name: "testaccount"
      resource_group: "{{ RG_NAME }}"
      state: absent
      login_host: "localhost"
      login_port: 6000
      client_id: "{{ AZURE_CLIENT_ID }}"
      secret: "{{ AZURE_SECRET }}"
      subscription_id: "{{ AZURE_SUBSCRIPTION_ID }}"
      tenant: "{{ AZURE_TENANT }}"
    vars:
      rg: "{{ RG_NAME }}"
    with_items:
    - testaccount
