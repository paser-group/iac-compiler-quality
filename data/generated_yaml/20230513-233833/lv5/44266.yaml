
- name: Create user with custom shell on Debian
  hosts: all
  tasks:
    - name: Create user
      user:
        name: testuser
        shell: /bin/bash
      become: true
    - name: Check user shell value
      command: getent passwd testuser | cut -d : -f 7
      register: shell_value
    - name: Assert shell value is correct
      assert:
        that:
          - shell_value.stdout == "/bin/bash"
