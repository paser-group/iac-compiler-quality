
- name: Test ec2_lc with no default VPC
  hosts: node2
  become: true
  vars:
    region: us-east-1
    image_id: ami-0c1a7f89451184c8b
    instance_type: t2.micro
    key_name: mykey

  tasks:
  - name: Create launch configuration
    ec2_lc:
      name: test-lc
      image_id: "{{ image_id }}"
      instance_type: "{{ instance_type }}"
      key_name: "{{ key_name }}"
      region: "{{ region }}"
    register: lc_result
    ignore_errors: true

  - name: Assert expected error message
    assert:
      that:
      - "'no default VPC for this user' in lc_result.msg"
