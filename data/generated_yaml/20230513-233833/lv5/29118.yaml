
---
- name: Configure ios_interfaces
  hosts: ios_devices
  gather_facts: no
  connection: network_cli
  
  tasks:
  - name: Configure interface with port/host
    ios_interface:
      name: "{{ interface_name }}"
      description: "{{ description }}"
      state: present
      ipv4:
        address: "{{ ipv4_address }}"
      port: "{{ port }}"
      host: "{{ host }}"
    register: with_port_host
      
  - name: Configure interface without port/host
    ios_interface:
      name: "{{ interface_name }}"
      description: "{{ description }}"
      state: present
      ipv4:
        address: "{{ ipv4_address }}"
      register: no_port_host
    
  - name: Verify ios_interface configuration
    assert:
      that:
        - with_port_host.changed == true
        - no_port_host.changed == true
      msg: "Configuration failed for ios_interfaces without port and host definitions"
