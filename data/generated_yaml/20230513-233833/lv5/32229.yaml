
- name: Create a container with a non-zero exit code
  hosts: all
  become: true

  tasks:
  - name: Create a container with an invalid command
    docker_container:
      name: alpine
      image: alpine
      state: present
      command: non-existent-command
    register: result

  - name: Fail the playbook if the container creation failed
    fail:
      msg: "Container creation failed with exit code {{ result.rc }}"
    when: result.rc != 0
