
- name: Verify syntax of the Ansible code
  hosts: all
  gather_facts: no
  tasks:
    - name: Dry Run the playbook
      ansible-playbook playbook.yml --check

    - name: Check for specific error messages
      fail:
        msg: "Syntax Error: Unexpected variable 'foo' found"
      when: "'Syntax error: expecting a value for {{ item }}' in ansible_result.stderr"
      with_items:
        - "group_vars"
        - "host_vars"
        - "host_vars/foo.yml"
