
- name: Check Vault cipher whitelist
  set_fact:
    good_ciphers:
      - AES256-GCM-SHA384
      - AES128-GCM-SHA256
      - AES256-SHA
      - AES128-SHA
      - ECDHE-RSA-AES256-GCM-SHA384
      - ECDHE-RSA-AES128-GCM-SHA256
  register: cipher_list

- name: Validate cipher whitelist
  assert:
    that:
      - cipher_list.good_ciphers | intersect(ansible_vault_supported_ciphers) == cipher_list.good_ciphers
    fail_msg: "Cipher whitelist error detected in Ansible Vault"
