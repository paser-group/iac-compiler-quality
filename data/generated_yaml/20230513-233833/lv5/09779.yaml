
- name: Check current version of Ansible
  shell: ansible --version | awk 'NR==1{print $2}'
  register: ansible_version

- debug: var=ansible_version.stdout

- name: Check if Ansible is up to date
  shell: ansible --version | awk 'NR==1{print $2}'
  register: ansible_version

- fail: msg="Ansible is not up to date. Update to the latest version before proceeding"  
  when: ansible_version.stdout != "{{ansible_version_latest}}"
