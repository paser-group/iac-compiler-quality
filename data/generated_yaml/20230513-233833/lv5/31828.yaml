
- name: Test deleting AWS security group
  hosts: localhost
  gather_facts: no

  tasks:
  - name: Create AWS security group
    ec2_group:
      name: test-delete-group
      description: This group is for testing delete
      vpc_id: vpc-xxxxxx
      region: us-east-1
    register: new_group

  - name: Delete AWS security group
    ec2_group:
      name: "{{ new_group.group_id }}"
      state: absent
      region: us-east-1
    register: deleted_group
