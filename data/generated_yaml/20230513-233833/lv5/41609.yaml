
- hosts: all
  tasks:
    - name: Collect facts
      setup:
        
    - name: Check facts for JSON errors
      command: python /path/to/json_parse_script.py "{{ansible_facts}}"
      register: json_parse_result
      
    - name: Fail the Playbook if JSON parse errors are detected 
      fail:
        msg: "JSON errors detected in Ansible facts"
      when: json_parse_result.rc != 0
