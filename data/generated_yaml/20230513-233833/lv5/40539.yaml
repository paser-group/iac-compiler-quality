
- name: Test bigip_node module server_port issue
  hosts: all
  gather_facts: yes
  vars:
    server_port: 8080 # Change this value to customize server port.
  tasks:
    - name: Create node on BIG-IP
      bigip_node:
        provider:
          server: lb.example.com
          user: admin
          password: pass
        name: test-pool-node
        partition: Common
        host: 10.10.10.10
        server_port: "{{ server_port }}"
        state: present
      delegate_to: localhost

    - name: Delete node from BIG-IP
      bigip_node:
        provider:
          server: lb.example.com
          user: admin
          password: pass
        name: test-pool-node
        partition: Common
        state: absent
      delegate_to: localhost
