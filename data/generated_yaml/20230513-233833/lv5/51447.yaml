
- name: test gcp_container_node_pool module with location field
  hosts: localhost
  tasks:
    - name: include gcp_auth plugin
      include_vars:
        file: "{{ playbook_dir }}/gcp-creds.yml"

    - name: set location parameter
      vars:
        location: "us-central1-c"

    - name: test gcp_container_node_pool module with location parameter
      gcp_container_node_pool:
        name: test-pool
        location: "{{ location }}"
        cluster: test-cluster
        state: present
        initial_node_count: 1
        labels:
          example: label
      register: pool_result

    - name: verify node pool creation
      assert:
        that:
          - pool_result is defined
          - pool_result != {}
          - pool_result.changed == true
