
- name: Test azure_rm_rediscache module
  hosts: azure
  vars:
    operations_to_block:
      - create
      - update
      - delete
  tasks:
    - name: Block unauthorized Redis Cache operations
      block:
        - debug: msg="Unauthorized Redis Cache operation attempted"
      when: "'{{ item }}_redis' not in allowed_redis_instances"
      with_items:
        - "{{ operations_to_block }}"

    # Additional tasks to explicitly allow Redis Cache operations
    # ...
