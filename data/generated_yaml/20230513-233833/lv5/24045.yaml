
- hosts: all
  vars:
    auth_username: "{{ ansible_user }}"
    auth_password: "{{ ansible_password }}"
    nova_api_version: "{{ nova_api_version }}"
    compute_endpoint: "{{ compute_endpoint }}"
  tasks:
    - name: Get availability zones
      uri:
        method: GET
        url: "{{ compute_endpoint }}/os-availability-zone/"
        timeout: 30
        user: "{{ auth_username }}"
        password: "{{ auth_password }}"
        force_basic_auth: yes
        headers:
          X-Auth-Token: "{{ auth_token }}"
          Content-Type: application/json
        status_code: 200
      register: response
    - name: Debug availability zones
      debug:
        msg: "{{ response.json }}"
