
- name: Configure SNMP on the target device
  ios_snmp:
    name: "{{ snmp_community }}"
    groups: "{{ snmp_groups }}"
    contact: "{{ snmp_contact }}"
    location: "{{ snmp_location }}"
    source_interface: "{{ snmp_source_interface }}"
  register: snmp

- name: Verify SNMP configuration using nxos-snmp-community module
  nxos_snmp_community:
    community: "{{ snmp_community }}"
    group: "{{ snmp_groups }}"
    contact: "{{ snmp_contact }}"
    location: "{{ snmp_location }}"
    source_interface: "{{ snmp_source_interface }}"
  register: snmp_community

- name: Verify the output of nxos-snmp-community module 
  assert:
    that:
      - "'Success' in snmp_community.stdout_lines"
