
- name: Remove VTP Password
  hosts: all
  gather_facts: false

  tasks:
    - name: Remove VTP Password
      nxos_vtp_password:
        password: ""
        state: absent
      register: result

    - name: Check VTP Password idempotence
      assert:
        that:
          - "'changed' not in result or result['changed'] == false"
