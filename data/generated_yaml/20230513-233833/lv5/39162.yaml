
- name: Encrypt sensitive data
  ansible-vault encrypt_string "password" --name "ansible_password" # replace 'password' with the actual password.

- name: Retrieve encrypted data using hostvars
  set_fact:
      ansible_password: "{{ hostvars[inventory_hostname]['ansible_password'] }}"

- name: Use the encrypted password
  shell: echo {{ ansible_password }}
