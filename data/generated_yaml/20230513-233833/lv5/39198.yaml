
---
- name: Test zabbix_template module
  hosts: all
  gather_facts: no
  tasks:
    - name: Test with a string template
      zabbix_template:
        server_url: "https://zabbix.example.com/api_jsonrpc.php"
        login_user: "{{ zabbix_user }}"
        login_password: "{{ zabbix_password }}"
        name: "Test Template"
        template: "string"
      register: result_str
      ignore_errors: yes

    - name: Test with an integer template
      zabbix_template:
        server_url: "https://zabbix.example.com/api_jsonrpc.php"
        login_user: "{{ zabbix_user }}"
        login_password: "{{ zabbix_password }}"
        name: "Test Template"
        template: 123
      register: result_int
      ignore_errors: yes

    - name: Fail the playbook if either test fails
      fail:
        msg: "Zabbix template module test failed"
      when: result_str.failed or result_int.failed
