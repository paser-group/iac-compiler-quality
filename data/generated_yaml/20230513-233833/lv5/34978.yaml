
- name: Launch EC2 instance with user-data and spot_price
  ec2:
    region: us-east-1
    instance_type: t2.micro
    image: ami-0c94855ba95c71c99
    count: 1
    key_name: ansible-key
    vpc_subnet_id: subnet-0e4727f4515784b25
    user_data: "{{ lookup('file', '/path/to/user-data.txt') }}"
    spot_price: null
  register: ec2_instance
