
- hosts: nxos_switches
  gather_facts: no
  tasks:
    - name: Configure L2 Interface 1
      nxos_l2_interface:
        name: Ethernet1
        description: "Configured by Ansible"
        state: present
        mode: access
        vlan_id: 10
      register: l2_interface_config_1

    - name: Configure L2 Interface 2
      nxos_l2_interface:
        name: Ethernet2
        description: "Configured by Ansible"
        state: present
        mode: access
        vlan_id: 20
      register: l2_interface_config_2

    - name: Configure L2 Interface 1 again
      nxos_l2_interface:
        name: Ethernet1
        description: "Configured by Ansible"
        state: present
        mode: access
        vlan_id: 10
      register: l2_interface_config_1_again

    - name: Configure L2 Interface 2 again
      nxos_l2_interface:
        name: Ethernet2
        description: "Configured by Ansible"
        state: present
        mode: access
        vlan_id: 20
      register: l2_interface_config_2_again

    - name: Debug output
      debug:
        var: item.changed
      with_items:
        - "{{ l2_interface_config_1 }}"
        - "{{ l2_interface_config_1_again }}"
        - "{{ l2_interface_config_2 }}"
        - "{{ l2_interface_config_2_again }}"
