
- name: Test Ansible-vault file creation
  hosts: localhost
  connection: local
  gather_facts: no

  vars:
    vault_pass: "my_vault_pass"

  tasks:
    - name: Test Ansible-vault file creation with no file name
      command: ansible-vault create
      register: result
      ignore_errors: yes
      become: yes
      become_user: root

    - name: Check whether Ansible-vault file created with no file name
      assert:
        that:
          - '"must provide file name" in result.stderr'
