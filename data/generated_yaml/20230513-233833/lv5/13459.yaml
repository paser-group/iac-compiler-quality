
- name: Set default shell type to sh
  hosts: all
  become: yes
  tasks:
    - name: Set default shell type to sh
      shell: chsh -s /bin/sh
      changed_when: false

- name: Execute a command with bash shell type
  hosts: all
  become: yes
  tasks:
    - name: Execute a command with bash shell type
      shell: echo test > /tmp/test.txt
      args:
        executable: "/bin/bash"

- name: Verify default shell type is still sh
  hosts: all
  become: yes
  tasks:
    - name: Get shell type of user
      shell: echo $0
      register: shell_type
    - name: Verify shell is still sh
      assert:
        that:
          - shell_type.stdout == "/bin/sh\n"
