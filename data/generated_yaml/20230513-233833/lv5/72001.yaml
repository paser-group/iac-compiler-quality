
---
- hosts: kubevirt_vms
  gather_facts: yes
  
  tasks:
  - name: Gather Facts
    setup:
  
  - name: Verify virtualization variables
    assert:
      that:
        - ansible_virtualization_type == 'kvm'
        - ansible_virtualization_role == 'guest'
  
  - name: Manage VMs
    virt:
      state: running
      name: my_vm_name
      ...
  
  - name: Install packages for KubeVirt
    apt:
      name: "{{ item }}"
      state: present
      update_cache: yes
    with_items:
      - kubevirt
      - kubevirt-ansible
