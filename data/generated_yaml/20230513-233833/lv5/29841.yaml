
---
- name: Test iam_role state handling
  hosts: all
  tasks:
    - name: Set iam_role state to active
      iam_role:
        name: my_role
        state: active
      register: iam_active
    - name: Verify iam_role state set to active
      assert:
        that:
          - iam_active is not failed
          - iam_active.state == 'active'
    - name: Set iam_role state to inactive
      iam_role:
        name: my_role
        state: inactive
      register: iam_inactive
    - name: Verify iam_role state set to inactive
      assert:
        that:
          - iam_inactive is not failed
          - iam_inactive.state == 'inactive'
