
---
- name: Test nxos_pim_rp_address module
  hosts: all
  gather_facts: False
  
  vars:
    ansible_connection: network_cli
    ansible_network_os: nxos
    ansible_become: yes
    ansible_become_method: enable
    
    cli_creds:
      host: "{{ inventory_hostname }}"
      username: admin
      password: admin

  tasks:
    - name: Test nxos_pim_rp_address module with CLI transport
      nxos_pim_rp_address:
        rp: "172.16.63.1"
        rp_range: ["224.0.0.0/4"]
        mode: "sm"
        vrf: "vxlan-101"
        transport: cli
      register: cli_result
      tags:
        - cli_test
    
    - name: Test nxos_pim_rp_address module with NXAPI transport
      nxos_pim_rp_address:
        rp: "172.16.63.1"
        rp_range: ["224.0.0.0/4"]
        mode: "sm"
        vrf: "vxlan-101"
        transport: nxapi
      register: nxapi_result
      tags:
        - nxapi_test
