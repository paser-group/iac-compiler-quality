
- hosts: localhost
  gather_facts: no
  connection: local
  vars:
    aws_region: us-west-2
  tasks:
    - name: create an inventory file
      add_host:
        name: TestInstance
        ansible_ssh_host: 10.1.1.1
        ansible_ssh_user: ubuntu
        ansible_ssh_private_key_file: /path/key
      run_once: true
    - name: Provision Route Table Using ec2_vpc_route_table module
      hosts: TestInstance
      vars:
        vpc_id: vpc-123456
        route_tables:
          - tags:
              Name: 'Test-RouteTable'
      tasks:
        - ec2_vpc_route_table:
            state: present
            vpc_id: "{{ vpc_id }}"
            route_tables: "{{ route_tables }}"
            region: "{{ aws_region }}"
