
---
- name: Test shell module
  hosts: all
  tasks:
    - name: Run whoami command and output to a file
      shell: whoami > /tmp/whoami.txt
      register: result
      ignore_errors: true
      
    - name: Verify output file
      assert:
        that:
          - result.rc == 0
          - "whoami" in result.stdout
      failed_when: false
