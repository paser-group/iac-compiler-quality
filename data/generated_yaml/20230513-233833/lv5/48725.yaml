
---
- name: Test Azure RM Virtual Machine Facts Module
  hosts: node1
  gather_facts: no
  
  vars:
    resource_group: "rg-name"
    state: "running"
  
  tasks:
    - name: Gather VM facts
      azure_rm_virtualmachine_facts:
        resource_group: "{{ resource_group }}"
        status: "{{ state }}"
      register: vm_facts
      ignore_errors: yes
    
    - name: Display gathered facts
      debug:
        var: vm_facts
