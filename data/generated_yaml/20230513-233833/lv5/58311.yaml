
- hosts: nodes
  gather_facts: False

  tasks:
  - name: Check SSO/ADFS authentication
    uri:
      url: https://my-sso.com/auth
      return_content: yes
      status_code: 200
      headers:
        Content-Type: "application/json"
    register: auth_status

  - name: Debug SSO/ADFS authentication status
    debug:
      var: auth_status

  - name: Check if authentication is successful or not
    fail:
      msg: "SSO/ADFS authentication failed"
    when: auth_status.status != 200

  - name: Proceed with the playbook execution if authentication is successful
    debug:
      msg: "SSO/ADFS authentication successful!"
