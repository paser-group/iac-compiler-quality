
---
- name: Test mssql_db module
  hosts: all
  vars:
    db_name: "{{ 'db_' ~ range(10000, 99999) | random }}"
  tasks:
    - name: Create database
      mssql_db:
        name: "{{ db_name }}"
        state: present
      register: result
    - name: Fail if error
      fail:
        msg: "{{ result.msg }}"
      when: result.failed
    - name: Log error message
      debug:
        var: result.msg
      when: result.failed
