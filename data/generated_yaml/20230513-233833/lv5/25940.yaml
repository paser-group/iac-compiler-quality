
- name: Test ec2_remote_facts with missing arguments
  hosts: ec2
  gather_facts: False
  vars:
    missing_args:
      - "--instance-ids"
      - "--filters"
      - "--aws-access-key"
      - "--aws-secret-key"
  tasks:
    - name: ec2_remote_facts test with missing argument: "{{ item }}"
      ec2_remote_facts:
        region: "us-east-1"
        validate_certs: False
        {{ item }}: ""
      register: output
      failed_when: output.facts is not defined
      changed_when: False
      ignore_errors: True
      retries: 3
    - name: "Debug task for ec2_remote_facts test with missing argument {{ item }}"
      debug:
        var: output
      failed_when: output.facts is not defined
