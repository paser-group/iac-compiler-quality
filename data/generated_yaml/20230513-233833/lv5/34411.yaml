yaml
---
- name: Win Firewall Test
  hosts: all
  gather_facts: no
  tasks:
  - name: Block all inbound traffic
    win_firewall:
      state: "block"
      name: "Block all inbound traffic"
      direction: "in"
      enabled: "yes"

  - name: Test Ping with Firewall Enabled
    win_ping:
      count: 2
    ignore_errors: yes

  - name: Allow RDP traffic
    win_firewall:
      state: "allow"
      name: "Allow RDP traffic"
      port: "3389"
      protocol: "tcp"
      direction: "in"
      enabled: "yes"

  - name: Test RDP with Firewall Enabled
    win_ping:
      count: 2
    ignore_errors: yes
