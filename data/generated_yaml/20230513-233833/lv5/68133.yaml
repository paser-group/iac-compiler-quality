
- name: Test gcp_compute_instance module for network parameter error
  hosts: localhost
  gather_facts: False
  
  vars:
    project_id: 'my-gcp-project'
    zone: 'us-central1-a'
    instance_name: 'test-instance'
    network: 'invalid'
    machine_type: 'f1-micro'
    image_family: 'ubuntu-2004-lts'

  tasks:
    - name: Create GCP compute instance
      gcp_compute_instance:
        name: "{{ instance_name }}"
        project: "{{ project_id }}"
        zone: "{{ zone }}"
        machine_type: "{{ machine_type }}"
        boot_disk_auto_delete: yes
        networkInterfaces:
          - accessConfigs:
            - name: external-nat
              type: ONE_TO_ONE_NAT
            network: "{{ network }}"
        disks:
          - auto_delete: yes
            boot: yes
            initialize_params:
              source_image_family: "{{ image_family }}"
      register: result

    - debug:
        var: result
