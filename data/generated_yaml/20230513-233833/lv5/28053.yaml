
- name: Start LXC container
  lxc_container:
    name: my-container
    state: started
    template: ubuntu
    template_opts: "--release=18.04"
    privileged: true

- name: Stop LXC container
  lxc_container:
    name: my-container
    state: stopped

- name: Check if LXC container is running
  shell: lxc-info -n my-container | grep RUNNING | wc -l
  register: container_running

- name: Fail if container is not running
  fail:
    msg: "LXC container is not running"
  when: container_running.stdout.strip() != "1"
