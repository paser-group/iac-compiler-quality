
- name: Test password authentication
  hosts: all
  tasks:
     - name: Authenticate using password
       become: yes
       become_user: root
       expect:
         command: ssh -i /path/to/key -o PreferredAuthentications=password remoteuser@{{ inventory_hostname }}
         responses:
           Password:\s: secretpass
       register: auth_status
      
     - name: Check authentication status
       debug:
         var: auth_status
