
- name: Create a Windows Shortcut
  hosts: windows_nodes
  become: yes
  tasks:
    - name: Add a new shortcut
      win_shortcut:
        src: C:\Program Files\myapp\app.exe
        dest: C:\Users\Public\Desktop\MyApp.lnk
        arguments: /silent /uninstall
        description: MyApp
        icon_location: C:\Program Files\myapp\app.exe, 0
        hotkey: Ctrl+Alt+Shift+T
      register: shortcut_result

    - name: Update an existing shortcut
      win_shortcut:
        src: C:\Program Files\myapp\app.exe
        dest: C:\Users\Public\Desktop\MyApp.lnk
        arguments: /silent /install
        description: MyApp
        icon_location: C:\Program Files\myapp\app.ico, 0
        hotkey: Ctrl+Alt+Shift+T
      when: shortcut_result.changed == True
