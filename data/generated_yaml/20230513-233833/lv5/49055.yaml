
- name: Configure domain settings on Windows host
  hosts: windows
  gather_facts: no
  vars:
    - domain_name: example.com
  tasks:
    - name: Join windows machine to domain
      win_domain:
        dns_domain_name: "{{ domain_name }}"
        hostname: "{{ inventory_hostname }}"
        admin_username: "administrator"
        admin_password: "{{ admin_password }}"
        domain_username: "{{ domain_username }}"
        domain_password: "{{ domain_password }}"
        ou_path: "OU=Computers,OU={{ domain_name.split('.')[0] }}"

        # Injecting error here
        InstallDNS: "{{ ansible_facts['os_type'] == 'Windows' }}"
 