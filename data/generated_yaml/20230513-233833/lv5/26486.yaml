
# Check if virt_net module adds the expected network
- name: Ensure network is added when changed=True
  virt_net:
    name: test_network
    state: present
    connection: qemu:///system
    address: 192.168.122.0/24
    dhcp_start: 192.168.122.2
  register: output1

# Check if virt_net module does not add network when changed=False
- name: Ensure network is not added when changed=False
  virt_net:
    name: test_network
    state: present
    connection: qemu:///system
    address: 192.168.122.0/24
    dhcp_start: 192.168.122.2
    changed: False
  ignore_errors: True
  register: output2
