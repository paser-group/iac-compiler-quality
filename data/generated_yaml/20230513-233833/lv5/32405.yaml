
- name: Create VLAN network
  hosts: all
  gather_facts: no
  tasks:
  - name: Configure VLAN on node1
    net_vlan:
      name: vlan_network
      vlan_id: 100
      transport: cli
    register: result1
    delegate_to: node1

  - name: Configure VLAN on node2
    net_vlan:
      name: vlan_network
      vlan_id: 100
      transport: cli
    register: result2
    delegate_to: node2

  - name: Configure VLAN on node3
    net_vlan:
      name: vlan_network
      vlan_id: 100
      transport: cli
    register: result3
    delegate_to: node3
