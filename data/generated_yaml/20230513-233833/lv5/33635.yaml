
---
- name: Test Junos command module
  hosts: junos_hosts
  gather_facts: no
  tasks:
  - name: Connect to Junos device
    junos_netconf:
      host: "{{ inventory_hostname }}"
      user: "{{ username }}"
      passwd: "{{ password }}"

  - name: Test connection to Junos device
    junos_command:
      command: "show version"
    register: result
    when: not result is failed

  - name: Test Junos command module
    junos_command:
      command: "show interfaces terse"
    register: result
    when: not result is failed

  - name: Save result to file
    copy:
      content: "{{ result }}"
      dest: "/tmp/ansible_junos_command_output"
      mode: '0666'

  - name: Display result
    debug:
      msg: "{{ result }}"
