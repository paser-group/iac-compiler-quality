
- name: Test temporary file handling
  hosts: all
  gather_facts: false
  tasks:
    - name: Create temporary file
      tempfile:
        state: file
        prefix: ansible-test-
        suffix: .txt
        dir: "{{ remote_tmp }}"
      register: tempfile

    - name: Verify temporary file creation
      stat:
        path: "{{ tempfile.path }}"
      register: file_status

    - name: Delete temporary file
      file:
        path: "{{ tempfile.path }}"
        state: absent
      when: file_status.stat.exists is defined and file_status.stat.exists == True
