
- name: Enable SSHD debug mode and check for parsing errors
  hosts: node1
  gather_facts: false
  tasks:
  - name: Enable debug mode for SSHD
    shell: sudo /usr/sbin/sshd -d > /tmp/sshd.log 2>&1 &
  - name: Check if sshd is running in debug mode without errors
    shell: cat /tmp/sshd.log
    register: sshd_output
    failed_when: "'parsing fatal' in sshd_output.stdout_lines"
