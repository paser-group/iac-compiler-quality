
- hosts: localhost
  gather_facts: false
  tasks:
    - name: create inventory
      add_host:
        name: "{{ item }}"
        groups: demo
        ansible_host: "{{ item }}"
      with_items:
        - "{{ groups['all'] }}"

- hosts: demo
  roles:
    - include_first
    - include_second
  vars:
    first_list: []
    second_list: ["node1", "node2", "node3"]

- name: Include first role
  include_role:
    name: first_role
  vars:
    sub_hosts: "{{ first_list }}"

- name: Include second role
  include_role:
    name: second_role
  vars:
    sub_hosts: "{{ second_list }}"
