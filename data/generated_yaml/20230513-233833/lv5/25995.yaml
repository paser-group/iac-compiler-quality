
- name: Check if bucket exists
  aws_s3_bucket_facts:
    name: my-bucket
  register: s3_bucket_facts
  ignore_errors: True

- name: Create S3 bucket if not exists
  aws_s3_bucket:
    name: my-bucket
    region: us-west-2
  when: s3_bucket_facts is failed
  failed_when: "'already owned by the authenticated user.' not in s3_bucket_facts.msg"
