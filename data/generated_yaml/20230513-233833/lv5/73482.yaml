
# template file
# test_template.j2
{% for item in items %}
{{ item | some_filter }}
{% if item.some_key %}
  {{ item.some_key }}
{% endif %}
{% endfor %}
  
# task to run the template file
- name: Run template module
  template:
    src: test_template.j2
    dest: /tmp/test_template_output)
  vars:
    items:
      - name: "item1"
        some_filter: "filter1"
      - name: "it`em2"
        some_filter: "filter2"
        some_key: "key1"
