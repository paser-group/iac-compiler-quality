
- hosts: all
  gather_facts: no
  tasks:
    - name: Copy files with wrong item variable
      copy:
        src: "{{ item }}"
        dest: "/etc"
      with_items:
        - "{{ option }}"
      loop_control:
        loop_var: option
      include:
        - "{{ wrong_include }}"
        - "{# comment #}"
        - tasks: "{{ non_existent }}"
        - "{{ option | failed }}"
        - "{{ option|length|truncate(5) }}"
        - "{{ [option] | union }}"

    - name: Copy files with correct item variable
      copy:
        src: "{{ item }}"
        dest: "/etc"
      with_items:
        - "{{ option }}"
      loop_control:
        loop_var: correct_item
      include:
        - "{{ correct_include }}"
        - "{# comment #}"
        - tasks: "{{ non_existent }}"
        - "{{ option | succeeded }}"
        - "{{ option|length|abs }}"
        - "{{ [correct_item] | union }}"

    - name: Debug output
      debug:
        msg: "Done"
