
- name: get_url edge case playbook
  hosts: all
  vars:
    url: "https://www.example.com"
    url_with_query: "https://www.example.com/search?q=ansible&limit=10"
    url_with_fragment: "#section1"

  tasks:
  - name: Download file with SSL verification disabled
    get_url:
      url: "{{ url }}"
      dest: "/tmp/index.html"
      validate_certs: no

  - name: Download file with HTTP Basic Authentication
    get_url:
      url: "{{ url }}"
      dest: "/tmp/index.html"
      user: "testuser"
      password: "testpassword"

  - name: Download file with query parameters
    get_url:
      url: "{{ url_with_query }}"
      dest: "/tmp/index.html"

  - name: Download file with fragment identifier
    get_url:
      url: "{{ url_with_fragment }}"
      dest: "/tmp/index.html"

  - name: Download file with invalid URL
    get_url:
      url: "https://invalid_url.com"
      dest: "/tmp/index.html"
    ignore_errors: true

  - name: Download file with unexpected response code
    get_url:
      url: "{{ url }}"
      dest: "/tmp/index.html"
      status_code: 404

  - name: Download file with unknown protocol
    get_url:
      url: "ftp://www.example.com"
      dest: "/tmp/index.html"
    ignore_errors: true
