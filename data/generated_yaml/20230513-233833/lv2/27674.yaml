
---
- name: Stress-Testing Ansible Compiler
  hosts: all
  gather_facts: no

  tasks:
    - name: Reboot NXOS devices with CLI
      nxos_reboot:
        provider:
          host: "{{ inventory_hostname }}"
          username: "{{ cli_username }}"
          password: "{{ cli_password }}"
          transport: cli
        confirm: "{{ reboot_confirm | default(omit) }}"
        timeout: "{{ timeout | default(omit) }}"
        
    - name: Reboot NXOS devices with NXAPI
      vars:
        api_port: "{{ (nxapi_port|int) + 1 }}"
        api_protocol: "{{ invalid_protocol | default('https') }}"
      nxos_reboot:
        provider:
          host: "{{ inventory_hostname }}"
          username: "{{ api_username }}"
          password: "{{ api_password }}"
          port: "{{ api_port }}"
          transport: "{{ api_protocol }}"
        confirm: "{{ reboot_confirm | default('yes') }}"
        timeout: "{{ timeout | default(300) }}"
