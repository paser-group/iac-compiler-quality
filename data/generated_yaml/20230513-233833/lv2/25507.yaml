
---
- name: Test playbook for nxos_facts module
  hosts: all
  gather_facts: no

  tasks:
    - name: Run nxos_facts module with invalid port input
      nxos_facts:
        host: "{{ inventory_hostname }}"
        username: "admin"
        password: "password"
        transport: "{{ ['nxapi', 'cli', 'ssh'] | random }}"
        port: "{{ random() * 1000 }}"
      register: result
      ignore_errors: true

    - name: Run nxos_facts module with missing host input
      nxos_facts:
        username: "admin"
        password: "password"
        transport: "{{ ['nxapi', 'cli', 'ssh'] | random }}"
        port: "{{ random() * 1000 }}"
      register: result
      ignore_errors: true
    
    - name: Run nxos_facts module with invalid username input
      nxos_facts:
        host: "{{ inventory_hostname }}"
        username: "{{ ['admin', 'admin123', 'admin!@#'] | random }}"
        password: "password"
        transport: "{{ ['nxapi', 'cli', 'ssh'] | random }}"
        port: "{{ random() * 1000 }}"
      register: result
      ignore_errors: true

    - name: Run nxos_facts module with invalid password input
      nxos_facts:
        host: "{{ inventory_hostname }}"
        username: "admin"
        password: "{{ ['password', 'admin123', 'admin!@#'] | random }}"
        transport: "{{ ['nxapi', 'cli', 'ssh'] | random }}"
        port: "{{ random() * 1000 }}"
      register: result
      ignore_errors: true

    - name: Run nxos_facts module with invalid transport input
      nxos_facts:
        host: "{{ inventory_hostname }}"
        username: "admin"
        password: "password"
        transport: "{{ ['invalid_transport', 'invalid_transport2'] | random }}"
        port: "{{ random() * 1000 }}"
      register: result
      ignore_errors: true

    - debug:
        var: result
