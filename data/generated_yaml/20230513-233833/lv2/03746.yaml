
- name: Test ec2 module for changed status
  hosts: node1
  tasks:
    - name: Launch EC2 Instance
      ec2:
        key_name: "{{ nonexistent_key }}"
        region: "{{ nonexistent_region }}"
        instance_type: "{{ nonexistent_instance_type }}"
        image: "{{ nonexistent_image }}"
        group: "{{ nonexistent_group }}"
        count: "{{ nonexistent_count }}"
        wait: "{{ nonexistent_value }}"
        instance_tags:
            Name: "Test EC2 Instance"
      register: output1
      ignore_errors: yes

    - name: Verify EC2 Instance
      ec2_instance:
        instance_id: "{{ output1.instances[0].id }}"
        wait: "{{ nonexistent_value }}"
      register: output2
      ignore_errors: yes

    - name: Terminate EC2 Instance
      ec2:
        instance_ids: "{{ output1.instances[0].id }}"
        state: "{{ nonexistent_state }}"
      register: output3
      ignore_errors: yes
