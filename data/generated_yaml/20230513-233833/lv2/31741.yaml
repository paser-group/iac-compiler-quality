
---
- name: Fuzzing playbook for Cryptography setup command
  hosts: all
  gather_facts: no

  tasks:
  - name: Install cryptography with invalid python version
    pip:
      name: cryptography
      state: present
      extra_args:
      - "--python-version < '3'"

  - name: Install cryptography with invalid environment marker
    pip:
      name: cryptography
      state: present
      extra_args:
      - "--python-version < '3'"
      - "--marker invalid_env_marker"

  - name: Install cryptography with unconventional syntax
    pip:
      name: cryptography_{ { '2' }}. { { '4*4' }}
      state: present

  - name: Install cryptography with unexpected input
    pip:
      name: "{{ some_nonexistent_variable }}"
      state: present
