
- hosts: all
  tasks:
    - name: Create an unknown group
      group:
        name: "unknown-group128472983droppdd"
        state: present
        system: yes

    - name: Add an unknown user with unknown group
      user:
        name: "unknown-user11823824283dd"
        group: "unknown-group128472983droppdd"
        state: present
        shell: /bin/false

    - name: Create temporary directory
      tempfile:
        state: directory
      register: temp_dir

    - name: Set SELinux context for temp directory
      file:
        path: "{{ temp_dir.path }}"
        state: directory
        selevel: s0-c0,c1

    - name: Buildah from Dockerfile
      become: yes
      become_user: "#1000"
      community.general.buildah:
        build_from: /
        container_name: unknown-container-w3jfi83d
        image: unknown-image
        dockerfile: "{{ temp_dir.path }}/Dockerfile"
      register: buildah_output

    - name: Print build result
      debug:
        var: buildah_output.stdout_lines
