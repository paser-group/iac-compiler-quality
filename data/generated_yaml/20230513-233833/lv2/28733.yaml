
---
- hosts: all
  gather_facts: no

  tasks:
    - name: Test if variable is defined
      debug:
        msg: "Variable is defined"
      when: "{{undefined_variable is defined }}"

    - name: Test if variable is not defined
      debug:
        msg: "Variable is not defined"
      when: "{{undefined_variable is not defined }}"

    - name: Test undefined variable with default value
      debug:
        msg: "Variable is defined with default value"
      when: "{{ undefined_variable | default('default_value') is defined }}"

    - name: Test undefined variable with Jinja test is defined
      debug:
        msg: "Variable is defined with Jinja test"
      when: "{{ undefined_variable is defined | bool }}"

    - name: Test undefined variable with Jinja test is undefined
      debug:
        msg: "Variable is not defined with Jinja test"
      when: "{{ undefined_variable is undefined | bool }}"

    - name: Test undefined variable with explicit type conversion
      debug:
        msg: "Variable is not defined with explicit type conversion"
      when: "{{ undefined_variable | string is not defined }}"

    - name: Test undefined variable with false expression
      debug:
        msg: "Variable is not defined with false expression"
      when: "{{ undefined_variable and true_variable }}"

    - name: Test defined variable with False value
      debug:
        msg: "Variable is defined with False value"
      when: "{{ false_variable is defined and false_variable == False }}"
