
- name: wait_for hang edge cases playbook
  hosts: all
  gather_facts: false
  tasks:

  - name: wait for unreachable port
    wait_for:
      port: 999999

  - name: wait for invalid protocol
    wait_for:
      host: google.com
      port: 80
      timeout: 5
      delay: 2
      active_connection_states:
        - "INVALID"

  - name: wait for DNS resolution failure
    wait_for:
      host: non-existent domain name
      port: 22

  - name: wait for invalid regex pattern
    wait_for:
      host: localhost
      port: 22
      search_regex: ["[\\"=~"]

  - name: wait for invalid response
    wait_for:
      host: google.com
      port: 80
      search_regex: "invalid regex"

  - name: wait for unexpected response
    wait_for:
      host: google.com
      port: 80
      search_regex: "SearchTermNotFound"
      delay: 10
      timeout: 15
      msg: "Custom message for unexpected response"

  - name: wait for large timeout
    wait_for:
      host: localhost
      port: 22
      timeout: 600

  - name: wait for negative timeout
    wait_for:
      host: localhost
      port: 22
      timeout: -1

  - name: wait for invalid delay
    wait_for:
      host: localhost
      port: 22
      delay: "invalid delay"
  
  - name: wait for non-existent port
    wait_for:
      host: localhost
      port: 123456
