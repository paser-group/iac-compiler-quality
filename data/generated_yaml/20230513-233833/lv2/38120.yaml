
- name: Test URI Module with API Token Authentication
  hosts: node1
  become: true

  tasks:
  - name: Test conventional syntax
    uri:
      url: https://{{ ansible_host }}/api/v1/data
      method: GET
      headers:
        Authorization: "Token {{ api_token }}"
      return_content: yes
    register: response01

  - name: Test unconventional syntax 1
    uri:
      url: https://{{ ansible_host }}/api/v1/data
      method: GET
      headers:
        "Authorization": "Token {{ api_token }}"
      return_content: yes
    register: response02

  - name: Test unconventional syntax 2
    uri:
      url: https://{{ ansible_host }}/api/v1/data
      method: GET
      headers:
        'Authorization': 'Token {{ api_token }}'
      return_content: yes
    register: response03

  - name: Test unexpected input 1
    uri:
      url: "https://{{ ansible_host }}/api/v1/data/{% if foo %}1{% endif %}"
      method: GET
      headers:
        Authorization: "Token {{ api_token }}"
      return_content: yes
    register: response04

  - name: Test unexpected input 2
    uri:
      url: https://{{ ansible_host }}/api/v1/{{ bar }}/data
      method: GET
      headers:
        Authorization: "Token {{ api_token }}"
      return_content: yes
    register: response05

  - name: Test unexpected input 3
    uri:
      url: https://{{ ansible_host }}/api/v1/data
      method: GET
      headers:
        Authorization: "Bearer {{ api_token }}"
      return_content: yes
    register: response06

  - name: Test unexpected input 4
    uri:
      url: https://{{ ansible_host }}/api/v1/data
      method: "{{ method }}"
      headers:
        Authorization: "Token {{ api_token }}"
      return_content: yes
    register: response07

  - name: Test unexpected input 5
    uri:
      url: https://{{ ansible_host }}/api/v1/data
      method: GET
      headers:
        Authorization: "{{ api_token }}"
      return_content: yes
    register: response08

  - name: Print responses
    debug:
      msg: "{{ item }}"
    with_items:
      - response01
      - response02
      - response03
      - response04
      - response05
      - response06
      - response07
      - response08
