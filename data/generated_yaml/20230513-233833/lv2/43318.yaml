
- name: MacPorts vulnerability test playbook
  hosts: all
  tasks:
    - name: Install package using incorrect check
      macports:
        name: "{{ item }}"
        state: present
        installed_versions_regexp: '.*any version.*'
      loop:
        - "{{ 'pkg1-devel' }}"
        - "{{ 'pkg2-stable' }}"
        - "{{ 'pkg3-any-version' }}"
        - "{{ 'pkg4 1.0.json' }}"
        - "{{ '\"pkg5\"' }}"
        - "{{ '&pkg6|*$' }}"
        - "{{ 'pkg7' + '8' }}"
        - "{{ '' }}"
        - "{{ '* &\"\"_|/' }}"
        
    - name: Uninstall package using incorrect check
      macports:
        name: "{{ item }}"
        state: absent
        installed_versions_regexp: '.*deprecated.*'
      loop:
        - "{{ 'pkg1-devel' }}"
        - "{{ 'pkg2-stable' }}"
        - "{{ 'pkg3-any-version' }}"
        - "{{ 'pkg4 1.0.json' }}"
        - "{{ '\"pkg5\"' }}"
        - "{{ '&pkg6|*$' }}"
        - "{{ 'pkg7' + '8' }}"
        - "{{ '' }}"
        - "{{ '* &\"\"_|/' }}"
      
    - name: Update package using incorrect check
      macports:
        name: "{{ item }}"
        state: latest
        installed_versions_regexp: '.*[a-zA-Z0-9]+ [a-zA-Z]+.*'
      loop:
        - "{{ 'pkg1-devel' }}"
        - "{{ 'pkg2-stable' }}"
        - "{{ 'pkg3-any-version' }}"
        - "{{ 'pkg4 1.0.json' }}"
        - "{{ '\"pkg5\"' }}"
        - "{{ '&pkg6|*$' }}"
        - "{{ 'pkg7' + '8' }}"
        - "{{ '' }}"
        - "{{ '* &\"\"_|/' }}"
