
- name: Test apt_repository module with proxy
  hosts: node1
  become: true
  vars:
    proxy: "http://proxy.example.com:8080/"
  tasks:
    - name: Add apt repository via proxy
      apt_repository:
        repo: "{{ item }}"
        state: present
        proxy: "{{ proxy }}"
      with_items:
        - deb https://example.com/debian buster main
        - deb-src https://example.com/debian buster main

- name: Test apt_repository module without proxy
  hosts: node2
  become: true
  vars:
    proxy: ""
  tasks:
    - name: Add apt repository without proxy
      apt_repository:
        repo: "{{ item }}"
        state: present
        proxy: "{{ proxy }}"
      with_items:
        - deb https://example.com/debian buster main
        - deb-src https://example.com/debian buster main
