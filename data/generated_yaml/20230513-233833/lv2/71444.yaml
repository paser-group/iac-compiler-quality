
- name: Test iptables comment parameter position
  hosts: all
  gather_facts: no
  become: yes
  tasks:
    - name: Add iptables rule with comment incorrectly positioned
      iptables:
        table: nat
        chain: POSTROUTING
        comment: Comment that should not be here
        jump: MASQUERADE
      register: iptables_rule
    - name: Check if iptables rule was added successfully
      debug:
        msg: "Iptables rule added successfully."
      when: iptables_rule|success
    - name: Remove iptables rule
      iptables:
        table: nat
        chain: POSTROUTING
        jump: MASQUERADE
        state: absent
