
- name: Test ec2_vol incorrect failure
  hosts: all
  gather_facts: false
  tasks:
  - name: Create error scenario
    ec2_vol:
      instance: "{{ hostvars['node3']['ansible_default_ipv4']['address'] }}"
      device_name: /dev/not_exist_drive
      region: "{{ ['us-west-1', 'us-east-1', 'ap-northeast-1'] | random }}"
      volume_size: "0"
      state: "{{ ['absent', 'attached', 'detached'] | random }}"
    become: true
    ignore_errors: true
    register: ec2_vol_result

  - name: Display error message
    debug:
      var: ec2_vol_result.msg
