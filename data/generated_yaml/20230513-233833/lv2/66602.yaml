yaml
---
- hosts: windows
  gather_facts: no

  tasks:
  - name: adding xml fragment
    win_shell: |
        $doc = [xml] (Get-Content "C:\file.xml")
        $newNode = $doc.CreateElement("Node")
        $newNode.SetAttribute("Attribute", "Value")
        $doc.DocumentElement.AppendChild($newNode)
        $doc.Save("C:\file.xml")
    register: result
    ignore_errors: true

  - debug:
      var: result
