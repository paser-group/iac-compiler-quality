
---
- name: Test playbook for ec2_group and multiple 'default' groups
  hosts: all
  gather_facts: no

  vars:
    groups:
      - default
      - default
      - custom

  tasks:
    - name: Add multiple 'default' groups to ec2_group
      ec2_group:
        name: "{{ item }}"
        region: us-west-1
        rules:
          - proto: tcp
            from_port: 80
            to_port: 80
            cidr_ip: 10.1.1.0/24
          - proto: tcp
            from_port: -1
            to_port: 22
            cidr_ip: "{{ item }}"
      with_items: "{{ groups }}"
