
---
- name: Shell module negative exit code segfault test playbook
  hosts: all
  gather_facts: no

  tasks:
  - name: Running a shell command with segfault to produce negative exit code '-11'
    shell: 'segfault && echo "Success!"'
    register: result
    ignore_errors: yes

  - name: Displaying segfault output
    debug:
      var: result.stdout_lines

  - name: Printing exit code
    debug:
      var: result.rc

  - name: Running a shell command with exit code restricted to positive integers
    shell: 'false; exit 252'
    register: result
    ignore_errors: yes

  - name: Displaying restricted exit code output
    debug:
      var: result.stdout_lines

  - name: Printing exit code
    debug:
      var: result.rc

  - name: Running a shell command with unexpected input
    shell: '{{ invalid_command }}'
    register: result
    ignore_errors: yes

  - name: Displaying unexpected input output
    debug:
      var: result.stdout_lines

  - name: Printing exit code
    debug:
      var: result.rc
