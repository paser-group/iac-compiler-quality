
- name: Attempt to DescribeVpcEndpoints and expect RequestLimitExceeded error
  hosts: node1
  gather_facts: no
  tasks:
    - name: DescribeVpcEndpoints Operation - RequestLimitExceeded Error Case 1
      ec2_vpc_endpoint_info:
        region: us-west-1
        vpc_endpoint_ids:
          - 'vpce-1234567890abcdef0'
          - 'vpce-0987654321fedcba0'
          - 'vpce-1357924680abcdef0'
          - 'vpce-2468013579fedcba0'
        aws_access_key: INVALID_ACCESS_KEY
        aws_secret_key: INVALID_SECRET_KEY
      register: endpoint_info_output
      ignore_errors: yes

    - name: DescribeVpcEndpoints Operation - RequestLimitExceeded Error Case 2
      ec2_vpc_endpoint_info:
        region: us-west-1
        vpc_endpoint_ids:
          - 'vpce-1234567890abcdef0'
          - 'vpce-0987654321fedcba0'
          - 'vpce-1357924680abcdef0'
          - 'vpce-2468013579fedcba0'
        aws_access_key: '{{ aws_access_key_var }}'
        aws_secret_key: '{{ aws_secret_key_var }}'
      register: endpoint_info_output
      ignore_errors: yes

    - name: DescribeVpcEndpoints Operation - RequestLimitExceeded Error Case 3
      ec2_vpc_endpoint_info:
        region: '[INVALID_REGION_US_X]'
        vpc_endpoint_ids:
          - 'vpce-1234567890abcdef0'
          - 'vpce-0987654321fedcba0'
          - 'vpce-1357924680abcdef0'
          - 'vpce-2468013579fedcba0'
        aws_access_key: '{{ aws_access_key_var }}'
        aws_secret_key: '{{ aws_secret_key_var }}'
      register: endpoint_info_output
      ignore_errors: yes

    - name: DescribeVpcEndpoints Operation - RequestLimitExceeded Error Case 4
      ec2_vpc_endpoint_info:
        region: '{{ region_var }}'
        vpc_endpoint_ids: 'vpce-INVALID-IDS'
        aws_access_key: '{{ aws_access_key_var }}'
        aws_secret_key: '{{ aws_secret_key_var }}'
      register: endpoint_info_output
      ignore_errors: yes

    - name: DescribeVpcEndpoints Operation - RequestLimitExceeded Error Case 5
      ec2_vpc_endpoint_info:
        region: '{{ region_var }}'
        vpc_endpoint_ids:
          - 'vpce-1234567890abcdef0'
          - 'vpce-0987654321fedcba0'
          - 'vpce-1357924680abcdef0'
          - 'vpce-2468013579fedcba0'
        filters: '{{ invalid_filter_var }}'
        aws_access_key: '{{ aws_access_key_var }}'
        aws_secret_key: '{{ aws_secret_key_var }}'
      register: endpoint_info_output
      ignore_errors: yes

    - name: Print endpoint_info_output variable
      debug:
        var: endpoint_info_output
