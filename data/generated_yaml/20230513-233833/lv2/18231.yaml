
- name: Install Ansible via setup.py
  hosts: all
  gather_facts: no
  tasks:
    - name: Clone Ansible repository
      git:
        repo: https://github.com/ansible/ansible.git
        dest: /opt/ansible

    - name: Install setuptools version 42.0.2
      command: pip install setuptools==42.0.2

    - name: Install Ansible via setup.py
      command: python /opt/ansible/setup.py install
      ignore_errors: yes

    - name: Install setuptools version 50.0.0
      command: pip install setuptools==50.0.0

    - name: Install Ansible via setup.py
      command: python /opt/ansible/setup.py install
      ignore_errors: yes
