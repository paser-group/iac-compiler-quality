
- name: AWX Templating Error Playbook
  hosts: all
  gather_facts: no

  vars:
    variable1: "{{ 'hello' }}"
    variable2: ~
    variable3: "{{ [1, '2', 3] }}"
    variable4: "{{ inside }}"
    variable5: "{{ omit }}"

  tasks:
    - name: Set Fact Using Template Variable
      set_fact:
        var1: "{{ variable1 }}"
        var2: "{{ variable2 }}"
        var3: "{{ variable3 }}"
        var4: "{{ variable4 }}"
        var5: "{{ variable5 }}"

    - name: Fail if Variable 4 or 5 are not Defined
      fail:
        msg: "One or both of 'variable4' and 'variable5' are not defined"
      when:
        - variable4 is not defined
        - variable5 is not defined

    - name: Display All Variables
      debug:
        msg: "{{ item }} = {{ vars[item] }}"
      loop: "{{ vars.keys() }}"
