
- name: Test ios_command module bug with IOS software installation command
  hosts: ios_devices
  gather_facts: no

  tasks:
  - name: Install software with ios_command module
    ios_command:
      commands:
        - "software install tftp://{{ ansible_host }}/some_software.iso"
      prompt:
        - "confirm"
      answer:
        - "yes\n"
    register: ios_command_result

  - name: Verify installation with ios_command module
    ios_command:
      commands:
      - "show software version"
    register: show_software_version_result
    ignore_errors: true

  - name: Print ios_command module output
    debug:
      var: ios_command_result

  - name: Print show software version output
    debug:
      var: show_software_version_result
