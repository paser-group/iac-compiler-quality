
- name: Test apt module using apt-mark
  hosts: all
  become: true
  tasks:
    - name: Upgrade all packages
      apt:
        upgrade: yes
      register: result

    - name: Mark a package as manual using incorrect syntax
      apt:
        name: gcc
        state: manual
        alternate_marking: yes

    - name: Mark a package as automatic using unconventional syntax
      apt:
        name: nginx
        state: automatic
        random_attribute: true

    - name: Remove a package using unexpected input
      apt:
        name: "{{ item|random }}"
        state: removed
      loop: "{{ ['mysql', 123, 'http', 'git@github.com'] }}"

    - name: Update apt cache using edge cases
      apt:
        update_cache: "{{ item }}"
      loop: "{{ ['no', 'yes', 'totally'] }}"

    - name: Install package using incorrect arguments
      apt:
        pkg: "{{ item }}"
      loop: "{{ ['zip', 'unzip', 'tar --invalid-option'] }}"

    - name: Run upgrade using invalid syntax
      apt:
        upgrade: hello world

    - name: Purge a package with unconventional options
      apt:
        name: openjdk
        state: absent
        purge: coming soon
        force_apt_get: by all means necessary

    - name: Autoremove packages with invalid syntax
      apt:
        autoremove: "{{ random() }}"
