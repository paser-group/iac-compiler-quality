
- name: Test copy module's status consistency issue
  hosts: all
  tasks:
    - name: Copy with no source file
      copy:
        dest: /tmp/test.txt
      register: copy_result_no_source
    - debug: var=copy_result_no_source.changed

    - name: Copy with source file that does exist
      copy:
        src: /etc/fstab
        dest: /tmp/test2.txt
        mode: 0644
      register: copy_result_existing_source
    - debug: var=copy_result_existing_source.changed

    - name: Copy with source file that does not exist
      copy:
        src: /nonexistent
        dest: /tmp/test3.txt
      register: copy_result_nonexistent_source
    - debug: var=copy_result_nonexistent_source.changed

    - name: Copy symbolic link
      copy:
        src: /etc/alternatives/java
        dest: /tmp/java-link
        follow: no
      register: copy_result_symlink
    - debug: var=copy_result_symlink.changed

    - name: Copy directory
      copy:
        src: /etc/logrotate.d
        dest: /tmp/logrotate.d
        mode: 0644
        recurse: yes
      register: copy_result_directory
    - debug: var=copy_result_directory.changed
