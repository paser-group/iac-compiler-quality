
---
- name: Test handlers issue 37512
  hosts: all
  gather_facts: false
  tasks:
    - name: Create a file with content
      blockinfile:
        path: /tmp/test.txt
        block: |
          {% if foo is defined %}
          this is {{ foo }}
          {% endif %}
      delegate_to: "{{ item }}"
      with_items:
        - node1
        - node2
        - node3
    handlers:
      - name: restart_foo
        debug:
          msg: "restart {{foo}}"
      - name: restart_bar
        debug:
          msg: "restart {{bar}}"
      - name: restart_baz
        debug:
          msg: "restart {{baz}}"
