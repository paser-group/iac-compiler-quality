
- name: Test ansible_processor_vcpus fact 
  hosts: all
  tasks:
    - name: Display ansible_processor_vcpus fact 
      debug: 
        msg: "{{ ansible_processor_vcpus }}"
    
    - name: Set ansible_processor_vcpus fact to unconventional value
      set_fact:
        ansible_processor_vcpus: "invalid"
    
    - name: Check if ansible_processor_vcpus contains a string
      debug:
        msg: "ansible_processor_vcpus contains a string"
      when: ansible_processor_vcpus is string
    
    - name: Check if ansible_processor_vcpus contains a number
      debug:
        msg: "ansible_processor_vcpus contains a number"
      when: ansible_processor_vcpus is number
    
    - name: Check if ansible_processor_vcpus contains an array
      debug:
        msg: "ansible_processor_vcpus contains an array"
      when: ansible_processor_vcpus is iterable and ansible_processor_vcpus is not string
    
    - name: Set ansible_processor_vcpus fact to null
      set_fact:
        ansible_processor_vcpus: null
    
    - name: Check if ansible_processor_vcpus is null
      debug:
        msg: "ansible_processor_vcpus is null"
      when: ansible_processor_vcpus is not defined or ansible_processor_vcpus is null
    
    - name: Check if ansible_processor_vcpus is not-null
      debug:
        msg: "ansible_processor_vcpus is not-null"
      when: ansible_processor_vcpus is defined and ansible_processor_vcpus is not null
    
    - name: Set ansible_processor_vcpus fact to unconventional syntax
      set_fact:
        ansible_processor_vcpus: "{{ ['value1', 'value2'] }}"
    
    - name: Display ansible_processor_vcpus fact 
      debug: 
        msg: "{{ ansible_processor_vcpus }}"
      
    - name: Check if ansible_processor_vcpus is an array with more than one element
      debug:
        msg: "ansible_processor_vcpus is an array with more than one element"
      when: ansible_processor_vcpus is iterable and ansible_processor_vcpus|length > 1
      
    - name: Check if ansible_processor_vcpus is an array with only one element
      debug:
        msg: "ansible_processor_vcpus is an array with only one element"
      when: ansible_processor_vcpus is iterable and ansible_processor_vcpus|length == 1
    
    - name: Set ansible_processor_vcpus fact to unexpected input
      set_fact:
        ansible_processor_vcpus: "{{ 1 / 0 }}"
      ignore_errors: true
    
    - name: Display ansible_processor_vcpus fact 
      debug: 
        msg: "{{ ansible_processor_vcpus }}"
      
    - name: Check if ansible_processor_vcpus results in an error
      debug:
        msg: "ansible_processor_vcpus results in an error"
      when: "'ZeroDivisionError' in ansible_failed_result.exception|default('')"
