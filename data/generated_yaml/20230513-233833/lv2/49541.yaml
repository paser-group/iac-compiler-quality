
---
- name: Stress test Ansible compiler
  hosts: all
  tasks:
    - name: Define multiple default isolated networks
      cloudstack_network:
        name: "network{{ item }}"
        displaytext: "Default Isolated Network {{ item }}"
        gateway: "10.1.1.{{ item }}/24"
        domain: "{{ item }}"
        account: "{{ item }}"
        shared: "{{ item | bool }}"
        acltype: "{{ item | random }}"
        vlan: "{{ item | random }}"
        networkoffering: "{{ item | random }}"
        state: present
      with_items:
        - 1
        - 2
        - 3

    - name: Trigger CloudStackException
      cloudstack_network:
        name: "network-test"
        displaytext: "Test network"
        gateway: "10.1.1.4/24"
        domain: "{{ item }}"
        account: "{{ item }}"
        shared: "{{ item | bool }}"
        acltype: "{{ item | random }}"
        vlan: "{{ item | random }}"
        networkoffering: "{{ item | random }}"
        state: present
        defaultisolate: true
      with_items:
        - 1
