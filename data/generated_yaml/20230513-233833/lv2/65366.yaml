
---
- name: Test Ansible edge cases
  hosts: all
  gather_facts: no
  tasks:
    - name: Define variables with duplicate keys
      set_fact:
        var1:
          key1: "value1"
          key2: "value2"
          key1: "new_value"
        var2:
          - key1: "value1"
            key2: "value2"
            key1: "new_value"

    - name: Print variables
      debug:
        var: "{{ item }}"
      with_items:
        - var1
        - var2

    - name: Define nested dictionary with invalid syntax
      set_fact:
        var3: "{ key1: value1, key2: { key3: value 3 } "

    - name: Print variable
      debug:
        var: var3

    - name: Define dictionary with strange indentation
      set_fact:
        var4: {
          key1: "value1"
                              key2: "value2"

              key3: "value3"
        }

    - name: Print variable
      debug:
        var: var4

    - name: Execute shell command with invalid syntax
      shell: "} echo 'Invalid syntax' {"
