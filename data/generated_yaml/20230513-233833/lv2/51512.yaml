
---
- name: Win_DSC PSCredential conversion error for DSC module xFailoverCluster xCluster resource Test Case
  hosts: all
  gather_facts: no
  tasks:
    - name: Create a PSCredential Object with invalid format
      win_domain_user:
        username: "myUser"
        password: "myPassword!"
      register: invalid_credential

    - name: Create a PSCredential Object with non-existing user
      win_domain_user:
        username: "nonExistingUser"
        password: "password"
      register: nonexistent_credential

    - name: Create xCluster Resource with invalid Credential object format
      win_xcluster:
        clusternodes:
          - nodename: "node1"
          - nodename: "node2"
        name: "MyCluster"
        credential: "{{ invalid_credential }}"

    - name: Create xCluster Resource with incorrect PSCredential format
      win_xcluster:
        clusternodes:
          - nodename: "node1"
          - nodename: "node2"
        name: "MyCluster"
        credential:
          password: "myPassword"
          user: "myUser"

    - name: Create xCluster Resource with non-existing user credential
      win_xcluster:
        clusternodes:
          - nodename: "node1"
          - nodename: "node2"
        name: "MyCluster"
        credential: "{{ nonexistent_credential }}"
