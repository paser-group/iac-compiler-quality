
- name: Test nxos_igmp_interface
  hosts: all
  gather_facts: no

  tasks:
    - name: Ensure default values are applied
      nxos_igmp_interface:
        name: "{{ item }}"
        version: "{{ [1, 2] }}"
        state: present
      with_items:
        - 1/1
        - "Ethernet1/1"
        - "eth1/1"
        - "e1/1"
        - "ethernet1/1"
        - "Ethernet 1/1"
        - "eth 1/1"
        - "Ethernet1/1:1"
        - "eth1/1:1"
        - "e1/1:1"
        - "ethernet1/1:1"
        - "Ethernet 1/1:1"
        - "eth 1/1:1"
        - "{{ '1/1;2/1' }}"

    - name: Ensure applying default values is idempotent
      nxos_igmp_interface:
        name: "{{ item }}"
        version: 1
        state: present
      with_items:
        - 1/1
        - "Ethernet1/1"

    - name: Ensure errors are raised with unconventional syntax
      nxos_igmp_interface:
        name: "{{ item }}"
        version: "{{ [1, 2] }}"
        state: present
      with_items:
        - "aggr1"
        - "lo1"
        - "svi1"
        - "po1"
        - "loopback1"
        - "vlan1"
        - "loopback 1"
        - "eth1"
        - "{{ '3/1' }}"
