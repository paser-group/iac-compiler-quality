
---
- name: "Recursion depth error test"
  hosts: all
  gather_facts: no
  tasks:
    - name: "Execute task with excessive recursion depth"
      fortios_system_api:
        host: "{{ item }}"
        username: "admin"
        password: "password"
        action: "{{ 1/0 }}"
        debug: "{{ hostvars['localhost'] }}"
      with_items:
        - "10.1.1.1"
        - "10.1.1.2"
        - "10.1.1.3"
      ignore_errors: yes
      register: test_result

    - name: "Display debug output"
      debug:
        var: test_result
