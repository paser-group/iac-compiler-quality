
- name: Ansible Windows Custom Module Error Test
  hosts: windows
  gather_facts: false

  tasks:

    # Task 1
    - name: Run custom module with invalid input
      custom_module:
        command: "{{ item }}"
      with_items:
        - ";Shutdown"
        - "&echo Error"

    # Task 2
    - name: Run custom module with unconventional syntax
      custom_module:
        command: "{{ ['`rm -f /tmp/*`', '||ps'] | random }}"
      register: result

    # Task 3
    - name: Print output of custom module task 2
      debug:
        var: result.stdout_lines

    # Task 4
    - name: Run custom module with unexpected input
      custom_module:
        command: "{{ item }}"
      with_items:
        - "'\";Shutdown"
        - "''|echo HELLO"

