
---
- name: Azure_rm error test playbook
  hosts: node1
  gather_facts: false

  tasks:
    - name: Install Azure Python SDK
      pip:
        name: azure
        state: present
      register: azure_pip

    - name: Check Azure Python SDK installation status
      debug:
        msg: "{{ azure_pip }}"
      when: azure_pip.changed

    - name: Gather Azure facts
      azure_rm:
        client_secret: 'dummy_secret'
        tenant_id: 'dummy_tenant'
        client_id: 'dummy_client'
        subscription_id: 'dummy_subscription'
        resource_group: 'dummy_resource_group'
        name: 'dummy_vm'
      register: azure_vm

    - name: Debug Azure facts
      debug:
        msg: "{{ azure_vm }}"
