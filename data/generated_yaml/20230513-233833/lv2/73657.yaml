yaml
---
- name: Playbook to test error handling
  hosts: all
  gather_facts: false

  tasks:
    - name: Block with rescue
      block:
        - name: Task to succeed
          shell: echo "Task succeeded"
      rescue:
        - name: Task to fail with unexpected input
          shell: echo $$
          register: result
        - name: Task to fail with unknown variable
          shell: echo "{{ unknown_variable }}"
          ignore_errors: true
        - name: Task to fail with unconventional syntax
          shell: echo "$("
        - name: Task to succeed after previous failure
          shell: echo "Task succeeded"
      always:
        - name: Task to always succeed
          shell: echo "Task succeeded"
