
- name: Test ansible-galaxy timeout error
  hosts: all
  gather_facts: false

  tasks:
    - name: Run ansible-galaxy with timeout
      command: >
        ansible-galaxy install --force --timeout 3
        {{ [
          "https://galaxy.ansible.com/cloudalchemy/ansible-prometheus-alertmanager",
          "https://galaxy.ansible.com/cloudalchemy/ansible-grafana",
          "https://galaxy.ansible.com/doppioandante/nginx",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-cron",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-drupal",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-mysql",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-nginx",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-php",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-postgresql",
          "https://galaxy.ansible.com/geerlingguy/ansible-role-security",
          "https://galaxy.ansible.com/geerlingguy/drupal-vm",
          "https://galaxy.ansible.com/pix-art/nginx-php-fpm",
          "https://galaxy.ansible.com/robertdebock/ansible-role-ntp",
          "https://galaxy.ansible.com/robertdebock/ansible-role-shell",
          "https://galaxy.ansible.com/robertdebock/ansible-role-unattended-upgrades",
          "https://galaxy.ansible.com/willshersystems/openssl_magic",
          "https://galaxy.ansible.com/yatesr.timezone",
          "https://galaxy.ansible.com/yatesr.users",
          "https://galaxy.ansible.com/yumiod/docker-compose",
          "https://galaxy.ansible.com/yumiod/gce_metadata",
          "https://galaxy.ansible.com/yumiod/gsutil",
          "https://galaxy.ansible.com/zcalusic/nginx",
          ] | join(' ') }}
      register: result
      ignore_errors: true

    - name: Debug result
      debug:
        var: result.stdout
