
---
- name: Test ec2_elb module for errors
  hosts: localhost
  connection: local
  gather_facts: no

  tasks:
  - name: Create a Classic Load Balancer with initial_state
    ec2_elb:
      state: present
      ec2_elb_name: "{{ item.name }}"
      listeners:
        - protocol: http
          load_balancer_port: 80
          instance_port: 80
      zones:
        - "{{ item.zone }}"
      initial_state: "{{ item.state }}"
    with_items:
      - { name: "test-loadbalancer-1", zone: "us-west-2a", state: true }
      - { name: "test-loadbalancer-2", zone: "us-west-2b", state: false }
      - { name: "test-loadbalancer-3", zone: "us-west-2c", state: "stopped" }
      - { name: "test-loadbalancer-4", zone: "us-west-2d", state: 123 }

  - name: Update a Classic Load Balancer with initial_state
    ec2_elb:
      state: present
      ec2_elb_name: "{{ item.name }}"
      listeners:
        - protocol: http
          load_balancer_port: 80
          instance_port: 80
      zones:
        - "{{ item.zone }}"
      initial_state: "{{ item.state }}"
    with_items:
      - { name: "test-loadbalancer-1", zone: "us-west-2a", state: true }
      - { name: "test-loadbalancer-2", zone: "us-west-2b", state: false }
      - { name: "test-loadbalancer-3", zone: "us-west-2c", state: "stopped" }
      - { name: "test-loadbalancer-4", zone: "us-west-2d", state: 123 }
