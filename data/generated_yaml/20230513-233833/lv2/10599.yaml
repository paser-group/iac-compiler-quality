
- name: Test playbook for [bug:fireball] cannot execute any modules
  hosts: all
  become: yes
  gather_facts: no

  tasks:

  - name: Run a module without specifying user/password
    shell: ansible all -m ping
    register: output
    ignore_errors: yes

  - name: Output the registered variable
    debug:
      var: output

  - name: Try to run a module with an invalid credential
    shell: ansible all -m ping -u invalid-user -k
    register: output
    ignore_errors: yes

  - name: Output the registered variable
    debug:
      var: output

  - name: Try to execute a module without specifying inventory
    shell: ansible -m ping
    register: output
    ignore_errors: yes

  - name: Output the registered variable
    debug:
      var: output

  - name: Try to execute a module with a non-existent inventory file
    shell: ansible all -m ping -i non-existent-inventory.ini
    register: output
    ignore_errors: yes

  - name: Output the registered variable
    debug:
      var: output

  - name: Try executing a non-existent module
    shell: ansible all -m non-existent-module
    register: output
    ignore_errors: yes

  - name: Output the registered variable
    debug:
      var: output
