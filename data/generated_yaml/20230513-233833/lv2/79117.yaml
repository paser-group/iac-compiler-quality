
- name: Ansible Default IPv4 Test Playbook
  hosts: all
  gather_facts: yes
  
  tasks:
    - name: Display default IPv4 address for each node
      debug:
        var: ansible_default_ipv4.address

    - name: Set default IPv4 address to a non-existent address for each node
      set_fact:
        ansible_default_ipv4:
          address: "192.168.0.100"
          interface: "{{ ansible_default_ipv4.interface }}"
          macaddress: "{{ ansible_default_ipv4.macaddress }}"

    - name: Display updated default IPv4 address for each node
      debug:
        var: ansible_default_ipv4.address

    - name: Ping each node using updated default IPv4 address
      ping:
        data: "Testing connectivity using updated default IPv4 address"
      register: ping_result
      retries: 10
      delay: 5
      
    - name: Display ping results for each node
      debug:
        var: ping_result
      
    - name: Remove default IPv4 address for each node
      set_fact:
        ansible_default_ipv4: {}

    - name: Display removed default IPv4 address for each node
      debug:
        var: ansible_default_ipv4.address

    - name: Ping each node using removed default IPv4 address
      ping:
        data: "Testing connectivity using removed default IPv4 address"
      register: ping_result
      retries: 10
      delay: 5
      
    - name: Display ping results for each node
      debug:
        var: ping_result
