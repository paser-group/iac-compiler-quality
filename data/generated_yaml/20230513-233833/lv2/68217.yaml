
- name: ec2_group VPC issue testing playbook
  hosts: node1
  gather_facts: no
  tasks:
    - name: Testing VPC group creation
      ec2_group:
        name: test-group
        description: Test group for VPC
        vpc_id: vpc-0123456789
        rules:
          - proto: tcp
            from_port: 22
            to_port: 22
            cidr_ip:
              - 10.1.1.0/24
              - 10.2.2.0/24
              - 10.3.3.0/24
      register: out
    - name: Print result
      debug:
        var: out
    - name: Testing VPC security group rule modification
      ec2_group:
        name: test-group
        rules:
          - proto: all
            from_port: 0
            to_port: 65535
            cidr_ip: 192.168.1.0/24
          - proto: tcp
            from_port: 22
            to_port: 22
            group_id: sg-0123456789
            group_name: test-group-1
      register: out
    - name: Print result
      debug:
        var: out
