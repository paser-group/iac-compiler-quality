
---
- name: Test playbook for nxos nxapi SSL
  hosts: all
  gather_facts: no
  
  vars:
    ssl_port: 443
    non_ssl_port: 80
  
  tasks:
  
    - name: Test case 1 - SSL enabled and port set to non-standard value
      nxos_command:
        command_string: "show version"
        use_ssl: yes
        port: "{{ non_ssl_port }}"
      ignore_errors: yes
  
    - name: Test case 2 - SSL disabled and port set to SSL standard value
      nxos_command:
        command_string: "show running-config interfaces"
        use_ssl: no
        port: "{{ ssl_port }}"
  
    - name: Test case 3 - Invalid value for port
      nxos_command:
        command_string: "show hostname"
        use_ssl: yes
        port: "invalid_value"
  
    - name: Test case 4 - SSL enabled with invalid certificate
      nxos_command:
        command_string: "show ip routes"
        use_ssl: yes
        port: "{{ ssl_port }}"
        validate_certs: no
  
    - name: Test case 5 - SSL enabled with valid certificate but expired
      nxos_command:
        command_string: "show cdp neighbors"
        use_ssl: yes
        port: "{{ ssl_port }}"
        validate_certs: yes
        ssl_cert_file: "/path/to/expired_cert.pem"
  
    - name: Test case 6 - Non-SSL connection and invalid hostname
      nxos_command:
        command_string: "show version"
        use_ssl: no
        port: "{{ non_ssl_port }}"
        host: "invalid_hostname"
  
    - name: Test case 7 - SSL connection with trailing slash in URL
      nxos_command:
        command_string: "show version"
        use_ssl: yes
        port: "{{ ssl_port }}"
        url: "/some/path/to/api/"
