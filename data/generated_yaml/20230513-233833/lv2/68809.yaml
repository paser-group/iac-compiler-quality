
- name: SSL issue running fortios_firewall_adress
  hosts: all
  vars:
    node1_cert: "/etc/ssl/certs/node1.crt"
    node1_key: "/etc/ssl/private/node1.key"
    invalid_cert: "/etc/ssl/certs/invalid.crt"
    invalid_key: "/etc/ssl/private/invalid.key"
  tasks:
    - name: Ensure valid SSL certs and keys
      fortios_firewall_adress:
        name: node1
        address: 10.1.1.1
        state: present
        schema: 'https'
        https_options:
          cert: "{{ node1_cert }}"
          key: "{{ node1_key }}"
          validate_certs: yes

    - name: Ensure invalid SSL certs and keys
      fortios_firewall_adress:
        name: node2
        address: 10.1.1.2
        state: present
        schema: 'https'
        https_options:
          cert: "{{ invalid_cert }}"
          key: "{{ invalid_key }}"
          validate_certs: no

    - name: Ensure invalid SSL schema
      fortios_firewall_adress:
        name: node3
        address: 10.1.1.3
        state: present
        schema: 'invalid-ssl-schema'
        https_options:
          validate_certs: yes

    - name: Ensure invalid SSL options
      fortios_firewall_adress:
        name: node4
        address: 10.1.1.4
        state: present
        schema: 'https'
        https_options: "{{ invalid_ssl_options }}"
