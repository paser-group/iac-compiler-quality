
- name: AWS ASG Module Bug Report
  hosts: localhost
  gather_facts: false
  vars:
    asg_name: "test-asg"
    min_instances: 0
    max_instances: 100
  tasks:
    - name: Test ASG Module with 'wait_for_instances: foo'
      ec2_asg:
        name: "{{ asg_name }}"
        min_size: "{{ min_instances }}"
        max_size: "{{ max_instances }}"
        wait_for_instances: "foo"
      register: asg_foo_error
      ignore_errors: true
      
    - name: Test ASG Module with 'wait_for_instances: 123'
      ec2_asg:
        name: "{{ asg_name }}"
        min_size: "{{ min_instances }}"
        max_size: "{{ max_instances }}"
        wait_for_instances: 123
      register: asg_int_error
      ignore_errors: true
      
    - name: Test ASG Module with 'wait_for_instances: [foo]'
      ec2_asg:
        name: "{{ asg_name }}"
        min_size: "{{ min_instances }}"
        max_size: "{{ max_instances }}"
        wait_for_instances: "[foo]"
      register: asg_list_error
      ignore_errors: true
      
    - name: Test ASG Module with 'wait_for_instances: true'
      ec2_asg:
        name: "{{ asg_name }}"
        min_size: "{{ min_instances }}"
        max_size: "{{ max_instances }}"
        wait_for_instances: true
      register: asg_true      
      ignore_errors: true
      
    - name: Test ASG Module with 'wait_for_instances: false'
      ec2_asg:
        name: "{{ asg_name }}"
        min_size: "{{ min_instances }}"
        max_size: "{{ max_instances }}"
        wait_for_instances: false
      register: asg_false     
      ignore_errors: true
      
    - name: Print debug information for failed tasks
      debug:
        var: item
      with_items:
        - asg_foo_error
        - asg_int_error
        - asg_list_error
        
