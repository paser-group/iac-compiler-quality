
---
- name: Test ec2_lc Module
  hosts: all

  vars:
    aws_region: us-west-1

  tasks:
    - name: Create Launch Configuration with Instance Profile Name
      ec2_lc:
        name: test-launch-config
        image_id: ami-0c94855ba95c71c99
        instance_type: t2.micro
        key_name: mykeypair
        security_groups: ['sg-0123456789abcdef', 'sg-9876543210fedcba']
        block_device_mappings: ['/dev/sda1=:25:true']
        user_data: |
          #!/bin/bash
          echo "This is user data script."
        InstanceProfileName: ec2-instance-profile

    - name: Create Launch Configuration with Invalid Parameter
      ec2_lc:
        name: test-launch-config
        image_id: ami-0c94855ba95c71c99
        instance_type: t2.micro
        key_name: mykeypair
        security_groups: ['sg-0123456789abcdef', 'sg-9876543210fedcba']
        block_device_mappings: ['/dev/sda1=:25:true']
        user_data: |
          #!/bin/bash
          echo "This is user data script."
        InvalidParameter: test

    - name: Delete Launch Configuration
      ec2_lc:
        name: test-launch-config
        state: absent
