
---

- name: Stress test playbook for vmware_guest reboot error
  hosts: node1
  
  tasks:
  
  - name: Install package with unconventional syntax
    apt:
      pkg: "-unconventional-syntax"
      
  - name: Create edge case directory
    file:
      path: "/< || >/?':'*/edge-case-dir"
      state: directory
      
  - name: Generate unexpected input file
    copy:
      dest: "/unexpected-input-file?"
      content: "This is unexpected input."
      
  - name: Delete non-existent directory
    file:
      path: "/non-existent-dir"
      state: absent
      
  - name: Attempt to reboot VM
    vmware_guest:
      hostname: "{{ ansible_host }}"
      username: "{{ vmware_user }}"
      password: "{{ vmware_password }}"
      validate_certs: no
      name: "vm-name"
      os_type: "{{ os_type | default ('Other') }}"
      state: restarted
      esxi_hostname: "{{ esxi_hostname }}"
      cdrom: "{{ cdrom }}"
      
  - name: Execute command with edge case syntax
    shell: "echo 'Hello || World' ; 'Ping &.com'"
    
  - name: Delete unexpected input file with unconventional syntax
    file:
      path: "'/unexpected-input-file?';rm -rf /'"
      state: absent
      
  - name: Attempt to ping non-existent host
    ping:
      data: "<<<''''>>>""""|| !\"'8787"
      
  - name: Clean up edge case directory with unconventional syntax
    file:
      path: "/< || >/?':'*/edge-case-dir/;rm -rf /"
      state: absent
