
- name: Test playbook for 'vars_prompt' issue
  hosts: all
  gather_facts: no
  vars_prompt:
    - name: invalid_input
      prompt: "Enter an invalid input: "
      invalid_var: true
    - name: unconventional_input
      prompt: "Enter an unconventional input: "
      default: "{{ hostname | lower }}"
      vars:
        - hostname: "{{ inventory_hostname }}"
      when: inventory_hostname == 'node2'
    - name: nested_input
      prompt: "Enter a nested input: "
      default: "{ { invalid_token }}"
      vars:
        - invalid_token: "{{ invalid_token | random }}"
  tasks:
    - name: Print invalid_input value
      debug:
        var: invalid_input
    - name: Print unconventional_input value
      debug:
        var: unconventional_input
    - name: Print nested_input value
      debug:
        var: nested_input
