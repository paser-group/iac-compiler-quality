yaml
---
- name: Test set_fact and run_once
  hosts: all
  vars:
    foo: "{{ [1,2,3]|random }}"
  tasks:
    - name: Set fact with run_once and unconventional syntax
      set_fact: "foo{{item}}": "{{ foo }}"
      run_once: true
      with_items:
        - ""
        - " "
        - "-"
        - "-"
        - "{{foo:bar}}"
        - "{{{foo:bar}}}"
        - "{{foo|join('')|last}}"
        - "{{foo[{foo|length//2}]}}"
        - "[{{foo}}]"
        - "{{[]|random}}"

    - name: Print set_fact results
      debug:
        var: "foo{{item}}"
      with_items:
        - ""
        - " "
        - "-"
        - "-"
        - "{{foo:bar}}"
        - "{{{foo:bar}}}"
        - "{{foo|join('')|last}}"
        - "{{foo[{foo|length//2}]}}"
        - "[{{foo}}]"
        - "{{[]|random}}"
