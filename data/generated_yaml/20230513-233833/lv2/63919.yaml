
---
- name: lineinfile edge case playbook
  hosts: all
  gather_facts: no

  tasks:
    - name: create directory for file
      file:
        path: '/tmp/test'
        state: directory

    - name: create file without path
      lineinfile:
        dest: '/tmp/test/file.txt'
        create: yes
        line: 'test'

    - name: create file with unconventional syntax
      lineinfile:
        dest: '/tmp/test/file.txt'
        regexp: '\w+\s+\d{4}'
        insertafter: 'date:'
        line: 'Oct 2021'

    - name: create file with unexpected input
      lineinfile:
        dest: /tmp/test/file.txt
        regexp: '(\d)+'
        line: '"foo": 123, "bar": 456'

    - name: create file with duplicate lines
      lineinfile:
        dest: '/tmp/test/file.txt'
        state: present
        line: 'test'
