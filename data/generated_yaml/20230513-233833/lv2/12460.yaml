
---
- name: Test Playbook for Roles breaking change issue
  hosts: all
  become: true

  roles:
    - { role: myrole }
    - { role: myrole, myvar: "value1" }
    - { role: myrole, myvar: "value2" }

  tasks:
    - name: Run a command
      command: echo "Hello World!"

  handlers:
    - name: Restart Nginx
      service: name=nginx state=restarted

  vars:
    myvar: "{{ some_invalid_syntax }}

  pre_tasks:
    - set_fact: myfact="{{ some_invalid_var }}"
    - name: Check if file exists
      stat:
        path: /path/to/file

  post_tasks:
    - name: Create a file
      file:
        path: /path/to/file
        state: touch
        mode: 0644

  environment:
    VARIABLE: "{{ some_invalid_env_var }}"
    ANOTHER_VARIABLE: "{{ some_invalid_env_var }}"
