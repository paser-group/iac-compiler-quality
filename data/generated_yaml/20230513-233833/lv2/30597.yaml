
---
- name: Ansible 2.4 CallBackModule error?
  hosts: all
  gather_facts: no

  tasks:

  - name: Test CallBackModule with invalid syntax
    command: >
      echo "Invalid syntax" >> /dev/null
    register: result
    - callback_plugin:
        invalid_option: true
        another_invalid_option: false
    ignore_errors: yes

  - name: Test CallBackModule with invalid parameter type
    command: >
      echo "Invalid parameter type" >> /dev/null
    register: result
    - callback_plugin:
        some_parameter: !!str "invalid value"
    ignore_errors: yes

  - name: Test CallBackModule with missing parameter
    command: >
      echo "Missing parameter" >> /dev/null
    register: result
    - callback_plugin:
    ignore_errors: yes

  - name: Test CallBackModule with successful run
    command: >
      echo "Successful run" >> /dev/null
    register: result
    - callback_plugin:
        some_parameter: true
