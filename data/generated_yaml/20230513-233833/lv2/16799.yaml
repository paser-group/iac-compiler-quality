yaml
- name: Test playbook for custom module folders
  hosts: all
  gather_facts: no

  tasks:
    - name: Include custom module folders
      include_vars:
        file: "{{ inventory_dir }}/custom_modules.yml"

    - name: Execute custom module
      custom_module:
        arg1: "{{ item }}"
        arg2: "{{ hostvars[item].ansible_default_ipv4.address }}"
      with_items: "{{ groups['all'] }}"
