
- name: Test nxos_pim_rp_address
  hosts: all
  gather_facts: no
  
  tasks:
    - name: Define variables
      vars:
        intf: 'Ethernet1/1'
        rp_address: '{{ "\"'\"'\"'\"'127.0.0.1\"'\"'\"'\"'" }}'
        invalid_rp_address: '{{ 127.0.0.1 }}'
        ipv6_rp_address: '{{ \"[2001:db8:85a3::8a2e:370:7334]\" }}'
        invalid_ipv6_rp_address: '{{ \"2001:db8::1::1\" }}'
        invalid_int: 'Ethernet 2/1'
        
    - name: Configure rp_address on interface with IPv4 address
      nxos_pim_rp_address:
        interface: "{{ intf }}"
        rp_address: "{{ rp_address }}"
        
    - name: Configure rp_address on interface with invalid IPv4 address
      nxos_pim_rp_address:
        interface: "{{ intf }}"
        rp_address: "{{ invalid_rp_address }}"
        
    - name: Configure rp_address on interface with IPv6 address
      nxos_pim_rp_address:
        interface: "{{ intf }}"
        rp_address: "{{ ipv6_rp_address }}"
        
    - name: Configure rp_address on interface with invalid IPv6 address
      nxos_pim_rp_address:
        interface: "{{ intf }}"
        rp_address: "{{ invalid_ipv6_rp_address }}"
        
    - name: Configure rp_address on invalid interface
      nxos_pim_rp_address:
        interface: "{{ invalid_int }}"
        rp_address: "{{ rp_address }}"
        
    - name: Remove rp_address from interface
      nxos_pim_rp_address:
        interface: "{{ intf }}"
        state: absent
        
    - debug: var=ansible_module_stderr
