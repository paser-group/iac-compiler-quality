
- name: InfluxDB user stress test playbook
  hosts: node1
  gather_facts: no

  tasks:
  - name: Create user with unspecified password
    influxdb_user:
      name: john
      state: present

  - name: Create user with default password
    influxdb_user:
      name: jane
      password: default
      state: present

  - name: Remove user with unspecified password
    influxdb_user:
      name: jim
      state: absent

  - name: Remove user with default password
    influxdb_user:
      name: jessica
      password: default
      state: absent

  - name: Test invalid syntax #1
    influxdb_user:
      name: jack
      state: present
      pas: "sword"

  - name: Test invalid syntax #2
    influxdb_user: "name=jill password='' state=present"

  - name: Test unexpected inputs #1
    influxdb_user:
      name: {{ foo | mandatory }}
      password: "{{ bar if baz else '' }}"
      state: "{{ 'present' if qux == 'yes' else 'absent' }}"

  - name: Test unexpected inputs #2
    influxdb_user:
      name: ["john", "jane"]
      password: ["password1", "password2"]
      state: ["present", "absent"]
