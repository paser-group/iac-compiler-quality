
- name: Test include_role module
  hosts: all
  tasks:
    - name: Include role with static defaults
      include_role:
        name: my_role
      vars:
        my_var: "Static Value"
      static: yes
      static_var_prefix: "unexpected"
      when: ansible_hostname == "node1"
      
    - name: Include role with templated defaults
      include_role:
        name: my_role
      vars:
        my_var: "Dynamic Value"
      when: ansible_hostname == "node2"

- name: second play
  hosts: all
  tasks:
  - name: Include role with missing required variables
    include_role:
      name: my_role
    static: yes
    static_var_prefix: "unexpected"
    when: ansible_hostname == "node3"
