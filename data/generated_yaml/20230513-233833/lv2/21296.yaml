
---
- name: "Test UFW Path"
  hosts: all
  become: TRUE

  tasks:
  - name: "Check if UFW path is correct"
    command: 'ufw --dry-run allow from 10.1.1.2 port 22'
    register: ufw_output

  - name: "Display output"
    debug:
      var: ufw_output.stdout

  - name: "Change UFW path to incorrect"
    command: 'ufw --dry-run deny from 10.1.1.2 port 22'
    ignore_errors: yes

  - name: "Check if UFW path is incorrect"
    command: 'ufw --dry-run allow from 10.1.1.2 port 22'
    register: ufw_output_incorrect

  - name: "Display output"
    debug:
      var: ufw_output_incorrect.stdout

  - name: "Change UFW path to correct"
    command: 'ufw --dry-run allow from 10.1.1.2 port 22'
    ignore_errors: yes

  - name: "Check if UFW path is correct again"
    command: 'ufw --dry-run allow from 10.1.1.2 port 22'
    register: ufw_output_correct

  - name: "Display output"
    debug:
      var: ufw_output_correct.stdout

  - name: "Testing negative number input"
    command: 'ufw --dry-run allow from -10.1.1.2 port 22'

  - name: "Testing unconventional syntax"
    command: 'ufw --dry-run allow from 10.1.1.2 /&$@##^(&%%$'

  - name: "Testing unexpected input"
    command: 'ufw --dry-run allow from unexpected-port'
