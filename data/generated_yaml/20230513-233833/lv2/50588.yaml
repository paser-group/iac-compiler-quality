
- name: Test win_reboot module
  hosts: all
  gather_facts: no
  vars:
    reboot_time: "{{ range(1, 10) | random }}"
  tasks:
    - name: Reboot Windows machines
      win_reboot:
        timeout: "{{ 60 * reboot_time }}"
        msg: Testing win_reboot module with timeout of {{ 60 * reboot_time }} seconds
        winrm_retry_timeout: "{{ range(1, 5) | random }}"
        force: "{{ [True, False] | random }}"
        msg_needs_reboot: "{{ ['reboot required', 'pending restart', 'needs to restart', 'system requirements still need attention'] | random }}"
        reg_key: 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager'
        reg_value: 'PendingFileRenameOperations'
        reg_type: dword
        reg_data: 00000000
