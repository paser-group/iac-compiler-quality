yaml
---

- name: Stress-test Ansible compiler for subprocess run ansible shell error
  hosts: all
  gather_facts: false

  tasks:

    - name: Run a shell command with incorrect syntax
      shell: {{ %&^*() }}
      register: shell_output
      ignore_errors: true

    - name: Attempt to execute a non-existent command
      command: /non/existent/command

    - name: Execute a command with a long output
      command: echo "This is a long output" * 1000

    - name: Attempt to access a non-existent variable
      command: echo "{{ non_existent_variable }}"

    - name: Execute a command that takes a long time
      command: sleep 60

    - name: Attempt to access a nonexistent file
      stat:
        path: /non/existent/file.txt

    - name: Execute a command as a non-existent user
      become: true
      become_user: non_existent_user
      shell: whoami

    - name: Execute a command with specific environment variables
      shell: echo $MY_VAR
      environment:
        MY_VAR: "Some value"

    - name: Execute a command with a custom user home directory
      shell: echo $HOME
      environment:
        HOME: /custom/home/dir

    - name: Execute a command with unusual inputs
      shell: printf '\x01\x02\x03'

    - name: Execute a shell command that requires an argument
      shell: command --argument

    - name: Execute a shell command with a long syntax
      shell: ls -la /absolutely/outrageously/long/path/and/file/name/that/should/test/Ansible's/limits

    - name: Attempt to execute a command with a non-ASCII character in the path
      shell: /šđčćž/bin/ls

    - name: Execute a command with multiple pipes
      command: echo "Hello" | grep "test" | wc -l

    - name: Attempt to execute a command with a syntax error in the command line
      shell: command | grep
