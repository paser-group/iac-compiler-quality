
- hosts: localhost
  connection: local
  gather_facts: no

  vars:
    slack_webhook_url: "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"
    slack_message_payload: "{'text': 'Test Message'}"

  tasks:
    - name: Test Slack Webhook using uri module
      uri:
        url: "{{ slack_webhook_url }}"
        method: POST
        body_format: json
        body: "{{ slack_message_payload }}"
        status_code: 200
        return_content: yes
      register: slack_response

    - name: Check for 404 error in Slack Webhook response
      fail:
        msg: "404 Error in webhook response"
      when: slack_response.status == 404

    - name: Check for server-side error in Slack Webhook response
      fail:
        msg: "Server Error in webhook response"
      when: slack_response.status >= 500
