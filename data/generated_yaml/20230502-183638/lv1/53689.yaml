yaml
- name: Install dependencies for Ansible Slack callback plugin
  hosts: all
  become: yes

  tasks:
    - name: Install pip
      apt:
        name: python-pip
        state: present

    - name: Install Ansible Slack callback plugin dependencies
      pip:
        name:
          - requests
          - slack-sdk
          - slack-sdk[browser]
          - slack-sdk[socket_mode]
          - slack-bolt
      become: yes

- name: Configure 'slack' callback plugin
  hosts: all
  gather_facts: no
  vars:
    slack_api_token: YOUR_SLACK_API_TOKEN_HERE
    slack_channel: YOUR_SLACK_CHANNEL_NAME_HERE

  tasks:
    - name: Copy slack.py plugin file to callback_plugins directory
      copy:
        src: /path/to/slack.py
        dest: /etc/ansible/callback_plugins/

    - name: Set Slack API token and channel info in ansible.cfg file
      lineinfile:
        path: /etc/ansible/ansible.cfg
        regexp: "^(callback_whitelist = )"
        line: "callback_whitelist = slack"
      become: yes

    - name: Create Slack notification test task
      debug:
        msg: "This is a test notification from Ansible to Slack channel."
      notify: slack

  handlers:
    - name: Send Slack notification
      slack:
        token: "{{ slack_api_token }}"
        channel: "{{ slack_channel }}"
        color: "#00FF00"
        title: "Ansible playbook run complete"
        title_link: "https://your.ansible.host"
        text: "Ansible playbook 'slack' callback plugin test message."
        footer: "Ansible Slack Callback Plugin"
